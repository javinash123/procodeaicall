{"file_contents":{"client/src/pages/features.tsx":{"content":"import { Button } from \"@/components/ui/button\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { CheckCircle2, Zap, Mic, MessageSquare, BarChart3, Shield, Globe, Clock } from \"lucide-react\";\nimport { motion } from \"framer-motion\";\nimport featureImage from \"@assets/generated_images/futuristic_server_room_or_data_center_for_features_page..png\";\n\nexport default function Features() {\n  const features = [\n    {\n      icon: Mic,\n      title: \"Natural Voice AI\",\n      description: \"Our AI speaks with human-like intonation, pauses, and emotional intelligence. It's indistinguishable from a top-tier sales rep.\"\n    },\n    {\n      icon: Zap,\n      title: \"Instant Response\",\n      description: \"Zero latency. The AI processes speech and responds in milliseconds, ensuring fluid, natural conversations without awkward pauses.\"\n    },\n    {\n      icon: MessageSquare,\n      title: \"Dynamic Scripting\",\n      description: \"Build complex conversation flows with a visual editor. The AI adapts to objections and questions in real-time.\"\n    },\n    {\n      icon: BarChart3,\n      title: \"Real-time Analytics\",\n      description: \"Track sentiment, objection rates, and conversion metrics instantly. optimizing your pitch based on data.\"\n    },\n    {\n      icon: Shield,\n      title: \"Enterprise Security\",\n      description: \"SOC2 compliant infrastructure. Your data is encrypted at rest and in transit. Role-based access control included.\"\n    },\n    {\n      icon: Globe,\n      title: \"Multilingual Support\",\n      description: \"Scale globally with support for 30+ languages and dialects. The AI detects language automatically.\"\n    },\n    {\n      icon: Clock,\n      title: \"24/7 Availability\",\n      description: \"Never miss a lead. Your AI agents work round the clock, handling inbound inquiries and outbound campaigns.\"\n    },\n    {\n      icon: CheckCircle2,\n      title: \"Seamless Integration\",\n      description: \"Connects with Salesforce, HubSpot, Pipedrive, and Zapier out of the box. Syncs data automatically.\"\n    }\n  ];\n\n  return (\n    <div className=\"flex flex-col min-h-screen\">\n      {/* Hero */}\n      <section className=\"relative py-24 overflow-hidden bg-muted/10\">\n        <div className=\"container mx-auto px-4 text-center relative z-10\">\n          <motion.div\n            initial={{ opacity: 0, y: 20 }}\n            animate={{ opacity: 1, y: 0 }}\n            transition={{ duration: 0.6 }}\n          >\n            <h1 className=\"text-4xl md:text-6xl font-bold mb-6\">\n              Features that <span className=\"text-primary\">Drive Revenue</span>\n            </h1>\n            <p className=\"text-xl text-muted-foreground max-w-2xl mx-auto mb-10\">\n              Built for sales teams who demand performance, reliability, and scale.\n            </p>\n          </motion.div>\n        </div>\n      </section>\n\n      {/* Feature Grid */}\n      <section className=\"py-24\">\n        <div className=\"container mx-auto px-4\">\n          <div className=\"grid md:grid-cols-2 lg:grid-cols-4 gap-8\">\n            {features.map((feature, index) => (\n              <Card key={index} className=\"bg-card/50 border-primary/10 hover:border-primary/30 transition-all duration-300 group\">\n                <CardHeader>\n                  <div className=\"w-12 h-12 rounded-lg bg-primary/10 flex items-center justify-center mb-4 group-hover:bg-primary/20 transition-colors\">\n                    <feature.icon className=\"h-6 w-6 text-primary\" />\n                  </div>\n                  <CardTitle>{feature.title}</CardTitle>\n                </CardHeader>\n                <CardContent>\n                  <p className=\"text-muted-foreground text-sm leading-relaxed\">\n                    {feature.description}\n                  </p>\n                </CardContent>\n              </Card>\n            ))}\n          </div>\n        </div>\n      </section>\n\n      {/* Tech Specs Section */}\n      <section className=\"py-24 bg-black text-white\">\n        <div className=\"container mx-auto px-4\">\n          <div className=\"grid md:grid-cols-2 gap-16 items-center\">\n            <div>\n              <h2 className=\"text-3xl md:text-4xl font-bold mb-6\">Under the Hood</h2>\n              <div className=\"space-y-8\">\n                <div>\n                  <h3 className=\"text-xl font-bold text-primary mb-2\">Latency</h3>\n                  <p className=\"text-gray-400\">Sub-500ms voice-to-voice response time using optimized edge computing.</p>\n                </div>\n                <div>\n                  <h3 className=\"text-xl font-bold text-primary mb-2\">Telephony</h3>\n                  <p className=\"text-gray-400\">Direct carrier integration via Twilio for crystal clear call quality and high deliverability.</p>\n                </div>\n                <div>\n                  <h3 className=\"text-xl font-bold text-primary mb-2\">LLM Engine</h3>\n                  <p className=\"text-gray-400\">Powered by fine-tuned models specifically trained on successful sales conversations.</p>\n                </div>\n              </div>\n            </div>\n            <div className=\"relative rounded-xl overflow-hidden border border-white/10 shadow-2xl\">\n               <img src={featureImage} alt=\"Tech Dashboard\" className=\"w-full h-full object-cover opacity-80\" />\n               <div className=\"absolute inset-0 bg-gradient-to-t from-black/80 to-transparent\" />\n            </div>\n          </div>\n        </div>\n      </section>\n      \n      {/* CTA */}\n      <section className=\"py-24 text-center\">\n         <div className=\"container mx-auto px-4\">\n           <h2 className=\"text-3xl font-bold mb-6\">Ready to experience the future?</h2>\n           <Button size=\"lg\" className=\"h-12 px-8 rounded-full\">\n             Get Started Today\n           </Button>\n         </div>\n      </section>\n    </div>\n  );\n}\n","path":null,"size_bytes":5811,"size_tokens":null},"server/static.ts":{"content":"import express, { type Express } from \"express\";\nimport fs from \"fs\";\nimport path from \"path\";\n\nexport function serveStatic(app: Express) {\n  const distPath = path.resolve(__dirname, \"public\");\n  if (!fs.existsSync(distPath)) {\n    throw new Error(\n      `Could not find the build directory: ${distPath}, make sure to build the client first`,\n    );\n  }\n\n  app.use(express.static(distPath));\n\n  // fall through to index.html if the file doesn't exist\n  app.use(\"*\", (_req, res) => {\n    res.sendFile(path.resolve(distPath, \"index.html\"));\n  });\n}\n","path":null,"size_bytes":547,"size_tokens":null},"client/src/components/ui/tabs.tsx":{"content":"import * as React from \"react\"\nimport * as TabsPrimitive from \"@radix-ui/react-tabs\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Tabs = TabsPrimitive.Root\n\nconst TabsList = React.forwardRef<\n  React.ElementRef<typeof TabsPrimitive.List>,\n  React.ComponentPropsWithoutRef<typeof TabsPrimitive.List>\n>(({ className, ...props }, ref) => (\n  <TabsPrimitive.List\n    ref={ref}\n    className={cn(\n      \"inline-flex h-9 items-center justify-center rounded-lg bg-muted p-1 text-muted-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\nTabsList.displayName = TabsPrimitive.List.displayName\n\nconst TabsTrigger = React.forwardRef<\n  React.ElementRef<typeof TabsPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof TabsPrimitive.Trigger>\n>(({ className, ...props }, ref) => (\n  <TabsPrimitive.Trigger\n    ref={ref}\n    className={cn(\n      \"inline-flex items-center justify-center whitespace-nowrap rounded-md px-3 py-1 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow\",\n      className\n    )}\n    {...props}\n  />\n))\nTabsTrigger.displayName = TabsPrimitive.Trigger.displayName\n\nconst TabsContent = React.forwardRef<\n  React.ElementRef<typeof TabsPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof TabsPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <TabsPrimitive.Content\n    ref={ref}\n    className={cn(\n      \"mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2\",\n      className\n    )}\n    {...props}\n  />\n))\nTabsContent.displayName = TabsPrimitive.Content.displayName\n\nexport { Tabs, TabsList, TabsTrigger, TabsContent }\n","path":null,"size_bytes":1877,"size_tokens":null},"client/src/hooks/use-mobile.tsx":{"content":"import * as React from \"react\"\n\nconst MOBILE_BREAKPOINT = 768\n\nexport function useIsMobile() {\n  const [isMobile, setIsMobile] = React.useState<boolean | undefined>(undefined)\n\n  React.useEffect(() => {\n    const mql = window.matchMedia(`(max-width: ${MOBILE_BREAKPOINT - 1}px)`)\n    const onChange = () => {\n      setIsMobile(window.innerWidth < MOBILE_BREAKPOINT)\n    }\n    mql.addEventListener(\"change\", onChange)\n    setIsMobile(window.innerWidth < MOBILE_BREAKPOINT)\n    return () => mql.removeEventListener(\"change\", onChange)\n  }, [])\n\n  return !!isMobile\n}\n","path":null,"size_bytes":565,"size_tokens":null},"script/build.ts":{"content":"import { build as esbuild } from \"esbuild\";\nimport { build as viteBuild } from \"vite\";\nimport { rm, readFile } from \"fs/promises\";\n\n// server deps to bundle to reduce openat(2) syscalls\n// which helps cold start times\nconst allowlist = [\n  \"@google/generative-ai\",\n  \"axios\",\n  \"bcryptjs\",\n  \"connect-pg-simple\",\n  \"cors\",\n  \"date-fns\",\n  \"drizzle-orm\",\n  \"drizzle-zod\",\n  \"express\",\n  \"express-rate-limit\",\n  \"express-session\",\n  \"jsonwebtoken\",\n  \"memorystore\",\n  \"mongodb\",\n  \"mongoose\",\n  \"multer\",\n  \"nanoid\",\n  \"nodemailer\",\n  \"openai\",\n  \"passport\",\n  \"passport-local\",\n  \"pg\",\n  \"stripe\",\n  \"uuid\",\n  \"ws\",\n  \"xlsx\",\n  \"zod\",\n  \"zod-validation-error\",\n];\n\nasync function buildAll() {\n  await rm(\"dist\", { recursive: true, force: true });\n\n  console.log(\"building client...\");\n  await viteBuild({ base: \"/aiagent/\" });\n\n  console.log(\"building server...\");\n  const pkg = JSON.parse(await readFile(\"package.json\", \"utf-8\"));\n  const allDeps = [\n    ...Object.keys(pkg.dependencies || {}),\n    ...Object.keys(pkg.devDependencies || {}),\n  ];\n  const externals = allDeps.filter((dep) => !allowlist.includes(dep));\n\n  await esbuild({\n    entryPoints: [\"server/index.ts\"],\n    platform: \"node\",\n    bundle: true,\n    format: \"cjs\",\n    outfile: \"dist/index.cjs\",\n    define: {\n      \"process.env.NODE_ENV\": '\"production\"',\n    },\n    minify: true,\n    external: externals,\n    logLevel: \"info\",\n  });\n}\n\nbuildAll().catch((err) => {\n  console.error(err);\n  process.exit(1);\n});\n","path":null,"size_bytes":1479,"size_tokens":null},"client/src/components/ui/sonner.tsx":{"content":"\"use client\"\n\nimport { useTheme } from \"next-themes\"\nimport { Toaster as Sonner } from \"sonner\"\n\ntype ToasterProps = React.ComponentProps<typeof Sonner>\n\nconst Toaster = ({ ...props }: ToasterProps) => {\n  const { theme = \"system\" } = useTheme()\n\n  return (\n    <Sonner\n      theme={theme as ToasterProps[\"theme\"]}\n      className=\"toaster group\"\n      toastOptions={{\n        classNames: {\n          toast:\n            \"group toast group-[.toaster]:bg-background group-[.toaster]:text-foreground group-[.toaster]:border-border group-[.toaster]:shadow-lg\",\n          description: \"group-[.toast]:text-muted-foreground\",\n          actionButton:\n            \"group-[.toast]:bg-primary group-[.toast]:text-primary-foreground\",\n          cancelButton:\n            \"group-[.toast]:bg-muted group-[.toast]:text-muted-foreground\",\n        },\n      }}\n      {...props}\n    />\n  )\n}\n\nexport { Toaster }\n","path":null,"size_bytes":894,"size_tokens":null},"client/src/components/ui/toggle.tsx":{"content":"import * as React from \"react\"\nimport * as TogglePrimitive from \"@radix-ui/react-toggle\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst toggleVariants = cva(\n  \"inline-flex items-center justify-center gap-2 rounded-md text-sm font-medium transition-colors hover:bg-muted hover:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 data-[state=on]:bg-accent data-[state=on]:text-accent-foreground [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\",\n  {\n    variants: {\n      variant: {\n        default: \"bg-transparent\",\n        outline:\n          \"border border-input bg-transparent shadow-sm hover:bg-accent hover:text-accent-foreground\",\n      },\n      size: {\n        default: \"h-9 px-2 min-w-9\",\n        sm: \"h-8 px-1.5 min-w-8\",\n        lg: \"h-10 px-2.5 min-w-10\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  }\n)\n\nconst Toggle = React.forwardRef<\n  React.ElementRef<typeof TogglePrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof TogglePrimitive.Root> &\n    VariantProps<typeof toggleVariants>\n>(({ className, variant, size, ...props }, ref) => (\n  <TogglePrimitive.Root\n    ref={ref}\n    className={cn(toggleVariants({ variant, size, className }))}\n    {...props}\n  />\n))\n\nToggle.displayName = TogglePrimitive.Root.displayName\n\nexport { Toggle, toggleVariants }\n","path":null,"size_bytes":1486,"size_tokens":null},"client/src/pages/about.tsx":{"content":"import { Button } from \"@/components/ui/button\";\nimport { Link } from \"wouter\";\nimport { ArrowRight } from \"lucide-react\";\nimport aboutImage from \"@assets/generated_images/abstract_network_connections_glowing_in_orange_for_about_and_contact_pages..png\";\n\nexport default function About() {\n  return (\n    <div className=\"flex flex-col min-h-screen\">\n      {/* Hero */}\n      <section className=\"relative py-24 overflow-hidden\">\n        <div className=\"container mx-auto px-4 relative z-10\">\n          <div className=\"max-w-3xl\">\n            <h1 className=\"text-4xl md:text-6xl font-bold mb-6\">\n              We're building the <span className=\"text-primary\">Voice of the Future</span>\n            </h1>\n            <p className=\"text-xl text-muted-foreground leading-relaxed\">\n              NIJVOX was founded on a simple belief: Humans shouldn't have to do robotic work. We're replacing the repetitive grind of outbound sales with intelligent, empathetic AI agents.\n            </p>\n          </div>\n        </div>\n      </section>\n\n      {/* Mission */}\n      <section className=\"py-16 bg-muted/10\">\n        <div className=\"container mx-auto px-4\">\n          <div className=\"grid md:grid-cols-2 gap-12 items-center\">\n             <div className=\"rounded-xl overflow-hidden border border-primary/10 shadow-xl\">\n                <img src={aboutImage} alt=\"About Us\" className=\"w-full h-full object-cover\" />\n             </div>\n             <div className=\"space-y-6\">\n               <h2 className=\"text-3xl font-bold\">Our Mission</h2>\n               <p className=\"text-muted-foreground\">\n                 Sales teams are burning out. They spend hours dialing numbers, getting rejected, and repeating the same script. It's inefficient and demoralizing.\n               </p>\n               <p className=\"text-muted-foreground\">\n                 We built NIJVOX to take over the \"grunt work\" of salesâ€”the cold calling, the qualifying, the follow-ups. This frees up human sales professionals to do what they do best: build genuine relationships and close complex deals.\n               </p>\n               <div className=\"pt-4\">\n                 <Link href=\"/contact\">\n                   <Button variant=\"outline\">Contact Us <ArrowRight className=\"ml-2 h-4 w-4\" /></Button>\n                 </Link>\n               </div>\n             </div>\n          </div>\n        </div>\n      </section>\n\n      {/* Team Stats */}\n      <section className=\"py-24\">\n        <div className=\"container mx-auto px-4\">\n           <div className=\"grid grid-cols-2 md:grid-cols-4 gap-8 text-center\">\n             <div>\n               <div className=\"text-4xl font-bold text-primary mb-2\">2023</div>\n               <div className=\"text-sm text-muted-foreground uppercase tracking-widest\">Founded</div>\n             </div>\n             <div>\n               <div className=\"text-4xl font-bold text-primary mb-2\">25+</div>\n               <div className=\"text-sm text-muted-foreground uppercase tracking-widest\">Team Members</div>\n             </div>\n             <div>\n               <div className=\"text-4xl font-bold text-primary mb-2\">SF</div>\n               <div className=\"text-sm text-muted-foreground uppercase tracking-widest\">HQ Location</div>\n             </div>\n             <div>\n               <div className=\"text-4xl font-bold text-primary mb-2\">$10M</div>\n               <div className=\"text-sm text-muted-foreground uppercase tracking-widest\">Funding</div>\n             </div>\n           </div>\n        </div>\n      </section>\n    </div>\n  );\n}\n","path":null,"size_bytes":3531,"size_tokens":null},"client/src/components/ui/chart.tsx":{"content":"import * as React from \"react\"\nimport * as RechartsPrimitive from \"recharts\"\n\nimport { cn } from \"@/lib/utils\"\n\n// Format: { THEME_NAME: CSS_SELECTOR }\nconst THEMES = { light: \"\", dark: \".dark\" } as const\n\nexport type ChartConfig = {\n  [k in string]: {\n    label?: React.ReactNode\n    icon?: React.ComponentType\n  } & (\n    | { color?: string; theme?: never }\n    | { color?: never; theme: Record<keyof typeof THEMES, string> }\n  )\n}\n\ntype ChartContextProps = {\n  config: ChartConfig\n}\n\nconst ChartContext = React.createContext<ChartContextProps | null>(null)\n\nfunction useChart() {\n  const context = React.useContext(ChartContext)\n\n  if (!context) {\n    throw new Error(\"useChart must be used within a <ChartContainer />\")\n  }\n\n  return context\n}\n\nconst ChartContainer = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\"> & {\n    config: ChartConfig\n    children: React.ComponentProps<\n      typeof RechartsPrimitive.ResponsiveContainer\n    >[\"children\"]\n  }\n>(({ id, className, children, config, ...props }, ref) => {\n  const uniqueId = React.useId()\n  const chartId = `chart-${id || uniqueId.replace(/:/g, \"\")}`\n\n  return (\n    <ChartContext.Provider value={{ config }}>\n      <div\n        data-chart={chartId}\n        ref={ref}\n        className={cn(\n          \"flex aspect-video justify-center text-xs [&_.recharts-cartesian-axis-tick_text]:fill-muted-foreground [&_.recharts-cartesian-grid_line[stroke='#ccc']]:stroke-border/50 [&_.recharts-curve.recharts-tooltip-cursor]:stroke-border [&_.recharts-dot[stroke='#fff']]:stroke-transparent [&_.recharts-layer]:outline-none [&_.recharts-polar-grid_[stroke='#ccc']]:stroke-border [&_.recharts-radial-bar-background-sector]:fill-muted [&_.recharts-rectangle.recharts-tooltip-cursor]:fill-muted [&_.recharts-reference-line_[stroke='#ccc']]:stroke-border [&_.recharts-sector[stroke='#fff']]:stroke-transparent [&_.recharts-sector]:outline-none [&_.recharts-surface]:outline-none\",\n          className\n        )}\n        {...props}\n      >\n        <ChartStyle id={chartId} config={config} />\n        <RechartsPrimitive.ResponsiveContainer>\n          {children}\n        </RechartsPrimitive.ResponsiveContainer>\n      </div>\n    </ChartContext.Provider>\n  )\n})\nChartContainer.displayName = \"Chart\"\n\nconst ChartStyle = ({ id, config }: { id: string; config: ChartConfig }) => {\n  const colorConfig = Object.entries(config).filter(\n    ([, config]) => config.theme || config.color\n  )\n\n  if (!colorConfig.length) {\n    return null\n  }\n\n  return (\n    <style\n      dangerouslySetInnerHTML={{\n        __html: Object.entries(THEMES)\n          .map(\n            ([theme, prefix]) => `\n${prefix} [data-chart=${id}] {\n${colorConfig\n  .map(([key, itemConfig]) => {\n    const color =\n      itemConfig.theme?.[theme as keyof typeof itemConfig.theme] ||\n      itemConfig.color\n    return color ? `  --color-${key}: ${color};` : null\n  })\n  .join(\"\\n\")}\n}\n`\n          )\n          .join(\"\\n\"),\n      }}\n    />\n  )\n}\n\nconst ChartTooltip = RechartsPrimitive.Tooltip\n\nconst ChartTooltipContent = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<typeof RechartsPrimitive.Tooltip> &\n    React.ComponentProps<\"div\"> & {\n      hideLabel?: boolean\n      hideIndicator?: boolean\n      indicator?: \"line\" | \"dot\" | \"dashed\"\n      nameKey?: string\n      labelKey?: string\n    }\n>(\n  (\n    {\n      active,\n      payload,\n      className,\n      indicator = \"dot\",\n      hideLabel = false,\n      hideIndicator = false,\n      label,\n      labelFormatter,\n      labelClassName,\n      formatter,\n      color,\n      nameKey,\n      labelKey,\n    },\n    ref\n  ) => {\n    const { config } = useChart()\n\n    const tooltipLabel = React.useMemo(() => {\n      if (hideLabel || !payload?.length) {\n        return null\n      }\n\n      const [item] = payload\n      const key = `${labelKey || item?.dataKey || item?.name || \"value\"}`\n      const itemConfig = getPayloadConfigFromPayload(config, item, key)\n      const value =\n        !labelKey && typeof label === \"string\"\n          ? config[label as keyof typeof config]?.label || label\n          : itemConfig?.label\n\n      if (labelFormatter) {\n        return (\n          <div className={cn(\"font-medium\", labelClassName)}>\n            {labelFormatter(value, payload)}\n          </div>\n        )\n      }\n\n      if (!value) {\n        return null\n      }\n\n      return <div className={cn(\"font-medium\", labelClassName)}>{value}</div>\n    }, [\n      label,\n      labelFormatter,\n      payload,\n      hideLabel,\n      labelClassName,\n      config,\n      labelKey,\n    ])\n\n    if (!active || !payload?.length) {\n      return null\n    }\n\n    const nestLabel = payload.length === 1 && indicator !== \"dot\"\n\n    return (\n      <div\n        ref={ref}\n        className={cn(\n          \"grid min-w-[8rem] items-start gap-1.5 rounded-lg border border-border/50 bg-background px-2.5 py-1.5 text-xs shadow-xl\",\n          className\n        )}\n      >\n        {!nestLabel ? tooltipLabel : null}\n        <div className=\"grid gap-1.5\">\n          {payload\n            .filter((item) => item.type !== \"none\")\n            .map((item, index) => {\n              const key = `${nameKey || item.name || item.dataKey || \"value\"}`\n              const itemConfig = getPayloadConfigFromPayload(config, item, key)\n              const indicatorColor = color || item.payload.fill || item.color\n\n              return (\n                <div\n                  key={item.dataKey}\n                  className={cn(\n                    \"flex w-full flex-wrap items-stretch gap-2 [&>svg]:h-2.5 [&>svg]:w-2.5 [&>svg]:text-muted-foreground\",\n                    indicator === \"dot\" && \"items-center\"\n                  )}\n                >\n                  {formatter && item?.value !== undefined && item.name ? (\n                    formatter(item.value, item.name, item, index, item.payload)\n                  ) : (\n                    <>\n                      {itemConfig?.icon ? (\n                        <itemConfig.icon />\n                      ) : (\n                        !hideIndicator && (\n                          <div\n                            className={cn(\n                              \"shrink-0 rounded-[2px] border-[--color-border] bg-[--color-bg]\",\n                              {\n                                \"h-2.5 w-2.5\": indicator === \"dot\",\n                                \"w-1\": indicator === \"line\",\n                                \"w-0 border-[1.5px] border-dashed bg-transparent\":\n                                  indicator === \"dashed\",\n                                \"my-0.5\": nestLabel && indicator === \"dashed\",\n                              }\n                            )}\n                            style={\n                              {\n                                \"--color-bg\": indicatorColor,\n                                \"--color-border\": indicatorColor,\n                              } as React.CSSProperties\n                            }\n                          />\n                        )\n                      )}\n                      <div\n                        className={cn(\n                          \"flex flex-1 justify-between leading-none\",\n                          nestLabel ? \"items-end\" : \"items-center\"\n                        )}\n                      >\n                        <div className=\"grid gap-1.5\">\n                          {nestLabel ? tooltipLabel : null}\n                          <span className=\"text-muted-foreground\">\n                            {itemConfig?.label || item.name}\n                          </span>\n                        </div>\n                        {item.value && (\n                          <span className=\"font-mono font-medium tabular-nums text-foreground\">\n                            {item.value.toLocaleString()}\n                          </span>\n                        )}\n                      </div>\n                    </>\n                  )}\n                </div>\n              )\n            })}\n        </div>\n      </div>\n    )\n  }\n)\nChartTooltipContent.displayName = \"ChartTooltip\"\n\nconst ChartLegend = RechartsPrimitive.Legend\n\nconst ChartLegendContent = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\"> &\n    Pick<RechartsPrimitive.LegendProps, \"payload\" | \"verticalAlign\"> & {\n      hideIcon?: boolean\n      nameKey?: string\n    }\n>(\n  (\n    { className, hideIcon = false, payload, verticalAlign = \"bottom\", nameKey },\n    ref\n  ) => {\n    const { config } = useChart()\n\n    if (!payload?.length) {\n      return null\n    }\n\n    return (\n      <div\n        ref={ref}\n        className={cn(\n          \"flex items-center justify-center gap-4\",\n          verticalAlign === \"top\" ? \"pb-3\" : \"pt-3\",\n          className\n        )}\n      >\n        {payload\n          .filter((item) => item.type !== \"none\")\n          .map((item) => {\n            const key = `${nameKey || item.dataKey || \"value\"}`\n            const itemConfig = getPayloadConfigFromPayload(config, item, key)\n\n            return (\n              <div\n                key={item.value}\n                className={cn(\n                  \"flex items-center gap-1.5 [&>svg]:h-3 [&>svg]:w-3 [&>svg]:text-muted-foreground\"\n                )}\n              >\n                {itemConfig?.icon && !hideIcon ? (\n                  <itemConfig.icon />\n                ) : (\n                  <div\n                    className=\"h-2 w-2 shrink-0 rounded-[2px]\"\n                    style={{\n                      backgroundColor: item.color,\n                    }}\n                  />\n                )}\n                {itemConfig?.label}\n              </div>\n            )\n          })}\n      </div>\n    )\n  }\n)\nChartLegendContent.displayName = \"ChartLegend\"\n\n// Helper to extract item config from a payload.\nfunction getPayloadConfigFromPayload(\n  config: ChartConfig,\n  payload: unknown,\n  key: string\n) {\n  if (typeof payload !== \"object\" || payload === null) {\n    return undefined\n  }\n\n  const payloadPayload =\n    \"payload\" in payload &&\n    typeof payload.payload === \"object\" &&\n    payload.payload !== null\n      ? payload.payload\n      : undefined\n\n  let configLabelKey: string = key\n\n  if (\n    key in payload &&\n    typeof payload[key as keyof typeof payload] === \"string\"\n  ) {\n    configLabelKey = payload[key as keyof typeof payload] as string\n  } else if (\n    payloadPayload &&\n    key in payloadPayload &&\n    typeof payloadPayload[key as keyof typeof payloadPayload] === \"string\"\n  ) {\n    configLabelKey = payloadPayload[\n      key as keyof typeof payloadPayload\n    ] as string\n  }\n\n  return configLabelKey in config\n    ? config[configLabelKey]\n    : config[key as keyof typeof config]\n}\n\nexport {\n  ChartContainer,\n  ChartTooltip,\n  ChartTooltipContent,\n  ChartLegend,\n  ChartLegendContent,\n  ChartStyle,\n}\n","path":null,"size_bytes":10763,"size_tokens":null},"client/src/lib/auth.tsx":{"content":"import { createContext, useContext, useState, useEffect, ReactNode } from \"react\";\nimport { useLocation } from \"wouter\";\nimport { authApi } from \"./api\";\nimport type { User } from \"@shared/schema\";\n\ninterface AuthContextType {\n  user: User | null;\n  loading: boolean;\n  login: (email: string, password: string) => Promise<void>;\n  logout: () => Promise<void>;\n  refetchUser: () => Promise<void>;\n}\n\nconst AuthContext = createContext<AuthContextType | undefined>(undefined);\n\nexport function AuthProvider({ children }: { children: ReactNode }) {\n  const [user, setUser] = useState<User | null>(null);\n  const [loading, setLoading] = useState(true);\n  const [, setLocation] = useLocation();\n\n  const fetchUser = async () => {\n    try {\n      const currentUser = await authApi.getCurrentUser();\n      setUser(currentUser);\n    } catch (error) {\n      setUser(null);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  useEffect(() => {\n    fetchUser();\n  }, []);\n\n  const login = async (email: string, password: string) => {\n    const loggedInUser = await authApi.login(email, password);\n    setUser(loggedInUser);\n    \n    // Redirect based on role\n    const isProduction = import.meta.env.PROD;\n    const base = isProduction ? \"/aiagent\" : \"\";\n    \n    if (loggedInUser.role === \"admin\") {\n      setLocation(`${base}/admin/dashboard`, { replace: true });\n    } else {\n      setLocation(`${base}/dashboard`, { replace: true });\n    }\n  };\n\n  const logout = async () => {\n    await authApi.logout();\n    setUser(null);\n    setLocation(\"/\");\n  };\n\n  const refetchUser = async () => {\n    await fetchUser();\n  };\n\n  return (\n    <AuthContext.Provider value={{ user, loading, login, logout, refetchUser }}>\n      {children}\n    </AuthContext.Provider>\n  );\n}\n\nexport function useAuth() {\n  const context = useContext(AuthContext);\n  if (context === undefined) {\n    throw new Error(\"useAuth must be used within an AuthProvider\");\n  }\n  return context;\n}\n","path":null,"size_bytes":1951,"size_tokens":null},"client/src/components/ui/table.tsx":{"content":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Table = React.forwardRef<\n  HTMLTableElement,\n  React.HTMLAttributes<HTMLTableElement>\n>(({ className, ...props }, ref) => (\n  <div className=\"relative w-full overflow-auto\">\n    <table\n      ref={ref}\n      className={cn(\"w-full caption-bottom text-sm\", className)}\n      {...props}\n    />\n  </div>\n))\nTable.displayName = \"Table\"\n\nconst TableHeader = React.forwardRef<\n  HTMLTableSectionElement,\n  React.HTMLAttributes<HTMLTableSectionElement>\n>(({ className, ...props }, ref) => (\n  <thead ref={ref} className={cn(\"[&_tr]:border-b\", className)} {...props} />\n))\nTableHeader.displayName = \"TableHeader\"\n\nconst TableBody = React.forwardRef<\n  HTMLTableSectionElement,\n  React.HTMLAttributes<HTMLTableSectionElement>\n>(({ className, ...props }, ref) => (\n  <tbody\n    ref={ref}\n    className={cn(\"[&_tr:last-child]:border-0\", className)}\n    {...props}\n  />\n))\nTableBody.displayName = \"TableBody\"\n\nconst TableFooter = React.forwardRef<\n  HTMLTableSectionElement,\n  React.HTMLAttributes<HTMLTableSectionElement>\n>(({ className, ...props }, ref) => (\n  <tfoot\n    ref={ref}\n    className={cn(\n      \"border-t bg-muted/50 font-medium [&>tr]:last:border-b-0\",\n      className\n    )}\n    {...props}\n  />\n))\nTableFooter.displayName = \"TableFooter\"\n\nconst TableRow = React.forwardRef<\n  HTMLTableRowElement,\n  React.HTMLAttributes<HTMLTableRowElement>\n>(({ className, ...props }, ref) => (\n  <tr\n    ref={ref}\n    className={cn(\n      \"border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted\",\n      className\n    )}\n    {...props}\n  />\n))\nTableRow.displayName = \"TableRow\"\n\nconst TableHead = React.forwardRef<\n  HTMLTableCellElement,\n  React.ThHTMLAttributes<HTMLTableCellElement>\n>(({ className, ...props }, ref) => (\n  <th\n    ref={ref}\n    className={cn(\n      \"h-10 px-2 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]\",\n      className\n    )}\n    {...props}\n  />\n))\nTableHead.displayName = \"TableHead\"\n\nconst TableCell = React.forwardRef<\n  HTMLTableCellElement,\n  React.TdHTMLAttributes<HTMLTableCellElement>\n>(({ className, ...props }, ref) => (\n  <td\n    ref={ref}\n    className={cn(\n      \"p-2 align-middle [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]\",\n      className\n    )}\n    {...props}\n  />\n))\nTableCell.displayName = \"TableCell\"\n\nconst TableCaption = React.forwardRef<\n  HTMLTableCaptionElement,\n  React.HTMLAttributes<HTMLTableCaptionElement>\n>(({ className, ...props }, ref) => (\n  <caption\n    ref={ref}\n    className={cn(\"mt-4 text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nTableCaption.displayName = \"TableCaption\"\n\nexport {\n  Table,\n  TableHeader,\n  TableBody,\n  TableFooter,\n  TableHead,\n  TableRow,\n  TableCell,\n  TableCaption,\n}\n","path":null,"size_bytes":2859,"size_tokens":null},"DEPLOYMENT_INSTRUCTIONS.md":{"content":"# Complete Deployment Instructions for AIAgent on AWS EC2\n\n## Files You Have\n\nYou have received the following files:\n\n1. **aiagent-deployment.tar.gz** (6.6 MB)\n   - Complete production-ready application\n   - All dependencies included\n   - Compiled frontend and backend\n\n2. **DEPLOYMENT_SUMMARY.txt**\n   - Quick reference for deployment details\n\n3. **DEPLOY_TO_EC2.sh**\n   - Automated deployment script\n\n4. **This file - DEPLOYMENT_INSTRUCTIONS.md**\n\n---\n\n## Option 1: Automated Deployment (Recommended)\n\n### Prerequisites\n- AWS EC2 instance running Ubuntu 20.04 or later\n- EC2 instance public IP: 3.208.52.220\n- SSH access with your AWS key pair\n- Apache already installed or will be installed\n\n### One-Command Deployment\n\n```bash\n# Make script executable\nchmod +x DEPLOY_TO_EC2.sh\n\n# Run the deployment script\n./DEPLOY_TO_EC2.sh /path/to/your-aws-key.pem\n```\n\nThe script will:\n1. Upload the deployment package to your EC2 instance\n2. Extract files\n3. Install dependencies\n4. Configure Apache\n5. Set up systemd service\n\n---\n\n## Option 2: Manual Step-by-Step Deployment\n\n### Step 1: Upload Deployment Package to EC2\n\nFrom your local machine:\n```bash\n# Using SCP to upload the file\nscp -i /path/to/your-aws-key.pem aiagent-deployment.tar.gz ubuntu@3.208.52.220:/tmp/\n```\n\n### Step 2: Connect to EC2\n\n```bash\nssh -i /path/to/your-aws-key.pem ubuntu@3.208.52.220\n```\n\n### Step 3: Extract and Setup\n\n```bash\n# Create application directory\nmkdir -p ~/aiagent\ncd ~/aiagent\n\n# Extract the deployment package\ntar -xzf /tmp/aiagent-deployment.tar.gz\nmv aiagent-deployment/* .\nmv aiagent-deployment/.* . 2>/dev/null || true\n\n# Set proper permissions\nchmod +x start.sh stop.sh\n```\n\n### Step 4: Install Node.js (if not already installed)\n\n```bash\n# Check if Node.js is installed\nnode --version\n\n# If not installed, install it\ncurl -fsSL https://deb.nodesource.com/setup_18.x | sudo -E bash -\nsudo apt-get install -y nodejs\n```\n\n### Step 5: Install Application Dependencies\n\n```bash\ncd ~/aiagent\nnpm install --only=production\n```\n\n### Step 6: Configure Environment Variables\n\n```bash\n# Edit the environment file\nnano .env.production\n```\n\n**Required Configuration:**\n\n```\nNODE_ENV=production\nPORT=5000\nMONGODB_URI=mongodb+srv://username:password@cluster.mongodb.net/aiagent?retryWrites=true&w=majority\nSESSION_SECRET=your-secure-random-string-minimum-32-characters-long\n```\n\n**How to generate SESSION_SECRET:**\n```bash\n# On your local machine or server\nnode -e \"console.log(require('crypto').randomBytes(32).toString('hex'))\"\n```\n\n### Step 7: Enable Apache Modules\n\n```bash\n# Enable required Apache modules\nsudo a2enmod proxy\nsudo a2enmod proxy_http\nsudo a2enmod headers\nsudo a2enmod deflate\n\n# Copy Apache configuration\nsudo cp ~/aiagent/aiagent.conf /etc/apache2/sites-available/\n\n# Enable the site\nsudo a2ensite aiagent.conf\n\n# Test Apache configuration\nsudo apache2ctl configtest\n# Should output: Syntax OK\n\n# Restart Apache\nsudo systemctl restart apache2\n```\n\n### Step 8: Start the Application\n\n```bash\ncd ~/aiagent\n./start.sh\n```\n\n### Step 9: Verify Installation\n\n```bash\n# Check if the Node.js process is running\nps aux | grep \"node dist\"\n\n# Test the backend API\ncurl http://localhost:5000/api/auth/me\n# Should return: {\"message\":\"Unauthorized\"}\n\n# View logs\ntail -f ~/aiagent/app.log\n```\n\n### Step 10: Access the Application\n\nOpen your browser and navigate to:\n```\nhttp://3.208.52.220/aiagent/\n```\n\n---\n\n## Troubleshooting\n\n### Application won't start\n\n**Check logs:**\n```bash\ntail -f ~/aiagent/app.log\n```\n\n**Common issues:**\n- MongoDB connection string is incorrect\n- .env.production is missing or has wrong values\n- Node.js is not installed\n- Port 5000 is already in use: `lsof -i :5000`\n\n### Apache proxy issues\n\n**Check Apache error logs:**\n```bash\nsudo tail -f /var/log/apache2/aiagent_error.log\n```\n\n**Verify proxy modules are enabled:**\n```bash\napache2ctl -M | grep proxy\n# Should show: proxy_module, proxy_http_module\n```\n\n**Test internal connection:**\n```bash\ncurl http://127.0.0.1:5000/\n```\n\n### MongoDB connection fails\n\n**Test connection string:**\n```bash\nnode -e \"require('mongodb').MongoClient.connect('YOUR_MONGODB_URI').then(() => console.log('Connected!')).catch(e => console.error('Failed:', e.message))\"\n```\n\n---\n\n## Managing the Application\n\n### Check Application Status\n```bash\nps aux | grep \"node dist\"\ncat ~/aiagent/app.pid\n```\n\n### View Real-time Logs\n```bash\ntail -f ~/aiagent/app.log\n```\n\n### Stop the Application\n```bash\n~/aiagent/stop.sh\n```\n\n### Restart the Application\n```bash\n~/aiagent/stop.sh\nsleep 2\n~/aiagent/start.sh\n```\n\n### Check Apache Status\n```bash\nsudo systemctl status apache2\n```\n\n### Reload Apache Configuration (without stopping)\n```bash\nsudo apache2ctl reload\n```\n\n---\n\n## Production Recommendations\n\n### 1. Enable HTTPS with Let's Encrypt\n\n```bash\n# Install Certbot\nsudo apt-get install -y certbot python3-certbot-apache\n\n# Get SSL certificate (auto-configures Apache)\nsudo certbot --apache -d 3.208.52.220\n\n# Auto-renewal is enabled by default\n```\n\n### 2. Setup Process Manager (PM2)\n\nPM2 will automatically restart the application if it crashes:\n\n```bash\n# Install PM2 globally\nsudo npm install -g pm2\n\n# Create ecosystem config\ncat > ~/aiagent/ecosystem.config.js << 'EOF'\nmodule.exports = {\n  apps: [{\n    name: 'aiagent',\n    script: './dist/index.cjs',\n    cwd: '/home/ubuntu/aiagent',\n    env: {\n      NODE_ENV: 'production',\n      PORT: 5000\n    },\n    autorestart: true,\n    max_memory_restart: '1G',\n    error_file: './pm2-error.log',\n    out_file: './pm2-out.log'\n  }]\n};\nEOF\n\n# Start with PM2\ncd ~/aiagent\npm2 start ecosystem.config.js\n\n# Make it auto-start on reboot\npm2 startup\npm2 save\n```\n\n### 3. Setup Firewall\n\n```bash\nsudo ufw allow 22/tcp    # SSH\nsudo ufw allow 80/tcp    # HTTP\nsudo ufw allow 443/tcp   # HTTPS\nsudo ufw enable\n```\n\n### 4. Monitor Logs and Disk Space\n\n```bash\n# Check disk usage\ndf -h\n\n# Rotate old logs\nfind ~/aiagent -name \"*.log\" -mtime +30 -delete\n\n# Monitor application logs\nwatch -n 5 'tail -20 ~/aiagent/app.log'\n```\n\n---\n\n## Updating the Application\n\nTo deploy a new version:\n\n```bash\n# Stop the current version\n~/aiagent/stop.sh\n\n# Backup current version\ntar -czf ~/aiagent-backup-$(date +%s).tar.gz ~/aiagent/dist\n\n# Extract new build (upload new aiagent-deployment.tar.gz first)\ncd ~/aiagent\ntar -xzf /tmp/aiagent-deployment.tar.gz\ncp -r aiagent-deployment/dist .\ncp aiagent-deployment/package.json .\ncp aiagent-deployment/package-lock.json .\n\n# Update dependencies\nnpm install --only=production\n\n# Start the new version\n./start.sh\n```\n\n---\n\n## Support & Monitoring\n\n### Key Commands Reference\n\n```bash\n# Check application process\nps aux | grep \"node dist\"\n\n# Monitor CPU and memory\ntop -p $(cat ~/aiagent/app.pid)\n\n# Check open ports\nlsof -i :80\nlsof -i :5000\n\n# View Apache access logs\nsudo tail -f /var/log/apache2/aiagent_access.log\n\n# View Apache error logs\nsudo tail -f /var/log/apache2/aiagent_error.log\n\n# Test internal connectivity\ncurl -v http://127.0.0.1:5000/\n\n# Check available disk space\ndf -h\n\n# Check system uptime\nuptime\n```\n\n---\n\n## Security Checklist\n\n- [ ] Changed SESSION_SECRET to a unique value\n- [ ] MongoDB URI is from a secure connection\n- [ ] Enabled HTTPS with Let's Encrypt\n- [ ] Firewall rules are properly configured\n- [ ] Regular database backups are configured\n- [ ] Application logs are monitored\n- [ ] Disk space is monitored\n- [ ] Updates are applied regularly\n\n---\n\n## File Structure After Deployment\n\n```\n/home/ubuntu/aiagent/\nâ”œâ”€â”€ dist/\nâ”‚   â”œâ”€â”€ public/              # Frontend files\nâ”‚   â”‚   â”œâ”€â”€ assets/\nâ”‚   â”‚   â”œâ”€â”€ index.html\nâ”‚   â”‚   â””â”€â”€ ...\nâ”‚   â””â”€â”€ index.cjs            # Backend compiled code\nâ”œâ”€â”€ uploads/                 # User uploaded files\nâ”œâ”€â”€ .env.production          # Environment configuration\nâ”œâ”€â”€ package.json\nâ”œâ”€â”€ package-lock.json\nâ”œâ”€â”€ start.sh                 # Start script\nâ”œâ”€â”€ stop.sh                  # Stop script\nâ”œâ”€â”€ aiagent.conf            # Apache configuration\nâ”œâ”€â”€ app.log                 # Application logs\nâ”œâ”€â”€ app.pid                 # Application process ID\nâ””â”€â”€ ecosystem.config.js     # PM2 configuration (if using PM2)\n```\n\n---\n\n## What to Do Next\n\n1. **Run deployment** using Option 1 or Option 2\n2. **Configure environment** variables (.env.production)\n3. **Access the application** at http://3.208.52.220/aiagent/\n4. **Test functionality** by creating a user account and logging in\n5. **Enable HTTPS** for production security\n6. **Setup monitoring** and backups\n\n---\n\n**Your AIAgent application is ready to deploy! Good luck! ðŸš€**\n","path":null,"size_bytes":8600,"size_tokens":null},"client/src/components/ui/progress.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as ProgressPrimitive from \"@radix-ui/react-progress\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Progress = React.forwardRef<\n  React.ElementRef<typeof ProgressPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof ProgressPrimitive.Root>\n>(({ className, value, ...props }, ref) => (\n  <ProgressPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"relative h-2 w-full overflow-hidden rounded-full bg-primary/20\",\n      className\n    )}\n    {...props}\n  >\n    <ProgressPrimitive.Indicator\n      className=\"h-full w-full flex-1 bg-primary transition-all\"\n      style={{ transform: `translateX(-${100 - (value || 0)}%)` }}\n    />\n  </ProgressPrimitive.Root>\n))\nProgress.displayName = ProgressPrimitive.Root.displayName\n\nexport { Progress }\n","path":null,"size_bytes":792,"size_tokens":null},"client/src/components/ui/label.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as LabelPrimitive from \"@radix-ui/react-label\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst labelVariants = cva(\n  \"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n)\n\nconst Label = React.forwardRef<\n  React.ElementRef<typeof LabelPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof LabelPrimitive.Root> &\n    VariantProps<typeof labelVariants>\n>(({ className, ...props }, ref) => (\n  <LabelPrimitive.Root\n    ref={ref}\n    className={cn(labelVariants(), className)}\n    {...props}\n  />\n))\nLabel.displayName = LabelPrimitive.Root.displayName\n\nexport { Label }\n","path":null,"size_bytes":724,"size_tokens":null},"client/src/components/ui/carousel.tsx":{"content":"import * as React from \"react\"\nimport useEmblaCarousel, {\n  type UseEmblaCarouselType,\n} from \"embla-carousel-react\"\nimport { ArrowLeft, ArrowRight } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Button } from \"@/components/ui/button\"\n\ntype CarouselApi = UseEmblaCarouselType[1]\ntype UseCarouselParameters = Parameters<typeof useEmblaCarousel>\ntype CarouselOptions = UseCarouselParameters[0]\ntype CarouselPlugin = UseCarouselParameters[1]\n\ntype CarouselProps = {\n  opts?: CarouselOptions\n  plugins?: CarouselPlugin\n  orientation?: \"horizontal\" | \"vertical\"\n  setApi?: (api: CarouselApi) => void\n}\n\ntype CarouselContextProps = {\n  carouselRef: ReturnType<typeof useEmblaCarousel>[0]\n  api: ReturnType<typeof useEmblaCarousel>[1]\n  scrollPrev: () => void\n  scrollNext: () => void\n  canScrollPrev: boolean\n  canScrollNext: boolean\n} & CarouselProps\n\nconst CarouselContext = React.createContext<CarouselContextProps | null>(null)\n\nfunction useCarousel() {\n  const context = React.useContext(CarouselContext)\n\n  if (!context) {\n    throw new Error(\"useCarousel must be used within a <Carousel />\")\n  }\n\n  return context\n}\n\nconst Carousel = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement> & CarouselProps\n>(\n  (\n    {\n      orientation = \"horizontal\",\n      opts,\n      setApi,\n      plugins,\n      className,\n      children,\n      ...props\n    },\n    ref\n  ) => {\n    const [carouselRef, api] = useEmblaCarousel(\n      {\n        ...opts,\n        axis: orientation === \"horizontal\" ? \"x\" : \"y\",\n      },\n      plugins\n    )\n    const [canScrollPrev, setCanScrollPrev] = React.useState(false)\n    const [canScrollNext, setCanScrollNext] = React.useState(false)\n\n    const onSelect = React.useCallback((api: CarouselApi) => {\n      if (!api) {\n        return\n      }\n\n      setCanScrollPrev(api.canScrollPrev())\n      setCanScrollNext(api.canScrollNext())\n    }, [])\n\n    const scrollPrev = React.useCallback(() => {\n      api?.scrollPrev()\n    }, [api])\n\n    const scrollNext = React.useCallback(() => {\n      api?.scrollNext()\n    }, [api])\n\n    const handleKeyDown = React.useCallback(\n      (event: React.KeyboardEvent<HTMLDivElement>) => {\n        if (event.key === \"ArrowLeft\") {\n          event.preventDefault()\n          scrollPrev()\n        } else if (event.key === \"ArrowRight\") {\n          event.preventDefault()\n          scrollNext()\n        }\n      },\n      [scrollPrev, scrollNext]\n    )\n\n    React.useEffect(() => {\n      if (!api || !setApi) {\n        return\n      }\n\n      setApi(api)\n    }, [api, setApi])\n\n    React.useEffect(() => {\n      if (!api) {\n        return\n      }\n\n      onSelect(api)\n      api.on(\"reInit\", onSelect)\n      api.on(\"select\", onSelect)\n\n      return () => {\n        api?.off(\"select\", onSelect)\n      }\n    }, [api, onSelect])\n\n    return (\n      <CarouselContext.Provider\n        value={{\n          carouselRef,\n          api: api,\n          opts,\n          orientation:\n            orientation || (opts?.axis === \"y\" ? \"vertical\" : \"horizontal\"),\n          scrollPrev,\n          scrollNext,\n          canScrollPrev,\n          canScrollNext,\n        }}\n      >\n        <div\n          ref={ref}\n          onKeyDownCapture={handleKeyDown}\n          className={cn(\"relative\", className)}\n          role=\"region\"\n          aria-roledescription=\"carousel\"\n          {...props}\n        >\n          {children}\n        </div>\n      </CarouselContext.Provider>\n    )\n  }\n)\nCarousel.displayName = \"Carousel\"\n\nconst CarouselContent = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => {\n  const { carouselRef, orientation } = useCarousel()\n\n  return (\n    <div ref={carouselRef} className=\"overflow-hidden\">\n      <div\n        ref={ref}\n        className={cn(\n          \"flex\",\n          orientation === \"horizontal\" ? \"-ml-4\" : \"-mt-4 flex-col\",\n          className\n        )}\n        {...props}\n      />\n    </div>\n  )\n})\nCarouselContent.displayName = \"CarouselContent\"\n\nconst CarouselItem = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => {\n  const { orientation } = useCarousel()\n\n  return (\n    <div\n      ref={ref}\n      role=\"group\"\n      aria-roledescription=\"slide\"\n      className={cn(\n        \"min-w-0 shrink-0 grow-0 basis-full\",\n        orientation === \"horizontal\" ? \"pl-4\" : \"pt-4\",\n        className\n      )}\n      {...props}\n    />\n  )\n})\nCarouselItem.displayName = \"CarouselItem\"\n\nconst CarouselPrevious = React.forwardRef<\n  HTMLButtonElement,\n  React.ComponentProps<typeof Button>\n>(({ className, variant = \"outline\", size = \"icon\", ...props }, ref) => {\n  const { orientation, scrollPrev, canScrollPrev } = useCarousel()\n\n  return (\n    <Button\n      ref={ref}\n      variant={variant}\n      size={size}\n      className={cn(\n        \"absolute  h-8 w-8 rounded-full\",\n        orientation === \"horizontal\"\n          ? \"-left-12 top-1/2 -translate-y-1/2\"\n          : \"-top-12 left-1/2 -translate-x-1/2 rotate-90\",\n        className\n      )}\n      disabled={!canScrollPrev}\n      onClick={scrollPrev}\n      {...props}\n    >\n      <ArrowLeft className=\"h-4 w-4\" />\n      <span className=\"sr-only\">Previous slide</span>\n    </Button>\n  )\n})\nCarouselPrevious.displayName = \"CarouselPrevious\"\n\nconst CarouselNext = React.forwardRef<\n  HTMLButtonElement,\n  React.ComponentProps<typeof Button>\n>(({ className, variant = \"outline\", size = \"icon\", ...props }, ref) => {\n  const { orientation, scrollNext, canScrollNext } = useCarousel()\n\n  return (\n    <Button\n      ref={ref}\n      variant={variant}\n      size={size}\n      className={cn(\n        \"absolute h-8 w-8 rounded-full\",\n        orientation === \"horizontal\"\n          ? \"-right-12 top-1/2 -translate-y-1/2\"\n          : \"-bottom-12 left-1/2 -translate-x-1/2 rotate-90\",\n        className\n      )}\n      disabled={!canScrollNext}\n      onClick={scrollNext}\n      {...props}\n    >\n      <ArrowRight className=\"h-4 w-4\" />\n      <span className=\"sr-only\">Next slide</span>\n    </Button>\n  )\n})\nCarouselNext.displayName = \"CarouselNext\"\n\nexport {\n  type CarouselApi,\n  Carousel,\n  CarouselContent,\n  CarouselItem,\n  CarouselPrevious,\n  CarouselNext,\n}\n","path":null,"size_bytes":6210,"size_tokens":null},"client/src/pages/bulk-whatsapp.tsx":{"content":"import { useState, useEffect } from \"react\";\nimport { useAuth } from \"@/lib/auth\";\nimport { Card, CardContent, CardHeader, CardTitle, CardDescription } from \"@/components/ui/card\";\nimport { Input } from \"@/components/ui/input\";\nimport { Search, MessageCircle, Calendar as CalendarIcon } from \"lucide-react\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { campaignsApi, leadsApi } from \"@/lib/api\";\nimport type { Campaign, Lead } from \"@shared/schema\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\";\n\nexport default function BulkWhatsapp() {\n  const { user } = useAuth();\n  const { toast } = useToast();\n  const [searchTerm, setSearchTerm] = useState(\"\");\n  const [campaignFilter, setCampaignFilter] = useState(\"all\");\n  const [dateRange, setDateRange] = useState({ start: \"\", end: \"\" });\n  const [campaigns, setCampaigns] = useState<Campaign[]>([]);\n  const [leads, setLeads] = useState<Lead[]>([]);\n  const [loading, setLoading] = useState(true);\n\n  useEffect(() => {\n    const fetchData = async () => {\n      try {\n        const [cRes, lRes] = await Promise.all([\n          campaignsApi.getAll(),\n          leadsApi.getAll()\n        ]);\n        setCampaigns(Array.isArray(cRes) ? cRes : (cRes as any).campaigns || []);\n        setLeads(Array.isArray(lRes) ? lRes : (lRes as any).leads || []);\n      } catch (error: any) {\n        toast({ variant: \"destructive\", title: \"Error loading data\", description: error.message });\n      } finally {\n        setLoading(false);\n      }\n    };\n    fetchData();\n  }, []);\n\n  const filteredLeads = leads.filter(lead => {\n    const matchesSearch = lead.name.toLowerCase().includes(searchTerm.toLowerCase()) || \n                         lead.phone.includes(searchTerm);\n    const matchesCampaign = campaignFilter === \"all\" || lead.campaignId === campaignFilter;\n    \n    let matchesDate = true;\n    if (dateRange.start || dateRange.end) {\n      const contactDate = lead.lastContact ? new Date(lead.lastContact) : new Date(lead.createdAt);\n      if (dateRange.start && contactDate < new Date(dateRange.start)) matchesDate = false;\n      if (dateRange.end && contactDate > new Date(dateRange.end)) matchesDate = false;\n    }\n\n    return matchesSearch && matchesCampaign && matchesDate;\n  });\n\n  if (!user) return null;\n\n  return (\n    <div className=\"p-6 space-y-6\">\n      <div className=\"flex flex-col gap-2\">\n        <h1 className=\"text-3xl font-bold flex items-center gap-2\">\n          <MessageCircle className=\"h-8 w-8 text-primary\" />\n          Bulk WhatsApp\n        </h1>\n        <p className=\"text-muted-foreground\">View-only list of WhatsApp communications and lead status.</p>\n      </div>\n\n      <div className=\"flex flex-wrap items-center gap-4 bg-muted/20 p-4 rounded-lg border border-border/50\">\n        <div className=\"relative min-w-[240px]\">\n          <Search className=\"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground\" />\n          <Input \n            placeholder=\"Search name or phone...\" \n            className=\"pl-9 h-9\" \n            value={searchTerm}\n            onChange={(e) => setSearchTerm(e.target.value)}\n          />\n        </div>\n\n        <Select value={campaignFilter} onValueChange={setCampaignFilter}>\n          <SelectTrigger className=\"w-[200px] h-9\">\n            <SelectValue placeholder=\"All Campaigns\" />\n          </SelectTrigger>\n          <SelectContent>\n            <SelectItem value=\"all\">All Campaigns</SelectItem>\n            {campaigns.map(c => (\n              <SelectItem key={c._id} value={c._id}>{c.name}</SelectItem>\n            ))}\n          </SelectContent>\n        </Select>\n\n        <div className=\"flex items-center gap-2 h-9\">\n          <Input \n            type=\"date\" \n            className=\"h-9 w-[150px]\"\n            value={dateRange.start} \n            onChange={(e) => setDateRange(prev => ({ ...prev, start: e.target.value }))}\n          />\n          <span className=\"text-muted-foreground\">â†’</span>\n          <Input \n            type=\"date\" \n            className=\"h-9 w-[150px]\"\n            value={dateRange.end} \n            onChange={(e) => setDateRange(prev => ({ ...prev, end: e.target.value }))}\n          />\n        </div>\n      </div>\n\n      <Card className=\"border-border/50\">\n        <CardHeader>\n          <CardTitle>WhatsApp History</CardTitle>\n          <CardDescription>{filteredLeads.length} leads found</CardDescription>\n        </CardHeader>\n        <CardContent>\n          <div className=\"rounded-md border h-[600px] overflow-auto\">\n            <table className=\"w-full text-sm\">\n              <thead className=\"bg-muted/50 sticky top-0 z-10\">\n                <tr>\n                  <th className=\"p-3 text-left\">Name</th>\n                  <th className=\"p-3 text-left\">Phone</th>\n                  <th className=\"p-3 text-left\">Campaign</th>\n                  <th className=\"p-3 text-left\">Status</th>\n                  <th className=\"p-3 text-left\">Last Interaction</th>\n                </tr>\n              </thead>\n              <tbody>\n                {filteredLeads.map(lead => (\n                  <tr key={lead._id} className=\"border-t hover:bg-muted/30 transition-colors\">\n                    <td className=\"p-3 font-medium\">{lead.name}</td>\n                    <td className=\"p-3\">{lead.phone}</td>\n                    <td className=\"p-3\">\n                      {campaigns.find(c => c._id === lead.campaignId)?.name || \"-\"}\n                    </td>\n                    <td className=\"p-3\">\n                      <Badge variant=\"outline\">{lead.status}</Badge>\n                    </td>\n                    <td className=\"p-3 text-muted-foreground\">\n                      {lead.lastContact ? new Date(lead.lastContact).toLocaleDateString() : \"No contact\"}\n                    </td>\n                  </tr>\n                ))}\n                {filteredLeads.length === 0 && (\n                  <tr>\n                    <td colSpan={5} className=\"p-12 text-center text-muted-foreground\">\n                      No WhatsApp records found matching your filters.\n                    </td>\n                  </tr>\n                )}\n              </tbody>\n            </table>\n          </div>\n        </CardContent>\n      </Card>\n    </div>\n  );\n}\n","path":null,"size_bytes":6288,"size_tokens":null},"aiagent-deployment.tar/aiagent-deployment/README.md":{"content":"# AIAgent Application - Production Build\n\nThis is a complete production-ready build of the AIAgent application for deployment on AWS EC2 with Apache.\n\n## Package Contents\n\n- **dist/** - Compiled frontend (React/Vite) and backend (Express/Node.js)\n- **uploads/** - Directory for user-uploaded files\n- **.env.production** - Environment configuration template\n- **aiagent.conf** - Apache virtual host configuration\n- **start.sh** - Application startup script\n- **stop.sh** - Application stop script\n- **package.json** - Node.js dependencies manifest\n- **package-lock.json** - Locked dependency versions\n- **DEPLOYMENT_GUIDE.md** - Complete deployment instructions\n- **QUICK_START.md** - 5-minute quick start guide\n\n## System Requirements\n\n- **Server**: AWS EC2 (t3.medium or larger recommended)\n- **OS**: Ubuntu 20.04+ or Amazon Linux 2\n- **Node.js**: v18.0.0 or higher\n- **Web Server**: Apache 2.4+\n- **Database**: MongoDB 5.0+ (cloud or self-hosted)\n- **Disk Space**: Minimum 2GB free space\n\n## What's Included\n\n### Application Features\n- User authentication with session management\n- Lead management system\n- Campaign creation and tracking\n- Appointment scheduling\n- Dashboard with analytics charts\n- Notes system for tracking information\n- File upload support for knowledge bases\n- Real-time activity logging\n- Admin panel for user management\n\n### Production Optimizations\n- Minified frontend bundle (~320KB gzipped)\n- Optimized images and assets\n- Session management with secure cookies\n- CORS configuration for proxy\n- Database connection pooling\n- Request compression\n- Static file caching headers\n\n## Getting Started\n\n1. **Read QUICK_START.md** for 5-minute deployment\n2. **Read DEPLOYMENT_GUIDE.md** for detailed information\n3. **Configure .env.production** with your settings\n4. **Run deployment steps** from QUICK_START.md\n\n## Support\n\nFor issues or questions, refer to the troubleshooting section in DEPLOYMENT_GUIDE.md\n\n## Build Information\n\n- **Build Date**: December 20, 2024\n- **Build Tool**: Vite + TypeScript\n- **Framework**: React 19 + Express.js\n- **Database**: MongoDB with Mongoose\n- **Frontend Size**: ~1.4MB (uncompressed), ~319KB (gzipped)\n- **Backend Size**: ~2.3MB (single file bundle)\n\n---\n\n**Ready to deploy? Start with QUICK_START.md**\n","path":null,"size_bytes":2263,"size_tokens":null},"client/src/components/ui/popover.tsx":{"content":"import * as React from \"react\"\nimport * as PopoverPrimitive from \"@radix-ui/react-popover\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Popover = PopoverPrimitive.Root\n\nconst PopoverTrigger = PopoverPrimitive.Trigger\n\nconst PopoverAnchor = PopoverPrimitive.Anchor\n\nconst PopoverContent = React.forwardRef<\n  React.ElementRef<typeof PopoverPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof PopoverPrimitive.Content>\n>(({ className, align = \"center\", sideOffset = 4, ...props }, ref) => (\n  <PopoverPrimitive.Portal>\n    <PopoverPrimitive.Content\n      ref={ref}\n      align={align}\n      sideOffset={sideOffset}\n      className={cn(\n        \"z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-popover-content-transform-origin]\",\n        className\n      )}\n      {...props}\n    />\n  </PopoverPrimitive.Portal>\n))\nPopoverContent.displayName = PopoverPrimitive.Content.displayName\n\nexport { Popover, PopoverTrigger, PopoverContent, PopoverAnchor }\n","path":null,"size_bytes":1342,"size_tokens":null},"client/src/components/ui/toaster.tsx":{"content":"import { useToast } from \"@/hooks/use-toast\"\nimport {\n  Toast,\n  ToastClose,\n  ToastDescription,\n  ToastProvider,\n  ToastTitle,\n  ToastViewport,\n} from \"@/components/ui/toast\"\n\nexport function Toaster() {\n  const { toasts } = useToast()\n\n  return (\n    <ToastProvider>\n      {toasts.map(function ({ id, title, description, action, ...props }) {\n        return (\n          <Toast key={id} {...props}>\n            <div className=\"grid gap-1\">\n              {title && <ToastTitle>{title}</ToastTitle>}\n              {description && (\n                <ToastDescription>{description}</ToastDescription>\n              )}\n            </div>\n            {action}\n            <ToastClose />\n          </Toast>\n        )\n      })}\n      <ToastViewport />\n    </ToastProvider>\n  )\n}\n","path":null,"size_bytes":772,"size_tokens":null},"client/src/components/ui/context-menu.tsx":{"content":"import * as React from \"react\"\nimport * as ContextMenuPrimitive from \"@radix-ui/react-context-menu\"\nimport { Check, ChevronRight, Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ContextMenu = ContextMenuPrimitive.Root\n\nconst ContextMenuTrigger = ContextMenuPrimitive.Trigger\n\nconst ContextMenuGroup = ContextMenuPrimitive.Group\n\nconst ContextMenuPortal = ContextMenuPrimitive.Portal\n\nconst ContextMenuSub = ContextMenuPrimitive.Sub\n\nconst ContextMenuRadioGroup = ContextMenuPrimitive.RadioGroup\n\nconst ContextMenuSubTrigger = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.SubTrigger>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.SubTrigger> & {\n    inset?: boolean\n  }\n>(({ className, inset, children, ...props }, ref) => (\n  <ContextMenuPrimitive.SubTrigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <ChevronRight className=\"ml-auto h-4 w-4\" />\n  </ContextMenuPrimitive.SubTrigger>\n))\nContextMenuSubTrigger.displayName = ContextMenuPrimitive.SubTrigger.displayName\n\nconst ContextMenuSubContent = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.SubContent>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.SubContent>\n>(({ className, ...props }, ref) => (\n  <ContextMenuPrimitive.SubContent\n    ref={ref}\n    className={cn(\n      \"z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-context-menu-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nContextMenuSubContent.displayName = ContextMenuPrimitive.SubContent.displayName\n\nconst ContextMenuContent = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <ContextMenuPrimitive.Portal>\n    <ContextMenuPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"z-50 max-h-[--radix-context-menu-content-available-height] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-context-menu-content-transform-origin]\",\n        className\n      )}\n      {...props}\n    />\n  </ContextMenuPrimitive.Portal>\n))\nContextMenuContent.displayName = ContextMenuPrimitive.Content.displayName\n\nconst ContextMenuItem = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Item> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <ContextMenuPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nContextMenuItem.displayName = ContextMenuPrimitive.Item.displayName\n\nconst ContextMenuCheckboxItem = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.CheckboxItem>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.CheckboxItem>\n>(({ className, children, checked, ...props }, ref) => (\n  <ContextMenuPrimitive.CheckboxItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    checked={checked}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <ContextMenuPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </ContextMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </ContextMenuPrimitive.CheckboxItem>\n))\nContextMenuCheckboxItem.displayName =\n  ContextMenuPrimitive.CheckboxItem.displayName\n\nconst ContextMenuRadioItem = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.RadioItem>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.RadioItem>\n>(({ className, children, ...props }, ref) => (\n  <ContextMenuPrimitive.RadioItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <ContextMenuPrimitive.ItemIndicator>\n        <Circle className=\"h-4 w-4 fill-current\" />\n      </ContextMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </ContextMenuPrimitive.RadioItem>\n))\nContextMenuRadioItem.displayName = ContextMenuPrimitive.RadioItem.displayName\n\nconst ContextMenuLabel = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Label> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <ContextMenuPrimitive.Label\n    ref={ref}\n    className={cn(\n      \"px-2 py-1.5 text-sm font-semibold text-foreground\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nContextMenuLabel.displayName = ContextMenuPrimitive.Label.displayName\n\nconst ContextMenuSeparator = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <ContextMenuPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-border\", className)}\n    {...props}\n  />\n))\nContextMenuSeparator.displayName = ContextMenuPrimitive.Separator.displayName\n\nconst ContextMenuShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn(\n        \"ml-auto text-xs tracking-widest text-muted-foreground\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\nContextMenuShortcut.displayName = \"ContextMenuShortcut\"\n\nexport {\n  ContextMenu,\n  ContextMenuTrigger,\n  ContextMenuContent,\n  ContextMenuItem,\n  ContextMenuCheckboxItem,\n  ContextMenuRadioItem,\n  ContextMenuLabel,\n  ContextMenuSeparator,\n  ContextMenuShortcut,\n  ContextMenuGroup,\n  ContextMenuPortal,\n  ContextMenuSub,\n  ContextMenuSubContent,\n  ContextMenuSubTrigger,\n  ContextMenuRadioGroup,\n}\n","path":null,"size_bytes":7406,"size_tokens":null},"client/src/components/ui/form.tsx":{"content":"import * as React from \"react\"\nimport * as LabelPrimitive from \"@radix-ui/react-label\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport {\n  Controller,\n  FormProvider,\n  useFormContext,\n  type ControllerProps,\n  type FieldPath,\n  type FieldValues,\n} from \"react-hook-form\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Label } from \"@/components/ui/label\"\n\nconst Form = FormProvider\n\ntype FormFieldContextValue<\n  TFieldValues extends FieldValues = FieldValues,\n  TName extends FieldPath<TFieldValues> = FieldPath<TFieldValues>\n> = {\n  name: TName\n}\n\nconst FormFieldContext = React.createContext<FormFieldContextValue | null>(null)\n\nconst FormField = <\n  TFieldValues extends FieldValues = FieldValues,\n  TName extends FieldPath<TFieldValues> = FieldPath<TFieldValues>\n>({\n  ...props\n}: ControllerProps<TFieldValues, TName>) => {\n  return (\n    <FormFieldContext.Provider value={{ name: props.name }}>\n      <Controller {...props} />\n    </FormFieldContext.Provider>\n  )\n}\n\nconst useFormField = () => {\n  const fieldContext = React.useContext(FormFieldContext)\n  const itemContext = React.useContext(FormItemContext)\n  const { getFieldState, formState } = useFormContext()\n\n  if (!fieldContext) {\n    throw new Error(\"useFormField should be used within <FormField>\")\n  }\n\n  if (!itemContext) {\n    throw new Error(\"useFormField should be used within <FormItem>\")\n  }\n\n  const fieldState = getFieldState(fieldContext.name, formState)\n\n  const { id } = itemContext\n\n  return {\n    id,\n    name: fieldContext.name,\n    formItemId: `${id}-form-item`,\n    formDescriptionId: `${id}-form-item-description`,\n    formMessageId: `${id}-form-item-message`,\n    ...fieldState,\n  }\n}\n\ntype FormItemContextValue = {\n  id: string\n}\n\nconst FormItemContext = React.createContext<FormItemContextValue | null>(null)\n\nconst FormItem = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => {\n  const id = React.useId()\n\n  return (\n    <FormItemContext.Provider value={{ id }}>\n      <div ref={ref} className={cn(\"space-y-2\", className)} {...props} />\n    </FormItemContext.Provider>\n  )\n})\nFormItem.displayName = \"FormItem\"\n\nconst FormLabel = React.forwardRef<\n  React.ElementRef<typeof LabelPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof LabelPrimitive.Root>\n>(({ className, ...props }, ref) => {\n  const { error, formItemId } = useFormField()\n\n  return (\n    <Label\n      ref={ref}\n      className={cn(error && \"text-destructive\", className)}\n      htmlFor={formItemId}\n      {...props}\n    />\n  )\n})\nFormLabel.displayName = \"FormLabel\"\n\nconst FormControl = React.forwardRef<\n  React.ElementRef<typeof Slot>,\n  React.ComponentPropsWithoutRef<typeof Slot>\n>(({ ...props }, ref) => {\n  const { error, formItemId, formDescriptionId, formMessageId } = useFormField()\n\n  return (\n    <Slot\n      ref={ref}\n      id={formItemId}\n      aria-describedby={\n        !error\n          ? `${formDescriptionId}`\n          : `${formDescriptionId} ${formMessageId}`\n      }\n      aria-invalid={!!error}\n      {...props}\n    />\n  )\n})\nFormControl.displayName = \"FormControl\"\n\nconst FormDescription = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLParagraphElement>\n>(({ className, ...props }, ref) => {\n  const { formDescriptionId } = useFormField()\n\n  return (\n    <p\n      ref={ref}\n      id={formDescriptionId}\n      className={cn(\"text-[0.8rem] text-muted-foreground\", className)}\n      {...props}\n    />\n  )\n})\nFormDescription.displayName = \"FormDescription\"\n\nconst FormMessage = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLParagraphElement>\n>(({ className, children, ...props }, ref) => {\n  const { error, formMessageId } = useFormField()\n  const body = error ? String(error?.message ?? \"\") : children\n\n  if (!body) {\n    return null\n  }\n\n  return (\n    <p\n      ref={ref}\n      id={formMessageId}\n      className={cn(\"text-[0.8rem] font-medium text-destructive\", className)}\n      {...props}\n    >\n      {body}\n    </p>\n  )\n})\nFormMessage.displayName = \"FormMessage\"\n\nexport {\n  useFormField,\n  Form,\n  FormItem,\n  FormLabel,\n  FormControl,\n  FormDescription,\n  FormMessage,\n  FormField,\n}\n","path":null,"size_bytes":4175,"size_tokens":null},"server/storage.ts":{"content":"import { UserModel, LeadModel, CampaignModel, AppointmentModel, NoteModel, PlanModel, FeatureModel, NotificationModel } from \"./db\";\nimport type {\n  User,\n  InsertUser,\n  UpdateUser,\n  Lead,\n  InsertLead,\n  Campaign,\n  InsertCampaign,\n  Appointment,\n  InsertAppointment,\n  UpdateSettings,\n  LeadHistoryItem,\n  Note,\n  InsertNote,\n  UpdateNote,\n  Plan,\n  InsertPlan,\n  Feature,\n  InsertFeature,\n  SubscriptionInfo,\n  Notification,\n  InsertNotification,\n} from \"@shared/schema\";\nimport bcryptjs from \"bcryptjs\";\n\nexport interface IStorage {\n  // User methods\n  getUser(id: string): Promise<User | null>;\n  getUserByEmail(email: string): Promise<User | null>;\n  createUser(user: InsertUser): Promise<User>;\n  updateUser(id: string, updates: UpdateUser): Promise<User | null>;\n  changePassword(id: string, currentPassword: string, newPassword: string): Promise<boolean>;\n  getAllUsers(): Promise<User[]>;\n  \n  // Lead methods\n  getLeads(userId: string, campaignId?: string): Promise<Lead[]>;\n  getLead(id: string): Promise<Lead | null>;\n  createLead(lead: InsertLead): Promise<Lead>;\n  updateLead(id: string, updates: Partial<InsertLead>): Promise<Lead | null>;\n  deleteLead(id: string): Promise<boolean>;\n  addLeadHistory(leadId: string, historyItem: LeadHistoryItem): Promise<Lead | null>;\n  \n  // Campaign methods\n  getCampaigns(userId: string): Promise<Campaign[]>;\n  getCampaign(id: string): Promise<Campaign | null>;\n  createCampaign(campaign: InsertCampaign): Promise<Campaign>;\n  updateCampaign(id: string, updates: Partial<InsertCampaign>): Promise<Campaign | null>;\n  deleteCampaign(id: string): Promise<boolean>;\n  \n  // Appointment methods\n  getAppointments(userId: string): Promise<Appointment[]>;\n  getAppointment(id: string): Promise<Appointment | null>;\n  createAppointment(appointment: InsertAppointment): Promise<Appointment>;\n  updateAppointment(id: string, updates: Partial<InsertAppointment>): Promise<Appointment | null>;\n  deleteAppointment(id: string): Promise<boolean>;\n  \n  // Settings methods\n  updateSettings(userId: string, settings: UpdateSettings): Promise<User | null>;\n  getSettings(userId: string): Promise<User | null>;\n  updateUserSubscription(userId: string, subscription: SubscriptionInfo): Promise<User | null>;\n  updateExotelConfig(userId: string, config: any): Promise<User | null>;\n  updateGupshupConfig(userId: string, config: any): Promise<User | null>;\n  getAdminSettings(): Promise<any>;\n  updateAdminSettings(settings: any): Promise<any>;\n\n  // Note methods\n  getNotes(userId: string): Promise<Note[]>;\n  getNote(id: string): Promise<Note | null>;\n  createNote(note: InsertNote): Promise<Note>;\n  updateNote(id: string, updates: UpdateNote): Promise<Note | null>;\n  deleteNote(id: string): Promise<boolean>;\n\n  // Plan methods\n  getPlans(): Promise<Plan[]>;\n  getPlan(id: string): Promise<Plan | null>;\n  createPlan(plan: InsertPlan): Promise<Plan>;\n  updatePlan(id: string, updates: Partial<InsertPlan>): Promise<Plan | null>;\n  deletePlan(id: string): Promise<boolean>;\n\n  // Feature methods\n  getFeatures(): Promise<Feature[]>;\n  createFeature(feature: InsertFeature): Promise<Feature>;\n\n  // Notification methods\n  getNotifications(): Promise<Notification[]>;\n  createNotification(notification: InsertNotification): Promise<Notification>;\n  markNotificationRead(id: string, userId: string): Promise<boolean>;\n}\n\nexport class MongoStorage implements IStorage {\n  // ... existing user methods ...\n  async getUser(id: string): Promise<User | null> {\n    const user = await UserModel.findById(id).select(\"-password\").lean();\n    if (!user) return null;\n    return { ...(user as any), _id: (user as any)._id.toString() } as any as User;\n  }\n\n  async getUserByEmail(email: string): Promise<User | null> {\n    const user = await UserModel.findOne({ email }).lean();\n    if (!user) return null;\n    return { ...(user as any), _id: (user as any)._id.toString() } as any as User;\n  }\n\n  async createUser(insertUser: InsertUser): Promise<User> {\n    const hashedPassword = await bcryptjs.hash(insertUser.password, 10);\n    const user = await UserModel.create({\n      ...insertUser,\n      password: hashedPassword,\n      subscription: {\n        plan: \"Pending\",\n        status: \"Inactive\",\n        monthlyCallCredits: 0,\n        creditsUsed: 0,\n        joinedDate: new Date(),\n      },\n    });\n    \n    const userObj = user.toObject();\n    const { password, _id, __v, ...rest } = userObj;\n    return { ...rest, _id: _id.toString() } as any as User;\n  }\n\n  // ... rest of MongoStorage methods ...\n  async updateUser(id: string, updates: UpdateUser): Promise<User | null> {\n    const user = await UserModel.findByIdAndUpdate(id, { $set: updates }, { new: true }).select(\"-password\").lean();\n    if (!user) return null;\n    return { ...(user as any), _id: (user as any)._id.toString() } as any as User;\n  }\n\n  async changePassword(id: string, currentPassword: string, newPassword: string): Promise<boolean> {\n    const user = await UserModel.findById(id);\n    if (!user) return false;\n    \n    const isValid = await bcryptjs.compare(currentPassword, user.password);\n    if (!isValid) return false;\n    \n    const hashedPassword = await bcryptjs.hash(newPassword, 10);\n    user.password = hashedPassword;\n    await user.save();\n    return true;\n  }\n\n  async getAllUsers(): Promise<User[]> {\n    const users = await UserModel.find().select(\"-password\").lean();\n    return users.map((u: any) => ({ ...u, _id: u._id.toString() })) as any as User[];\n  }\n\n  // Lead methods\n  async getLeads(userId: string, campaignId?: string): Promise<Lead[]> {\n    const query: any = { userId };\n    if (campaignId) {\n      query.campaignId = campaignId;\n    }\n    const leads = await LeadModel.find(query).populate(\"appointments\").populate(\"campaignId\", \"name\").lean();\n    return leads.map((l: any) => ({\n      ...l,\n      _id: l._id.toString(),\n      userId: l.userId.toString(),\n      campaignId: l.campaignId?._id?.toString() || (typeof l.campaignId === 'object' ? null : l.campaignId?.toString()) || null,\n      campaignName: l.campaignId?.name || null,\n    })) as any as Lead[];\n  }\n\n  async getLead(id: string): Promise<Lead | null> {\n    const lead = await LeadModel.findById(id).populate(\"appointments\").populate(\"campaignId\", \"name\").lean();\n    if (!lead) return null;\n    const leadObj = lead as any;\n    return {\n      ...leadObj,\n      _id: leadObj._id.toString(),\n      userId: leadObj.userId.toString(),\n      campaignId: leadObj.campaignId?._id?.toString() || (typeof leadObj.campaignId === 'object' ? null : leadObj.campaignId?.toString()) || null,\n      campaignName: leadObj.campaignId?.name || null,\n    } as any as Lead;\n  }\n\n  async createLead(lead: InsertLead): Promise<Lead> {\n    const newLead = await LeadModel.create(lead);\n    const obj = newLead.toObject();\n    return { ...(obj as any), _id: obj._id.toString(), userId: obj.userId.toString() } as any as Lead;\n  }\n\n  async updateLead(id: string, updates: Partial<InsertLead>): Promise<Lead | null> {\n    const lead = await LeadModel.findByIdAndUpdate(id, { ...updates, lastContact: new Date() }, { new: true }).lean();\n    if (!lead) return null;\n    return { ...(lead as any), _id: (lead as any)._id.toString(), userId: (lead as any).userId.toString() } as any as Lead;\n  }\n\n  async deleteLead(id: string): Promise<boolean> {\n    const result = await LeadModel.findByIdAndDelete(id);\n    return !!result;\n  }\n\n  async addLeadHistory(leadId: string, historyItem: LeadHistoryItem): Promise<Lead | null> {\n    const lead = await LeadModel.findByIdAndUpdate(\n      leadId,\n      { \n        $push: { history: { $each: [historyItem], $position: 0 } },\n        lastContact: new Date(),\n      },\n      { new: true }\n    ).lean();\n    if (!lead) return null;\n    return { ...(lead as any), _id: (lead as any)._id.toString(), userId: (lead as any).userId.toString() } as any as Lead;\n  }\n\n  // Campaign methods\n  async getCampaigns(userId: string): Promise<Campaign[]> {\n    const campaigns = await CampaignModel.find({ userId }).lean();\n    return campaigns.map((c: any) => ({ ...c, _id: c._id.toString(), userId: c.userId.toString() })) as any as Campaign[];\n  }\n\n  async getCampaign(id: string): Promise<Campaign | null> {\n    const campaign = await CampaignModel.findById(id).lean();\n    if (!campaign) return null;\n    return { ...(campaign as any), _id: (campaign as any)._id.toString(), userId: (campaign as any).userId.toString() } as any as Campaign;\n  }\n\n  async createCampaign(campaign: InsertCampaign): Promise<Campaign> {\n    const newCampaign = await CampaignModel.create(campaign as any);\n    const obj = (newCampaign as any).toObject();\n    return { ...(obj as any), _id: obj._id.toString(), userId: obj.userId.toString() } as any as Campaign;\n  }\n\n  async updateCampaign(id: string, updates: Partial<InsertCampaign>): Promise<Campaign | null> {\n    const campaign = await CampaignModel.findByIdAndUpdate(id, updates, { new: true }).lean();\n    if (!campaign) return null;\n    return { ...(campaign as any), _id: (campaign as any)._id.toString(), userId: (campaign as any).userId.toString() } as any as Campaign;\n  }\n\n  async deleteCampaign(id: string): Promise<boolean> {\n    const result = await CampaignModel.findByIdAndDelete(id);\n    return !!result;\n  }\n\n  // Appointment methods\n  async getAppointments(userId: string): Promise<Appointment[]> {\n    const appointments = await AppointmentModel.find({ userId }).lean();\n    return appointments.map((a: any) => ({ ...a, _id: a._id.toString(), userId: a.userId.toString(), leadId: a.leadId.toString() })) as any as Appointment[];\n  }\n\n  async getAppointment(id: string): Promise<Appointment | null> {\n    const appointment = await AppointmentModel.findById(id).lean();\n    if (!appointment) return null;\n    return { ...(appointment as any), _id: (appointment as any)._id.toString(), userId: (appointment as any).userId.toString(), leadId: (appointment as any).leadId.toString() } as any as Appointment;\n  }\n\n  async createAppointment(appointment: InsertAppointment): Promise<Appointment> {\n    const newAppointment = await AppointmentModel.create(appointment);\n    \n    // Add appointment to lead's appointments array\n    await LeadModel.findByIdAndUpdate(appointment.leadId, {\n      $push: { appointments: newAppointment._id },\n    });\n    \n    const obj = newAppointment.toObject();\n    return { ...(obj as any), _id: obj._id.toString(), userId: obj.userId.toString(), leadId: obj.leadId.toString() } as any as Appointment;\n  }\n\n  async updateAppointment(id: string, updates: Partial<InsertAppointment>): Promise<Appointment | null> {\n    const appointment = await AppointmentModel.findByIdAndUpdate(id, updates, { new: true }).lean();\n    if (!appointment) return null;\n    return { ...(appointment as any), _id: (appointment as any)._id.toString(), userId: (appointment as any).userId.toString(), leadId: (appointment as any).leadId.toString() } as any as Appointment;\n  }\n\n  async deleteAppointment(id: string): Promise<boolean> {\n    const appointment = await AppointmentModel.findById(id);\n    if (!appointment) return false;\n    \n    // Remove from lead's appointments array\n    await LeadModel.findByIdAndUpdate(appointment.leadId, {\n      $pull: { appointments: id },\n    });\n    \n    await AppointmentModel.findByIdAndDelete(id);\n    return true;\n  }\n\n  // Settings methods\n  async updateSettings(userId: string, settings: UpdateSettings): Promise<User | null> {\n    const user = await UserModel.findByIdAndUpdate(\n      userId,\n      { $set: { \"settings\": settings } },\n      { new: true }\n    ).select(\"-password\").lean();\n    if (!user) return null;\n    return { ...(user as any), _id: (user as any)._id.toString() } as any as User;\n  }\n\n  async getSettings(userId: string): Promise<User | null> {\n    const user = await UserModel.findById(userId).select(\"-password\").lean();\n    if (!user) return null;\n    return { ...(user as any), _id: (user as any)._id.toString() } as any as User;\n  }\n\n  async updateUserSubscription(userId: string, subscription: SubscriptionInfo): Promise<User | null> {\n    const user = await UserModel.findByIdAndUpdate(\n      userId,\n      { $set: { subscription } },\n      { new: true }\n    ).select(\"-password\").lean();\n    if (!user) return null;\n    return { ...(user as any), _id: (user as any)._id.toString() } as any as User;\n  }\n\n  async updateExotelConfig(userId: string, config: any): Promise<User | null> {\n    const user = await UserModel.findByIdAndUpdate(\n      userId,\n      { $set: { exotelConfig: config } },\n      { new: true }\n    ).select(\"-password\").lean();\n    if (!user) return null;\n    return { ...(user as any), _id: (user as any)._id.toString() } as any as User;\n  }\n\n  async updateGupshupConfig(userId: string, config: any): Promise<User | null> {\n    const user = await UserModel.findByIdAndUpdate(\n      userId,\n      { $set: { gupshupConfig: config } },\n      { new: true }\n    ).select(\"-password\").lean();\n    if (!user) return null;\n    return { ...(user as any), _id: (user as any)._id.toString() } as any as User;\n  }\n\n  async getAdminSettings(): Promise<any> {\n    const admin = await UserModel.findOne({ role: \"admin\" }).select(\"exotelConfig\").lean();\n    return (admin as any)?.exotelConfig || null;\n  }\n\n  async updateAdminSettings(settings: any): Promise<any> {\n    const admin = await UserModel.findOneAndUpdate(\n      { role: \"admin\" },\n      { $set: { exotelConfig: settings } },\n      { new: true }\n    ).select(\"exotelConfig\").lean();\n    return (admin as any)?.exotelConfig || null;\n  }\n\n  // Note methods\n  async getNotes(userId: string): Promise<Note[]> {\n    const notes = await NoteModel.find({ userId }).sort({ createdAt: -1 }).lean();\n    return notes.map((n: any) => ({ ...n, _id: n._id.toString(), userId: n.userId.toString() })) as any as Note[];\n  }\n\n  async getNote(id: string): Promise<Note | null> {\n    const note = await NoteModel.findById(id).lean();\n    if (!note) return null;\n    return { ...(note as any), _id: (note as any)._id.toString(), userId: (note as any).userId.toString() } as any as Note;\n  }\n\n  async createNote(note: InsertNote): Promise<Note> {\n    const newNote = await NoteModel.create(note);\n    const obj = newNote.toObject();\n    return { ...(obj as any), _id: obj._id.toString(), userId: obj.userId.toString() } as any as Note;\n  }\n\n  async updateNote(id: string, updates: UpdateNote): Promise<Note | null> {\n    const note = await NoteModel.findByIdAndUpdate(id, { ...updates, updatedAt: new Date() }, { new: true }).lean();\n    if (!note) return null;\n    return { ...(note as any), _id: (note as any)._id.toString(), userId: (note as any).userId.toString() } as any as Note;\n  }\n\n  async deleteNote(id: string): Promise<boolean> {\n    const result = await NoteModel.findByIdAndDelete(id);\n    return !!result;\n  }\n\n  // Plan methods\n  async getPlans(): Promise<Plan[]> {\n    const plans = await PlanModel.find().lean();\n    return plans.map((p: any) => ({ ...p, _id: p._id.toString() })) as any as Plan[];\n  }\n\n  async getPlan(id: string): Promise<Plan | null> {\n    const plan = await PlanModel.findById(id).lean();\n    if (!plan) return null;\n    return { ...(plan as any), _id: (plan as any)._id.toString() } as any as Plan;\n  }\n\n  async createPlan(plan: InsertPlan): Promise<Plan> {\n    const newPlan = await PlanModel.create(plan);\n    const obj = newPlan.toObject();\n    return { ...(obj as any), _id: obj._id.toString() } as any as Plan;\n  }\n\n  async updatePlan(id: string, updates: Partial<InsertPlan>): Promise<Plan | null> {\n    const plan = await PlanModel.findByIdAndUpdate(id, updates, { new: true }).lean();\n    if (!plan) return null;\n    return { ...(plan as any), _id: (plan as any)._id.toString() } as any as Plan;\n  }\n\n  async deletePlan(id: string): Promise<boolean> {\n    const result = await PlanModel.findByIdAndDelete(id);\n    return !!result;\n  }\n\n  // Feature methods\n  async getFeatures(): Promise<Feature[]> {\n    const features = await FeatureModel.find().lean();\n    return features.map((f: any) => ({ ...f, _id: f._id.toString() })) as any as Feature[];\n  }\n\n  async createFeature(feature: InsertFeature): Promise<Feature> {\n    const newFeature = await FeatureModel.create(feature);\n    const obj = newFeature.toObject();\n    return { ...(obj as any), _id: obj._id.toString() } as any as Feature;\n  }\n\n  // Notification methods\n  async getNotifications(): Promise<Notification[]> {\n    const notifications = await NotificationModel.find().sort({ createdAt: -1 }).lean();\n    return notifications.map((n: any) => ({ ...n, _id: n._id.toString() })) as any as Notification[];\n  }\n\n  async createNotification(notification: InsertNotification): Promise<Notification> {\n    const newNotification = await NotificationModel.create({\n      ...notification,\n      readBy: [],\n    });\n    const obj = newNotification.toObject();\n    return { ...(obj as any), _id: obj._id.toString() } as any as Notification;\n  }\n\n  async markNotificationRead(id: string, userId: string): Promise<boolean> {\n    await NotificationModel.findByIdAndUpdate(id, {\n      $addToSet: { readBy: userId }\n    });\n    return true;\n  }\n}\n\nexport const storage = new MongoStorage();\n","path":null,"size_bytes":17161,"size_tokens":null},"client/src/components/ui/menubar.tsx":{"content":"import * as React from \"react\"\nimport * as MenubarPrimitive from \"@radix-ui/react-menubar\"\nimport { Check, ChevronRight, Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nfunction MenubarMenu({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.Menu>) {\n  return <MenubarPrimitive.Menu {...props} />\n}\n\nfunction MenubarGroup({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.Group>) {\n  return <MenubarPrimitive.Group {...props} />\n}\n\nfunction MenubarPortal({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.Portal>) {\n  return <MenubarPrimitive.Portal {...props} />\n}\n\nfunction MenubarRadioGroup({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.RadioGroup>) {\n  return <MenubarPrimitive.RadioGroup {...props} />\n}\n\nfunction MenubarSub({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.Sub>) {\n  return <MenubarPrimitive.Sub data-slot=\"menubar-sub\" {...props} />\n}\n\nconst Menubar = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <MenubarPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"flex h-9 items-center space-x-1 rounded-md border bg-background p-1 shadow-sm\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubar.displayName = MenubarPrimitive.Root.displayName\n\nconst MenubarTrigger = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Trigger>\n>(({ className, ...props }, ref) => (\n  <MenubarPrimitive.Trigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center rounded-sm px-3 py-1 text-sm font-medium outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubarTrigger.displayName = MenubarPrimitive.Trigger.displayName\n\nconst MenubarSubTrigger = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.SubTrigger>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.SubTrigger> & {\n    inset?: boolean\n  }\n>(({ className, inset, children, ...props }, ref) => (\n  <MenubarPrimitive.SubTrigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <ChevronRight className=\"ml-auto h-4 w-4\" />\n  </MenubarPrimitive.SubTrigger>\n))\nMenubarSubTrigger.displayName = MenubarPrimitive.SubTrigger.displayName\n\nconst MenubarSubContent = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.SubContent>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.SubContent>\n>(({ className, ...props }, ref) => (\n  <MenubarPrimitive.SubContent\n    ref={ref}\n    className={cn(\n      \"z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-menubar-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubarSubContent.displayName = MenubarPrimitive.SubContent.displayName\n\nconst MenubarContent = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Content>\n>(\n  (\n    { className, align = \"start\", alignOffset = -4, sideOffset = 8, ...props },\n    ref\n  ) => (\n    <MenubarPrimitive.Portal>\n      <MenubarPrimitive.Content\n        ref={ref}\n        align={align}\n        alignOffset={alignOffset}\n        sideOffset={sideOffset}\n        className={cn(\n          \"z-50 min-w-[12rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-menubar-content-transform-origin]\",\n          className\n        )}\n        {...props}\n      />\n    </MenubarPrimitive.Portal>\n  )\n)\nMenubarContent.displayName = MenubarPrimitive.Content.displayName\n\nconst MenubarItem = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Item> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <MenubarPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubarItem.displayName = MenubarPrimitive.Item.displayName\n\nconst MenubarCheckboxItem = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.CheckboxItem>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.CheckboxItem>\n>(({ className, children, checked, ...props }, ref) => (\n  <MenubarPrimitive.CheckboxItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    checked={checked}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <MenubarPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </MenubarPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </MenubarPrimitive.CheckboxItem>\n))\nMenubarCheckboxItem.displayName = MenubarPrimitive.CheckboxItem.displayName\n\nconst MenubarRadioItem = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.RadioItem>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.RadioItem>\n>(({ className, children, ...props }, ref) => (\n  <MenubarPrimitive.RadioItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <MenubarPrimitive.ItemIndicator>\n        <Circle className=\"h-4 w-4 fill-current\" />\n      </MenubarPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </MenubarPrimitive.RadioItem>\n))\nMenubarRadioItem.displayName = MenubarPrimitive.RadioItem.displayName\n\nconst MenubarLabel = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Label> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <MenubarPrimitive.Label\n    ref={ref}\n    className={cn(\n      \"px-2 py-1.5 text-sm font-semibold\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubarLabel.displayName = MenubarPrimitive.Label.displayName\n\nconst MenubarSeparator = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <MenubarPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-muted\", className)}\n    {...props}\n  />\n))\nMenubarSeparator.displayName = MenubarPrimitive.Separator.displayName\n\nconst MenubarShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn(\n        \"ml-auto text-xs tracking-widest text-muted-foreground\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\nMenubarShortcut.displayname = \"MenubarShortcut\"\n\nexport {\n  Menubar,\n  MenubarMenu,\n  MenubarTrigger,\n  MenubarContent,\n  MenubarItem,\n  MenubarSeparator,\n  MenubarLabel,\n  MenubarCheckboxItem,\n  MenubarRadioGroup,\n  MenubarRadioItem,\n  MenubarPortal,\n  MenubarSubContent,\n  MenubarSubTrigger,\n  MenubarGroup,\n  MenubarSub,\n  MenubarShortcut,\n}\n","path":null,"size_bytes":8608,"size_tokens":null},"client/src/main.tsx":{"content":"import { createRoot } from \"react-dom/client\";\nimport App from \"./App\";\nimport \"./index.css\";\n\ncreateRoot(document.getElementById(\"root\")!).render(<App />);\n","path":null,"size_bytes":157,"size_tokens":null},"client/src/lib/api.ts":{"content":"import type { User, InsertUser, Lead, InsertLead, Campaign, InsertCampaign, Appointment, InsertAppointment, Plan, Feature, InsertPlan, InsertFeature } from \"@shared/schema\";\n\nconst getApiBase = () => {\n  if (typeof window !== 'undefined') {\n    // In production, always use the /aiagent prefix for API calls\n    const isProduction = import.meta.env.PROD || window.location.hostname === '3.208.52.220';\n    const basePath = isProduction ? '/aiagent' : (import.meta.env.BASE_URL || '/');\n    const base = basePath.endsWith('/') ? basePath.slice(0, -1) : basePath;\n    return `${base}/api`;\n  }\n  return '/api';\n};\n\nconst API_BASE = getApiBase();\n\nasync function handleResponse<T>(response: Response): Promise<T> {\n  if (!response.ok) {\n    const error = await response.json().catch(() => ({ message: \"Request failed\" }));\n    throw new Error(error.message || \"Request failed\");\n  }\n  return response.json();\n}\n\n// Auth API\nexport const authApi = {\n  login: async (email: string, password: string): Promise<User> => {\n    try {\n      const response = await fetch(`${API_BASE}/auth/login`, {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify({ email, password }),\n        credentials: \"include\",\n      });\n      \n      if (!response.ok) {\n        const error = await response.json().catch(() => ({ message: \"Login failed\" }));\n        throw new Error(error.message || \"Invalid credentials\");\n      }\n      \n      const result = await response.json();\n      return result.user;\n    } catch (error: any) {\n      console.error(\"Login error:\", error);\n      throw error;\n    }\n  },\n\n  register: async (data: InsertUser): Promise<User> => {\n    try {\n      const response = await fetch(`${API_BASE}/auth/register`, {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify(data),\n        credentials: \"include\",\n      });\n      \n      if (!response.ok) {\n        const error = await response.json().catch(() => ({ message: \"Registration failed\" }));\n        throw new Error(error.message || \"Registration failed\");\n      }\n      \n      const result = await response.json();\n      return result.user;\n    } catch (error: any) {\n      console.error(\"Registration error:\", error);\n      throw error;\n    }\n  },\n\n  logout: async (): Promise<void> => {\n    try {\n      const response = await fetch(`${API_BASE}/auth/logout`, {\n        method: \"POST\",\n        credentials: \"include\",\n      });\n      if (!response.ok) throw new Error(\"Logout failed\");\n    } catch (error) {\n      console.error(\"Logout error:\", error);\n    }\n  },\n\n  getCurrentUser: async (): Promise<User> => {\n    try {\n      const response = await fetch(`${API_BASE}/auth/me`, {\n        credentials: \"include\",\n      });\n      \n      if (!response.ok) {\n        throw new Error(\"Not authenticated\");\n      }\n      \n      const data = await response.json();\n      return data.user;\n    } catch (error: any) {\n      console.error(\"GetCurrentUser error:\", error);\n      throw error;\n    }\n  },\n};\n\n// Users API (Admin)\nexport const usersApi = {\n  getAll: async (): Promise<User[]> => {\n    const response = await fetch(`${API_BASE}/users`, {\n      credentials: \"include\",\n    });\n    const data = await handleResponse<{ users: User[] }>(response);\n    return data.users;\n  },\n\n  getById: async (id: string): Promise<User> => {\n    const response = await fetch(`${API_BASE}/users/${id}`, {\n      credentials: \"include\",\n    });\n    const data = await handleResponse<{ user: User }>(response);\n    return data.user;\n  },\n\n  update: async (id: string, data: Partial<User>): Promise<User> => {\n    const response = await fetch(`${API_BASE}/users/${id}`, {\n      method: \"PATCH\",\n      headers: { \"Content-Type\": \"application/json\" },\n      body: JSON.stringify(data),\n      credentials: \"include\",\n    });\n    const result = await handleResponse<{ user: User }>(response);\n    return result.user;\n  },\n\n  delete: async (id: string): Promise<void> => {\n    const response = await fetch(`${API_BASE}/users/${id}`, {\n      method: \"DELETE\",\n      credentials: \"include\",\n    });\n    await handleResponse(response);\n  },\n};\n\n// Leads API\nexport const leadsApi = {\n  getAll: async (): Promise<Lead[]> => {\n    const response = await fetch(`${API_BASE}/leads`, {\n      credentials: \"include\",\n    });\n    const data = await handleResponse<{ leads: Lead[] }>(response);\n    return data.leads;\n  },\n\n  getById: async (id: string): Promise<Lead> => {\n    const response = await fetch(`${API_BASE}/leads/${id}`, {\n      credentials: \"include\",\n    });\n    const data = await handleResponse<{ lead: Lead }>(response);\n    return data.lead;\n  },\n\n  create: async (data: InsertLead): Promise<Lead> => {\n    const response = await fetch(`${API_BASE}/leads`, {\n      method: \"POST\",\n      headers: { \"Content-Type\": \"application/json\" },\n      body: JSON.stringify(data),\n      credentials: \"include\",\n    });\n    const result = await handleResponse<{ lead: Lead }>(response);\n    return result.lead;\n  },\n\n  update: async (id: string, data: Partial<InsertLead>): Promise<Lead> => {\n    const response = await fetch(`${API_BASE}/leads/${id}`, {\n      method: \"PATCH\",\n      headers: { \"Content-Type\": \"application/json\" },\n      body: JSON.stringify(data),\n      credentials: \"include\",\n    });\n    const result = await handleResponse<{ lead: Lead }>(response);\n    return result.lead;\n  },\n\n  delete: async (id: string): Promise<void> => {\n    const response = await fetch(`${API_BASE}/leads/${id}`, {\n      method: \"DELETE\",\n      credentials: \"include\",\n    });\n    await handleResponse(response);\n  },\n\n  addHistory: async (id: string, historyItem: any): Promise<Lead> => {\n    const response = await fetch(`${API_BASE}/leads/${id}/history`, {\n      method: \"POST\",\n      headers: { \"Content-Type\": \"application/json\" },\n      body: JSON.stringify(historyItem),\n      credentials: \"include\",\n    });\n    const result = await handleResponse<{ lead: Lead }>(response);\n    return result.lead;\n  },\n\n  initiateCall: async (id: string): Promise<void> => {\n    const response = await fetch(`${API_BASE}/leads/${id}/call`, {\n      method: \"POST\",\n      credentials: \"include\",\n    });\n    await handleResponse(response);\n  },\n\n  sendSms: async (id: string): Promise<void> => {\n    const response = await fetch(`${API_BASE}/leads/${id}/sms`, {\n      method: \"POST\",\n      credentials: \"include\",\n    });\n    await handleResponse(response);\n  },\n};\n\n// Campaigns API\nexport const campaignsApi = {\n  getAll: async (): Promise<Campaign[]> => {\n    const response = await fetch(`${API_BASE}/campaigns`, {\n      credentials: \"include\",\n    });\n    const data = await handleResponse<{ campaigns: Campaign[] }>(response);\n    return data.campaigns;\n  },\n\n  getById: async (id: string): Promise<Campaign> => {\n    const response = await fetch(`${API_BASE}/campaigns/${id}`, {\n      credentials: \"include\",\n    });\n    const data = await handleResponse<{ campaign: Campaign }>(response);\n    return data.campaign;\n  },\n\n  create: async (data: InsertCampaign): Promise<Campaign> => {\n    const response = await fetch(`${API_BASE}/campaigns`, {\n      method: \"POST\",\n      headers: { \"Content-Type\": \"application/json\" },\n      body: JSON.stringify(data),\n      credentials: \"include\",\n    });\n    const result = await handleResponse<{ campaign: Campaign }>(response);\n    return result.campaign;\n  },\n\n  update: async (id: string, data: Partial<InsertCampaign>): Promise<Campaign> => {\n    const response = await fetch(`${API_BASE}/campaigns/${id}`, {\n      method: \"PATCH\",\n      headers: { \"Content-Type\": \"application/json\" },\n      body: JSON.stringify(data),\n      credentials: \"include\",\n    });\n    const result = await handleResponse<{ campaign: Campaign }>(response);\n    return result.campaign;\n  },\n\n  delete: async (id: string): Promise<void> => {\n    const response = await fetch(`${API_BASE}/campaigns/${id}`, {\n      method: \"DELETE\",\n      credentials: \"include\",\n    });\n    await handleResponse(response);\n  },\n};\n\n// File Upload API\nexport type UploadedFile = {\n  id: string;\n  name: string;\n  type: string;\n  size: number;\n  url: string;\n  uploadedAt: Date;\n};\n\nexport const uploadApi = {\n  uploadFiles: async (files: File[]): Promise<UploadedFile[]> => {\n    const formData = new FormData();\n    files.forEach((file) => {\n      formData.append(\"files\", file);\n    });\n\n    const response = await fetch(`${API_BASE}/upload`, {\n      method: \"POST\",\n      body: formData,\n      credentials: \"include\",\n    });\n    const result = await handleResponse<{ files: UploadedFile[] }>(response);\n    return result.files;\n  },\n\n  deleteFile: async (filename: string): Promise<void> => {\n    const response = await fetch(`${API_BASE}/upload/${filename}`, {\n      method: \"DELETE\",\n      credentials: \"include\",\n    });\n    await handleResponse(response);\n  },\n};\n\n// Appointments API\nexport const appointmentsApi = {\n  getAll: async (): Promise<Appointment[]> => {\n    const response = await fetch(`${API_BASE}/appointments`, {\n      credentials: \"include\",\n    });\n    const data = await handleResponse<{ appointments: Appointment[] }>(response);\n    return data.appointments;\n  },\n\n  getById: async (id: string): Promise<Appointment> => {\n    const response = await fetch(`${API_BASE}/appointments/${id}`, {\n      credentials: \"include\",\n    });\n    const data = await handleResponse<{ appointment: Appointment }>(response);\n    return data.appointment;\n  },\n\n  create: async (data: InsertAppointment): Promise<Appointment> => {\n    const response = await fetch(`${API_BASE}/appointments`, {\n      method: \"POST\",\n      headers: { \"Content-Type\": \"application/json\" },\n      body: JSON.stringify(data),\n      credentials: \"include\",\n    });\n    const result = await handleResponse<{ appointment: Appointment }>(response);\n    return result.appointment;\n  },\n\n  update: async (id: string, data: Partial<InsertAppointment>): Promise<Appointment> => {\n    const response = await fetch(`${API_BASE}/appointments/${id}`, {\n      method: \"PATCH\",\n      headers: { \"Content-Type\": \"application/json\" },\n      body: JSON.stringify(data),\n      credentials: \"include\",\n    });\n    const result = await handleResponse<{ appointment: Appointment }>(response);\n    return result.appointment;\n  },\n\n  delete: async (id: string): Promise<void> => {\n    const response = await fetch(`${API_BASE}/appointments/${id}`, {\n      method: \"DELETE\",\n      credentials: \"include\",\n    });\n    await handleResponse(response);\n  },\n};\n\n// Notes API\nexport const notesApi = {\n  getAll: async (): Promise<any[]> => {\n    const response = await fetch(`${API_BASE}/notes`, {\n      credentials: \"include\",\n    });\n    const data = await handleResponse<{ notes: any[] }>(response);\n    return data.notes;\n  },\n\n  create: async (data: { title: string; content: string }): Promise<any> => {\n    const response = await fetch(`${API_BASE}/notes`, {\n      method: \"POST\",\n      headers: { \"Content-Type\": \"application/json\" },\n      body: JSON.stringify(data),\n      credentials: \"include\",\n    });\n    const result = await handleResponse<{ note: any }>(response);\n    return result.note;\n  },\n\n  update: async (id: string, data: { title: string; content: string }): Promise<any> => {\n    const response = await fetch(`${API_BASE}/notes/${id}`, {\n      method: \"PATCH\",\n      headers: { \"Content-Type\": \"application/json\" },\n      body: JSON.stringify(data),\n      credentials: \"include\",\n    });\n    const result = await handleResponse<{ note: any }>(response);\n    return result.note;\n  },\n\n  delete: async (id: string): Promise<void> => {\n    const response = await fetch(`${API_BASE}/notes/${id}`, {\n      method: \"DELETE\",\n      credentials: \"include\",\n    });\n    await handleResponse(response);\n  },\n};\n\n// Settings API\nexport const settingsApi = {\n  get: async (): Promise<{ settings: any; subscription: any }> => {\n    const response = await fetch(`${API_BASE}/settings`, {\n      credentials: \"include\",\n    });\n    return handleResponse<{ settings: any; subscription: any }>(response);\n  },\n\n  update: async (data: any): Promise<{ settings: any }> => {\n    const response = await fetch(`${API_BASE}/settings`, {\n      method: \"PATCH\",\n      headers: { \"Content-Type\": \"application/json\" },\n      body: JSON.stringify(data),\n      credentials: \"include\",\n    });\n    return handleResponse<{ settings: any }>(response);\n  },\n\n  changePassword: async (userId: string, currentPassword: string, newPassword: string): Promise<void> => {\n    const response = await fetch(`${API_BASE}/users/${userId}/password`, {\n      method: \"POST\",\n      headers: { \"Content-Type\": \"application/json\" },\n      body: JSON.stringify({ currentPassword, newPassword }),\n      credentials: \"include\",\n    });\n    await handleResponse(response);\n  },\n};\n\n// Plans API\nexport const plansApi = {\n  getAll: async (): Promise<Plan[]> => {\n    const response = await fetch(`${API_BASE}/plans`, {\n      credentials: \"include\",\n    });\n    const data = await handleResponse<{ plans: Plan[] }>(response);\n    return data.plans;\n  },\n\n  create: async (data: InsertPlan): Promise<Plan> => {\n    const response = await fetch(`${API_BASE}/plans`, {\n      method: \"POST\",\n      headers: { \"Content-Type\": \"application/json\" },\n      body: JSON.stringify(data),\n      credentials: \"include\",\n    });\n    const result = await handleResponse<{ plan: Plan }>(response);\n    return result.plan;\n  },\n\n  update: async (id: string, data: Partial<InsertPlan>): Promise<Plan> => {\n    const response = await fetch(`${API_BASE}/plans/${id}`, {\n      method: \"PATCH\",\n      headers: { \"Content-Type\": \"application/json\" },\n      body: JSON.stringify(data),\n      credentials: \"include\",\n    });\n    const result = await handleResponse<{ plan: Plan }>(response);\n    return result.plan;\n  },\n\n  delete: async (id: string): Promise<void> => {\n    const response = await fetch(`${API_BASE}/plans/${id}`, {\n      method: \"DELETE\",\n      credentials: \"include\",\n    });\n    await handleResponse(response);\n  },\n};\n\n// Features API\nexport const featuresApi = {\n  getAll: async (): Promise<Feature[]> => {\n    try {\n      const response = await fetch(`${API_BASE}/features`, {\n        credentials: \"include\",\n      });\n      const data = await handleResponse<{ features: Feature[] }>(response);\n      return data.features || [];\n    } catch (error) {\n      console.error(\"Error fetching features:\", error);\n      return [];\n    }\n  },\n\n  create: async (data: InsertFeature): Promise<Feature> => {\n    const response = await fetch(`${API_BASE}/features`, {\n      method: \"POST\",\n      headers: { \"Content-Type\": \"application/json\" },\n      body: JSON.stringify(data),\n      credentials: \"include\",\n    });\n    const result = await handleResponse<{ feature: Feature }>(response);\n    return result.feature;\n  },\n};\n\n// Notifications API\nexport const notificationsApi = {\n  getAll: async (): Promise<any[]> => {\n    try {\n      const response = await fetch(`${API_BASE}/notifications`, {\n        credentials: \"include\",\n      });\n      const data = await handleResponse<{ notifications: any[] }>(response);\n      return data.notifications || [];\n    } catch (error) {\n      console.error(\"Error fetching notifications:\", error);\n      return [];\n    }\n  },\n};\n","path":null,"size_bytes":15317,"size_tokens":null},"client/src/components/ui/hover-card.tsx":{"content":"import * as React from \"react\"\nimport * as HoverCardPrimitive from \"@radix-ui/react-hover-card\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst HoverCard = HoverCardPrimitive.Root\n\nconst HoverCardTrigger = HoverCardPrimitive.Trigger\n\nconst HoverCardContent = React.forwardRef<\n  React.ElementRef<typeof HoverCardPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof HoverCardPrimitive.Content>\n>(({ className, align = \"center\", sideOffset = 4, ...props }, ref) => (\n  <HoverCardPrimitive.Content\n    ref={ref}\n    align={align}\n    sideOffset={sideOffset}\n    className={cn(\n      \"z-50 w-64 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-hover-card-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nHoverCardContent.displayName = HoverCardPrimitive.Content.displayName\n\nexport { HoverCard, HoverCardTrigger, HoverCardContent }\n","path":null,"size_bytes":1237,"size_tokens":null},"PRODUCTION_DEPLOYMENT.md":{"content":"# Production Deployment Instructions for AWS EC2\n\n## Server Configuration\n- **URL:** http://3.208.52.220/aiagent/\n- **Server Path:** /var/www/aiagent/\n- **Node Port:** 3000 (internal, behind Apache)\n\n## What's Included in Build\n- âœ… Frontend React build (dist/public/) - compiled and optimized\n- âœ… Backend Express.js server (dist/index.cjs + server/)\n- âœ… All dependencies configured\n- âœ… MongoDB integration ready\n- âœ… Routing configured for `/aiagent/` base path\n\n## Deployment Steps\n\n### 1. Extract Build on Server\n```bash\ncd /var/www\ntar -xzf aiagent-production-build.tar.gz\n```\n\n### 2. Install Dependencies\n```bash\ncd /var/www/aiagent\nnpm install --production\n```\n\n### 3. Configure Environment Variables\nCreate `.env` file in `/var/www/aiagent/`:\n```\nNODE_ENV=production\nPORT=3000\nMONGODB_URI=your_mongodb_connection_string\nSESSION_SECRET=your_secure_session_secret\n```\n\n### 4. Start Application\n```bash\n# Option A: Direct start\nnode dist/index.cjs\n\n# Option B: Using PM2 (recommended for production)\npm2 start dist/index.cjs --name \"aiagent\"\npm2 save\npm2 startup\n```\n\n### 5. Apache Configuration (Already Done)\nYour Apache proxy should forward `/aiagent/*` to `http://localhost:3000/*`\n\nExample Apache config (if needs updating):\n```apache\n<Location /aiagent>\n  ProxyPass http://localhost:3000/\n  ProxyPassReverse http://localhost:3000/\n</Location>\n```\n\n## Key Features Already Configured\n\nâœ… **Routing Base Path:** `/aiagent/`\n- After login: Redirects to `http://3.208.52.220/aiagent/dashboard/`\n- All public pages: `/aiagent/`, `/aiagent/features`, `/aiagent/pricing`, etc.\n\nâœ… **Frontend Build:** Optimized React + Vite\n- Minified CSS and JS\n- Asset optimization\n- Configured for subdirectory serving\n\nâœ… **Backend:** Express.js Server\n- Serves API on `/api/*` routes\n- Serves static frontend files\n- MongoDB ready for production\n- Session management configured\n\n## Database Setup\n\nIf using MongoDB Atlas:\n```\nMONGODB_URI=mongodb+srv://username:password@cluster.mongodb.net/aiagent?retryWrites=true&w=majority\n```\n\n## Verification\n\nAfter deployment, test:\n1. **Home Page:** http://3.208.52.220/aiagent/\n2. **Login:** http://3.208.52.220/aiagent/login\n3. **Dashboard (after login):** http://3.208.52.220/aiagent/dashboard/\n\n## File Structure\n\n```\n/var/www/aiagent/\nâ”œâ”€â”€ dist/\nâ”‚   â”œâ”€â”€ index.cjs          # Compiled server\nâ”‚   â””â”€â”€ public/            # Frontend build (HTML, CSS, JS)\nâ”œâ”€â”€ server/                # Server source files\nâ”œâ”€â”€ package.json           # Dependencies\nâ”œâ”€â”€ .env                   # Environment variables (CREATE THIS)\nâ””â”€â”€ node_modules/          # Dependencies (installed)\n```\n\n## Troubleshooting\n\n**Issue:** Blank page at `/aiagent/`\n- Solution: Ensure Node.js app is running on port 3000\n- Check: `curl http://localhost:3000/`\n\n**Issue:** API calls failing\n- Check: MongoDB connection string in `.env`\n- Verify: Port 3000 is accessible from Apache\n\n**Issue:** Styling/JS not loading\n- Clear browser cache (Ctrl+Shift+Del)\n- Verify Apache proxy headers are correct\n\n**Issue:** Redirects to wrong path\n- Already fixed in build! Uses wouter base path `/aiagent`\n- Verify Apache config forwards to root `/`\n\n## Logs\n\nCheck application logs:\n```bash\n# If running directly\ntail -f nohup.out\n\n# If using PM2\npm2 logs aiagent\n```\n\n## Performance Notes\n\n- Frontend is minified and optimized\n- Bundle size: ~1.1 MB gzipped JavaScript\n- Images compressed and optimized\n- Ready for production use\n\n---\n**Build Date:** 2025-12-21\n**Node Version Required:** 16+\n**NPM Version Required:** 8+\n","path":null,"size_bytes":3559,"size_tokens":null},"client/src/components/ui/dropdown-menu.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as DropdownMenuPrimitive from \"@radix-ui/react-dropdown-menu\"\nimport { Check, ChevronRight, Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst DropdownMenu = DropdownMenuPrimitive.Root\n\nconst DropdownMenuTrigger = DropdownMenuPrimitive.Trigger\n\nconst DropdownMenuGroup = DropdownMenuPrimitive.Group\n\nconst DropdownMenuPortal = DropdownMenuPrimitive.Portal\n\nconst DropdownMenuSub = DropdownMenuPrimitive.Sub\n\nconst DropdownMenuRadioGroup = DropdownMenuPrimitive.RadioGroup\n\nconst DropdownMenuSubTrigger = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.SubTrigger>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.SubTrigger> & {\n    inset?: boolean\n  }\n>(({ className, inset, children, ...props }, ref) => (\n  <DropdownMenuPrimitive.SubTrigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <ChevronRight className=\"ml-auto\" />\n  </DropdownMenuPrimitive.SubTrigger>\n))\nDropdownMenuSubTrigger.displayName =\n  DropdownMenuPrimitive.SubTrigger.displayName\n\nconst DropdownMenuSubContent = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.SubContent>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.SubContent>\n>(({ className, ...props }, ref) => (\n  <DropdownMenuPrimitive.SubContent\n    ref={ref}\n    className={cn(\n      \"z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-dropdown-menu-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nDropdownMenuSubContent.displayName =\n  DropdownMenuPrimitive.SubContent.displayName\n\nconst DropdownMenuContent = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Content>\n>(({ className, sideOffset = 4, ...props }, ref) => (\n  <DropdownMenuPrimitive.Portal>\n    <DropdownMenuPrimitive.Content\n      ref={ref}\n      sideOffset={sideOffset}\n      className={cn(\n        \"z-50 max-h-[var(--radix-dropdown-menu-content-available-height)] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md\",\n        \"data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-dropdown-menu-content-transform-origin]\",\n        className\n      )}\n      {...props}\n    />\n  </DropdownMenuPrimitive.Portal>\n))\nDropdownMenuContent.displayName = DropdownMenuPrimitive.Content.displayName\n\nconst DropdownMenuItem = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Item> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <DropdownMenuPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&>svg]:size-4 [&>svg]:shrink-0\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nDropdownMenuItem.displayName = DropdownMenuPrimitive.Item.displayName\n\nconst DropdownMenuCheckboxItem = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.CheckboxItem>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.CheckboxItem>\n>(({ className, children, checked, ...props }, ref) => (\n  <DropdownMenuPrimitive.CheckboxItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    checked={checked}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <DropdownMenuPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </DropdownMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </DropdownMenuPrimitive.CheckboxItem>\n))\nDropdownMenuCheckboxItem.displayName =\n  DropdownMenuPrimitive.CheckboxItem.displayName\n\nconst DropdownMenuRadioItem = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.RadioItem>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.RadioItem>\n>(({ className, children, ...props }, ref) => (\n  <DropdownMenuPrimitive.RadioItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <DropdownMenuPrimitive.ItemIndicator>\n        <Circle className=\"h-2 w-2 fill-current\" />\n      </DropdownMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </DropdownMenuPrimitive.RadioItem>\n))\nDropdownMenuRadioItem.displayName = DropdownMenuPrimitive.RadioItem.displayName\n\nconst DropdownMenuLabel = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Label> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <DropdownMenuPrimitive.Label\n    ref={ref}\n    className={cn(\n      \"px-2 py-1.5 text-sm font-semibold\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nDropdownMenuLabel.displayName = DropdownMenuPrimitive.Label.displayName\n\nconst DropdownMenuSeparator = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <DropdownMenuPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-muted\", className)}\n    {...props}\n  />\n))\nDropdownMenuSeparator.displayName = DropdownMenuPrimitive.Separator.displayName\n\nconst DropdownMenuShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn(\"ml-auto text-xs tracking-widest opacity-60\", className)}\n      {...props}\n    />\n  )\n}\nDropdownMenuShortcut.displayName = \"DropdownMenuShortcut\"\n\nexport {\n  DropdownMenu,\n  DropdownMenuTrigger,\n  DropdownMenuContent,\n  DropdownMenuItem,\n  DropdownMenuCheckboxItem,\n  DropdownMenuRadioItem,\n  DropdownMenuLabel,\n  DropdownMenuSeparator,\n  DropdownMenuShortcut,\n  DropdownMenuGroup,\n  DropdownMenuPortal,\n  DropdownMenuSub,\n  DropdownMenuSubContent,\n  DropdownMenuSubTrigger,\n  DropdownMenuRadioGroup,\n}\n","path":null,"size_bytes":7606,"size_tokens":null},"client/src/components/ui/toggle-group.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as ToggleGroupPrimitive from \"@radix-ui/react-toggle-group\"\nimport { type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\nimport { toggleVariants } from \"@/components/ui/toggle\"\n\nconst ToggleGroupContext = React.createContext<\n  VariantProps<typeof toggleVariants>\n>({\n  size: \"default\",\n  variant: \"default\",\n})\n\nconst ToggleGroup = React.forwardRef<\n  React.ElementRef<typeof ToggleGroupPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof ToggleGroupPrimitive.Root> &\n    VariantProps<typeof toggleVariants>\n>(({ className, variant, size, children, ...props }, ref) => (\n  <ToggleGroupPrimitive.Root\n    ref={ref}\n    className={cn(\"flex items-center justify-center gap-1\", className)}\n    {...props}\n  >\n    <ToggleGroupContext.Provider value={{ variant, size }}>\n      {children}\n    </ToggleGroupContext.Provider>\n  </ToggleGroupPrimitive.Root>\n))\n\nToggleGroup.displayName = ToggleGroupPrimitive.Root.displayName\n\nconst ToggleGroupItem = React.forwardRef<\n  React.ElementRef<typeof ToggleGroupPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof ToggleGroupPrimitive.Item> &\n    VariantProps<typeof toggleVariants>\n>(({ className, children, variant, size, ...props }, ref) => {\n  const context = React.useContext(ToggleGroupContext)\n\n  return (\n    <ToggleGroupPrimitive.Item\n      ref={ref}\n      className={cn(\n        toggleVariants({\n          variant: context.variant || variant,\n          size: context.size || size,\n        }),\n        className\n      )}\n      {...props}\n    >\n      {children}\n    </ToggleGroupPrimitive.Item>\n  )\n})\n\nToggleGroupItem.displayName = ToggleGroupPrimitive.Item.displayName\n\nexport { ToggleGroup, ToggleGroupItem }\n","path":null,"size_bytes":1753,"size_tokens":null},"client/src/components/ui/skeleton.tsx":{"content":"import { cn } from \"@/lib/utils\"\n\nfunction Skeleton({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) {\n  return (\n    <div\n      className={cn(\"animate-pulse rounded-md bg-primary/10\", className)}\n      {...props}\n    />\n  )\n}\n\nexport { Skeleton }\n","path":null,"size_bytes":266,"size_tokens":null},"replit.md":{"content":"# NIJVOX - AI-Powered Calling Agent Platform\n\n## Project Overview\nNIJVOX is a complete SaaS platform for AI-powered calling agents with admin functionality, CRM/lead management, AI campaign creation with document-based training, bulk SMS, appointment scheduling, and subscription management.\n\n## Recent Changes (December 12, 2024)\n- âœ… Successfully connected MongoDB database via MONGODB_URI secret\n- âœ… Implemented full authentication system with session-based login\n- âœ… Created comprehensive API endpoints for all features\n- âœ… Built authentication UI with login/register forms\n- âœ… Added database seeding with admin and test accounts\n- âœ… Fixed MongoDB ObjectId to string conversion for frontend compatibility\n- âœ… Integrated dashboard UI with real backend APIs\n- âœ… Connected CRM leads management (create, view, delete)\n- âœ… Connected campaigns management (create, view, delete)\n- âœ… Connected appointments with calendar view\n- âœ… Connected user profile and settings management\n- âœ… Added admin user management UI with real data\n- âœ… Fixed TypeScript errors in dashboard component\n- âœ… Fixed nested anchor tag issue in auth page\n- âœ… Added full edit functionality for leads with validation\n- âœ… Added edit campaign dialog with all 3 tabs (basics, AI knowledge, configuration)\n- âœ… Made voice selection functional (Rachel American, Drew British)\n- âœ… Added campaign resume/pause toggle functionality\n- âœ… Added campaign delete functionality\n- âœ… Added comprehensive validation for leads (name required, phone required + format, email format)\n- âœ… Added comprehensive validation for campaigns (name required, script required, calling hours validation)\n- âœ… Fixed HTTP method mismatches (PATCH for updates)\n- âœ… Implemented file upload for AI Knowledge tab in campaigns\n- âœ… Added support for PDF, DOCX, TXT, and image uploads (up to 10MB)\n- âœ… Files saved to /uploads directory and served statically\n- âœ… Upload functionality works in both create and edit campaign dialogs\n- âœ… Added lead-campaign association (leads can be linked to campaigns)\n- âœ… Campaign selector in lead create/edit forms\n- âœ… Campaign column and filter in leads table\n- âœ… Delete confirmation dialogs for leads and campaigns\n- âœ… Removed Settings from sidebar (available in account dropdown)\n- âœ… Made calendar fully functional with dynamic dates and month navigation\n- âœ… Added Schedule Meeting functionality from lead details\n- âœ… Added appointment create/edit/delete dialogs with full CRUD\n- âœ… Enhanced lead details Overview tab with campaign and company info\n- âœ… Added Log Activity functionality in Activity & Logs tab (calls, emails, notes)\n- âœ… Fixed Schedule tab to filter appointments by lead and added edit/delete actions\n\n## Architecture\n- **Frontend**: React + TypeScript + Vite + Tailwind CSS + shadcn/ui\n- **Backend**: Express.js with session-based authentication\n- **Database**: MongoDB with Mongoose ODM\n- **Authentication**: Passport.js with bcryptjs password hashing\n- **Session Storage**: MongoDB session store\n\n## Project Structure\n```\nâ”œâ”€â”€ client/src/\nâ”‚   â”œâ”€â”€ pages/          # All page components\nâ”‚   â”œâ”€â”€ components/     # Reusable UI components\nâ”‚   â”œâ”€â”€ lib/           # API client and auth context\nâ”‚   â””â”€â”€ hooks/         # Custom React hooks\nâ”œâ”€â”€ server/\nâ”‚   â”œâ”€â”€ index.ts       # Express server setup\nâ”‚   â”œâ”€â”€ routes.ts      # API route handlers\nâ”‚   â”œâ”€â”€ storage.ts     # Database operations layer\nâ”‚   â”œâ”€â”€ db.ts          # MongoDB models and connection\nâ”‚   â””â”€â”€ seed.ts        # Database seeding script\nâ””â”€â”€ shared/\n    â””â”€â”€ schema.ts      # Shared TypeScript types and Zod schemas\n```\n\n## Database Models\n1. **Users** - User accounts with role-based access (admin/user)\n2. **Leads** - CRM contacts with history tracking\n3. **Campaigns** - AI calling campaigns with knowledge base\n4. **Appointments** - Calendar appointments linked to leads\n\n## Test Accounts\nCreated via `npm run db:seed`:\n\n### Admin Account\n- Email: `admin@nijvox.com`\n- Password: `admin123`\n- Role: Admin (full access to user management)\n\n### Test User Account\n- Email: `test@example.com`\n- Password: `test123`\n- Role: User (standard access)\n\n## User Preferences\n- Web app only (no mobile)\n- MongoDB as database\n- Session-based authentication\n- Role-based access control (Admin vs User)\n- Document-based AI training for campaigns (PDF/DOCX uploads)\n\n## Features Implemented\n### âœ… Completed\n- Frontend prototype with all pages and UI components\n- MongoDB integration with Mongoose\n- Authentication system (login, register, logout)\n- Session management with secure cookies\n- User management API (CRUD operations)\n- API client library with type-safe endpoints\n- CRM/Leads management UI with full CRUD\n- Campaign creation and management\n- Appointment scheduling and calendar view\n- User profile and settings management\n- Admin user management dashboard\n\n### ðŸ“‹ Pending\n- Document upload for AI training (PDF/DOCX)\n- Bulk SMS functionality\n- Payment/subscription integration\n- AI calling integration\n\n## Environment Variables\nRequired secrets (configured in Replit Secrets):\n- `MONGODB_URI` - MongoDB connection string\n\n## Development Scripts\n```bash\nnpm run dev        # Start development server\nnpm run db:seed    # Seed database with test accounts\nnpm run build      # Build for production\nnpm run start      # Start production server\n```\n\n## API Endpoints\nAll endpoints are prefixed with `/api`\n\n### Authentication\n- `POST /api/auth/register` - Register new user\n- `POST /api/auth/login` - Login user\n- `POST /api/auth/logout` - Logout user\n- `GET /api/auth/me` - Get current user\n\n### Users (Admin only)\n- `GET /api/users` - Get all users\n- `GET /api/users/:id` - Get user by ID\n- `PUT /api/users/:id` - Update user\n- `DELETE /api/users/:id` - Delete user\n\n### Leads\n- `GET /api/leads` - Get user's leads\n- `GET /api/leads/:id` - Get lead by ID\n- `POST /api/leads` - Create new lead\n- `PUT /api/leads/:id` - Update lead\n- `DELETE /api/leads/:id` - Delete lead\n- `POST /api/leads/:id/history` - Add history item to lead\n\n### Campaigns\n- `GET /api/campaigns` - Get user's campaigns\n- `GET /api/campaigns/:id` - Get campaign by ID\n- `POST /api/campaigns` - Create new campaign\n- `PUT /api/campaigns/:id` - Update campaign\n- `DELETE /api/campaigns/:id` - Delete campaign\n\n### Appointments\n- `GET /api/appointments` - Get user's appointments\n- `GET /api/appointments/:id` - Get appointment by ID\n- `POST /api/appointments` - Create new appointment\n- `PUT /api/appointments/:id` - Update appointment\n- `DELETE /api/appointments/:id` - Delete appointment\n\n### Settings\n- `GET /api/settings` - Get user settings\n- `PUT /api/settings` - Update user settings\n- `PUT /api/settings/password` - Change password\n\n## Next Steps\n1. Implement document upload for AI campaign training (PDF/DOCX parsing)\n2. Add bulk SMS functionality with message templates\n3. Integrate payment/subscription system (Stripe)\n4. Build AI calling integration with voice synthesis\n5. Add real-time call monitoring and analytics\n6. Implement advanced lead scoring and automation\n","path":null,"size_bytes":7138,"size_tokens":null},"client/src/components/ui/tooltip.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as TooltipPrimitive from \"@radix-ui/react-tooltip\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst TooltipProvider = TooltipPrimitive.Provider\n\nconst Tooltip = TooltipPrimitive.Root\n\nconst TooltipTrigger = TooltipPrimitive.Trigger\n\nconst TooltipContent = React.forwardRef<\n  React.ElementRef<typeof TooltipPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof TooltipPrimitive.Content>\n>(({ className, sideOffset = 4, ...props }, ref) => (\n  <TooltipPrimitive.Portal>\n    <TooltipPrimitive.Content\n      ref={ref}\n      sideOffset={sideOffset}\n      className={cn(\n        \"z-50 overflow-hidden rounded-md bg-primary px-3 py-1.5 text-xs text-primary-foreground animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-tooltip-content-transform-origin]\",\n        className\n      )}\n      {...props}\n    />\n  </TooltipPrimitive.Portal>\n))\nTooltipContent.displayName = TooltipPrimitive.Content.displayName\n\nexport { Tooltip, TooltipTrigger, TooltipContent, TooltipProvider }\n","path":null,"size_bytes":1267,"size_tokens":null},"client/src/pages/admin-plans.tsx":{"content":"import { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { useForm } from \"react-hook-form\";\nimport { zodResolver } from \"@hookform/resolvers/zod\";\nimport { insertPlanSchema, type Plan, type Feature, insertFeatureSchema } from \"@shared/schema\";\nimport { queryClient, apiRequest } from \"@/lib/queryClient\";\nimport { Button } from \"@/components/ui/button\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Input } from \"@/components/ui/input\";\nimport { Form, FormControl, FormField, FormItem, FormLabel, FormMessage } from \"@/components/ui/form\";\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\";\nimport { Checkbox } from \"@/components/ui/checkbox\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { Label } from \"@/components/ui/label\";\nimport { Plus, Trash2, Loader2, List, Edit2, Search, ChevronLeft, ChevronRight } from \"lucide-react\";\nimport { \n  Table, \n  TableBody, \n  TableCell, \n  TableHead, \n  TableHeader, \n  TableRow \n} from \"@/components/ui/table\";\nimport {\n  Dialog,\n  DialogContent,\n  DialogHeader,\n  DialogTitle,\n  DialogTrigger,\n} from \"@/components/ui/dialog\";\nimport { useState, useMemo } from \"react\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Textarea } from \"@/components/ui/textarea\";\n\nexport default function AdminPlans() {\n  const { toast } = useToast();\n  const [isAddOpen, setIsAddOpen] = useState(false);\n  const [isEditOpen, setIsEditOpen] = useState(false);\n  const [isFeaturesOpen, setIsFeaturesOpen] = useState(false);\n  const [editingPlan, setEditingPlan] = useState<Plan | null>(null);\n  \n  // Search, Filter, Pagination states\n  const [search, setSearch] = useState(\"\");\n  const [filterDuration, setFilterDuration] = useState(\"all\");\n  const [page, setPage] = useState(1);\n  const itemsPerPage = 10;\n\n  const { data: plansResponse, isLoading: plansLoading } = useQuery<{ plans: Plan[] }>({ \n    queryKey: [\"/api/plans\"] \n  });\n  const { data: featuresResponse, isLoading: featuresLoading } = useQuery<{ features: Feature[] }>({ \n    queryKey: [\"/api/features\"] \n  });\n\n  const plans = plansResponse?.plans || [];\n  const features = featuresResponse?.features || [];\n\n  // Derived data\n  const filteredPlans = useMemo(() => {\n    return plans.filter(plan => {\n      const matchesSearch = plan.name.toLowerCase().includes(search.toLowerCase());\n      const matchesDuration = filterDuration === \"all\" || plan.duration === filterDuration;\n      return matchesSearch && matchesDuration;\n    });\n  }, [plans, search, filterDuration]);\n\n  const totalPages = Math.ceil(filteredPlans.length / itemsPerPage);\n  const paginatedPlans = filteredPlans.slice((page - 1) * itemsPerPage, page * itemsPerPage);\n\n  const createPlanMutation = useMutation({\n    mutationFn: async (data: any) => {\n      const res = await apiRequest(\"POST\", \"/api/plans\", data);\n      return res.json();\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/plans\"] });\n      toast({ title: \"Success\", description: \"Plan created successfully\" });\n      setIsAddOpen(false);\n      form.reset();\n    },\n  });\n\n  const updatePlanMutation = useMutation({\n    mutationFn: async (data: any) => {\n      const res = await apiRequest(\"PATCH\", `/api/plans/${editingPlan?._id}`, data);\n      return res.json();\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/plans\"] });\n      toast({ title: \"Success\", description: \"Plan updated successfully\" });\n      setIsEditOpen(false);\n      setEditingPlan(null);\n      editForm.reset();\n    },\n  });\n\n  const createFeatureMutation = useMutation({\n    mutationFn: async (data: any) => {\n      const res = await apiRequest(\"POST\", \"/api/features\", data);\n      return res.json();\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/features\"] });\n      toast({ title: \"Success\", description: \"Feature created successfully\" });\n      featureForm.reset();\n    },\n  });\n\n  const form = useForm({\n    resolver: zodResolver(insertPlanSchema),\n    defaultValues: {\n      name: \"\",\n      price: 0,\n      duration: \"monthly\" as const,\n      credits: 0,\n      callingRate: 0,\n      smsRate: 0,\n      whatsappRate: 0,\n      features: [] as string[],\n      limitations: [] as string[],\n      description: \"\",\n      isActive: true,\n      selfBranding: false,\n    },\n  });\n\n  const editForm = useForm({\n    resolver: zodResolver(insertPlanSchema),\n    defaultValues: {\n      name: \"\",\n      price: 0,\n      duration: \"monthly\" as const,\n      credits: 0,\n      callingRate: 0,\n      smsRate: 0,\n      whatsappRate: 0,\n      features: [] as string[],\n      limitations: [] as string[],\n      description: \"\",\n      isActive: true,\n      selfBranding: false,\n    },\n  });\n\n  const featureForm = useForm({\n    resolver: zodResolver(insertFeatureSchema),\n    defaultValues: {\n      name: \"\",\n    },\n  });\n\n  const handleEdit = (plan: Plan) => {\n    setEditingPlan(plan);\n    editForm.reset({\n      name: plan.name,\n      price: plan.price,\n      duration: plan.duration as any,\n      credits: plan.credits,\n      callingRate: plan.callingRate || 0,\n      smsRate: plan.smsRate || 0,\n      whatsappRate: plan.whatsappRate || 0,\n      features: plan.features || [],\n      limitations: plan.limitations || [],\n      description: plan.description || \"\",\n      isActive: plan.isActive,\n      selfBranding: plan.selfBranding ?? false,\n    });\n    setIsEditOpen(true);\n  };\n\n  if (plansLoading || featuresLoading) {\n    return (\n      <div className=\"flex items-center justify-center h-full\">\n        <Loader2 className=\"h-8 w-8 animate-spin text-primary\" />\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"p-8 space-y-8\">\n      <div className=\"flex justify-between items-center\">\n        <div>\n          <h1 className=\"text-3xl font-bold\">Subscription Plans</h1>\n          <p className=\"text-muted-foreground\">Manage your pricing plans and features</p>\n        </div>\n        <div className=\"flex gap-2\">\n          <Dialog open={isFeaturesOpen} onOpenChange={setIsFeaturesOpen}>\n            <DialogTrigger asChild>\n              <Button variant=\"outline\">\n                <List className=\"h-4 w-4 mr-2\" /> Manage Features\n              </Button>\n            </DialogTrigger>\n            <DialogContent className=\"sm:max-w-[500px]\">\n              <DialogHeader>\n                <DialogTitle>Manage Features</DialogTitle>\n              </DialogHeader>\n              <div className=\"space-y-6\">\n                <Form {...featureForm}>\n                  <form onSubmit={featureForm.handleSubmit((data) => createFeatureMutation.mutate(data))} className=\"flex flex-col gap-4\">\n                    <FormField\n                      control={featureForm.control}\n                      name=\"name\"\n                      render={({ field }) => (\n                        <FormItem>\n                          <FormControl>\n                            <Input placeholder=\"Feature Name (e.g., Bulk SMS)\" {...field} />\n                          </FormControl>\n                          <FormMessage />\n                        </FormItem>\n                      )}\n                    />\n                    <Button type=\"submit\" disabled={createFeatureMutation.isPending}>\n                      <Plus className=\"h-4 w-4 mr-2\" /> Add Feature\n                    </Button>\n                  </form>\n                </Form>\n\n                <div className=\"space-y-2\">\n                  <h3 className=\"font-semibold\">Existing Features</h3>\n                  <div className=\"flex flex-wrap gap-2\">\n                    {Array.isArray(features) && features.length > 0 ? (\n                      features.map((feature) => (\n                        <Badge key={feature._id} variant=\"secondary\" className=\"px-3 py-1\">\n                          {feature.name}\n                        </Badge>\n                      ))\n                    ) : (\n                      <p className=\"text-sm text-muted-foreground\">No features created yet.</p>\n                    )}\n                  </div>\n                </div>\n              </div>\n            </DialogContent>\n          </Dialog>\n\n          <Dialog open={isAddOpen} onOpenChange={setIsAddOpen}>\n            <DialogTrigger asChild>\n              <Button>\n                <Plus className=\"h-4 w-4 mr-2\" /> Add Plan\n              </Button>\n            </DialogTrigger>\n            <DialogContent className=\"sm:max-w-[600px] max-h-[90vh] overflow-y-auto\">\n              <DialogHeader>\n                <DialogTitle>Create New Subscription Plan</DialogTitle>\n              </DialogHeader>\n              <Form {...form}>\n                <form onSubmit={form.handleSubmit((data) => createPlanMutation.mutate(data))} className=\"space-y-4 py-4\">\n                  <FormField\n                    control={form.control}\n                    name=\"name\"\n                    render={({ field }) => (\n                      <FormItem>\n                        <FormLabel>Plan Name</FormLabel>\n                        <FormControl>\n                          <Input placeholder=\"e.g., Enterprise\" {...field} />\n                        </FormControl>\n                        <FormMessage />\n                      </FormItem>\n                    )}\n                  />\n                  <div className=\"grid grid-cols-2 gap-4\">\n                    <FormField\n                      control={form.control}\n                      name=\"price\"\n                      render={({ field }) => (\n                        <FormItem>\n                          <FormLabel>Price (â‚¹)</FormLabel>\n                          <FormControl>\n                            <Input type=\"number\" {...field} onChange={e => field.onChange(parseFloat(e.target.value))} />\n                          </FormControl>\n                          <FormMessage />\n                        </FormItem>\n                      )}\n                    />\n                    <FormField\n                      control={form.control}\n                      name=\"duration\"\n                      render={({ field }) => (\n                        <FormItem>\n                          <FormLabel>Duration</FormLabel>\n                          <Select onValueChange={field.onChange} defaultValue={field.value}>\n                            <FormControl>\n                              <SelectTrigger>\n                                <SelectValue placeholder=\"Select duration\" />\n                              </SelectTrigger>\n                            </FormControl>\n                            <SelectContent>\n                              <SelectItem value=\"monthly\">Monthly</SelectItem>\n                              <SelectItem value=\"quarterly\">Quarterly</SelectItem>\n                              <SelectItem value=\"yearly\">Yearly</SelectItem>\n                              <SelectItem value=\"lifetime\">Lifetime</SelectItem>\n                            </SelectContent>\n                          </Select>\n                          <FormMessage />\n                        </FormItem>\n                      )}\n                    />\n                  </div>\n                  <FormField\n                    control={form.control}\n                    name=\"credits\"\n                    render={({ field }) => (\n                      <FormItem>\n                        <FormLabel>Credits</FormLabel>\n                        <FormControl>\n                          <Input type=\"number\" {...field} onChange={e => field.onChange(parseInt(e.target.value))} />\n                        </FormControl>\n                        <FormMessage />\n                      </FormItem>\n                    )}\n                  />\n                  <div className=\"grid grid-cols-3 gap-4\">\n                    <FormField\n                      control={form.control}\n                      name=\"callingRate\"\n                      render={({ field }) => (\n                        <FormItem>\n                          <FormLabel>Calling Rate (â‚¹/min)</FormLabel>\n                          <FormControl>\n                            <Input type=\"number\" step=\"0.01\" {...field} onChange={e => field.onChange(parseFloat(e.target.value))} />\n                          </FormControl>\n                          <FormMessage />\n                        </FormItem>\n                      )}\n                    />\n                    <FormField\n                      control={form.control}\n                      name=\"smsRate\"\n                      render={({ field }) => (\n                        <FormItem>\n                          <FormLabel>SMS Rate (â‚¹/msg)</FormLabel>\n                          <FormControl>\n                            <Input type=\"number\" step=\"0.01\" {...field} onChange={e => field.onChange(parseFloat(e.target.value))} />\n                          </FormControl>\n                          <FormMessage />\n                        </FormItem>\n                      )}\n                    />\n                    <FormField\n                      control={form.control}\n                      name=\"whatsappRate\"\n                      render={({ field }) => (\n                        <FormItem>\n                          <FormLabel>WhatsApp Rate (â‚¹/msg)</FormLabel>\n                          <FormControl>\n                            <Input type=\"number\" step=\"0.01\" {...field} onChange={e => field.onChange(parseFloat(e.target.value))} />\n                          </FormControl>\n                          <FormMessage />\n                        </FormItem>\n                      )}\n                    />\n                  </div>\n                  <FormField\n                    control={form.control}\n                    name=\"description\"\n                    render={({ field }) => (\n                      <FormItem>\n                        <FormLabel>Plan Description (HTML supported)</FormLabel>\n                        <FormControl>\n                          <Textarea placeholder=\"Enter plan details...\" className=\"min-h-[100px]\" {...field} />\n                        </FormControl>\n                        <FormMessage />\n                      </FormItem>\n                    )}\n                  />\n                  <div className=\"space-y-3\">\n                    <Label>Select Features</Label>\n                    <div className=\"grid grid-cols-2 gap-3 p-4 border rounded-md max-h-[200px] overflow-y-auto\">\n                      {Array.isArray(features) && features.length > 0 ? (\n                        features.map((feature) => (\n                          <div key={feature._id} className=\"flex items-center space-x-2\">\n                            <Checkbox\n                              id={`feature-${feature._id}`}\n                              checked={(form.watch(\"features\") || []).includes(feature.name)}\n                              onCheckedChange={(checked) => {\n                                const current = (form.getValues(\"features\") || []) as string[];\n                                if (checked) {\n                                  form.setValue(\"features\", [...current, feature.name]);\n                                } else {\n                                  form.setValue(\"features\", current.filter((f: string) => f !== feature.name));\n                                }\n                              }}\n                            />\n                            <label htmlFor={`feature-${feature._id}`} className=\"text-sm cursor-pointer\">{feature.name}</label>\n                          </div>\n                        ))\n                      ) : (\n                        <p className=\"col-span-2 text-sm text-muted-foreground text-center py-2\">\n                          No features available. Please add features first.\n                        </p>\n                      )}\n                    </div>\n                  </div>\n                  <FormField\n                    control={form.control}\n                    name=\"selfBranding\"\n                    render={({ field }) => (\n                      <FormItem className=\"flex flex-row items-center justify-between rounded-lg border p-3 shadow-sm\">\n                        <div className=\"space-y-0.5\">\n                          <FormLabel>Self Branding</FormLabel>\n                        </div>\n                        <FormControl>\n                          <Select onValueChange={(val) => field.onChange(val === \"yes\")} value={field.value ? \"yes\" : \"no\"}>\n                            <SelectTrigger className=\"w-[100px]\">\n                              <SelectValue placeholder=\"Select\" />\n                            </SelectTrigger>\n                            <SelectContent>\n                              <SelectItem value=\"yes\">Yes</SelectItem>\n                              <SelectItem value=\"no\">No</SelectItem>\n                            </SelectContent>\n                          </Select>\n                        </FormControl>\n                      </FormItem>\n                    )}\n                  />\n                  <Button type=\"submit\" className=\"w-full mt-4\" disabled={createPlanMutation.isPending}>\n                    {createPlanMutation.isPending && <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" />}\n                    Create Plan\n                  </Button>\n                </form>\n              </Form>\n            </DialogContent>\n          </Dialog>\n\n          <Dialog open={isEditOpen} onOpenChange={setIsEditOpen}>\n            <DialogContent className=\"sm:max-w-[600px] max-h-[90vh] overflow-y-auto\">\n              <DialogHeader>\n                <DialogTitle>Edit Subscription Plan</DialogTitle>\n              </DialogHeader>\n              <Form {...editForm}>\n                <form onSubmit={editForm.handleSubmit((data) => updatePlanMutation.mutate(data))} className=\"space-y-4 py-4\">\n                  <FormField\n                    control={editForm.control}\n                    name=\"name\"\n                    render={({ field }) => (\n                      <FormItem>\n                        <FormLabel>Plan Name</FormLabel>\n                        <FormControl>\n                          <Input placeholder=\"e.g., Enterprise\" {...field} />\n                        </FormControl>\n                        <FormMessage />\n                      </FormItem>\n                    )}\n                  />\n                  <div className=\"grid grid-cols-2 gap-4\">\n                    <FormField\n                      control={editForm.control}\n                      name=\"price\"\n                      render={({ field }) => (\n                        <FormItem>\n                          <FormLabel>Price (â‚¹)</FormLabel>\n                          <FormControl>\n                            <Input type=\"number\" {...field} onChange={e => field.onChange(parseFloat(e.target.value))} />\n                          </FormControl>\n                          <FormMessage />\n                        </FormItem>\n                      )}\n                    />\n                    <FormField\n                      control={editForm.control}\n                      name=\"duration\"\n                      render={({ field }) => (\n                        <FormItem>\n                          <FormLabel>Duration</FormLabel>\n                          <Select onValueChange={field.onChange} value={field.value}>\n                            <FormControl>\n                              <SelectTrigger>\n                                <SelectValue placeholder=\"Select duration\" />\n                              </SelectTrigger>\n                            </FormControl>\n                            <SelectContent>\n                              <SelectItem value=\"monthly\">Monthly</SelectItem>\n                              <SelectItem value=\"quarterly\">Quarterly</SelectItem>\n                              <SelectItem value=\"yearly\">Yearly</SelectItem>\n                              <SelectItem value=\"lifetime\">Lifetime</SelectItem>\n                            </SelectContent>\n                          </Select>\n                          <FormMessage />\n                        </FormItem>\n                      )}\n                    />\n                  </div>\n                  <FormField\n                    control={editForm.control}\n                    name=\"credits\"\n                    render={({ field }) => (\n                      <FormItem>\n                        <FormLabel>Credits</FormLabel>\n                        <FormControl>\n                          <Input type=\"number\" {...field} onChange={e => field.onChange(parseInt(e.target.value))} />\n                        </FormControl>\n                        <FormMessage />\n                      </FormItem>\n                    )}\n                  />\n                  <div className=\"grid grid-cols-3 gap-4\">\n                    <FormField\n                      control={editForm.control}\n                      name=\"callingRate\"\n                      render={({ field }) => (\n                        <FormItem>\n                          <FormLabel>Calling Rate (â‚¹/min)</FormLabel>\n                          <FormControl>\n                            <Input type=\"number\" step=\"0.01\" {...field} onChange={e => field.onChange(parseFloat(e.target.value))} />\n                          </FormControl>\n                          <FormMessage />\n                        </FormItem>\n                      )}\n                    />\n                    <FormField\n                      control={editForm.control}\n                      name=\"smsRate\"\n                      render={({ field }) => (\n                        <FormItem>\n                          <FormLabel>SMS Rate (â‚¹/msg)</FormLabel>\n                          <FormControl>\n                            <Input type=\"number\" step=\"0.01\" {...field} onChange={e => field.onChange(parseFloat(e.target.value))} />\n                          </FormControl>\n                          <FormMessage />\n                        </FormItem>\n                      )}\n                    />\n                    <FormField\n                      control={editForm.control}\n                      name=\"whatsappRate\"\n                      render={({ field }) => (\n                        <FormItem>\n                          <FormLabel>WhatsApp Rate (â‚¹/msg)</FormLabel>\n                          <FormControl>\n                            <Input type=\"number\" step=\"0.01\" {...field} onChange={e => field.onChange(parseFloat(e.target.value))} />\n                          </FormControl>\n                          <FormMessage />\n                        </FormItem>\n                      )}\n                    />\n                  </div>\n                  <FormField\n                    control={editForm.control}\n                    name=\"description\"\n                    render={({ field }) => (\n                      <FormItem>\n                        <FormLabel>Plan Description (HTML supported)</FormLabel>\n                        <FormControl>\n                          <Textarea placeholder=\"Enter plan details...\" className=\"min-h-[100px]\" {...field} />\n                        </FormControl>\n                        <FormMessage />\n                      </FormItem>\n                    )}\n                  />\n                  <div className=\"space-y-3\">\n                    <Label>Select Features</Label>\n                    <div className=\"grid grid-cols-2 gap-3 p-4 border rounded-md max-h-[200px] overflow-y-auto\">\n                      {Array.isArray(features) && features.length > 0 ? (\n                        features.map((feature) => (\n                          <div key={feature._id} className=\"flex items-center space-x-2\">\n                            <Checkbox\n                              id={`edit-feature-${feature._id}`}\n                              checked={(editForm.watch(\"features\") || []).includes(feature.name)}\n                              onCheckedChange={(checked) => {\n                                const current = (editForm.getValues(\"features\") || []) as string[];\n                                if (checked) {\n                                  editForm.setValue(\"features\", [...current, feature.name]);\n                                } else {\n                                  editForm.setValue(\"features\", current.filter((f: string) => f !== feature.name));\n                                }\n                              }}\n                            />\n                            <label htmlFor={`edit-feature-${feature._id}`} className=\"text-sm cursor-pointer\">{feature.name}</label>\n                          </div>\n                        ))\n                      ) : (\n                        <p className=\"col-span-2 text-sm text-muted-foreground text-center py-2\">\n                          No features available.\n                        </p>\n                      )}\n                    </div>\n                  </div>\n                  <FormField\n                    control={editForm.control}\n                    name=\"selfBranding\"\n                    render={({ field }) => (\n                      <FormItem className=\"flex flex-row items-center justify-between rounded-lg border p-3 shadow-sm\">\n                        <div className=\"space-y-0.5\">\n                          <FormLabel>Self Branding</FormLabel>\n                        </div>\n                        <FormControl>\n                          <Select onValueChange={(val) => field.onChange(val === \"yes\")} value={field.value ? \"yes\" : \"no\"}>\n                            <SelectTrigger className=\"w-[100px]\">\n                              <SelectValue placeholder=\"Select\" />\n                            </SelectTrigger>\n                            <SelectContent>\n                              <SelectItem value=\"yes\">Yes</SelectItem>\n                              <SelectItem value=\"no\">No</SelectItem>\n                            </SelectContent>\n                          </Select>\n                        </FormControl>\n                      </FormItem>\n                    )}\n                  />\n                  <Button type=\"submit\" className=\"w-full mt-4\" disabled={updatePlanMutation.isPending}>\n                    {updatePlanMutation.isPending && <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" />}\n                    Update Plan\n                  </Button>\n                </form>\n              </Form>\n            </DialogContent>\n          </Dialog>\n        </div>\n      </div>\n\n      <div className=\"flex flex-col md:flex-row gap-4 mb-4\">\n        <div className=\"relative flex-1\">\n          <Search className=\"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground\" />\n          <Input \n            placeholder=\"Search plans...\" \n            value={search}\n            onChange={(e) => { setSearch(e.target.value); setPage(1); }}\n            className=\"pl-9\"\n          />\n        </div>\n        <Select value={filterDuration} onValueChange={(val) => { setFilterDuration(val); setPage(1); }}>\n          <SelectTrigger className=\"w-[180px]\">\n            <SelectValue placeholder=\"Filter by duration\" />\n          </SelectTrigger>\n          <SelectContent>\n            <SelectItem value=\"all\">All Durations</SelectItem>\n            <SelectItem value=\"monthly\">Monthly</SelectItem>\n            <SelectItem value=\"quarterly\">Quarterly</SelectItem>\n            <SelectItem value=\"yearly\">Yearly</SelectItem>\n            <SelectItem value=\"lifetime\">Lifetime</SelectItem>\n          </SelectContent>\n        </Select>\n      </div>\n\n      <Card>\n        <CardContent className=\"p-0\">\n          <Table>\n            <TableHeader>\n              <TableRow>\n                <TableHead className=\"w-[200px]\">Plan Name</TableHead>\n                <TableHead>Price</TableHead>\n                <TableHead>Duration</TableHead>\n                <TableHead>Credits</TableHead>\n                <TableHead>Rates (Call/SMS/WA)</TableHead>\n                <TableHead className=\"text-right\">Actions</TableHead>\n              </TableRow>\n            </TableHeader>\n            <TableBody>\n              {Array.isArray(paginatedPlans) && paginatedPlans.length > 0 ? (\n                paginatedPlans.map((plan) => (\n                  <TableRow key={plan._id}>\n                    <TableCell className=\"font-medium\">{plan.name}</TableCell>\n                    <TableCell>â‚¹{plan.price}</TableCell>\n                    <TableCell className=\"capitalize\">{plan.duration}</TableCell>\n                    <TableCell>{plan.credits.toLocaleString()}</TableCell>\n                    <TableCell>\n                      <div className=\"text-xs space-y-0.5\">\n                        <div>Call: â‚¹{plan.callingRate}/min</div>\n                        <div>SMS: â‚¹{plan.smsRate}/msg</div>\n                        <div>WA: â‚¹{plan.whatsappRate}/msg</div>\n                      </div>\n                    </TableCell>\n                    <TableCell className=\"text-right\">\n                      <div className=\"flex justify-end gap-2\">\n                        <Button \n                          variant=\"ghost\" \n                          size=\"icon\"\n                          onClick={() => handleEdit(plan)}\n                        >\n                          <Edit2 className=\"h-4 w-4 text-primary\" />\n                        </Button>\n                        <Button \n                          variant=\"ghost\" \n                          size=\"icon\"\n                          className=\"text-destructive\"\n                          onClick={async () => {\n                            if (confirm(\"Are you sure you want to delete this plan?\")) {\n                              await apiRequest(\"DELETE\", `/api/plans/${plan._id}`);\n                              queryClient.invalidateQueries({ queryKey: [\"/api/plans\"] });\n                              toast({ title: \"Deleted\", description: \"Plan deleted successfully\" });\n                            }\n                          }}\n                        >\n                          <Trash2 className=\"h-4 w-4\" />\n                        </Button>\n                      </div>\n                    </TableCell>\n                  </TableRow>\n                ))\n              ) : (\n                <TableRow>\n                  <TableCell colSpan={6} className=\"text-center py-8 text-muted-foreground\">\n                    No plans found.\n                  </TableCell>\n                </TableRow>\n              )}\n            </TableBody>\n          </Table>\n        </CardContent>\n      </Card>\n\n      {totalPages > 1 && (\n        <div className=\"flex items-center justify-center gap-4\">\n          <Button\n            variant=\"outline\"\n            size=\"sm\"\n            onClick={() => setPage(p => Math.max(1, p - 1))}\n            disabled={page === 1}\n          >\n            <ChevronLeft className=\"h-4 w-4 mr-1\" /> Previous\n          </Button>\n          <span className=\"text-sm text-muted-foreground\">\n            Page {page} of {totalPages}\n          </span>\n          <Button\n            variant=\"outline\"\n            size=\"sm\"\n            onClick={() => setPage(p => Math.min(totalPages, p + 1))}\n            disabled={page === totalPages}\n          >\n            Next <ChevronRight className=\"h-4 w-4 ml-1\" />\n          </Button>\n        </div>\n      )}\n    </div>\n  );\n}\n","path":null,"size_bytes":31246,"size_tokens":null},"client/src/components/ui/accordion.tsx":{"content":"import * as React from \"react\"\nimport * as AccordionPrimitive from \"@radix-ui/react-accordion\"\nimport { ChevronDown } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Accordion = AccordionPrimitive.Root\n\nconst AccordionItem = React.forwardRef<\n  React.ElementRef<typeof AccordionPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Item>\n>(({ className, ...props }, ref) => (\n  <AccordionPrimitive.Item\n    ref={ref}\n    className={cn(\"border-b\", className)}\n    {...props}\n  />\n))\nAccordionItem.displayName = \"AccordionItem\"\n\nconst AccordionTrigger = React.forwardRef<\n  React.ElementRef<typeof AccordionPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Trigger>\n>(({ className, children, ...props }, ref) => (\n  <AccordionPrimitive.Header className=\"flex\">\n    <AccordionPrimitive.Trigger\n      ref={ref}\n      className={cn(\n        \"flex flex-1 items-center justify-between py-4 text-sm font-medium transition-all hover:underline text-left [&[data-state=open]>svg]:rotate-180\",\n        className\n      )}\n      {...props}\n    >\n      {children}\n      <ChevronDown className=\"h-4 w-4 shrink-0 text-muted-foreground transition-transform duration-200\" />\n    </AccordionPrimitive.Trigger>\n  </AccordionPrimitive.Header>\n))\nAccordionTrigger.displayName = AccordionPrimitive.Trigger.displayName\n\nconst AccordionContent = React.forwardRef<\n  React.ElementRef<typeof AccordionPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Content>\n>(({ className, children, ...props }, ref) => (\n  <AccordionPrimitive.Content\n    ref={ref}\n    className=\"overflow-hidden text-sm data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down\"\n    {...props}\n  >\n    <div className={cn(\"pb-4 pt-0\", className)}>{children}</div>\n  </AccordionPrimitive.Content>\n))\nAccordionContent.displayName = AccordionPrimitive.Content.displayName\n\nexport { Accordion, AccordionItem, AccordionTrigger, AccordionContent }\n","path":null,"size_bytes":2001,"size_tokens":null},"client/src/components/ui/scroll-area.tsx":{"content":"import * as React from \"react\"\nimport * as ScrollAreaPrimitive from \"@radix-ui/react-scroll-area\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ScrollArea = React.forwardRef<\n  React.ElementRef<typeof ScrollAreaPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof ScrollAreaPrimitive.Root>\n>(({ className, children, ...props }, ref) => (\n  <ScrollAreaPrimitive.Root\n    ref={ref}\n    className={cn(\"relative overflow-hidden\", className)}\n    {...props}\n  >\n    <ScrollAreaPrimitive.Viewport className=\"h-full w-full rounded-[inherit]\">\n      {children}\n    </ScrollAreaPrimitive.Viewport>\n    <ScrollBar />\n    <ScrollAreaPrimitive.Corner />\n  </ScrollAreaPrimitive.Root>\n))\nScrollArea.displayName = ScrollAreaPrimitive.Root.displayName\n\nconst ScrollBar = React.forwardRef<\n  React.ElementRef<typeof ScrollAreaPrimitive.ScrollAreaScrollbar>,\n  React.ComponentPropsWithoutRef<typeof ScrollAreaPrimitive.ScrollAreaScrollbar>\n>(({ className, orientation = \"vertical\", ...props }, ref) => (\n  <ScrollAreaPrimitive.ScrollAreaScrollbar\n    ref={ref}\n    orientation={orientation}\n    className={cn(\n      \"flex touch-none select-none transition-colors\",\n      orientation === \"vertical\" &&\n        \"h-full w-2.5 border-l border-l-transparent p-[1px]\",\n      orientation === \"horizontal\" &&\n        \"h-2.5 flex-col border-t border-t-transparent p-[1px]\",\n      className\n    )}\n    {...props}\n  >\n    <ScrollAreaPrimitive.ScrollAreaThumb className=\"relative flex-1 rounded-full bg-border\" />\n  </ScrollAreaPrimitive.ScrollAreaScrollbar>\n))\nScrollBar.displayName = ScrollAreaPrimitive.ScrollAreaScrollbar.displayName\n\nexport { ScrollArea, ScrollBar }\n","path":null,"size_bytes":1642,"size_tokens":null},"client/src/components/theme-provider.tsx":{"content":"import { createContext, useContext, useEffect, useState } from \"react\"\n\ntype Theme = \"dark\" | \"light\" | \"system\"\n\ntype ThemeProviderProps = {\n  children: React.ReactNode\n  defaultTheme?: Theme\n  storageKey?: string\n}\n\ntype ThemeProviderState = {\n  theme: Theme\n  setTheme: (theme: Theme) => void\n}\n\nconst initialState: ThemeProviderState = {\n  theme: \"system\",\n  setTheme: () => null,\n}\n\nconst ThemeProviderContext = createContext<ThemeProviderState>(initialState)\n\nexport function ThemeProvider({\n  children,\n  defaultTheme = \"system\",\n  storageKey = \"vite-ui-theme\",\n}: ThemeProviderProps) {\n  const [theme, setTheme] = useState<Theme>(\n    () => (localStorage.getItem(storageKey) as Theme) || defaultTheme\n  )\n\n  useEffect(() => {\n    const root = window.document.documentElement\n\n    root.classList.remove(\"light\", \"dark\")\n\n    if (theme === \"system\") {\n      const systemTheme = window.matchMedia(\"(prefers-color-scheme: dark)\")\n        .matches\n        ? \"dark\"\n        : \"light\"\n\n      root.classList.add(systemTheme)\n      return\n    }\n\n    root.classList.add(theme)\n  }, [theme])\n\n  const value = {\n    theme,\n    setTheme: (theme: Theme) => {\n      localStorage.setItem(storageKey, theme)\n      setTheme(theme)\n    },\n  }\n\n  return (\n    <ThemeProviderContext.Provider value={value}>\n      {children}\n    </ThemeProviderContext.Provider>\n  )\n}\n\nexport const useTheme = () => {\n  const context = useContext(ThemeProviderContext)\n\n  if (context === undefined)\n    throw new Error(\"useTheme must be used within a ThemeProvider\")\n\n  return context\n}\n","path":null,"size_bytes":1556,"size_tokens":null},"client/src/components/ui/badge.tsx":{"content":"import * as React from \"react\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst badgeVariants = cva(\n  // @replit\n  // Whitespace-nowrap: Badges should never wrap.\n  \"whitespace-nowrap inline-flex items-center rounded-md border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2\" +\n  \" hover-elevate \",\n  {\n    variants: {\n      variant: {\n        default:\n          // @replit shadow-xs instead of shadow, no hover because we use hover-elevate\n          \"border-transparent bg-primary text-primary-foreground shadow-xs\",\n        secondary:\n          // @replit no hover because we use hover-elevate\n          \"border-transparent bg-secondary text-secondary-foreground\",\n        destructive:\n          // @replit shadow-xs instead of shadow, no hover because we use hover-elevate\n          \"border-transparent bg-destructive text-destructive-foreground shadow-xs\",\n          // @replit shadow-xs\" - use badge outline variable\n        outline: \"text-foreground border [border-color:var(--badge-outline)]\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  }\n)\n\nexport interface BadgeProps\n  extends React.HTMLAttributes<HTMLDivElement>,\n    VariantProps<typeof badgeVariants> {}\n\nfunction Badge({ className, variant, ...props }: BadgeProps) {\n  return (\n    <div className={cn(badgeVariants({ variant }), className)} {...props} />\n  )\n}\n\nexport { Badge, badgeVariants }\n","path":null,"size_bytes":1522,"size_tokens":null},"client/src/components/ui/calendar.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport {\n  ChevronDownIcon,\n  ChevronLeftIcon,\n  ChevronRightIcon,\n} from \"lucide-react\"\nimport { DayButton, DayPicker, getDefaultClassNames } from \"react-day-picker\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Button, buttonVariants } from \"@/components/ui/button\"\n\nfunction Calendar({\n  className,\n  classNames,\n  showOutsideDays = true,\n  captionLayout = \"label\",\n  buttonVariant = \"ghost\",\n  formatters,\n  components,\n  ...props\n}: React.ComponentProps<typeof DayPicker> & {\n  buttonVariant?: React.ComponentProps<typeof Button>[\"variant\"]\n}) {\n  const defaultClassNames = getDefaultClassNames()\n\n  return (\n    <DayPicker\n      showOutsideDays={showOutsideDays}\n      className={cn(\n        \"bg-background group/calendar p-3 [--cell-size:2rem] [[data-slot=card-content]_&]:bg-transparent [[data-slot=popover-content]_&]:bg-transparent\",\n        String.raw`rtl:**:[.rdp-button\\_next>svg]:rotate-180`,\n        String.raw`rtl:**:[.rdp-button\\_previous>svg]:rotate-180`,\n        className\n      )}\n      captionLayout={captionLayout}\n      formatters={{\n        formatMonthDropdown: (date) =>\n          date.toLocaleString(\"default\", { month: \"short\" }),\n        ...formatters,\n      }}\n      classNames={{\n        root: cn(\"w-fit\", defaultClassNames.root),\n        months: cn(\n          \"relative flex flex-col gap-4 md:flex-row\",\n          defaultClassNames.months\n        ),\n        month: cn(\"flex w-full flex-col gap-4\", defaultClassNames.month),\n        nav: cn(\n          \"absolute inset-x-0 top-0 flex w-full items-center justify-between gap-1\",\n          defaultClassNames.nav\n        ),\n        button_previous: cn(\n          buttonVariants({ variant: buttonVariant }),\n          \"h-[--cell-size] w-[--cell-size] select-none p-0 aria-disabled:opacity-50\",\n          defaultClassNames.button_previous\n        ),\n        button_next: cn(\n          buttonVariants({ variant: buttonVariant }),\n          \"h-[--cell-size] w-[--cell-size] select-none p-0 aria-disabled:opacity-50\",\n          defaultClassNames.button_next\n        ),\n        month_caption: cn(\n          \"flex h-[--cell-size] w-full items-center justify-center px-[--cell-size]\",\n          defaultClassNames.month_caption\n        ),\n        dropdowns: cn(\n          \"flex h-[--cell-size] w-full items-center justify-center gap-1.5 text-sm font-medium\",\n          defaultClassNames.dropdowns\n        ),\n        dropdown_root: cn(\n          \"has-focus:border-ring border-input shadow-xs has-focus:ring-ring/50 has-focus:ring-[3px] relative rounded-md border\",\n          defaultClassNames.dropdown_root\n        ),\n        dropdown: cn(\n          \"bg-popover absolute inset-0 opacity-0\",\n          defaultClassNames.dropdown\n        ),\n        caption_label: cn(\n          \"select-none font-medium\",\n          captionLayout === \"label\"\n            ? \"text-sm\"\n            : \"[&>svg]:text-muted-foreground flex h-8 items-center gap-1 rounded-md pl-2 pr-1 text-sm [&>svg]:size-3.5\",\n          defaultClassNames.caption_label\n        ),\n        table: \"w-full border-collapse\",\n        weekdays: cn(\"flex\", defaultClassNames.weekdays),\n        weekday: cn(\n          \"text-muted-foreground flex-1 select-none rounded-md text-[0.8rem] font-normal\",\n          defaultClassNames.weekday\n        ),\n        week: cn(\"mt-2 flex w-full\", defaultClassNames.week),\n        week_number_header: cn(\n          \"w-[--cell-size] select-none\",\n          defaultClassNames.week_number_header\n        ),\n        week_number: cn(\n          \"text-muted-foreground select-none text-[0.8rem]\",\n          defaultClassNames.week_number\n        ),\n        day: cn(\n          \"group/day relative aspect-square h-full w-full select-none p-0 text-center [&:first-child[data-selected=true]_button]:rounded-l-md [&:last-child[data-selected=true]_button]:rounded-r-md\",\n          defaultClassNames.day\n        ),\n        range_start: cn(\n          \"bg-accent rounded-l-md\",\n          defaultClassNames.range_start\n        ),\n        range_middle: cn(\"rounded-none\", defaultClassNames.range_middle),\n        range_end: cn(\"bg-accent rounded-r-md\", defaultClassNames.range_end),\n        today: cn(\n          \"bg-accent text-accent-foreground rounded-md data-[selected=true]:rounded-none\",\n          defaultClassNames.today\n        ),\n        outside: cn(\n          \"text-muted-foreground aria-selected:text-muted-foreground\",\n          defaultClassNames.outside\n        ),\n        disabled: cn(\n          \"text-muted-foreground opacity-50\",\n          defaultClassNames.disabled\n        ),\n        hidden: cn(\"invisible\", defaultClassNames.hidden),\n        ...classNames,\n      }}\n      components={{\n        Root: ({ className, rootRef, ...props }) => {\n          return (\n            <div\n              data-slot=\"calendar\"\n              ref={rootRef}\n              className={cn(className)}\n              {...props}\n            />\n          )\n        },\n        Chevron: ({ className, orientation, ...props }) => {\n          if (orientation === \"left\") {\n            return (\n              <ChevronLeftIcon className={cn(\"size-4\", className)} {...props} />\n            )\n          }\n\n          if (orientation === \"right\") {\n            return (\n              <ChevronRightIcon\n                className={cn(\"size-4\", className)}\n                {...props}\n              />\n            )\n          }\n\n          return (\n            <ChevronDownIcon className={cn(\"size-4\", className)} {...props} />\n          )\n        },\n        DayButton: CalendarDayButton,\n        WeekNumber: ({ children, ...props }) => {\n          return (\n            <td {...props}>\n              <div className=\"flex size-[--cell-size] items-center justify-center text-center\">\n                {children}\n              </div>\n            </td>\n          )\n        },\n        ...components,\n      }}\n      {...props}\n    />\n  )\n}\n\nfunction CalendarDayButton({\n  className,\n  day,\n  modifiers,\n  ...props\n}: React.ComponentProps<typeof DayButton>) {\n  const defaultClassNames = getDefaultClassNames()\n\n  const ref = React.useRef<HTMLButtonElement>(null)\n  React.useEffect(() => {\n    if (modifiers.focused) ref.current?.focus()\n  }, [modifiers.focused])\n\n  return (\n    <Button\n      ref={ref}\n      variant=\"ghost\"\n      size=\"icon\"\n      data-day={day.date.toLocaleDateString()}\n      data-selected-single={\n        modifiers.selected &&\n        !modifiers.range_start &&\n        !modifiers.range_end &&\n        !modifiers.range_middle\n      }\n      data-range-start={modifiers.range_start}\n      data-range-end={modifiers.range_end}\n      data-range-middle={modifiers.range_middle}\n      className={cn(\n        \"data-[selected-single=true]:bg-primary data-[selected-single=true]:text-primary-foreground data-[range-middle=true]:bg-accent data-[range-middle=true]:text-accent-foreground data-[range-start=true]:bg-primary data-[range-start=true]:text-primary-foreground data-[range-end=true]:bg-primary data-[range-end=true]:text-primary-foreground group-data-[focused=true]/day:border-ring group-data-[focused=true]/day:ring-ring/50 flex aspect-square h-auto w-full min-w-[--cell-size] flex-col gap-1 font-normal leading-none data-[range-end=true]:rounded-md data-[range-middle=true]:rounded-none data-[range-start=true]:rounded-md group-data-[focused=true]/day:relative group-data-[focused=true]/day:z-10 group-data-[focused=true]/day:ring-[3px] [&>span]:text-xs [&>span]:opacity-70\",\n        defaultClassNames.day,\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nexport { Calendar, CalendarDayButton }\n","path":null,"size_bytes":7569,"size_tokens":null},"client/src/components/ui/radio-group.tsx":{"content":"import * as React from \"react\"\nimport * as RadioGroupPrimitive from \"@radix-ui/react-radio-group\"\nimport { Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst RadioGroup = React.forwardRef<\n  React.ElementRef<typeof RadioGroupPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof RadioGroupPrimitive.Root>\n>(({ className, ...props }, ref) => {\n  return (\n    <RadioGroupPrimitive.Root\n      className={cn(\"grid gap-2\", className)}\n      {...props}\n      ref={ref}\n    />\n  )\n})\nRadioGroup.displayName = RadioGroupPrimitive.Root.displayName\n\nconst RadioGroupItem = React.forwardRef<\n  React.ElementRef<typeof RadioGroupPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof RadioGroupPrimitive.Item>\n>(({ className, ...props }, ref) => {\n  return (\n    <RadioGroupPrimitive.Item\n      ref={ref}\n      className={cn(\n        \"aspect-square h-4 w-4 rounded-full border border-primary text-primary shadow focus:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50\",\n        className\n      )}\n      {...props}\n    >\n      <RadioGroupPrimitive.Indicator className=\"flex items-center justify-center\">\n        <Circle className=\"h-3.5 w-3.5 fill-primary\" />\n      </RadioGroupPrimitive.Indicator>\n    </RadioGroupPrimitive.Item>\n  )\n})\nRadioGroupItem.displayName = RadioGroupPrimitive.Item.displayName\n\nexport { RadioGroup, RadioGroupItem }\n","path":null,"size_bytes":1410,"size_tokens":null},"client/src/components/ui/sheet.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as SheetPrimitive from \"@radix-ui/react-dialog\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\nimport { X } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Sheet = SheetPrimitive.Root\n\nconst SheetTrigger = SheetPrimitive.Trigger\n\nconst SheetClose = SheetPrimitive.Close\n\nconst SheetPortal = SheetPrimitive.Portal\n\nconst SheetOverlay = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof SheetPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <SheetPrimitive.Overlay\n    className={cn(\n      \"fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0\",\n      className\n    )}\n    {...props}\n    ref={ref}\n  />\n))\nSheetOverlay.displayName = SheetPrimitive.Overlay.displayName\n\nconst sheetVariants = cva(\n  \"fixed z-50 gap-4 bg-background p-6 shadow-lg transition ease-in-out data-[state=closed]:duration-300 data-[state=open]:duration-500 data-[state=open]:animate-in data-[state=closed]:animate-out\",\n  {\n    variants: {\n      side: {\n        top: \"inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top\",\n        bottom:\n          \"inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom\",\n        left: \"inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm\",\n        right:\n          \"inset-y-0 right-0 h-full w-3/4 border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm\",\n      },\n    },\n    defaultVariants: {\n      side: \"right\",\n    },\n  }\n)\n\ninterface SheetContentProps\n  extends React.ComponentPropsWithoutRef<typeof SheetPrimitive.Content>,\n    VariantProps<typeof sheetVariants> {}\n\nconst SheetContent = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Content>,\n  SheetContentProps\n>(({ side = \"right\", className, children, ...props }, ref) => (\n  <SheetPortal>\n    <SheetOverlay />\n    <SheetPrimitive.Content\n      ref={ref}\n      className={cn(sheetVariants({ side }), className)}\n      {...props}\n    >\n      <SheetPrimitive.Close className=\"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-secondary\">\n        <X className=\"h-4 w-4\" />\n        <span className=\"sr-only\">Close</span>\n      </SheetPrimitive.Close>\n      {children}\n    </SheetPrimitive.Content>\n  </SheetPortal>\n))\nSheetContent.displayName = SheetPrimitive.Content.displayName\n\nconst SheetHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col space-y-2 text-center sm:text-left\",\n      className\n    )}\n    {...props}\n  />\n)\nSheetHeader.displayName = \"SheetHeader\"\n\nconst SheetFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2\",\n      className\n    )}\n    {...props}\n  />\n)\nSheetFooter.displayName = \"SheetFooter\"\n\nconst SheetTitle = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof SheetPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <SheetPrimitive.Title\n    ref={ref}\n    className={cn(\"text-lg font-semibold text-foreground\", className)}\n    {...props}\n  />\n))\nSheetTitle.displayName = SheetPrimitive.Title.displayName\n\nconst SheetDescription = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof SheetPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <SheetPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nSheetDescription.displayName = SheetPrimitive.Description.displayName\n\nexport {\n  Sheet,\n  SheetPortal,\n  SheetOverlay,\n  SheetTrigger,\n  SheetClose,\n  SheetContent,\n  SheetHeader,\n  SheetFooter,\n  SheetTitle,\n  SheetDescription,\n}\n","path":null,"size_bytes":4280,"size_tokens":null},"client/src/components/ui/item.tsx":{"content":"import * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Separator } from \"@/components/ui/separator\"\n\nfunction ItemGroup({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      role=\"list\"\n      data-slot=\"item-group\"\n      className={cn(\"group/item-group flex flex-col\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction ItemSeparator({\n  className,\n  ...props\n}: React.ComponentProps<typeof Separator>) {\n  return (\n    <Separator\n      data-slot=\"item-separator\"\n      orientation=\"horizontal\"\n      className={cn(\"my-0\", className)}\n      {...props}\n    />\n  )\n}\n\nconst itemVariants = cva(\n  \"group/item [a]:hover:bg-accent/50 focus-visible:border-ring focus-visible:ring-ring/50 [a]:transition-colors flex flex-wrap items-center rounded-md border border-transparent text-sm outline-none transition-colors duration-100 focus-visible:ring-[3px]\",\n  {\n    variants: {\n      variant: {\n        default: \"bg-transparent\",\n        outline: \"border-border\",\n        muted: \"bg-muted/50\",\n      },\n      size: {\n        default: \"gap-4 p-4 \",\n        sm: \"gap-2.5 px-4 py-3\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  }\n)\n\nfunction Item({\n  className,\n  variant = \"default\",\n  size = \"default\",\n  asChild = false,\n  ...props\n}: React.ComponentProps<\"div\"> &\n  VariantProps<typeof itemVariants> & { asChild?: boolean }) {\n  const Comp = asChild ? Slot : \"div\"\n  return (\n    <Comp\n      data-slot=\"item\"\n      data-variant={variant}\n      data-size={size}\n      className={cn(itemVariants({ variant, size, className }))}\n      {...props}\n    />\n  )\n}\n\nconst itemMediaVariants = cva(\n  \"flex shrink-0 items-center justify-center gap-2 group-has-[[data-slot=item-description]]/item:translate-y-0.5 group-has-[[data-slot=item-description]]/item:self-start [&_svg]:pointer-events-none\",\n  {\n    variants: {\n      variant: {\n        default: \"bg-transparent\",\n        icon: \"bg-muted size-8 rounded-sm border [&_svg:not([class*='size-'])]:size-4\",\n        image:\n          \"size-10 overflow-hidden rounded-sm [&_img]:size-full [&_img]:object-cover\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  }\n)\n\nfunction ItemMedia({\n  className,\n  variant = \"default\",\n  ...props\n}: React.ComponentProps<\"div\"> & VariantProps<typeof itemMediaVariants>) {\n  return (\n    <div\n      data-slot=\"item-media\"\n      data-variant={variant}\n      className={cn(itemMediaVariants({ variant, className }))}\n      {...props}\n    />\n  )\n}\n\nfunction ItemContent({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"item-content\"\n      className={cn(\n        \"flex flex-1 flex-col gap-1 [&+[data-slot=item-content]]:flex-none\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction ItemTitle({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"item-title\"\n      className={cn(\n        \"flex w-fit items-center gap-2 text-sm font-medium leading-snug\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction ItemDescription({ className, ...props }: React.ComponentProps<\"p\">) {\n  return (\n    <p\n      data-slot=\"item-description\"\n      className={cn(\n        \"text-muted-foreground line-clamp-2 text-balance text-sm font-normal leading-normal\",\n        \"[&>a:hover]:text-primary [&>a]:underline [&>a]:underline-offset-4\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction ItemActions({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"item-actions\"\n      className={cn(\"flex items-center gap-2\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction ItemHeader({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"item-header\"\n      className={cn(\n        \"flex basis-full items-center justify-between gap-2\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction ItemFooter({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"item-footer\"\n      className={cn(\n        \"flex basis-full items-center justify-between gap-2\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nexport {\n  Item,\n  ItemMedia,\n  ItemContent,\n  ItemActions,\n  ItemGroup,\n  ItemSeparator,\n  ItemTitle,\n  ItemDescription,\n  ItemHeader,\n  ItemFooter,\n}\n","path":null,"size_bytes":4494,"size_tokens":null},"client/src/components/layout/footer.tsx":{"content":"import { Link } from \"wouter\";\nimport { Phone, Mail, MapPin, Twitter, Linkedin, Github } from \"lucide-react\";\n\nexport function Footer() {\n  return (\n    <footer className=\"border-t bg-muted/40\">\n      <div className=\"container mx-auto px-4 py-12 md:py-16\">\n        <div className=\"grid grid-cols-1 md:grid-cols-4 gap-8\">\n          <div className=\"space-y-4\">\n            <div className=\"flex items-center gap-2 text-xl font-bold tracking-tighter\">\n              <div className=\"flex h-8 w-8 items-center justify-center rounded-lg bg-primary text-primary-foreground\">\n                <Phone className=\"h-4 w-4\" />\n              </div>\n              <span>NIJVOX</span>\n            </div>\n            <p className=\"text-muted-foreground text-sm leading-relaxed\">\n              Replacing human effort with intelligent, voice-driven AI sales agents. Scale your outreach today.\n            </p>\n          </div>\n          \n          <div>\n            <h3 className=\"font-bold mb-4\">Product</h3>\n            <ul className=\"space-y-2 text-sm text-muted-foreground\">\n              <li><Link href=\"/how-it-works\" className=\"hover:text-primary transition-colors\">How It Works</Link></li>\n              <li><Link href=\"/features\" className=\"hover:text-primary transition-colors\">Voice Agent</Link></li>\n              <li><Link href=\"/features\" className=\"hover:text-primary transition-colors\">Bulk SMS</Link></li>\n              <li><Link href=\"/features\" className=\"hover:text-primary transition-colors\">CRM Integration</Link></li>\n              <li><Link href=\"/pricing\" className=\"hover:text-primary transition-colors\">Pricing</Link></li>\n            </ul>\n          </div>\n\n          <div>\n            <h3 className=\"font-bold mb-4\">Company</h3>\n            <ul className=\"space-y-2 text-sm text-muted-foreground\">\n              <li><Link href=\"/about\" className=\"hover:text-primary transition-colors\">About Us</Link></li>\n              <li><Link href=\"/contact\" className=\"hover:text-primary transition-colors\">Contact</Link></li>\n              <li><Link href=\"/careers\" className=\"hover:text-primary transition-colors\">Careers</Link></li>\n              <li><Link href=\"/privacy\" className=\"hover:text-primary transition-colors\">Privacy Policy</Link></li>\n            </ul>\n          </div>\n\n          <div>\n            <h3 className=\"font-bold mb-4\">Connect</h3>\n            <div className=\"flex gap-4\">\n              <a href=\"#\" className=\"text-muted-foreground hover:text-primary transition-colors\"><Twitter className=\"h-5 w-5\" /></a>\n              <a href=\"#\" className=\"text-muted-foreground hover:text-primary transition-colors\"><Linkedin className=\"h-5 w-5\" /></a>\n              <a href=\"#\" className=\"text-muted-foreground hover:text-primary transition-colors\"><Github className=\"h-5 w-5\" /></a>\n            </div>\n          </div>\n        </div>\n        <div className=\"mt-12 pt-8 border-t text-center text-sm text-muted-foreground\">\n          Â© {new Date().getFullYear()} NIJVOX Inc. All rights reserved.\n        </div>\n      </div>\n    </footer>\n  );\n}\n","path":null,"size_bytes":3058,"size_tokens":null},"client/src/components/ui/pagination.tsx":{"content":"import * as React from \"react\"\nimport { ChevronLeft, ChevronRight, MoreHorizontal } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\nimport { ButtonProps, buttonVariants } from \"@/components/ui/button\"\n\nconst Pagination = ({ className, ...props }: React.ComponentProps<\"nav\">) => (\n  <nav\n    role=\"navigation\"\n    aria-label=\"pagination\"\n    className={cn(\"mx-auto flex w-full justify-center\", className)}\n    {...props}\n  />\n)\nPagination.displayName = \"Pagination\"\n\nconst PaginationContent = React.forwardRef<\n  HTMLUListElement,\n  React.ComponentProps<\"ul\">\n>(({ className, ...props }, ref) => (\n  <ul\n    ref={ref}\n    className={cn(\"flex flex-row items-center gap-1\", className)}\n    {...props}\n  />\n))\nPaginationContent.displayName = \"PaginationContent\"\n\nconst PaginationItem = React.forwardRef<\n  HTMLLIElement,\n  React.ComponentProps<\"li\">\n>(({ className, ...props }, ref) => (\n  <li ref={ref} className={cn(\"\", className)} {...props} />\n))\nPaginationItem.displayName = \"PaginationItem\"\n\ntype PaginationLinkProps = {\n  isActive?: boolean\n} & Pick<ButtonProps, \"size\"> &\n  React.ComponentProps<\"a\">\n\nconst PaginationLink = ({\n  className,\n  isActive,\n  size = \"icon\",\n  ...props\n}: PaginationLinkProps) => (\n  <a\n    aria-current={isActive ? \"page\" : undefined}\n    className={cn(\n      buttonVariants({\n        variant: isActive ? \"outline\" : \"ghost\",\n        size,\n      }),\n      className\n    )}\n    {...props}\n  />\n)\nPaginationLink.displayName = \"PaginationLink\"\n\nconst PaginationPrevious = ({\n  className,\n  ...props\n}: React.ComponentProps<typeof PaginationLink>) => (\n  <PaginationLink\n    aria-label=\"Go to previous page\"\n    size=\"default\"\n    className={cn(\"gap-1 pl-2.5\", className)}\n    {...props}\n  >\n    <ChevronLeft className=\"h-4 w-4\" />\n    <span>Previous</span>\n  </PaginationLink>\n)\nPaginationPrevious.displayName = \"PaginationPrevious\"\n\nconst PaginationNext = ({\n  className,\n  ...props\n}: React.ComponentProps<typeof PaginationLink>) => (\n  <PaginationLink\n    aria-label=\"Go to next page\"\n    size=\"default\"\n    className={cn(\"gap-1 pr-2.5\", className)}\n    {...props}\n  >\n    <span>Next</span>\n    <ChevronRight className=\"h-4 w-4\" />\n  </PaginationLink>\n)\nPaginationNext.displayName = \"PaginationNext\"\n\nconst PaginationEllipsis = ({\n  className,\n  ...props\n}: React.ComponentProps<\"span\">) => (\n  <span\n    aria-hidden\n    className={cn(\"flex h-9 w-9 items-center justify-center\", className)}\n    {...props}\n  >\n    <MoreHorizontal className=\"h-4 w-4\" />\n    <span className=\"sr-only\">More pages</span>\n  </span>\n)\nPaginationEllipsis.displayName = \"PaginationEllipsis\"\n\nexport {\n  Pagination,\n  PaginationContent,\n  PaginationLink,\n  PaginationItem,\n  PaginationPrevious,\n  PaginationNext,\n  PaginationEllipsis,\n}\n","path":null,"size_bytes":2751,"size_tokens":null},"postcss.config.js":{"content":"export default {\n  plugins: {\n    tailwindcss: {},\n    autoprefixer: {},\n  },\n}\n","path":null,"size_bytes":80,"size_tokens":null},"server/seed.ts":{"content":"import { connectDB, UserModel } from \"./db\";\nimport bcryptjs from \"bcryptjs\";\n\nasync function seed() {\n  try {\n    await connectDB();\n    console.log(\"Connected to MongoDB\");\n\n    const adminExists = await UserModel.findOne({ email: \"admin@nijvox.com\" });\n    \n    if (!adminExists) {\n      const hashedPassword = await bcryptjs.hash(\"admin123\", 10);\n      const admin = await UserModel.create({\n        email: \"admin@nijvox.com\",\n        password: hashedPassword,\n        firstName: \"Admin\",\n        lastName: \"User\",\n        role: \"admin\",\n        subscription: {\n          plan: \"Enterprise\",\n          status: \"Active\",\n          monthlyCallCredits: 10000,\n          creditsUsed: 0,\n          joinedDate: new Date(),\n        },\n        settings: {\n          dailyCallLimit: 1000,\n          dndEnabled: false,\n          localPresenceDialing: true,\n        },\n      });\n      console.log(\"âœ“ Admin user created: admin@nijvox.com / admin123\");\n    } else {\n      console.log(\"âœ“ Admin user already exists\");\n    }\n\n    const testUserExists = await UserModel.findOne({ email: \"test@example.com\" });\n    \n    if (!testUserExists) {\n      const hashedPassword = await bcryptjs.hash(\"test123\", 10);\n      const testUser = await UserModel.create({\n        email: \"test@example.com\",\n        password: hashedPassword,\n        firstName: \"Test\",\n        lastName: \"User\",\n        role: \"user\",\n        companyName: \"Test Company\",\n        phone: \"+1234567890\",\n        subscription: {\n          plan: \"Pro\",\n          status: \"Active\",\n          monthlyCallCredits: 2000,\n          creditsUsed: 250,\n          joinedDate: new Date(),\n        },\n        settings: {\n          dailyCallLimit: 500,\n          dndEnabled: false,\n          localPresenceDialing: true,\n        },\n      });\n      console.log(\"âœ“ Test user created: test@example.com / test123\");\n    } else {\n      console.log(\"âœ“ Test user already exists\");\n    }\n\n    console.log(\"\\nDatabase seeded successfully!\");\n    process.exit(0);\n  } catch (error) {\n    console.error(\"Error seeding database:\", error);\n    process.exit(1);\n  }\n}\n\nseed();\n","path":null,"size_bytes":2105,"size_tokens":null},"shared/schema.ts":{"content":"import { z } from \"zod\";\n\n// Subscription Info Type\nexport type SubscriptionInfo = {\n  plan: string; // Dynamic plan name\n  status: \"Active\" | \"Inactive\" | \"Cancelled\";\n  monthlyCallCredits: number;\n  creditsUsed: number;\n  renewalDate?: Date;\n  joinedDate: Date;\n};\n\n// Plan Schema\nexport const insertPlanSchema = z.object({\n  name: z.string().min(1),\n  price: z.number().min(0),\n  duration: z.enum([\"monthly\", \"yearly\", \"quarterly\", \"lifetime\"]),\n  credits: z.number().min(0),\n  callingRate: z.number().min(0).default(0),\n  smsRate: z.number().min(0).default(0),\n  whatsappRate: z.number().min(0).default(0),\n  features: z.array(z.string()),\n  limitations: z.array(z.string()),\n  description: z.string().optional(),\n  isActive: z.boolean().default(true),\n  selfBranding: z.boolean().default(false),\n});\n\nexport type InsertPlan = z.infer<typeof insertPlanSchema>;\nexport type Plan = InsertPlan & {\n  _id: string;\n  createdAt: Date;\n};\n\n// Feature Schema (for dynamic management)\nexport const insertFeatureSchema = z.object({\n  name: z.string().min(1),\n});\n\nexport type InsertFeature = z.infer<typeof insertFeatureSchema>;\nexport type Feature = InsertFeature & {\n  _id: string;\n};\n\n// User Schema\nexport const insertUserSchema = z.object({\n  email: z.string().email(),\n  password: z.string().min(6),\n  firstName: z.string().min(1),\n  lastName: z.string().min(1),\n  role: z.enum([\"admin\", \"user\"]).default(\"user\"),\n  companyName: z.string().optional(),\n  phone: z.string().optional(),\n  selectedPlanId: z.string().optional(),\n  companyLogo: z.string().optional(),\n  dltPrincipalEntityId: z.string().optional(),\n  dltHeaderId: z.string().optional(),\n});\n\nexport const updateUserSchema = insertUserSchema.partial().omit({ password: true });\n\nexport const changePasswordSchema = z.object({\n  currentPassword: z.string(),\n  newPassword: z.string().min(6),\n});\n\nexport type InsertUser = z.infer<typeof insertUserSchema>;\nexport type UpdateUser = z.infer<typeof updateUserSchema>;\nexport type User = Omit<InsertUser, \"password\"> & {\n  _id: string;\n  createdAt: Date;\n  settings?: {\n    dailyCallLimit: number;\n    dndEnabled: boolean;\n    localPresenceDialing: boolean;\n  };\n  dltPrincipalEntityId?: string;\n  dltHeaderId?: string;\n  subscription?: SubscriptionInfo;\n  exotelConfig?: {\n    apiKey: string;\n    apiToken: string;\n    subdomain: string;\n    sid: string;\n  };\n  gupshupConfig?: {\n    apiKey: string;\n    userId: string;\n  };\n};\n\n// Admin Settings Schema (Global config)\nexport const insertAdminSettingsSchema = z.object({\n  exotelApiKey: z.string().min(1),\n  exotelApiToken: z.string().min(1),\n  exotelSubdomain: z.string().min(1),\n  exotelSid: z.string().min(1),\n  gupshupApiKey: z.string().optional(),\n  gupshupUserId: z.string().optional(),\n});\n\nexport type AdminSettings = z.infer<typeof insertAdminSettingsSchema>;\n\n// Credit Usage Schema\nexport const insertCreditUsageSchema = z.object({\n  userId: z.string(),\n  campaignId: z.string().optional(),\n  type: z.enum([\"call\", \"sms\", \"whatsapp\"]),\n  amount: z.number().min(0),\n  date: z.string(), // ISO date string (YYYY-MM-DD)\n});\n\nexport type InsertCreditUsage = z.infer<typeof insertCreditUsageSchema>;\nexport type CreditUsage = InsertCreditUsage & {\n  _id: string;\n  createdAt: Date;\n};\n\n// Lead Schema\nexport const insertLeadSchema = z.object({\n  userId: z.string(),\n  campaignId: z.string().optional(), // Associated campaign ID\n  name: z.string().min(1),\n  company: z.string().optional(),\n  email: z.string().email().optional(),\n  phone: z.string().min(1),\n  status: z.enum([\"New\", \"Interested\", \"Follow Up\", \"Closed\", \"Unqualified\", \"In Progress\"]).default(\"New\"),\n  outcome: z.string().default(\"Pending\"),\n  notes: z.string().optional(),\n});\n\nexport type InsertLead = z.infer<typeof insertLeadSchema>;\nexport type Lead = InsertLead & {\n  _id: string;\n  campaignId?: string; // Associated campaign ID\n  campaignName?: string; // Populated from campaign (for display)\n  lastContact: Date;\n  history: LeadHistoryItem[];\n  appointments: string[]; // appointment IDs\n  createdAt: Date;\n};\n\n// Lead History Item\nexport type LeadHistoryItem = {\n  type: \"call\" | \"email\" | \"note\";\n  date: Date;\n  duration?: string;\n  outcome?: string;\n  subject?: string;\n  note: string;\n  campaignId?: string; // Track which campaign triggered this interaction\n  campaignName?: string;\n};\n\n// Knowledge Base File Type\nexport type KnowledgeBaseFile = {\n  id: string;\n  name: string;\n  type: string;\n  size: number;\n  url: string;\n  uploadedAt: Date;\n};\n\n// Campaign Schema\nexport const insertCampaignSchema = z.object({\n  userId: z.string(),\n  name: z.string().min(1),\n  goal: z.enum([\"sales\", \"support\", \"survey\", \"appointment\"]),\n  script: z.string().optional(),\n  status: z.enum([\"Active\", \"Paused\", \"Draft\"]).default(\"Draft\"),\n  voice: z.string().default(\"Rachel (American)\"),\n  knowledgeBase: z.array(z.string()).optional(),\n  knowledgeBaseFiles: z.array(z.object({\n    id: z.string(),\n    name: z.string(),\n    type: z.string(),\n    size: z.number(),\n    url: z.string(),\n    uploadedAt: z.date().or(z.string()),\n  })).optional(),\n  additionalContext: z.string().optional(),\n  callingHours: z.object({\n    start: z.string(),\n    end: z.string(),\n  }).optional(),\n  startDate: z.string().optional(),\n  endDate: z.string().optional(),\n});\n\nexport type InsertCampaign = z.infer<typeof insertCampaignSchema>;\nexport type Campaign = InsertCampaign & {\n  _id: string;\n  progress: number;\n  callsMade: number;\n  goalsMet: number;\n  knowledgeBaseFiles?: KnowledgeBaseFile[];\n  startDate?: string;\n  endDate?: string;\n  createdAt: Date;\n};\n\n// Appointment Schema\nexport const insertAppointmentSchema = z.object({\n  userId: z.string(),\n  leadId: z.string(),\n  leadName: z.string(),\n  title: z.string().min(1),\n  date: z.string(), // ISO date string\n  time: z.string(),\n  type: z.string().default(\"Zoom\"),\n  notes: z.string().optional(),\n});\n\nexport type InsertAppointment = z.infer<typeof insertAppointmentSchema>;\nexport type Appointment = InsertAppointment & {\n  _id: string;\n  createdAt: Date;\n};\n\n// User Settings Schema\nexport const updateSettingsSchema = z.object({\n  dailyCallLimit: z.number().min(0).max(10000).optional(),\n  dndEnabled: z.boolean().optional(),\n  localPresenceDialing: z.boolean().optional(),\n});\n\nexport type UpdateSettings = z.infer<typeof updateSettingsSchema>;\nexport type UserSettings = UpdateSettings & {\n  _id: string;\n  userId: string;\n};\n\n// Notes Schema\nexport const insertNoteSchema = z.object({\n  userId: z.string(),\n  title: z.string().min(1),\n  content: z.string().min(1),\n});\n\nexport const updateNoteSchema = insertNoteSchema.partial();\n\nexport type InsertNote = z.infer<typeof insertNoteSchema>;\nexport type UpdateNote = z.infer<typeof updateNoteSchema>;\nexport type Note = InsertNote & {\n  _id: string;\n  createdAt: Date;\n  updatedAt: Date;\n};\n\n// Notification Schema\nexport const insertNotificationSchema = z.object({\n  message: z.string().min(1),\n  type: z.enum([\"notification\", \"announcement\"]),\n  date: z.string().optional(),\n});\n\nexport type InsertNotification = z.infer<typeof insertNotificationSchema>;\nexport type Notification = InsertNotification & {\n  _id: string;\n  createdAt: Date;\n  readBy: string[]; // User IDs who have seen/dismissed it\n};\n","path":null,"size_bytes":7235,"size_tokens":null},"server/db.ts":{"content":"import mongoose from \"mongoose\";\n\nconst MONGODB_URI = process.env.MONGODB_URI || \"mongodb://localhost:27017/nijvox\";\n\nlet isConnected = false;\n\nexport async function connectDB() {\n  if (isConnected) {\n    return;\n  }\n\n  try {\n    await mongoose.connect(MONGODB_URI);\n    isConnected = true;\n    console.log(\"MongoDB connected successfully\");\n  } catch (error) {\n    console.error(`MongoDB connection error: ${error}`);\n    throw error;\n  }\n}\n\n// User Model\nconst userSchema = new mongoose.Schema({\n  email: { type: String, required: true, unique: true },\n  password: { type: String, required: true },\n  firstName: { type: String, required: true },\n  lastName: { type: String, required: true },\n  role: { type: String, enum: [\"admin\", \"user\"], default: \"user\" },\n  companyName: String,\n  phone: String,\n  subscription: {\n    plan: { type: String, default: \"Free\" },\n    status: { type: String, enum: [\"Active\", \"Inactive\", \"Cancelled\"], default: \"Active\" },\n    monthlyCallCredits: { type: Number, default: 0 },\n    creditsUsed: { type: Number, default: 0 },\n    renewalDate: Date,\n    joinedDate: { type: Date, default: Date.now },\n  },\n  settings: {\n    dailyCallLimit: { type: Number, default: 500 },\n    dndEnabled: { type: Boolean, default: false },\n    localPresenceDialing: { type: Boolean, default: true },\n  },\n  exotelConfig: {\n    apiKey: String,\n    apiToken: String,\n    subdomain: String,\n    sid: String,\n  },\n  gupshupConfig: {\n    apiKey: String,\n    userId: String,\n  },\n  createdAt: { type: Date, default: Date.now },\n});\n\n// Lead Model\nconst leadSchema = new mongoose.Schema({\n  userId: { type: mongoose.Schema.Types.ObjectId, ref: \"User\", required: true },\n  campaignId: { type: mongoose.Schema.Types.ObjectId, ref: \"Campaign\" }, // Associated campaign\n  name: { type: String, required: true },\n  company: String,\n  email: String,\n  phone: { type: String, required: true },\n  status: {\n    type: String,\n    enum: [\"New\", \"Interested\", \"Follow Up\", \"Closed\", \"Unqualified\", \"In Progress\"],\n    default: \"New\",\n  },\n  outcome: { type: String, default: \"Pending\" },\n  notes: String,\n  lastContact: { type: Date, default: Date.now },\n  history: [{\n    type: { type: String, enum: [\"call\", \"email\", \"note\"], required: true },\n    date: { type: Date, default: Date.now },\n    duration: String,\n    outcome: String,\n    subject: String,\n    note: String,\n    campaignId: { type: mongoose.Schema.Types.ObjectId, ref: \"Campaign\" },\n    campaignName: String,\n  }],\n  appointments: [{ type: mongoose.Schema.Types.ObjectId, ref: \"Appointment\" }],\n  createdAt: { type: Date, default: Date.now },\n});\n\n// Campaign Model\nconst campaignSchema = new mongoose.Schema({\n  userId: { type: mongoose.Schema.Types.ObjectId, ref: \"User\", required: true },\n  name: { type: String, required: true },\n  goal: { type: String, enum: [\"sales\", \"support\", \"survey\", \"appointment\"], required: true },\n  script: String,\n  status: { type: String, enum: [\"Active\", \"Paused\", \"Draft\"], default: \"Draft\" },\n  voice: { type: String, default: \"Rachel (American)\" },\n  knowledgeBase: [String],\n  knowledgeBaseFiles: [{\n    id: String,\n    name: String,\n    type: String,\n    size: Number,\n    url: String,\n    uploadedAt: Date,\n  }],\n  additionalContext: String,\n  callingHours: {\n    start: String,\n    end: String,\n  },\n  startDate: String,\n  endDate: String,\n  progress: { type: Number, default: 0 },\n  callsMade: { type: Number, default: 0 },\n  goalsMet: { type: Number, default: 0 },\n  createdAt: { type: Date, default: Date.now },\n});\n\n// Appointment Model\nconst appointmentSchema = new mongoose.Schema({\n  userId: { type: mongoose.Schema.Types.ObjectId, ref: \"User\", required: true },\n  leadId: { type: mongoose.Schema.Types.ObjectId, ref: \"Lead\", required: true },\n  leadName: { type: String, required: true },\n  title: { type: String, required: true },\n  date: { type: String, required: true },\n  time: { type: String, required: true },\n  type: { type: String, default: \"Zoom\" },\n  notes: String,\n  createdAt: { type: Date, default: Date.now },\n});\n\n// Note Model\nexport const noteSchema = new mongoose.Schema({\n  userId: { type: mongoose.Schema.Types.ObjectId, ref: \"User\", required: true },\n  title: { type: String, required: true },\n  content: { type: String, required: true },\n  createdAt: { type: Date, default: Date.now },\n  updatedAt: { type: Date, default: Date.now },\n});\n\n// Notification Model\nexport const notificationSchema = new mongoose.Schema({\n  message: { type: String, required: true },\n  type: { type: String, enum: [\"notification\", \"announcement\"], required: true },\n  date: String,\n  readBy: [{ type: String }],\n  createdAt: { type: Date, default: Date.now },\n});\n\n// Plan Model\nexport const planSchema = new mongoose.Schema({\n  name: { type: String, required: true },\n  price: { type: Number, required: true },\n  duration: { type: String, enum: [\"monthly\", \"yearly\", \"quarterly\", \"lifetime\"], required: true },\n  credits: { type: Number, required: true },\n  callingRate: { type: Number, default: 0 },\n  smsRate: { type: Number, default: 0 },\n  whatsappRate: { type: Number, default: 0 },\n  features: [String],\n  limitations: [String],\n  description: String,\n  isActive: { type: Boolean, default: true },\n  selfBranding: { type: Boolean, default: false },\n  createdAt: { type: Date, default: Date.now },\n});\n\n// Feature Model\nconst featureSchema = new mongoose.Schema({\n  name: { type: String, required: true },\n});\n\nexport const UserModel = mongoose.model(\"User\", userSchema);\nexport const LeadModel = mongoose.model(\"Lead\", leadSchema);\nexport const CampaignModel = mongoose.model(\"Campaign\", campaignSchema);\nexport const AppointmentModel = mongoose.model(\"Appointment\", appointmentSchema);\nexport const NoteModel = mongoose.model(\"Note\", noteSchema);\nexport const NotificationModel = mongoose.model(\"Notification\", notificationSchema);\nexport const PlanModel = mongoose.model(\"Plan\", planSchema);\nexport const FeatureModel = mongoose.model(\"Feature\", featureSchema);\n","path":null,"size_bytes":5982,"size_tokens":null},"client/src/pages/admin-login.tsx":{"content":"import { Button } from \"@/components/ui/button\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle, CardFooter } from \"@/components/ui/card\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { Phone, ArrowLeft, Loader2 } from \"lucide-react\";\nimport { Link, useLocation } from \"wouter\";\nimport { useAuth } from \"@/lib/auth\";\nimport { useState } from \"react\";\nimport { useToast } from \"@/hooks/use-toast\";\n\nexport default function AdminLogin() {\n  const [, setLocation] = useLocation();\n  const { login, user } = useAuth();\n  const { toast } = useToast();\n  const [email, setEmail] = useState(\"\");\n  const [password, setPassword] = useState(\"\");\n  const [isSubmitting, setIsSubmitting] = useState(false);\n\n  // Redirect if already logged in as admin\n  if (user && user.role === \"admin\") {\n    setLocation(\"/admin/dashboard\");\n    return null;\n  }\n\n  const handleLogin = async (e: React.FormEvent) => {\n    e.preventDefault();\n    setIsSubmitting(true);\n    try {\n      await login(email, password);\n      // AuthProvider will handle redirection based on role\n    } catch (error: any) {\n      toast({\n        variant: \"destructive\",\n        title: \"Authentication Failed\",\n        description: error.message || \"Invalid admin credentials\",\n      });\n    } finally {\n      setIsSubmitting(false);\n    }\n  };\n\n  return (\n    <div className=\"min-h-screen flex items-center justify-center bg-background px-4 relative overflow-hidden\">\n       {/* Background elements */}\n       <div className=\"absolute inset-0 z-0 opacity-5\">\n          <div className=\"absolute top-0 left-0 w-96 h-96 bg-primary rounded-full blur-3xl -translate-x-1/2 -translate-y-1/2\" />\n          <div className=\"absolute bottom-0 right-0 w-96 h-96 bg-primary rounded-full blur-3xl translate-x-1/2 translate-y-1/2\" />\n       </div>\n\n      <div className=\"absolute top-8 left-8 z-20\">\n        <Link href=\"/\">\n          <a className=\"flex items-center text-muted-foreground hover:text-foreground transition-colors\">\n            <ArrowLeft className=\"mr-2 h-4 w-4\" /> Back to Site\n          </a>\n        </Link>\n      </div>\n\n      <Card className=\"w-full max-w-md border-primary/20 shadow-2xl shadow-primary/5 relative z-10 bg-card/80 backdrop-blur\">\n        <CardHeader className=\"text-center space-y-2\">\n          <div className=\"flex justify-center mb-4\">\n            <div className=\"flex h-12 w-12 items-center justify-center rounded-xl bg-primary text-primary-foreground\">\n              <Phone className=\"h-6 w-6\" />\n            </div>\n          </div>\n          <CardTitle className=\"text-2xl font-bold tracking-tighter\">NIJVOX ADMIN</CardTitle>\n          <CardDescription>\n            Restricted area. Authorized personnel only.\n          </CardDescription>\n        </CardHeader>\n        <CardContent>\n          <form className=\"space-y-4\" onSubmit={handleLogin}>\n            <div className=\"space-y-2\">\n              <Label htmlFor=\"email\">Admin Email</Label>\n              <Input \n                id=\"email\" \n                type=\"email\" \n                placeholder=\"admin@nijvox.com\" \n                required \n                className=\"bg-background/50\"\n                value={email}\n                onChange={(e) => setEmail(e.target.value)}\n              />\n            </div>\n            <div className=\"space-y-2\">\n              <div className=\"flex justify-between items-center\">\n                <Label htmlFor=\"password\">Password</Label>\n              </div>\n              <Input \n                id=\"password\" \n                type=\"password\" \n                required \n                className=\"bg-background/50\"\n                value={password}\n                onChange={(e) => setPassword(e.target.value)}\n              />\n            </div>\n            <Button type=\"submit\" className=\"w-full h-10 font-medium\" disabled={isSubmitting}>\n              {isSubmitting ? (\n                <>\n                  <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" />\n                  Authenticating...\n                </>\n              ) : (\n                \"Authenticate\"\n              )}\n            </Button>\n          </form>\n        </CardContent>\n        <CardFooter className=\"justify-center border-t p-6 text-xs text-muted-foreground\">\n          System activity is monitored and logged.\n        </CardFooter>\n      </Card>\n    </div>\n  );\n}\n","path":null,"size_bytes":4391,"size_tokens":null},"client/src/components/ui/checkbox.tsx":{"content":"import * as React from \"react\"\nimport * as CheckboxPrimitive from \"@radix-ui/react-checkbox\"\nimport { Check } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Checkbox = React.forwardRef<\n  React.ElementRef<typeof CheckboxPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof CheckboxPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <CheckboxPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"grid place-content-center peer h-4 w-4 shrink-0 rounded-sm border border-primary shadow focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground\",\n      className\n    )}\n    {...props}\n  >\n    <CheckboxPrimitive.Indicator\n      className={cn(\"grid place-content-center text-current\")}\n    >\n      <Check className=\"h-4 w-4\" />\n    </CheckboxPrimitive.Indicator>\n  </CheckboxPrimitive.Root>\n))\nCheckbox.displayName = CheckboxPrimitive.Root.displayName\n\nexport { Checkbox }\n","path":null,"size_bytes":1031,"size_tokens":null},"client/src/components/ui/avatar.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as AvatarPrimitive from \"@radix-ui/react-avatar\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Avatar = React.forwardRef<\n  React.ElementRef<typeof AvatarPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <AvatarPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full\",\n      className\n    )}\n    {...props}\n  />\n))\nAvatar.displayName = AvatarPrimitive.Root.displayName\n\nconst AvatarImage = React.forwardRef<\n  React.ElementRef<typeof AvatarPrimitive.Image>,\n  React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Image>\n>(({ className, ...props }, ref) => (\n  <AvatarPrimitive.Image\n    ref={ref}\n    className={cn(\"aspect-square h-full w-full\", className)}\n    {...props}\n  />\n))\nAvatarImage.displayName = AvatarPrimitive.Image.displayName\n\nconst AvatarFallback = React.forwardRef<\n  React.ElementRef<typeof AvatarPrimitive.Fallback>,\n  React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Fallback>\n>(({ className, ...props }, ref) => (\n  <AvatarPrimitive.Fallback\n    ref={ref}\n    className={cn(\n      \"flex h-full w-full items-center justify-center rounded-full bg-muted\",\n      className\n    )}\n    {...props}\n  />\n))\nAvatarFallback.displayName = AvatarPrimitive.Fallback.displayName\n\nexport { Avatar, AvatarImage, AvatarFallback }\n","path":null,"size_bytes":1419,"size_tokens":null},"client/src/components/ui/command.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport { type DialogProps } from \"@radix-ui/react-dialog\"\nimport { Command as CommandPrimitive } from \"cmdk\"\nimport { Search } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Dialog, DialogContent } from \"@/components/ui/dialog\"\n\nconst Command = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive\n    ref={ref}\n    className={cn(\n      \"flex h-full w-full flex-col overflow-hidden rounded-md bg-popover text-popover-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\nCommand.displayName = CommandPrimitive.displayName\n\nconst CommandDialog = ({ children, ...props }: DialogProps) => {\n  return (\n    <Dialog {...props}>\n      <DialogContent className=\"overflow-hidden p-0\">\n        <Command className=\"[&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground [&_[cmdk-group]:not([hidden])_~[cmdk-group]]:pt-0 [&_[cmdk-group]]:px-2 [&_[cmdk-input-wrapper]_svg]:h-5 [&_[cmdk-input-wrapper]_svg]:w-5 [&_[cmdk-input]]:h-12 [&_[cmdk-item]]:px-2 [&_[cmdk-item]]:py-3 [&_[cmdk-item]_svg]:h-5 [&_[cmdk-item]_svg]:w-5\">\n          {children}\n        </Command>\n      </DialogContent>\n    </Dialog>\n  )\n}\n\nconst CommandInput = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Input>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Input>\n>(({ className, ...props }, ref) => (\n  <div className=\"flex items-center border-b px-3\" cmdk-input-wrapper=\"\">\n    <Search className=\"mr-2 h-4 w-4 shrink-0 opacity-50\" />\n    <CommandPrimitive.Input\n      ref={ref}\n      className={cn(\n        \"flex h-10 w-full rounded-md bg-transparent py-3 text-sm outline-none placeholder:text-muted-foreground disabled:cursor-not-allowed disabled:opacity-50\",\n        className\n      )}\n      {...props}\n    />\n  </div>\n))\n\nCommandInput.displayName = CommandPrimitive.Input.displayName\n\nconst CommandList = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.List>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.List>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.List\n    ref={ref}\n    className={cn(\"max-h-[300px] overflow-y-auto overflow-x-hidden\", className)}\n    {...props}\n  />\n))\n\nCommandList.displayName = CommandPrimitive.List.displayName\n\nconst CommandEmpty = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Empty>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Empty>\n>((props, ref) => (\n  <CommandPrimitive.Empty\n    ref={ref}\n    className=\"py-6 text-center text-sm\"\n    {...props}\n  />\n))\n\nCommandEmpty.displayName = CommandPrimitive.Empty.displayName\n\nconst CommandGroup = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Group>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Group>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.Group\n    ref={ref}\n    className={cn(\n      \"overflow-hidden p-1 text-foreground [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\n\nCommandGroup.displayName = CommandPrimitive.Group.displayName\n\nconst CommandSeparator = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 h-px bg-border\", className)}\n    {...props}\n  />\n))\nCommandSeparator.displayName = CommandPrimitive.Separator.displayName\n\nconst CommandItem = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Item>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default gap-2 select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none data-[disabled=true]:pointer-events-none data-[selected=true]:bg-accent data-[selected=true]:text-accent-foreground data-[disabled=true]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\",\n      className\n    )}\n    {...props}\n  />\n))\n\nCommandItem.displayName = CommandPrimitive.Item.displayName\n\nconst CommandShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn(\n        \"ml-auto text-xs tracking-widest text-muted-foreground\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\nCommandShortcut.displayName = \"CommandShortcut\"\n\nexport {\n  Command,\n  CommandDialog,\n  CommandInput,\n  CommandList,\n  CommandEmpty,\n  CommandGroup,\n  CommandItem,\n  CommandShortcut,\n  CommandSeparator,\n}\n","path":null,"size_bytes":4887,"size_tokens":null},"client/src/index.css":{"content":"@import \"tailwindcss\";\n@import \"tw-animate-css\";\n\n@custom-variant dark (&:is(.dark *));\n\n@theme inline {\n  --font-sans: \"DM Sans\", sans-serif;\n  --font-heading: \"Space Grotesk\", sans-serif;\n  \n  --radius-sm: calc(var(--radius) - 4px);\n  --radius-md: calc(var(--radius) - 2px);\n  --radius-lg: var(--radius);\n\n  --color-background: hsl(var(--background));\n  --color-foreground: hsl(var(--foreground));\n  \n  --color-card: hsl(var(--card));\n  --color-card-foreground: hsl(var(--card-foreground));\n  \n  --color-popover: hsl(var(--popover));\n  --color-popover-foreground: hsl(var(--popover-foreground));\n  \n  --color-primary: hsl(var(--primary));\n  --color-primary-foreground: hsl(var(--primary-foreground));\n  \n  --color-secondary: hsl(var(--secondary));\n  --color-secondary-foreground: hsl(var(--secondary-foreground));\n  \n  --color-muted: hsl(var(--muted));\n  --color-muted-foreground: hsl(var(--muted-foreground));\n  \n  --color-accent: hsl(var(--accent));\n  --color-accent-foreground: hsl(var(--accent-foreground));\n  \n  --color-destructive: hsl(var(--destructive));\n  --color-destructive-foreground: hsl(var(--destructive-foreground));\n  \n  --color-border: hsl(var(--border));\n  --color-input: hsl(var(--input));\n  --color-ring: hsl(var(--ring));\n  \n  --color-chart-1: hsl(var(--chart-1));\n  --color-chart-2: hsl(var(--chart-2));\n  --color-chart-3: hsl(var(--chart-3));\n  --color-chart-4: hsl(var(--chart-4));\n  --color-chart-5: hsl(var(--chart-5));\n  \n  --color-sidebar: hsl(var(--sidebar));\n  --color-sidebar-foreground: hsl(var(--sidebar-foreground));\n  --color-sidebar-primary: hsl(var(--sidebar-primary));\n  --color-sidebar-primary-foreground: hsl(var(--sidebar-primary-foreground));\n  --color-sidebar-accent: hsl(var(--sidebar-accent));\n  --color-sidebar-accent-foreground: hsl(var(--sidebar-accent-foreground));\n  --color-sidebar-border: hsl(var(--sidebar-border));\n  --color-sidebar-ring: hsl(var(--sidebar-ring));\n}\n\n@layer base {\n  :root {\n    --background: 0 0% 100%; /* White */\n    --foreground: 240 10% 3.9%; /* Black */\n\n    --card: 0 0% 100%;\n    --card-foreground: 240 10% 3.9%;\n \n    --popover: 0 0% 100%;\n    --popover-foreground: 240 10% 3.9%;\n \n    --primary: 16 100% 50%; /* Vibrant Orange */\n    --primary-foreground: 0 0% 100%;\n \n    --secondary: 240 4.8% 95.9%;\n    --secondary-foreground: 240 5.9% 10%;\n \n    --muted: 240 4.8% 95.9%;\n    --muted-foreground: 240 3.8% 46.1%;\n \n    --accent: 16 100% 95%; /* Light Orange Tint */\n    --accent-foreground: 240 5.9% 10%;\n \n    --destructive: 0 84.2% 60.2%;\n    --destructive-foreground: 0 0% 98%;\n\n    --border: 240 5.9% 90%;\n    --input: 240 5.9% 90%;\n    --ring: 16 100% 50%;\n \n    --radius: 0.5rem;\n\n    --chart-1: 16 100% 50%;\n    --chart-2: 240 10% 40%;\n    --chart-3: 240 10% 20%;\n    --chart-4: 40 100% 50%;\n    --chart-5: 0 0% 0%;\n    \n    --sidebar: 0 0% 98%;\n    --sidebar-foreground: 240 5.3% 26.1%;\n    --sidebar-primary: 240 5.9% 10%;\n    --sidebar-primary-foreground: 0 0% 98%;\n    --sidebar-accent: 240 4.8% 95.9%;\n    --sidebar-accent-foreground: 240 5.9% 10%;\n    --sidebar-border: 220 13% 91%;\n    --sidebar-ring: 217.2 91.2% 59.8%;\n  }\n \n  .dark {\n    --background: 240 10% 4%; /* Deep Black/Carbon */\n    --foreground: 0 0% 98%;\n \n    --card: 240 10% 6%;\n    --card-foreground: 0 0% 98%;\n \n    --popover: 240 10% 4%;\n    --popover-foreground: 0 0% 98%;\n \n    --primary: 16 100% 60%; /* Brighter Orange for dark mode */\n    --primary-foreground: 240 5.9% 10%;\n \n    --secondary: 240 3.7% 15.9%;\n    --secondary-foreground: 0 0% 98%;\n \n    --muted: 240 3.7% 15.9%;\n    --muted-foreground: 240 5% 64.9%;\n \n    --accent: 16 30% 15%; /* Dark Orange Tint */\n    --accent-foreground: 0 0% 98%;\n \n    --destructive: 0 62.8% 30.6%;\n    --destructive-foreground: 0 0% 98%;\n \n    --border: 240 3.7% 15.9%;\n    --input: 240 3.7% 15.9%;\n    --ring: 16 100% 60%;\n\n    --chart-1: 16 100% 60%;\n    --chart-2: 240 5% 60%;\n    --chart-3: 240 5% 80%;\n    --chart-4: 40 100% 60%;\n    --chart-5: 0 0% 100%;\n    \n    --sidebar: 240 5.9% 10%;\n    --sidebar-foreground: 240 4.8% 95.9%;\n    --sidebar-primary: 224.3 76.3% 48%;\n    --sidebar-primary-foreground: 0 0% 100%;\n    --sidebar-accent: 240 3.7% 15.9%;\n    --sidebar-accent-foreground: 240 4.8% 95.9%;\n    --sidebar-border: 240 3.7% 15.9%;\n    --sidebar-ring: 217.2 91.2% 59.8%;\n  }\n}\n\n@layer base {\n  * {\n    @apply border-border;\n  }\n  body {\n    @apply font-sans antialiased bg-background text-foreground;\n  }\n  h1, h2, h3, h4, h5, h6 {\n    @apply font-heading tracking-tight;\n  }\n}\n","path":null,"size_bytes":4508,"size_tokens":null},"client/src/hooks/use-toast.ts":{"content":"import * as React from \"react\"\n\nimport type {\n  ToastActionElement,\n  ToastProps,\n} from \"@/components/ui/toast\"\n\nconst TOAST_LIMIT = 1\nconst TOAST_REMOVE_DELAY = 1000000\n\ntype ToasterToast = ToastProps & {\n  id: string\n  title?: React.ReactNode\n  description?: React.ReactNode\n  action?: ToastActionElement\n}\n\nconst actionTypes = {\n  ADD_TOAST: \"ADD_TOAST\",\n  UPDATE_TOAST: \"UPDATE_TOAST\",\n  DISMISS_TOAST: \"DISMISS_TOAST\",\n  REMOVE_TOAST: \"REMOVE_TOAST\",\n} as const\n\nlet count = 0\n\nfunction genId() {\n  count = (count + 1) % Number.MAX_SAFE_INTEGER\n  return count.toString()\n}\n\ntype ActionType = typeof actionTypes\n\ntype Action =\n  | {\n      type: ActionType[\"ADD_TOAST\"]\n      toast: ToasterToast\n    }\n  | {\n      type: ActionType[\"UPDATE_TOAST\"]\n      toast: Partial<ToasterToast>\n    }\n  | {\n      type: ActionType[\"DISMISS_TOAST\"]\n      toastId?: ToasterToast[\"id\"]\n    }\n  | {\n      type: ActionType[\"REMOVE_TOAST\"]\n      toastId?: ToasterToast[\"id\"]\n    }\n\ninterface State {\n  toasts: ToasterToast[]\n}\n\nconst toastTimeouts = new Map<string, ReturnType<typeof setTimeout>>()\n\nconst addToRemoveQueue = (toastId: string) => {\n  if (toastTimeouts.has(toastId)) {\n    return\n  }\n\n  const timeout = setTimeout(() => {\n    toastTimeouts.delete(toastId)\n    dispatch({\n      type: \"REMOVE_TOAST\",\n      toastId: toastId,\n    })\n  }, TOAST_REMOVE_DELAY)\n\n  toastTimeouts.set(toastId, timeout)\n}\n\nexport const reducer = (state: State, action: Action): State => {\n  switch (action.type) {\n    case \"ADD_TOAST\":\n      return {\n        ...state,\n        toasts: [action.toast, ...state.toasts].slice(0, TOAST_LIMIT),\n      }\n\n    case \"UPDATE_TOAST\":\n      return {\n        ...state,\n        toasts: state.toasts.map((t) =>\n          t.id === action.toast.id ? { ...t, ...action.toast } : t\n        ),\n      }\n\n    case \"DISMISS_TOAST\": {\n      const { toastId } = action\n\n      // ! Side effects ! - This could be extracted into a dismissToast() action,\n      // but I'll keep it here for simplicity\n      if (toastId) {\n        addToRemoveQueue(toastId)\n      } else {\n        state.toasts.forEach((toast) => {\n          addToRemoveQueue(toast.id)\n        })\n      }\n\n      return {\n        ...state,\n        toasts: state.toasts.map((t) =>\n          t.id === toastId || toastId === undefined\n            ? {\n                ...t,\n                open: false,\n              }\n            : t\n        ),\n      }\n    }\n    case \"REMOVE_TOAST\":\n      if (action.toastId === undefined) {\n        return {\n          ...state,\n          toasts: [],\n        }\n      }\n      return {\n        ...state,\n        toasts: state.toasts.filter((t) => t.id !== action.toastId),\n      }\n  }\n}\n\nconst listeners: Array<(state: State) => void> = []\n\nlet memoryState: State = { toasts: [] }\n\nfunction dispatch(action: Action) {\n  memoryState = reducer(memoryState, action)\n  listeners.forEach((listener) => {\n    listener(memoryState)\n  })\n}\n\ntype Toast = Omit<ToasterToast, \"id\">\n\nfunction toast({ ...props }: Toast) {\n  const id = genId()\n\n  const update = (props: ToasterToast) =>\n    dispatch({\n      type: \"UPDATE_TOAST\",\n      toast: { ...props, id },\n    })\n  const dismiss = () => dispatch({ type: \"DISMISS_TOAST\", toastId: id })\n\n  dispatch({\n    type: \"ADD_TOAST\",\n    toast: {\n      ...props,\n      id,\n      open: true,\n      onOpenChange: (open) => {\n        if (!open) dismiss()\n      },\n    },\n  })\n\n  return {\n    id: id,\n    dismiss,\n    update,\n  }\n}\n\nfunction useToast() {\n  const [state, setState] = React.useState<State>(memoryState)\n\n  React.useEffect(() => {\n    listeners.push(setState)\n    return () => {\n      const index = listeners.indexOf(setState)\n      if (index > -1) {\n        listeners.splice(index, 1)\n      }\n    }\n  }, [state])\n\n  return {\n    ...state,\n    toast,\n    dismiss: (toastId?: string) => dispatch({ type: \"DISMISS_TOAST\", toastId }),\n  }\n}\n\nexport { useToast, toast }\n","path":null,"size_bytes":3895,"size_tokens":null},"client/src/components/ui/drawer.tsx":{"content":"import * as React from \"react\"\nimport { Drawer as DrawerPrimitive } from \"vaul\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Drawer = ({\n  shouldScaleBackground = true,\n  ...props\n}: React.ComponentProps<typeof DrawerPrimitive.Root>) => (\n  <DrawerPrimitive.Root\n    shouldScaleBackground={shouldScaleBackground}\n    {...props}\n  />\n)\nDrawer.displayName = \"Drawer\"\n\nconst DrawerTrigger = DrawerPrimitive.Trigger\n\nconst DrawerPortal = DrawerPrimitive.Portal\n\nconst DrawerClose = DrawerPrimitive.Close\n\nconst DrawerOverlay = React.forwardRef<\n  React.ElementRef<typeof DrawerPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <DrawerPrimitive.Overlay\n    ref={ref}\n    className={cn(\"fixed inset-0 z-50 bg-black/80\", className)}\n    {...props}\n  />\n))\nDrawerOverlay.displayName = DrawerPrimitive.Overlay.displayName\n\nconst DrawerContent = React.forwardRef<\n  React.ElementRef<typeof DrawerPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Content>\n>(({ className, children, ...props }, ref) => (\n  <DrawerPortal>\n    <DrawerOverlay />\n    <DrawerPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"fixed inset-x-0 bottom-0 z-50 mt-24 flex h-auto flex-col rounded-t-[10px] border bg-background\",\n        className\n      )}\n      {...props}\n    >\n      <div className=\"mx-auto mt-4 h-2 w-[100px] rounded-full bg-muted\" />\n      {children}\n    </DrawerPrimitive.Content>\n  </DrawerPortal>\n))\nDrawerContent.displayName = \"DrawerContent\"\n\nconst DrawerHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\"grid gap-1.5 p-4 text-center sm:text-left\", className)}\n    {...props}\n  />\n)\nDrawerHeader.displayName = \"DrawerHeader\"\n\nconst DrawerFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\"mt-auto flex flex-col gap-2 p-4\", className)}\n    {...props}\n  />\n)\nDrawerFooter.displayName = \"DrawerFooter\"\n\nconst DrawerTitle = React.forwardRef<\n  React.ElementRef<typeof DrawerPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <DrawerPrimitive.Title\n    ref={ref}\n    className={cn(\n      \"text-lg font-semibold leading-none tracking-tight\",\n      className\n    )}\n    {...props}\n  />\n))\nDrawerTitle.displayName = DrawerPrimitive.Title.displayName\n\nconst DrawerDescription = React.forwardRef<\n  React.ElementRef<typeof DrawerPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <DrawerPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nDrawerDescription.displayName = DrawerPrimitive.Description.displayName\n\nexport {\n  Drawer,\n  DrawerPortal,\n  DrawerOverlay,\n  DrawerTrigger,\n  DrawerClose,\n  DrawerContent,\n  DrawerHeader,\n  DrawerFooter,\n  DrawerTitle,\n  DrawerDescription,\n}\n","path":null,"size_bytes":3007,"size_tokens":null},"client/src/components/ui/slider.tsx":{"content":"import * as React from \"react\"\nimport * as SliderPrimitive from \"@radix-ui/react-slider\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Slider = React.forwardRef<\n  React.ElementRef<typeof SliderPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof SliderPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <SliderPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"relative flex w-full touch-none select-none items-center\",\n      className\n    )}\n    {...props}\n  >\n    <SliderPrimitive.Track className=\"relative h-1.5 w-full grow overflow-hidden rounded-full bg-primary/20\">\n      <SliderPrimitive.Range className=\"absolute h-full bg-primary\" />\n    </SliderPrimitive.Track>\n    <SliderPrimitive.Thumb className=\"block h-4 w-4 rounded-full border border-primary/50 bg-background shadow transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50\" />\n  </SliderPrimitive.Root>\n))\nSlider.displayName = SliderPrimitive.Root.displayName\n\nexport { Slider }\n","path":null,"size_bytes":1037,"size_tokens":null},"DEPLOY_TO_EC2.sh":{"content":"#!/bin/bash\n\n# Master Deployment Script\n# This script automates the entire deployment process\n\nset -e\n\necho \"==========================================\"\necho \"  AIAgent EC2 Deployment Script\"\necho \"==========================================\"\n\n# Configuration\nEC2_IP=\"3.208.52.220\"\nEC2_USER=\"ubuntu\"\nEC2_KEY_PATH=\"${1:-./your-aws-key.pem}\"\nDEPLOYMENT_FILE=\"aiagent-deployment.tar.gz\"\n\n# Check if deployment file exists\nif [ ! -f \"$DEPLOYMENT_FILE\" ]; then\n    echo \"ERROR: $DEPLOYMENT_FILE not found!\"\n    echo \"Usage: ./DEPLOY_TO_EC2.sh /path/to/your-aws-key.pem\"\n    exit 1\nfi\n\n# Check if AWS key exists\nif [ ! -f \"$EC2_KEY_PATH\" ]; then\n    echo \"ERROR: AWS key file not found: $EC2_KEY_PATH\"\n    echo \"Usage: ./DEPLOY_TO_EC2.sh /path/to/your-aws-key.pem\"\n    exit 1\nfi\n\necho \"Deploying to: $EC2_IP\"\necho \"Using key: $EC2_KEY_PATH\"\necho \"\"\n\n# Upload files\necho \"1. Uploading deployment package...\"\nscp -i \"$EC2_KEY_PATH\" \"$DEPLOYMENT_FILE\" \"${EC2_USER}@${EC2_IP}:/tmp/\"\n\n# Run installation on remote server\necho \"2. Installing on remote server...\"\nssh -i \"$EC2_KEY_PATH\" \"${EC2_USER}@${EC2_IP}\" << 'REMOTE_INSTALL'\n#!/bin/bash\nset -e\ncd /tmp\ntar -xzf aiagent-deployment.tar.gz\ncd aiagent-deployment\nchmod +x install.sh\n./install.sh\nREMOTE_INSTALL\n\necho \"\"\necho \"==========================================\"\necho \"  Deployment Complete!\"\necho \"==========================================\"\necho \"\"\necho \"NEXT STEPS:\"\necho \"1. SSH to your server:\"\necho \"   ssh -i $EC2_KEY_PATH ${EC2_USER}@${EC2_IP}\"\necho \"\"\necho \"2. Configure environment:\"\necho \"   nano /home/ubuntu/aiagent/.env.production\"\necho \"   - Update MONGODB_URI\"\necho \"   - Generate SESSION_SECRET\"\necho \"\"\necho \"3. Restart Apache:\"\necho \"   sudo systemctl restart apache2\"\necho \"\"\necho \"4. Start the application:\"\necho \"   /home/ubuntu/aiagent/start.sh\"\necho \"\"\necho \"5. Access your application:\"\necho \"   http://3.208.52.220/aiagent/\"\necho \"\"\n","path":null,"size_bytes":1904,"size_tokens":null},"client/src/components/ui/breadcrumb.tsx":{"content":"import * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { ChevronRight, MoreHorizontal } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Breadcrumb = React.forwardRef<\n  HTMLElement,\n  React.ComponentPropsWithoutRef<\"nav\"> & {\n    separator?: React.ReactNode\n  }\n>(({ ...props }, ref) => <nav ref={ref} aria-label=\"breadcrumb\" {...props} />)\nBreadcrumb.displayName = \"Breadcrumb\"\n\nconst BreadcrumbList = React.forwardRef<\n  HTMLOListElement,\n  React.ComponentPropsWithoutRef<\"ol\">\n>(({ className, ...props }, ref) => (\n  <ol\n    ref={ref}\n    className={cn(\n      \"flex flex-wrap items-center gap-1.5 break-words text-sm text-muted-foreground sm:gap-2.5\",\n      className\n    )}\n    {...props}\n  />\n))\nBreadcrumbList.displayName = \"BreadcrumbList\"\n\nconst BreadcrumbItem = React.forwardRef<\n  HTMLLIElement,\n  React.ComponentPropsWithoutRef<\"li\">\n>(({ className, ...props }, ref) => (\n  <li\n    ref={ref}\n    className={cn(\"inline-flex items-center gap-1.5\", className)}\n    {...props}\n  />\n))\nBreadcrumbItem.displayName = \"BreadcrumbItem\"\n\nconst BreadcrumbLink = React.forwardRef<\n  HTMLAnchorElement,\n  React.ComponentPropsWithoutRef<\"a\"> & {\n    asChild?: boolean\n  }\n>(({ asChild, className, ...props }, ref) => {\n  const Comp = asChild ? Slot : \"a\"\n\n  return (\n    <Comp\n      ref={ref}\n      className={cn(\"transition-colors hover:text-foreground\", className)}\n      {...props}\n    />\n  )\n})\nBreadcrumbLink.displayName = \"BreadcrumbLink\"\n\nconst BreadcrumbPage = React.forwardRef<\n  HTMLSpanElement,\n  React.ComponentPropsWithoutRef<\"span\">\n>(({ className, ...props }, ref) => (\n  <span\n    ref={ref}\n    role=\"link\"\n    aria-disabled=\"true\"\n    aria-current=\"page\"\n    className={cn(\"font-normal text-foreground\", className)}\n    {...props}\n  />\n))\nBreadcrumbPage.displayName = \"BreadcrumbPage\"\n\nconst BreadcrumbSeparator = ({\n  children,\n  className,\n  ...props\n}: React.ComponentProps<\"li\">) => (\n  <li\n    role=\"presentation\"\n    aria-hidden=\"true\"\n    className={cn(\"[&>svg]:w-3.5 [&>svg]:h-3.5\", className)}\n    {...props}\n  >\n    {children ?? <ChevronRight />}\n  </li>\n)\nBreadcrumbSeparator.displayName = \"BreadcrumbSeparator\"\n\nconst BreadcrumbEllipsis = ({\n  className,\n  ...props\n}: React.ComponentProps<\"span\">) => (\n  <span\n    role=\"presentation\"\n    aria-hidden=\"true\"\n    className={cn(\"flex h-9 w-9 items-center justify-center\", className)}\n    {...props}\n  >\n    <MoreHorizontal className=\"h-4 w-4\" />\n    <span className=\"sr-only\">More</span>\n  </span>\n)\nBreadcrumbEllipsis.displayName = \"BreadcrumbElipssis\"\n\nexport {\n  Breadcrumb,\n  BreadcrumbList,\n  BreadcrumbItem,\n  BreadcrumbLink,\n  BreadcrumbPage,\n  BreadcrumbSeparator,\n  BreadcrumbEllipsis,\n}\n","path":null,"size_bytes":2712,"size_tokens":null},"client/src/components/ui/alert.tsx":{"content":"import * as React from \"react\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst alertVariants = cva(\n  \"relative w-full rounded-lg border px-4 py-3 text-sm [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground [&>svg~*]:pl-7\",\n  {\n    variants: {\n      variant: {\n        default: \"bg-background text-foreground\",\n        destructive:\n          \"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  }\n)\n\nconst Alert = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement> & VariantProps<typeof alertVariants>\n>(({ className, variant, ...props }, ref) => (\n  <div\n    ref={ref}\n    role=\"alert\"\n    className={cn(alertVariants({ variant }), className)}\n    {...props}\n  />\n))\nAlert.displayName = \"Alert\"\n\nconst AlertTitle = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLHeadingElement>\n>(({ className, ...props }, ref) => (\n  <h5\n    ref={ref}\n    className={cn(\"mb-1 font-medium leading-none tracking-tight\", className)}\n    {...props}\n  />\n))\nAlertTitle.displayName = \"AlertTitle\"\n\nconst AlertDescription = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLParagraphElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"text-sm [&_p]:leading-relaxed\", className)}\n    {...props}\n  />\n))\nAlertDescription.displayName = \"AlertDescription\"\n\nexport { Alert, AlertTitle, AlertDescription }\n","path":null,"size_bytes":1598,"size_tokens":null},"aiagent-deployment.tar/aiagent-deployment/start.sh":{"content":"#!/bin/bash\n\n# AIAgent Application Startup Script\n# This script starts the Express server with proper environment variables\n\n# Exit on error\nset -e\n\n# Colors for output\nRED='\\033[0;31m'\nGREEN='\\033[0;32m'\nYELLOW='\\033[1;33m'\nNC='\\033[0m' # No Color\n\n# Directory where the app is installed\nAPP_DIR=\"$(cd \"$(dirname \"${BASH_SOURCE[0]}\")\" && pwd)\"\nLOG_FILE=\"$APP_DIR/app.log\"\nPID_FILE=\"$APP_DIR/app.pid\"\n\necho -e \"${YELLOW}Starting AIAgent Application...${NC}\"\n\n# Check if app is already running\nif [ -f \"$PID_FILE\" ]; then\n    OLD_PID=$(cat \"$PID_FILE\")\n    if kill -0 \"$OLD_PID\" 2>/dev/null; then\n        echo -e \"${RED}Application is already running (PID: $OLD_PID)${NC}\"\n        exit 1\n    fi\nfi\n\n# Load environment variables\nif [ -f \"$APP_DIR/.env.production\" ]; then\n    export $(cat \"$APP_DIR/.env.production\" | xargs)\nelse\n    echo -e \"${RED}Error: .env.production file not found!${NC}\"\n    exit 1\nfi\n\n# Start the application\ncd \"$APP_DIR\"\nnohup node dist/index.cjs > \"$LOG_FILE\" 2>&1 &\nAPP_PID=$!\necho $APP_PID > \"$PID_FILE\"\n\necho -e \"${GREEN}Application started successfully (PID: $APP_PID)${NC}\"\necho -e \"${GREEN}Log file: $LOG_FILE${NC}\"\necho -e \"${YELLOW}Access the app at: http://3.208.52.220/aiagent/${NC}\"\n","path":null,"size_bytes":1219,"size_tokens":null},"client/src/components/ui/sidebar.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { cva, VariantProps } from \"class-variance-authority\"\nimport { PanelLeftIcon } from \"lucide-react\"\n\nimport { useIsMobile } from \"@/hooks/use-mobile\"\nimport { cn } from \"@/lib/utils\"\nimport { Button } from \"@/components/ui/button\"\nimport { Input } from \"@/components/ui/input\"\nimport { Separator } from \"@/components/ui/separator\"\nimport {\n  Sheet,\n  SheetContent,\n  SheetDescription,\n  SheetHeader,\n  SheetTitle,\n} from \"@/components/ui/sheet\"\nimport { Skeleton } from \"@/components/ui/skeleton\"\nimport {\n  Tooltip,\n  TooltipContent,\n  TooltipProvider,\n  TooltipTrigger,\n} from \"@/components/ui/tooltip\"\n\nconst SIDEBAR_COOKIE_NAME = \"sidebar_state\"\nconst SIDEBAR_COOKIE_MAX_AGE = 60 * 60 * 24 * 7\nconst SIDEBAR_WIDTH = \"16rem\"\nconst SIDEBAR_WIDTH_MOBILE = \"18rem\"\nconst SIDEBAR_WIDTH_ICON = \"3rem\"\nconst SIDEBAR_KEYBOARD_SHORTCUT = \"b\"\n\ntype SidebarContextProps = {\n  state: \"expanded\" | \"collapsed\"\n  open: boolean\n  setOpen: (open: boolean) => void\n  openMobile: boolean\n  setOpenMobile: (open: boolean) => void\n  isMobile: boolean\n  toggleSidebar: () => void\n}\n\nconst SidebarContext = React.createContext<SidebarContextProps | null>(null)\n\nfunction useSidebar() {\n  const context = React.useContext(SidebarContext)\n  if (!context) {\n    throw new Error(\"useSidebar must be used within a SidebarProvider.\")\n  }\n\n  return context\n}\n\nfunction SidebarProvider({\n  defaultOpen = true,\n  open: openProp,\n  onOpenChange: setOpenProp,\n  className,\n  style,\n  children,\n  ...props\n}: React.ComponentProps<\"div\"> & {\n  defaultOpen?: boolean\n  open?: boolean\n  onOpenChange?: (open: boolean) => void\n}) {\n  const isMobile = useIsMobile()\n  const [openMobile, setOpenMobile] = React.useState(false)\n\n  // This is the internal state of the sidebar.\n  // We use openProp and setOpenProp for control from outside the component.\n  const [_open, _setOpen] = React.useState(defaultOpen)\n  const open = openProp ?? _open\n  const setOpen = React.useCallback(\n    (value: boolean | ((value: boolean) => boolean)) => {\n      const openState = typeof value === \"function\" ? value(open) : value\n      if (setOpenProp) {\n        setOpenProp(openState)\n      } else {\n        _setOpen(openState)\n      }\n\n      // This sets the cookie to keep the sidebar state.\n      document.cookie = `${SIDEBAR_COOKIE_NAME}=${openState}; path=/; max-age=${SIDEBAR_COOKIE_MAX_AGE}`\n    },\n    [setOpenProp, open]\n  )\n\n  // Helper to toggle the sidebar.\n  const toggleSidebar = React.useCallback(() => {\n    return isMobile ? setOpenMobile((open) => !open) : setOpen((open) => !open)\n  }, [isMobile, setOpen, setOpenMobile])\n\n  // Adds a keyboard shortcut to toggle the sidebar.\n  React.useEffect(() => {\n    const handleKeyDown = (event: KeyboardEvent) => {\n      if (\n        event.key === SIDEBAR_KEYBOARD_SHORTCUT &&\n        (event.metaKey || event.ctrlKey)\n      ) {\n        event.preventDefault()\n        toggleSidebar()\n      }\n    }\n\n    window.addEventListener(\"keydown\", handleKeyDown)\n    return () => window.removeEventListener(\"keydown\", handleKeyDown)\n  }, [toggleSidebar])\n\n  // We add a state so that we can do data-state=\"expanded\" or \"collapsed\".\n  // This makes it easier to style the sidebar with Tailwind classes.\n  const state = open ? \"expanded\" : \"collapsed\"\n\n  const contextValue = React.useMemo<SidebarContextProps>(\n    () => ({\n      state,\n      open,\n      setOpen,\n      isMobile,\n      openMobile,\n      setOpenMobile,\n      toggleSidebar,\n    }),\n    [state, open, setOpen, isMobile, openMobile, setOpenMobile, toggleSidebar]\n  )\n\n  return (\n    <SidebarContext.Provider value={contextValue}>\n      <TooltipProvider delayDuration={0}>\n        <div\n          data-slot=\"sidebar-wrapper\"\n          style={\n            {\n              \"--sidebar-width\": SIDEBAR_WIDTH,\n              \"--sidebar-width-icon\": SIDEBAR_WIDTH_ICON,\n              ...style,\n            } as React.CSSProperties\n          }\n          className={cn(\n            \"group/sidebar-wrapper has-data-[variant=inset]:bg-sidebar flex min-h-svh w-full\",\n            className\n          )}\n          {...props}\n        >\n          {children}\n        </div>\n      </TooltipProvider>\n    </SidebarContext.Provider>\n  )\n}\n\nfunction Sidebar({\n  side = \"left\",\n  variant = \"sidebar\",\n  collapsible = \"offcanvas\",\n  className,\n  children,\n  ...props\n}: React.ComponentProps<\"div\"> & {\n  side?: \"left\" | \"right\"\n  variant?: \"sidebar\" | \"floating\" | \"inset\"\n  collapsible?: \"offcanvas\" | \"icon\" | \"none\"\n}) {\n  const { isMobile, state, openMobile, setOpenMobile } = useSidebar()\n\n  if (collapsible === \"none\") {\n    return (\n      <div\n        data-slot=\"sidebar\"\n        className={cn(\n          \"bg-sidebar text-sidebar-foreground flex h-full w-[var(--sidebar-width)] flex-col\",\n          className\n        )}\n        {...props}\n      >\n        {children}\n      </div>\n    )\n  }\n\n  if (isMobile) {\n    return (\n      <Sheet open={openMobile} onOpenChange={setOpenMobile} {...props}>\n        <SheetContent\n          data-sidebar=\"sidebar\"\n          data-slot=\"sidebar\"\n          data-mobile=\"true\"\n          className=\"bg-sidebar text-sidebar-foreground w-[var(--sidebar-width)] p-0 [&>button]:hidden\"\n          style={\n            {\n              \"--sidebar-width\": SIDEBAR_WIDTH_MOBILE,\n            } as React.CSSProperties\n          }\n          side={side}\n        >\n          <SheetHeader className=\"sr-only\">\n            <SheetTitle>Sidebar</SheetTitle>\n            <SheetDescription>Displays the mobile sidebar.</SheetDescription>\n          </SheetHeader>\n          <div className=\"flex h-full w-full flex-col\">{children}</div>\n        </SheetContent>\n      </Sheet>\n    )\n  }\n\n  return (\n    <div\n      className=\"group peer text-sidebar-foreground hidden md:block\"\n      data-state={state}\n      data-collapsible={state === \"collapsed\" ? collapsible : \"\"}\n      data-variant={variant}\n      data-side={side}\n      data-slot=\"sidebar\"\n    >\n      {/* This is what handles the sidebar gap on desktop */}\n      <div\n        data-slot=\"sidebar-gap\"\n        className={cn(\n          \"relative w-[var(--sidebar-width)] bg-transparent transition-[width] duration-200 ease-linear\",\n          \"group-data-[collapsible=offcanvas]:w-0\",\n          \"group-data-[side=right]:rotate-180\",\n          variant === \"floating\" || variant === \"inset\"\n            ? \"group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)+var(--spacing-4))]\"\n            : \"group-data-[collapsible=icon]:w-[var(--sidebar-width-icon)]\"\n        )}\n      />\n      <div\n        data-slot=\"sidebar-container\"\n        className={cn(\n          \"fixed inset-y-0 z-10 hidden h-svh w-[var(--sidebar-width)] transition-[left,right,width] duration-200 ease-linear md:flex\",\n          side === \"left\"\n            ? \"left-0 group-data-[collapsible=offcanvas]:left-[calc(var(--sidebar-width)*-1)]\"\n            : \"right-0 group-data-[collapsible=offcanvas]:right-[calc(var(--sidebar-width)*-1)]\",\n          // Adjust the padding for floating and inset variants.\n          variant === \"floating\" || variant === \"inset\"\n            ? \"p-2 group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)+var(--spacing-4)+2px)]\"\n            : \"group-data-[collapsible=icon]:w-[var(--sidebar-width-icon)] group-data-[side=left]:border-r group-data-[side=right]:border-l\",\n          className\n        )}\n        {...props}\n      >\n        <div\n          data-sidebar=\"sidebar\"\n          data-slot=\"sidebar-inner\"\n          className=\"bg-sidebar group-data-[variant=floating]:border-sidebar-border flex h-full w-full flex-col group-data-[variant=floating]:rounded-lg group-data-[variant=floating]:border group-data-[variant=floating]:shadow-sm\"\n        >\n          {children}\n        </div>\n      </div>\n    </div>\n  )\n}\n\nfunction SidebarTrigger({\n  className,\n  onClick,\n  ...props\n}: React.ComponentProps<typeof Button>) {\n  const { toggleSidebar } = useSidebar()\n\n  return (\n    <Button\n      data-sidebar=\"trigger\"\n      data-slot=\"sidebar-trigger\"\n      variant=\"ghost\"\n      size=\"icon\"\n      className={cn(\"h-7 w-7\", className)}\n      onClick={(event) => {\n        onClick?.(event)\n        toggleSidebar()\n      }}\n      {...props}\n    >\n      <PanelLeftIcon />\n      <span className=\"sr-only\">Toggle Sidebar</span>\n    </Button>\n  )\n}\n\nfunction SidebarRail({ className, ...props }: React.ComponentProps<\"button\">) {\n  const { toggleSidebar } = useSidebar()\n\n  // Note: Tailwind v3.4 doesn't support \"in-\" selectors. So the rail won't work perfectly.\n  return (\n    <button\n      data-sidebar=\"rail\"\n      data-slot=\"sidebar-rail\"\n      aria-label=\"Toggle Sidebar\"\n      tabIndex={-1}\n      onClick={toggleSidebar}\n      title=\"Toggle Sidebar\"\n      className={cn(\n        \"hover:after:bg-sidebar-border absolute inset-y-0 z-20 hidden w-4 -translate-x-1/2 transition-all ease-linear group-data-[side=left]:-right-4 group-data-[side=right]:left-0 after:absolute after:inset-y-0 after:left-1/2 after:w-[2px] sm:flex\",\n        \"in-data-[side=left]:cursor-w-resize in-data-[side=right]:cursor-e-resize\",\n        \"[[data-side=left][data-state=collapsed]_&]:cursor-e-resize [[data-side=right][data-state=collapsed]_&]:cursor-w-resize\",\n        \"hover:group-data-[collapsible=offcanvas]:bg-sidebar group-data-[collapsible=offcanvas]:translate-x-0 group-data-[collapsible=offcanvas]:after:left-full\",\n        \"[[data-side=left][data-collapsible=offcanvas]_&]:-right-2\",\n        \"[[data-side=right][data-collapsible=offcanvas]_&]:-left-2\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarInset({ className, ...props }: React.ComponentProps<\"main\">) {\n  return (\n    <main\n      data-slot=\"sidebar-inset\"\n      className={cn(\n        \"bg-background relative flex w-full flex-1 flex-col\",\n        \"md:peer-data-[variant=inset]:m-2 md:peer-data-[variant=inset]:ml-0 md:peer-data-[variant=inset]:rounded-xl md:peer-data-[variant=inset]:shadow-sm md:peer-data-[variant=inset]:peer-data-[state=collapsed]:ml-2\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarInput({\n  className,\n  ...props\n}: React.ComponentProps<typeof Input>) {\n  return (\n    <Input\n      data-slot=\"sidebar-input\"\n      data-sidebar=\"input\"\n      className={cn(\"bg-background h-8 w-full shadow-none\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarHeader({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-header\"\n      data-sidebar=\"header\"\n      className={cn(\"flex flex-col gap-2 p-2\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarFooter({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-footer\"\n      data-sidebar=\"footer\"\n      className={cn(\"flex flex-col gap-2 p-2\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarSeparator({\n  className,\n  ...props\n}: React.ComponentProps<typeof Separator>) {\n  return (\n    <Separator\n      data-slot=\"sidebar-separator\"\n      data-sidebar=\"separator\"\n      className={cn(\"bg-sidebar-border mx-2 w-auto\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarContent({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-content\"\n      data-sidebar=\"content\"\n      className={cn(\n        \"flex min-h-0 flex-1 flex-col gap-2 overflow-auto group-data-[collapsible=icon]:overflow-hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarGroup({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-group\"\n      data-sidebar=\"group\"\n      className={cn(\"relative flex w-full min-w-0 flex-col p-2\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarGroupLabel({\n  className,\n  asChild = false,\n  ...props\n}: React.ComponentProps<\"div\"> & { asChild?: boolean }) {\n  const Comp = asChild ? Slot : \"div\"\n\n  return (\n    <Comp\n      data-slot=\"sidebar-group-label\"\n      data-sidebar=\"group-label\"\n      className={cn(\n        \"text-sidebar-foreground/70 ring-sidebar-ring flex h-8 shrink-0 items-center rounded-md px-2 text-xs font-medium outline-hidden transition-[margin,opacity] duration-200 ease-linear focus-visible:ring-2 [&>svg]:h-4 [&>svg]:w-4 [&>svg]:shrink-0\",\n        \"group-data-[collapsible=icon]:-mt-8 group-data-[collapsible=icon]:opacity-0\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarGroupAction({\n  className,\n  asChild = false,\n  ...props\n}: React.ComponentProps<\"button\"> & { asChild?: boolean }) {\n  const Comp = asChild ? Slot : \"button\"\n\n  return (\n    <Comp\n      data-slot=\"sidebar-group-action\"\n      data-sidebar=\"group-action\"\n      className={cn(\n        \"text-sidebar-foreground ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground absolute top-3.5 right-3 flex aspect-square w-5 items-center justify-center rounded-md p-0 outline-hidden transition-transform focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0\",\n        // Increases the hit area of the button on mobile.\n        \"after:absolute after:-inset-2 md:after:hidden\",\n        \"group-data-[collapsible=icon]:hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarGroupContent({\n  className,\n  ...props\n}: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-group-content\"\n      data-sidebar=\"group-content\"\n      className={cn(\"w-full text-sm\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenu({ className, ...props }: React.ComponentProps<\"ul\">) {\n  return (\n    <ul\n      data-slot=\"sidebar-menu\"\n      data-sidebar=\"menu\"\n      className={cn(\"flex w-full min-w-0 flex-col gap-1\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenuItem({ className, ...props }: React.ComponentProps<\"li\">) {\n  return (\n    <li\n      data-slot=\"sidebar-menu-item\"\n      data-sidebar=\"menu-item\"\n      className={cn(\"group/menu-item relative\", className)}\n      {...props}\n    />\n  )\n}\n\nconst sidebarMenuButtonVariants = cva(\n  \"peer/menu-button flex w-full items-center gap-2 overflow-hidden rounded-md p-2 text-left text-sm outline-hidden ring-sidebar-ring transition-[width,height,padding] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 group-has-data-[sidebar=menu-action]/menu-item:pr-8 aria-disabled:pointer-events-none aria-disabled:opacity-50 data-[active=true]:bg-sidebar-accent data-[active=true]:font-medium data-[active=true]:text-sidebar-accent-foreground data-[state=open]:hover:bg-sidebar-accent data-[state=open]:hover:text-sidebar-accent-foreground group-data-[collapsible=icon]:w-8! group-data-[collapsible=icon]:h-8! group-data-[collapsible=icon]:p-2! [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0\",\n  {\n    variants: {\n      variant: {\n        default: \"hover:bg-sidebar-accent hover:text-sidebar-accent-foreground\",\n        outline:\n          \"bg-background shadow-[0_0_0_1px_hsl(var(--sidebar-border))] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground hover:shadow-[0_0_0_1px_hsl(var(--sidebar-accent))]\",\n      },\n      size: {\n        default: \"h-8 text-sm\",\n        sm: \"h-7 text-xs\",\n        lg: \"h-12 text-sm group-data-[collapsible=icon]:p-0!\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  }\n)\n\nfunction SidebarMenuButton({\n  asChild = false,\n  isActive = false,\n  variant = \"default\",\n  size = \"default\",\n  tooltip,\n  className,\n  ...props\n}: React.ComponentProps<\"button\"> & {\n  asChild?: boolean\n  isActive?: boolean\n  tooltip?: string | React.ComponentProps<typeof TooltipContent>\n} & VariantProps<typeof sidebarMenuButtonVariants>) {\n  const Comp = asChild ? Slot : \"button\"\n  const { isMobile, state } = useSidebar()\n\n  const button = (\n    <Comp\n      data-slot=\"sidebar-menu-button\"\n      data-sidebar=\"menu-button\"\n      data-size={size}\n      data-active={isActive}\n      className={cn(sidebarMenuButtonVariants({ variant, size }), className)}\n      {...props}\n    />\n  )\n\n  if (!tooltip) {\n    return button\n  }\n\n  if (typeof tooltip === \"string\") {\n    tooltip = {\n      children: tooltip,\n    }\n  }\n\n  return (\n    <Tooltip>\n      <TooltipTrigger asChild>{button}</TooltipTrigger>\n      <TooltipContent\n        side=\"right\"\n        align=\"center\"\n        hidden={state !== \"collapsed\" || isMobile}\n        {...tooltip}\n      />\n    </Tooltip>\n  )\n}\n\nfunction SidebarMenuAction({\n  className,\n  asChild = false,\n  showOnHover = false,\n  ...props\n}: React.ComponentProps<\"button\"> & {\n  asChild?: boolean\n  showOnHover?: boolean\n}) {\n  const Comp = asChild ? Slot : \"button\"\n\n  return (\n    <Comp\n      data-slot=\"sidebar-menu-action\"\n      data-sidebar=\"menu-action\"\n      className={cn(\n        \"text-sidebar-foreground ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground peer-hover/menu-button:text-sidebar-accent-foreground absolute top-1.5 right-1 flex aspect-square w-5 items-center justify-center rounded-md p-0 outline-hidden transition-transform focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0\",\n        // Increases the hit area of the button on mobile.\n        \"after:absolute after:-inset-2 md:after:hidden\",\n        \"peer-data-[size=sm]/menu-button:top-1\",\n        \"peer-data-[size=default]/menu-button:top-1.5\",\n        \"peer-data-[size=lg]/menu-button:top-2.5\",\n        \"group-data-[collapsible=icon]:hidden\",\n        showOnHover &&\n          \"peer-data-[active=true]/menu-button:text-sidebar-accent-foreground group-focus-within/menu-item:opacity-100 group-hover/menu-item:opacity-100 data-[state=open]:opacity-100 md:opacity-0\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenuBadge({\n  className,\n  ...props\n}: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-menu-badge\"\n      data-sidebar=\"menu-badge\"\n      className={cn(\n        \"text-sidebar-foreground pointer-events-none absolute right-1 flex h-5 min-w-5 items-center justify-center rounded-md px-1 text-xs font-medium tabular-nums select-none\",\n        \"peer-hover/menu-button:text-sidebar-accent-foreground peer-data-[active=true]/menu-button:text-sidebar-accent-foreground\",\n        \"peer-data-[size=sm]/menu-button:top-1\",\n        \"peer-data-[size=default]/menu-button:top-1.5\",\n        \"peer-data-[size=lg]/menu-button:top-2.5\",\n        \"group-data-[collapsible=icon]:hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenuSkeleton({\n  className,\n  showIcon = false,\n  ...props\n}: React.ComponentProps<\"div\"> & {\n  showIcon?: boolean\n}) {\n  // Random width between 50 to 90%.\n  const width = React.useMemo(() => {\n    return `${Math.floor(Math.random() * 40) + 50}%`\n  }, [])\n\n  return (\n    <div\n      data-slot=\"sidebar-menu-skeleton\"\n      data-sidebar=\"menu-skeleton\"\n      className={cn(\"flex h-8 items-center gap-2 rounded-md px-2\", className)}\n      {...props}\n    >\n      {showIcon && (\n        <Skeleton\n          className=\"size-4 rounded-md\"\n          data-sidebar=\"menu-skeleton-icon\"\n        />\n      )}\n      <Skeleton\n        className=\"h-4 max-w-[var(--skeleton-width)] flex-1\"\n        data-sidebar=\"menu-skeleton-text\"\n        style={\n          {\n            \"--skeleton-width\": width,\n          } as React.CSSProperties\n        }\n      />\n    </div>\n  )\n}\n\nfunction SidebarMenuSub({ className, ...props }: React.ComponentProps<\"ul\">) {\n  return (\n    <ul\n      data-slot=\"sidebar-menu-sub\"\n      data-sidebar=\"menu-sub\"\n      className={cn(\n        \"border-sidebar-border mx-3.5 flex min-w-0 translate-x-px flex-col gap-1 border-l px-2.5 py-0.5\",\n        \"group-data-[collapsible=icon]:hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenuSubItem({\n  className,\n  ...props\n}: React.ComponentProps<\"li\">) {\n  return (\n    <li\n      data-slot=\"sidebar-menu-sub-item\"\n      data-sidebar=\"menu-sub-item\"\n      className={cn(\"group/menu-sub-item relative\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenuSubButton({\n  asChild = false,\n  size = \"md\",\n  isActive = false,\n  className,\n  ...props\n}: React.ComponentProps<\"a\"> & {\n  asChild?: boolean\n  size?: \"sm\" | \"md\"\n  isActive?: boolean\n}) {\n  const Comp = asChild ? Slot : \"a\"\n\n  return (\n    <Comp\n      data-slot=\"sidebar-menu-sub-button\"\n      data-sidebar=\"menu-sub-button\"\n      data-size={size}\n      data-active={isActive}\n      className={cn(\n        \"text-sidebar-foreground ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground active:bg-sidebar-accent active:text-sidebar-accent-foreground [&>svg]:text-sidebar-accent-foreground flex h-7 min-w-0 -translate-x-px items-center gap-2 overflow-hidden rounded-md px-2 outline outline-2 outline-transparent outline-offset-2 focus-visible:ring-2 disabled:pointer-events-none disabled:opacity-50 aria-disabled:pointer-events-none aria-disabled:opacity-50 [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0\",\n        \"data-[active=true]:bg-sidebar-accent data-[active=true]:text-sidebar-accent-foreground\",\n        size === \"sm\" && \"text-xs\",\n        size === \"md\" && \"text-sm\",\n        \"group-data-[collapsible=icon]:hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nexport {\n  Sidebar,\n  SidebarContent,\n  SidebarFooter,\n  SidebarGroup,\n  SidebarGroupAction,\n  SidebarGroupContent,\n  SidebarGroupLabel,\n  SidebarHeader,\n  SidebarInput,\n  SidebarInset,\n  SidebarMenu,\n  SidebarMenuAction,\n  SidebarMenuBadge,\n  SidebarMenuButton,\n  SidebarMenuItem,\n  SidebarMenuSkeleton,\n  SidebarMenuSub,\n  SidebarMenuSubButton,\n  SidebarMenuSubItem,\n  SidebarProvider,\n  SidebarRail,\n  SidebarSeparator,\n  SidebarTrigger,\n  useSidebar,\n}\n","path":null,"size_bytes":21846,"size_tokens":null},"aiagent-deployment.tar/aiagent-deployment/QUICK_START.md":{"content":"# AIAgent - Quick Start Guide\n\n## Pre-Deployment Checklist\n\n- [ ] Node.js v18+ installed on your EC2\n- [ ] Apache web server installed\n- [ ] MongoDB connection string ready\n- [ ] AWS security group allows ports 22, 80, 443\n- [ ] SSH access to EC2 instance\n\n---\n\n## 5-Minute Deployment\n\n### Step 1: Connect to EC2\n```bash\nssh -i your-key.pem ubuntu@3.208.52.220\n```\n\n### Step 2: Extract Package\n```bash\ncd /tmp\n# Upload aiagent-deployment.tar.gz file, then:\ntar -xzf aiagent-deployment.tar.gz\nsudo mkdir -p /home/ubuntu/aiagent\nsudo cp -r aiagent-deployment/* /home/ubuntu/aiagent/\nsudo chown -R ubuntu:ubuntu /home/ubuntu/aiagent\n```\n\n### Step 3: Configure Environment\n```bash\ncd /home/ubuntu/aiagent\nnano .env.production\n\n# Edit these values:\n# MONGODB_URI=your-mongodb-connection-string\n# SESSION_SECRET=generate-a-random-string-32chars-min\n```\n\n### Step 4: Install Apache Config\n```bash\nsudo cp /home/ubuntu/aiagent/aiagent.conf /etc/apache2/sites-available/\nsudo a2ensite aiagent\nsudo a2enmod proxy proxy_http headers\nsudo systemctl restart apache2\n```\n\n### Step 5: Install Dependencies & Start\n```bash\ncd /home/ubuntu/aiagent\nnpm install --only=production\n./start.sh\n```\n\n### Step 6: Verify It's Running\n```bash\ncurl http://localhost:5000/api/auth/me\n# Should return 401 Unauthorized (which is expected)\n\n# Access in browser:\n# http://3.208.52.220/aiagent/\n```\n\n---\n\n## Troubleshooting Quick Commands\n\n```bash\n# Check if Node app is running\nps aux | grep \"node dist\"\n\n# View logs in real-time\ntail -f /home/ubuntu/aiagent/app.log\n\n# Stop the app\n/home/ubuntu/aiagent/stop.sh\n\n# Start the app\n/home/ubuntu/aiagent/start.sh\n\n# Check Apache status\nsudo systemctl status apache2\n\n# View Apache errors\nsudo tail -f /var/log/apache2/aiagent_error.log\n```\n\n---\n\n## Port Information\n\n- **Node.js App runs on**: localhost:5000 (internal)\n- **Apache listens on**: 0.0.0.0:80 (public)\n- **Access path**: http://3.208.52.220/aiagent/\n- **MongoDB**: Configure in .env.production\n\n---\n\nFor detailed information, see **DEPLOYMENT_GUIDE.md**\n","path":null,"size_bytes":2031,"size_tokens":null},"DEPLOYMENT_CHECKLIST.md":{"content":"# Deployment Checklist\n\n## Pre-Deployment\n\n- [ ] AWS EC2 instance running (3.208.52.220)\n- [ ] SSH key pair downloaded and saved securely\n- [ ] Downloaded `aiagent-deployment.tar.gz` from Replit\n- [ ] Read DEPLOYMENT_INSTRUCTIONS.md\n- [ ] MongoDB connection string ready\n- [ ] Decided on deployment method (automated or manual)\n\n## Deployment\n\n- [ ] Uploaded aiagent-deployment.tar.gz to EC2\n- [ ] Connected to EC2 via SSH\n- [ ] Extracted deployment package\n- [ ] Node.js v18+ installed on EC2\n- [ ] Apache web server installed\n- [ ] Configured .env.production with:\n  - [ ] MONGODB_URI\n  - [ ] SESSION_SECRET (generated securely)\n- [ ] Installed npm dependencies\n- [ ] Enabled Apache proxy modules\n- [ ] Copied Apache configuration\n- [ ] Restarted Apache\n- [ ] Started the application with ./start.sh\n\n## Verification\n\n- [ ] Node.js process is running: `ps aux | grep \"node dist\"`\n- [ ] Backend responds to API: `curl http://localhost:5000/api/auth/me`\n- [ ] Apache is running: `sudo systemctl status apache2`\n- [ ] Firewall allows HTTP (port 80): `sudo ufw status`\n- [ ] Application loads in browser: http://3.208.52.220/aiagent/\n- [ ] Can create user account\n- [ ] Can login successfully\n- [ ] Dashboard loads with data\n- [ ] Navigation works between pages\n- [ ] Notes system works\n- [ ] Campaigns can be created\n\n## Post-Deployment\n\n- [ ] Enabled HTTPS with Let's Encrypt (production)\n- [ ] Setup PM2 for auto-restart (optional but recommended)\n- [ ] Configured firewall rules (SSH, HTTP, HTTPS)\n- [ ] Setup log rotation (optional)\n- [ ] Configured database backups (MongoDB)\n- [ ] Setup monitoring/alerts (optional)\n- [ ] Documented access credentials securely\n- [ ] Tested disaster recovery process\n\n## Maintenance\n\n- [ ] Set reminder to update Node.js packages\n- [ ] Set reminder to backup MongoDB\n- [ ] Monitor disk space regularly\n- [ ] Review application logs for errors\n- [ ] Monitor CPU and memory usage\n- [ ] Setup automated SSL renewal (if using Let's Encrypt)\n\n## Security\n\n- [ ] SESSION_SECRET is unique and secure\n- [ ] .env.production is NOT in git repository\n- [ ] HTTPS is enabled (production)\n- [ ] Firewall is enabled\n- [ ] SSH key is not shared\n- [ ] MongoDB connection is encrypted\n- [ ] Regular database backups exist\n- [ ] Application logs are monitored\n\n---\n\n**Mark items as completed and date each phase.**\n\nDeployment Date: _______________\nProduction Live Date: _______________\n","path":null,"size_bytes":2407,"size_tokens":null},"client/src/components/ui/separator.tsx":{"content":"import * as React from \"react\"\nimport * as SeparatorPrimitive from \"@radix-ui/react-separator\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Separator = React.forwardRef<\n  React.ElementRef<typeof SeparatorPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof SeparatorPrimitive.Root>\n>(\n  (\n    { className, orientation = \"horizontal\", decorative = true, ...props },\n    ref\n  ) => (\n    <SeparatorPrimitive.Root\n      ref={ref}\n      decorative={decorative}\n      orientation={orientation}\n      className={cn(\n        \"shrink-0 bg-border\",\n        orientation === \"horizontal\" ? \"h-[1px] w-full\" : \"h-full w-[1px]\",\n        className\n      )}\n      {...props}\n    />\n  )\n)\nSeparator.displayName = SeparatorPrimitive.Root.displayName\n\nexport { Separator }\n","path":null,"size_bytes":756,"size_tokens":null},"vite-plugin-meta-images.ts":{"content":"import type { Plugin } from 'vite';\nimport fs from 'fs';\nimport path from 'path';\n\n/**\n * Vite plugin that updates og:image and twitter:image meta tags\n * to point to the app's opengraph image with the correct Replit domain.\n */\nexport function metaImagesPlugin(): Plugin {\n  return {\n    name: 'vite-plugin-meta-images',\n    transformIndexHtml(html) {\n      const baseUrl = getDeploymentUrl();\n      if (!baseUrl) {\n        log('[meta-images] no Replit deployment domain found, skipping meta tag updates');\n        return html;\n      }\n\n      // Check if opengraph image exists in public directory\n      const publicDir = path.resolve(process.cwd(), 'client', 'public');\n      const opengraphPngPath = path.join(publicDir, 'opengraph.png');\n      const opengraphJpgPath = path.join(publicDir, 'opengraph.jpg');\n      const opengraphJpegPath = path.join(publicDir, 'opengraph.jpeg');\n\n      let imageExt: string | null = null;\n      if (fs.existsSync(opengraphPngPath)) {\n        imageExt = 'png';\n      } else if (fs.existsSync(opengraphJpgPath)) {\n        imageExt = 'jpg';\n      } else if (fs.existsSync(opengraphJpegPath)) {\n        imageExt = 'jpeg';\n      }\n\n      if (!imageExt) {\n        log('[meta-images] OpenGraph image not found, skipping meta tag updates');\n        return html;\n      }\n\n      const imageUrl = `${baseUrl}/opengraph.${imageExt}`;\n\n      log('[meta-images] updating meta image tags to:', imageUrl);\n\n      html = html.replace(\n        /<meta\\s+property=\"og:image\"\\s+content=\"[^\"]*\"\\s*\\/>/g,\n        `<meta property=\"og:image\" content=\"${imageUrl}\" />`\n      );\n\n      html = html.replace(\n        /<meta\\s+name=\"twitter:image\"\\s+content=\"[^\"]*\"\\s*\\/>/g,\n        `<meta name=\"twitter:image\" content=\"${imageUrl}\" />`\n      );\n\n      return html;\n    },\n  };\n}\n\nfunction getDeploymentUrl(): string | null {\n  if (process.env.REPLIT_INTERNAL_APP_DOMAIN) {\n    const url = `https://${process.env.REPLIT_INTERNAL_APP_DOMAIN}`;\n    log('[meta-images] using internal app domain:', url);\n    return url;\n  }\n\n  if (process.env.REPLIT_DEV_DOMAIN) {\n    const url = `https://${process.env.REPLIT_DEV_DOMAIN}`;\n    log('[meta-images] using dev domain:', url);\n    return url;\n  }\n\n  return null;\n}\n\nfunction log(...args: any[]): void {\n  if (process.env.NODE_ENV === 'production') {\n    console.log(...args);\n  }\n}\n","path":null,"size_bytes":2333,"size_tokens":null},"START_HERE.md":{"content":"# ðŸš€ AIAgent - Production Build Ready\n\n## Your Deployment Package is Ready!\n\nI've created a complete, production-ready build of your AIAgent application with everything needed to deploy on your AWS EC2 instance.\n\n---\n\n## ðŸ“¦ What You Have\n\n### Download These Files from Replit:\n\n1. **aiagent-deployment.tar.gz** (6.6 MB)\n   - âœ… Complete production build\n   - âœ… Frontend (React/Vite) compiled\n   - âœ… Backend (Node.js/Express) compiled\n   - âœ… All static assets\n   - âœ… Upload directories\n\n2. **DEPLOYMENT_INSTRUCTIONS.md**\n   - Complete step-by-step deployment guide\n   - Automated and manual options\n   - Troubleshooting section\n   - Security recommendations\n\n3. **DEPLOY_TO_EC2.sh**\n   - One-command automated deployment script\n   - (Optional - for advanced users)\n\n4. **DEPLOYMENT_SUMMARY.txt**\n   - Quick reference guide\n   - File structure overview\n   - Key commands\n\n---\n\n## âš¡ Quick Deployment (5 Minutes)\n\n### Prerequisites\n- AWS EC2 instance: 3.208.52.220\n- SSH access to EC2\n- Apache web server (will be installed if needed)\n- MongoDB connection string ready\n\n### Step 1: Download Package\nClick the \"Files\" icon on the left sidebar and download:\n- `aiagent-deployment.tar.gz`\n\n### Step 2: Upload to EC2\n```bash\n# From your computer\nscp -i /path/to/your-aws-key.pem aiagent-deployment.tar.gz ubuntu@3.208.52.220:/tmp/\n```\n\n### Step 3: Connect to EC2\n```bash\nssh -i /path/to/your-aws-key.pem ubuntu@3.208.52.220\n```\n\n### Step 4: Extract & Install\n```bash\ncd /tmp\ntar -xzf aiagent-deployment.tar.gz\ncd aiagent-deployment\nchmod +x install.sh\n./install.sh\n```\n\n### Step 5: Configure\n```bash\nnano /home/ubuntu/aiagent/.env.production\n# Edit these values:\n# MONGODB_URI=your-mongodb-connection-string\n# SESSION_SECRET=generate-a-secure-random-string-32chars-min\n```\n\nTo generate SESSION_SECRET:\n```bash\nnode -e \"console.log(require('crypto').randomBytes(32).toString('hex'))\"\n```\n\n### Step 6: Start\n```bash\n/home/ubuntu/aiagent/start.sh\n```\n\n### Step 7: Verify\nOpen browser: `http://3.208.52.220/aiagent/`\n\n---\n\n## ðŸ“‹ What's Included in the Build\n\nâœ… **Frontend (React)**\n- Dashboard with analytics charts\n- Lead management system\n- Campaign management\n- Appointment scheduling\n- Notes system\n- Authentication pages\n- Responsive design\n- Dark mode support\n\nâœ… **Backend (Node.js)**\n- Express.js API server\n- MongoDB integration\n- Session management\n- User authentication\n- CRUD operations for all features\n- File upload support\n- Analytics calculations\n\nâœ… **Infrastructure**\n- Apache vhost configuration\n- Environment templates\n- Start/stop scripts\n- Installation helper\n- Systemd service file\n- Full documentation\n\n---\n\n## ðŸ”§ Configuration Options\n\n### Required Environment Variables\n\n| Variable | Purpose | Example |\n|----------|---------|---------|\n| `NODE_ENV` | Environment | `production` |\n| `PORT` | Internal port | `5000` |\n| `MONGODB_URI` | Database connection | `mongodb+srv://...` |\n| `SESSION_SECRET` | Session encryption | 32+ character random string |\n\n### Optional for Production\n\n- Enable HTTPS with Let's Encrypt (Certbot)\n- Use PM2 for process management\n- Enable firewall rules\n- Configure log rotation\n- Setup monitoring/alerts\n\n---\n\n## ðŸ“– Documentation Files\n\nAll detailed information is in the deployment package:\n\n**DEPLOYMENT_INSTRUCTIONS.md** contains:\n- âœ… Automated deployment with DEPLOY_TO_EC2.sh\n- âœ… Step-by-step manual deployment\n- âœ… Troubleshooting guide\n- âœ… Production recommendations\n- âœ… Security checklist\n- âœ… Monitoring setup\n- âœ… How to update the application\n\n**Inside the tarball** (/after extraction):\n- `README.md` - Package overview\n- `QUICK_START.md` - 5-minute guide\n- `DEPLOYMENT_GUIDE.md` - Detailed instructions\n- `aiagent.conf` - Apache configuration\n- `start.sh` - Application startup\n- `stop.sh` - Application stop\n- `.env.production` - Environment template\n- `ecosystem.config.js` - PM2 config (optional)\n\n---\n\n## ðŸŽ¯ Next Steps\n\n1. **Download the package**\n   - Click Files â†’ Download `aiagent-deployment.tar.gz`\n\n2. **Read DEPLOYMENT_INSTRUCTIONS.md**\n   - Choose automated or manual deployment\n\n3. **Upload to EC2**\n   - Use SCP command above\n\n4. **Run installation**\n   - Execute install.sh script\n\n5. **Configure environment**\n   - Add MongoDB URI\n   - Generate SESSION_SECRET\n\n6. **Start the application**\n   - Run start.sh\n\n7. **Access at**\n   - http://3.208.52.220/aiagent/\n\n---\n\n## âœ¨ Features Deployed\n\n### Completed Features\n- âœ… User authentication\n- âœ… Lead management with status tracking\n- âœ… Campaign creation with dates\n- âœ… Campaign configuration options\n- âœ… Appointment scheduling\n- âœ… Notes system with CRUD\n- âœ… Dashboard with analytics\n- âœ… Activity logging\n- âœ… File uploads\n- âœ… Admin panel\n\n### Analytics Included\n- Lead status distribution pie chart\n- 12-month lead trends line chart\n- Daily call activity chart with filters\n- Total leads, calls, and appointment counts\n- Recent activity log\n\n---\n\n## ðŸ”’ Security Notes\n\n**Before Deploying:**\n1. âœ… Generate a unique SESSION_SECRET (don't use the default)\n2. âœ… Use HTTPS/SSL certificate (Certbot)\n3. âœ… Keep NODE_ENV as \"production\"\n4. âœ… Never commit .env.production to version control\n5. âœ… Update database credentials regularly\n6. âœ… Monitor logs for suspicious activity\n\n**Recommended:**\n- Enable firewall (ufw)\n- Use PM2 for auto-restart\n- Setup log rotation\n- Configure automatic backups\n- Monitor disk space\n\n---\n\n## ðŸ“ž Getting Help\n\n### Common Issues\n\n**\"Command not found: node\"**\nâ†’ Install Node.js v18+\n```bash\ncurl -fsSL https://deb.nodesource.com/setup_18.x | sudo -E bash -\nsudo apt-get install -y nodejs\n```\n\n**\"MongoDB connection failed\"**\nâ†’ Check MongoDB URI in .env.production\nâ†’ Verify network access (IP whitelist for cloud DB)\n\n**\"Apache proxy not working\"**\nâ†’ Enable modules: `sudo a2enmod proxy proxy_http`\nâ†’ Test: `curl http://127.0.0.1:5000/`\n\n**\"Port 5000 already in use\"**\nâ†’ Find process: `lsof -i :5000`\nâ†’ Kill process: `kill -9 <PID>`\n\nSee **DEPLOYMENT_INSTRUCTIONS.md** for detailed troubleshooting.\n\n---\n\n## ðŸ“Š Build Statistics\n\n| Component | Size |\n|-----------|------|\n| Total Package | 6.6 MB |\n| Frontend Files | ~1.4 MB |\n| Frontend Gzipped | ~320 KB |\n| Backend (Node.js) | ~2.3 MB |\n| Dependencies | Included |\n\n---\n\n## ðŸš€ You're All Set!\n\nYour AIAgent application is ready for production deployment. Follow the DEPLOYMENT_INSTRUCTIONS.md file for detailed step-by-step guidance.\n\n**Time to deploy:** ~15-30 minutes from start to live application\n\nGood luck! ðŸŽ‰\n","path":null,"size_bytes":6506,"size_tokens":null},"client/src/components/ui/alert-dialog.tsx":{"content":"import * as React from \"react\"\nimport * as AlertDialogPrimitive from \"@radix-ui/react-alert-dialog\"\n\nimport { cn } from \"@/lib/utils\"\nimport { buttonVariants } from \"@/components/ui/button\"\n\nconst AlertDialog = AlertDialogPrimitive.Root\n\nconst AlertDialogTrigger = AlertDialogPrimitive.Trigger\n\nconst AlertDialogPortal = AlertDialogPrimitive.Portal\n\nconst AlertDialogOverlay = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Overlay\n    className={cn(\n      \"fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0\",\n      className\n    )}\n    {...props}\n    ref={ref}\n  />\n))\nAlertDialogOverlay.displayName = AlertDialogPrimitive.Overlay.displayName\n\nconst AlertDialogContent = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPortal>\n    <AlertDialogOverlay />\n    <AlertDialogPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg\",\n        className\n      )}\n      {...props}\n    />\n  </AlertDialogPortal>\n))\nAlertDialogContent.displayName = AlertDialogPrimitive.Content.displayName\n\nconst AlertDialogHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col space-y-2 text-center sm:text-left\",\n      className\n    )}\n    {...props}\n  />\n)\nAlertDialogHeader.displayName = \"AlertDialogHeader\"\n\nconst AlertDialogFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2\",\n      className\n    )}\n    {...props}\n  />\n)\nAlertDialogFooter.displayName = \"AlertDialogFooter\"\n\nconst AlertDialogTitle = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Title\n    ref={ref}\n    className={cn(\"text-lg font-semibold\", className)}\n    {...props}\n  />\n))\nAlertDialogTitle.displayName = AlertDialogPrimitive.Title.displayName\n\nconst AlertDialogDescription = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nAlertDialogDescription.displayName =\n  AlertDialogPrimitive.Description.displayName\n\nconst AlertDialogAction = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Action>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Action>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Action\n    ref={ref}\n    className={cn(buttonVariants(), className)}\n    {...props}\n  />\n))\nAlertDialogAction.displayName = AlertDialogPrimitive.Action.displayName\n\nconst AlertDialogCancel = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Cancel>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Cancel>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Cancel\n    ref={ref}\n    className={cn(\n      buttonVariants({ variant: \"outline\" }),\n      \"mt-2 sm:mt-0\",\n      className\n    )}\n    {...props}\n  />\n))\nAlertDialogCancel.displayName = AlertDialogPrimitive.Cancel.displayName\n\nexport {\n  AlertDialog,\n  AlertDialogPortal,\n  AlertDialogOverlay,\n  AlertDialogTrigger,\n  AlertDialogContent,\n  AlertDialogHeader,\n  AlertDialogFooter,\n  AlertDialogTitle,\n  AlertDialogDescription,\n  AlertDialogAction,\n  AlertDialogCancel,\n}\n","path":null,"size_bytes":4419,"size_tokens":null},"client/src/components/ui/navigation-menu.tsx":{"content":"import * as React from \"react\"\nimport * as NavigationMenuPrimitive from \"@radix-ui/react-navigation-menu\"\nimport { cva } from \"class-variance-authority\"\nimport { ChevronDown } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst NavigationMenu = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Root>\n>(({ className, children, ...props }, ref) => (\n  <NavigationMenuPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"relative z-10 flex max-w-max flex-1 items-center justify-center\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <NavigationMenuViewport />\n  </NavigationMenuPrimitive.Root>\n))\nNavigationMenu.displayName = NavigationMenuPrimitive.Root.displayName\n\nconst NavigationMenuList = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.List>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.List>\n>(({ className, ...props }, ref) => (\n  <NavigationMenuPrimitive.List\n    ref={ref}\n    className={cn(\n      \"group flex flex-1 list-none items-center justify-center space-x-1\",\n      className\n    )}\n    {...props}\n  />\n))\nNavigationMenuList.displayName = NavigationMenuPrimitive.List.displayName\n\nconst NavigationMenuItem = NavigationMenuPrimitive.Item\n\nconst navigationMenuTriggerStyle = cva(\n  \"group inline-flex h-9 w-max items-center justify-center rounded-md bg-background px-4 py-2 text-sm font-medium transition-colors hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground focus:outline-none disabled:pointer-events-none disabled:opacity-50 data-[state=open]:text-accent-foreground data-[state=open]:bg-accent/50 data-[state=open]:hover:bg-accent data-[state=open]:focus:bg-accent\"\n)\n\nconst NavigationMenuTrigger = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Trigger>\n>(({ className, children, ...props }, ref) => (\n  <NavigationMenuPrimitive.Trigger\n    ref={ref}\n    className={cn(navigationMenuTriggerStyle(), \"group\", className)}\n    {...props}\n  >\n    {children}{\" \"}\n    <ChevronDown\n      className=\"relative top-[1px] ml-1 h-3 w-3 transition duration-300 group-data-[state=open]:rotate-180\"\n      aria-hidden=\"true\"\n    />\n  </NavigationMenuPrimitive.Trigger>\n))\nNavigationMenuTrigger.displayName = NavigationMenuPrimitive.Trigger.displayName\n\nconst NavigationMenuContent = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <NavigationMenuPrimitive.Content\n    ref={ref}\n    className={cn(\n      \"left-0 top-0 w-full data-[motion^=from-]:animate-in data-[motion^=to-]:animate-out data-[motion^=from-]:fade-in data-[motion^=to-]:fade-out data-[motion=from-end]:slide-in-from-right-52 data-[motion=from-start]:slide-in-from-left-52 data-[motion=to-end]:slide-out-to-right-52 data-[motion=to-start]:slide-out-to-left-52 md:absolute md:w-auto \",\n      className\n    )}\n    {...props}\n  />\n))\nNavigationMenuContent.displayName = NavigationMenuPrimitive.Content.displayName\n\nconst NavigationMenuLink = NavigationMenuPrimitive.Link\n\nconst NavigationMenuViewport = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Viewport>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Viewport>\n>(({ className, ...props }, ref) => (\n  <div className={cn(\"absolute left-0 top-full flex justify-center\")}>\n    <NavigationMenuPrimitive.Viewport\n      className={cn(\n        \"origin-top-center relative mt-1.5 h-[var(--radix-navigation-menu-viewport-height)] w-full overflow-hidden rounded-md border bg-popover text-popover-foreground shadow data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-90 md:w-[var(--radix-navigation-menu-viewport-width)]\",\n        className\n      )}\n      ref={ref}\n      {...props}\n    />\n  </div>\n))\nNavigationMenuViewport.displayName =\n  NavigationMenuPrimitive.Viewport.displayName\n\nconst NavigationMenuIndicator = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Indicator>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Indicator>\n>(({ className, ...props }, ref) => (\n  <NavigationMenuPrimitive.Indicator\n    ref={ref}\n    className={cn(\n      \"top-full z-[1] flex h-1.5 items-end justify-center overflow-hidden data-[state=visible]:animate-in data-[state=hidden]:animate-out data-[state=hidden]:fade-out data-[state=visible]:fade-in\",\n      className\n    )}\n    {...props}\n  >\n    <div className=\"relative top-[60%] h-2 w-2 rotate-45 rounded-tl-sm bg-border shadow-md\" />\n  </NavigationMenuPrimitive.Indicator>\n))\nNavigationMenuIndicator.displayName =\n  NavigationMenuPrimitive.Indicator.displayName\n\nexport {\n  navigationMenuTriggerStyle,\n  NavigationMenu,\n  NavigationMenuList,\n  NavigationMenuItem,\n  NavigationMenuContent,\n  NavigationMenuTrigger,\n  NavigationMenuLink,\n  NavigationMenuIndicator,\n  NavigationMenuViewport,\n}\n","path":null,"size_bytes":5124,"size_tokens":null},"client/src/components/ui/input-otp.tsx":{"content":"import * as React from \"react\"\nimport { OTPInput, OTPInputContext } from \"input-otp\"\nimport { Minus } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst InputOTP = React.forwardRef<\n  React.ElementRef<typeof OTPInput>,\n  React.ComponentPropsWithoutRef<typeof OTPInput>\n>(({ className, containerClassName, ...props }, ref) => (\n  <OTPInput\n    ref={ref}\n    containerClassName={cn(\n      \"flex items-center gap-2 has-[:disabled]:opacity-50\",\n      containerClassName\n    )}\n    className={cn(\"disabled:cursor-not-allowed\", className)}\n    {...props}\n  />\n))\nInputOTP.displayName = \"InputOTP\"\n\nconst InputOTPGroup = React.forwardRef<\n  React.ElementRef<\"div\">,\n  React.ComponentPropsWithoutRef<\"div\">\n>(({ className, ...props }, ref) => (\n  <div ref={ref} className={cn(\"flex items-center\", className)} {...props} />\n))\nInputOTPGroup.displayName = \"InputOTPGroup\"\n\nconst InputOTPSlot = React.forwardRef<\n  React.ElementRef<\"div\">,\n  React.ComponentPropsWithoutRef<\"div\"> & { index: number }\n>(({ index, className, ...props }, ref) => {\n  const inputOTPContext = React.useContext(OTPInputContext)\n  const { char, hasFakeCaret, isActive } = inputOTPContext.slots[index]\n\n  return (\n    <div\n      ref={ref}\n      className={cn(\n        \"relative flex h-9 w-9 items-center justify-center border-y border-r border-input text-sm shadow-sm transition-all first:rounded-l-md first:border-l last:rounded-r-md\",\n        isActive && \"z-10 ring-1 ring-ring\",\n        className\n      )}\n      {...props}\n    >\n      {char}\n      {hasFakeCaret && (\n        <div className=\"pointer-events-none absolute inset-0 flex items-center justify-center\">\n          <div className=\"h-4 w-px animate-caret-blink bg-foreground duration-1000\" />\n        </div>\n      )}\n    </div>\n  )\n})\nInputOTPSlot.displayName = \"InputOTPSlot\"\n\nconst InputOTPSeparator = React.forwardRef<\n  React.ElementRef<\"div\">,\n  React.ComponentPropsWithoutRef<\"div\">\n>(({ ...props }, ref) => (\n  <div ref={ref} role=\"separator\" {...props}>\n    <Minus />\n  </div>\n))\nInputOTPSeparator.displayName = \"InputOTPSeparator\"\n\nexport { InputOTP, InputOTPGroup, InputOTPSlot, InputOTPSeparator }\n","path":null,"size_bytes":2143,"size_tokens":null},"client/src/components/ui/textarea.tsx":{"content":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Textarea = React.forwardRef<\n  HTMLTextAreaElement,\n  React.ComponentProps<\"textarea\">\n>(({ className, ...props }, ref) => {\n  return (\n    <textarea\n      className={cn(\n        \"flex min-h-[60px] w-full rounded-md border border-input bg-transparent px-3 py-2 text-base shadow-sm placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm\",\n        className\n      )}\n      ref={ref}\n      {...props}\n    />\n  )\n})\nTextarea.displayName = \"Textarea\"\n\nexport { Textarea }\n","path":null,"size_bytes":649,"size_tokens":null},"client/src/pages/payment.tsx":{"content":"import { useEffect, useState } from \"react\";\nimport { useLocation } from \"wouter\";\nimport { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { type Plan } from \"@shared/schema\";\nimport { Button } from \"@/components/ui/button\";\nimport { Card, CardContent, CardDescription, CardFooter, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Loader2, CheckCircle2, AlertCircle } from \"lucide-react\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { apiRequest, queryClient } from \"@/lib/queryClient\";\nimport { useAuth } from \"@/lib/auth\";\n\nexport default function Payment() {\n  const [location, setLocation] = useLocation();\n  const { toast } = useToast();\n  const { login } = useAuth();\n  const queryParams = new URLSearchParams(window.location.search);\n  const planId = queryParams.get(\"plan\");\n  const email = queryParams.get(\"email\");\n\n  const { data: plan, isLoading } = useQuery<Plan>({\n    queryKey: [\"/api/plans\", planId],\n    queryFn: async () => {\n      if (!planId) return null;\n      const res = await fetch(`/api/plans/${planId}`);\n      if (!res.ok) throw new Error(\"Failed to fetch plan\");\n      return res.json();\n    },\n    enabled: !!planId,\n  });\n\n  const upgradeMutation = useMutation({\n    mutationFn: async (planId: string) => {\n      const res = await apiRequest(\"POST\", \"/api/billing/upgrade\", { planId });\n      return res.json();\n    },\n    onSuccess: async () => {\n      toast({\n        title: \"Success\",\n        description: \"Your payment was successful and your plan has been activated.\",\n      });\n      \n      // Auto-redirect after successful payment\n      setTimeout(() => {\n        if (email) {\n          // If we came from registration, redirect to login with a success message\n          setLocation(`/login?message=Account activated successfully! Please login with your credentials.&email=${encodeURIComponent(email)}`);\n        } else {\n          // Otherwise, try to go to dashboard (for existing users upgrading)\n          queryClient.invalidateQueries({ queryKey: [\"/api/auth/me\"] });\n          setLocation(\"/dashboard\");\n        }\n      }, 2000); // Give user a moment to see the success toast\n    },\n    onError: (error: any) => {\n      toast({\n        variant: \"destructive\",\n        title: \"Upgrade failed\",\n        description: error.message || \"Something went wrong during plan activation\",\n      });\n    },\n  });\n\n  const handlePayment = () => {\n    if (!plan) return;\n    \n    // Check if Razorpay is available\n    if (!(window as any).Razorpay) {\n      toast({\n        variant: \"destructive\",\n        title: \"Error\",\n        description: \"Razorpay SDK not loaded. Please refresh and try again.\",\n      });\n      return;\n    }\n\n    // In a real scenario, you'd get an orderId from the backend first\n    // For now, we'll simulate the Razorpay options\n    const options = {\n      key: import.meta.env.VITE_RAZORPAY_KEY_ID || \"rzp_test_placeholder\",\n      amount: plan.price * 100, // in paise\n      currency: \"INR\",\n      name: \"NIJVOX\",\n      description: `Payment for ${plan.name} Plan`,\n      handler: function (response: any) {\n        // Handle successful payment\n        upgradeMutation.mutate(plan._id);\n      },\n      prefill: {\n        name: \"\", // Will be filled from auth state if needed\n        email: email || \"\",\n      },\n      theme: {\n        color: \"#f97316\", // Primary color\n      },\n    };\n\n    const rzp = new (window as any).Razorpay(options);\n    rzp.open();\n  };\n\n  if (isLoading) {\n    return (\n      <div className=\"flex items-center justify-center min-h-screen\">\n        <Loader2 className=\"h-8 w-8 animate-spin text-primary\" />\n      </div>\n    );\n  }\n\n  if (!plan) {\n    return (\n      <div className=\"flex flex-col items-center justify-center min-h-screen space-y-4\">\n        <AlertCircle className=\"h-12 w-12 text-destructive\" />\n        <h2 className=\"text-2xl font-bold\">Invalid Plan</h2>\n        <Button onClick={() => setLocation(\"/pricing\")}>Go to Pricing</Button>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"min-h-screen bg-muted/20 flex items-center justify-center px-4 py-12\">\n      <Card className=\"w-full max-w-lg\">\n        <CardHeader className=\"text-center\">\n          <CardTitle className=\"text-3xl font-bold\">\n            {upgradeMutation.isSuccess ? \"Payment Successful!\" : \"Complete Your Purchase\"}\n          </CardTitle>\n          <CardDescription>\n            {upgradeMutation.isSuccess \n              ? \"Your account is now active. Redirecting you...\" \n              : `You're subscribing to the ${plan.name} Plan`}\n          </CardDescription>\n        </CardHeader>\n        <CardContent className=\"space-y-6\">\n          {upgradeMutation.isSuccess ? (\n            <div className=\"flex flex-col items-center justify-center py-8 space-y-4\">\n              <div className=\"h-20 w-20 bg-green-100 dark:bg-green-900/20 rounded-full flex items-center justify-center\">\n                <CheckCircle2 className=\"h-12 w-12 text-green-600 dark:text-green-400\" />\n              </div>\n              <p className=\"text-center text-muted-foreground font-medium\">\n                Thank you for your purchase. We are setting up your workspace.\n              </p>\n            </div>\n          ) : (\n            <>\n              <div className=\"bg-primary/5 rounded-xl p-6 border border-primary/10\">\n                <div className=\"flex justify-between items-center mb-4\">\n                  <span className=\"text-lg font-medium\">Total Amount</span>\n                  <span className=\"text-3xl font-bold text-primary\">â‚¹{plan.price}</span>\n                </div>\n                <div className=\"space-y-3\">\n                  <div className=\"flex items-center text-sm text-muted-foreground\">\n                    <CheckCircle2 className=\"h-4 w-4 mr-2 text-primary\" />\n                    {plan.credits.toLocaleString()} Credits included\n                  </div>\n                  <div className=\"flex items-center text-sm text-muted-foreground\">\n                    <CheckCircle2 className=\"h-4 w-4 mr-2 text-primary\" />\n                    Full access to all {plan.name} features\n                  </div>\n                </div>\n              </div>\n\n              <div className=\"text-center space-y-4\">\n                <p className=\"text-sm text-muted-foreground\">\n                  Secure payment processing via Razorpay\n                </p>\n                <Button \n                  size=\"lg\" \n                  className=\"w-full h-12 text-lg font-semibold\"\n                  onClick={handlePayment}\n                  disabled={upgradeMutation.isPending}\n                >\n                  {upgradeMutation.isPending ? (\n                    <>\n                      <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" />\n                      Processing...\n                    </>\n                  ) : (\n                    `Pay â‚¹${plan.price} Now`\n                  )}\n                </Button>\n                <Button \n                  variant=\"ghost\" \n                  className=\"w-full\"\n                  onClick={() => setLocation(\"/pricing\")}\n                  disabled={upgradeMutation.isPending}\n                >\n                  Change Plan\n                </Button>\n              </div>\n            </>\n          )}\n        </CardContent>\n        {!upgradeMutation.isSuccess && (\n          <CardFooter className=\"justify-center border-t p-6\">\n            <div className=\"flex items-center gap-4 grayscale opacity-50\">\n              <span className=\"text-xs font-medium uppercase tracking-widest\">Secure Checkout</span>\n            </div>\n          </CardFooter>\n        )}\n      </Card>\n    </div>\n  );\n}\n","path":null,"size_bytes":7633,"size_tokens":null},"client/src/components/ui/toast.tsx":{"content":"import * as React from \"react\"\nimport * as ToastPrimitives from \"@radix-ui/react-toast\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\nimport { X } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ToastProvider = ToastPrimitives.Provider\n\nconst ToastViewport = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Viewport>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Viewport>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Viewport\n    ref={ref}\n    className={cn(\n      \"fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]\",\n      className\n    )}\n    {...props}\n  />\n))\nToastViewport.displayName = ToastPrimitives.Viewport.displayName\n\nconst toastVariants = cva(\n  \"group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full\",\n  {\n    variants: {\n      variant: {\n        default: \"border bg-background text-foreground\",\n        destructive:\n          \"destructive group border-destructive bg-destructive text-destructive-foreground\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  }\n)\n\nconst Toast = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Root>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Root> &\n    VariantProps<typeof toastVariants>\n>(({ className, variant, ...props }, ref) => {\n  return (\n    <ToastPrimitives.Root\n      ref={ref}\n      className={cn(toastVariants({ variant }), className)}\n      {...props}\n    />\n  )\n})\nToast.displayName = ToastPrimitives.Root.displayName\n\nconst ToastAction = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Action>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Action>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Action\n    ref={ref}\n    className={cn(\n      \"inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive\",\n      className\n    )}\n    {...props}\n  />\n))\nToastAction.displayName = ToastPrimitives.Action.displayName\n\nconst ToastClose = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Close>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Close>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Close\n    ref={ref}\n    className={cn(\n      \"absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600\",\n      className\n    )}\n    toast-close=\"\"\n    {...props}\n  >\n    <X className=\"h-4 w-4\" />\n  </ToastPrimitives.Close>\n))\nToastClose.displayName = ToastPrimitives.Close.displayName\n\nconst ToastTitle = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Title>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Title>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Title\n    ref={ref}\n    className={cn(\"text-sm font-semibold\", className)}\n    {...props}\n  />\n))\nToastTitle.displayName = ToastPrimitives.Title.displayName\n\nconst ToastDescription = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Description>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Description>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Description\n    ref={ref}\n    className={cn(\"text-sm opacity-90\", className)}\n    {...props}\n  />\n))\nToastDescription.displayName = ToastPrimitives.Description.displayName\n\ntype ToastProps = React.ComponentPropsWithoutRef<typeof Toast>\n\ntype ToastActionElement = React.ReactElement<typeof ToastAction>\n\nexport {\n  type ToastProps,\n  type ToastActionElement,\n  ToastProvider,\n  ToastViewport,\n  Toast,\n  ToastTitle,\n  ToastDescription,\n  ToastClose,\n  ToastAction,\n}\n","path":null,"size_bytes":4845,"size_tokens":null},"client/src/pages/home.tsx":{"content":"import { Button } from \"@/components/ui/button\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Mic, MessageSquare, BarChart3, Globe, Zap, CheckCircle2, Play } from \"lucide-react\";\nimport { Link } from \"wouter\";\nimport heroImage from \"@assets/generated_images/abstract_visualization_of_ai_voice_technology_with_sound_waves_and_digital_nodes_in_orange_and_black..png\";\nimport { motion } from \"framer-motion\";\n\nexport default function Home() {\n  return (\n    <div className=\"flex flex-col min-h-screen\">\n      {/* Hero Section */}\n      <section className=\"relative pt-24 pb-32 overflow-hidden\">\n        <div className=\"absolute inset-0 z-0 opacity-20 dark:opacity-40\">\n           <img \n             src={heroImage} \n             alt=\"Background\" \n             className=\"w-full h-full object-cover\"\n           />\n           <div className=\"absolute inset-0 bg-gradient-to-b from-background via-background/80 to-background\" />\n        </div>\n        \n        <div className=\"container relative z-10 mx-auto px-4 text-center\">\n          <motion.div \n            initial={{ opacity: 0, y: 20 }}\n            animate={{ opacity: 1, y: 0 }}\n            transition={{ duration: 0.6 }}\n          >\n            <Badge variant=\"outline\" className=\"mb-6 border-primary/50 text-primary px-4 py-1 text-sm uppercase tracking-widest\">\n              Enterprise-Grade Voice Automation\n            </Badge>\n            <h1 className=\"text-5xl md:text-7xl font-bold tracking-tight mb-8\">\n              Bulk SMS & AI <br/>\n              <span className=\"text-primary\">Calling Platform</span>\n            </h1>\n            <p className=\"text-xl text-muted-foreground max-w-2xl mx-auto mb-10 leading-relaxed\">\n              The all-in-one platform for Bulk SMS, WhatsApp Messaging, and AI Voice Calling. \n              Reach thousands of customers instantly and automate your sales outreach.\n            </p>\n            <div className=\"flex flex-col sm:flex-row gap-4 justify-center items-center\">\n              <Link href=\"/register\">\n                <Button size=\"lg\" className=\"h-12 px-8 text-lg rounded-full shadow-lg shadow-primary/20 hover:shadow-primary/40 transition-all\">\n                  Start Free Trial <Zap className=\"ml-2 h-4 w-4\" />\n                </Button>\n              </Link>\n              <Button size=\"lg\" variant=\"outline\" className=\"h-12 px-8 text-lg rounded-full backdrop-blur-sm\">\n                <Play className=\"mr-2 h-4 w-4\" /> Watch the Demo\n              </Button>\n            </div>\n          </motion.div>\n        </div>\n      </section>\n\n      {/* Stats Section */}\n      <section className=\"py-12 border-y bg-muted/20\">\n        <div className=\"container mx-auto px-4\">\n          <div className=\"grid grid-cols-2 md:grid-cols-4 gap-8 text-center\">\n            {[\n              { label: \"Calls Automate\", value: \"10M+\" },\n              { label: \"Sales Closed\", value: \"$500M+\" },\n              { label: \"Uptime\", value: \"99.9%\" },\n              { label: \"Languages\", value: \"30+\" },\n            ].map((stat, i) => (\n              <div key={i}>\n                <div className=\"text-3xl md:text-4xl font-bold text-foreground mb-1\">{stat.value}</div>\n                <div className=\"text-sm text-muted-foreground uppercase tracking-wider\">{stat.label}</div>\n              </div>\n            ))}\n          </div>\n        </div>\n      </section>\n\n      {/* Features Grid */}\n      <section className=\"py-24\" id=\"products\">\n        <div className=\"container mx-auto px-4\">\n          <div className=\"text-center mb-16\">\n            <h2 className=\"text-3xl md:text-5xl font-bold mb-4\">Everything you need to scale</h2>\n            <p className=\"text-muted-foreground max-w-2xl mx-auto\">\n              A complete suite of tools designed to replace the manual grunt work of sales.\n            </p>\n          </div>\n\n          <div className=\"grid md:grid-cols-3 gap-8\">\n            <Card className=\"bg-card/50 backdrop-blur border-primary/10 hover:border-primary/30 transition-all duration-300\">\n              <CardHeader>\n                <div className=\"w-12 h-12 rounded-lg bg-primary/10 flex items-center justify-center mb-4\">\n                  <Mic className=\"h-6 w-6 text-primary\" />\n                </div>\n                <CardTitle>AI Voice Agent</CardTitle>\n                <CardDescription>Human-like conversations</CardDescription>\n              </CardHeader>\n              <CardContent>\n                <p className=\"text-muted-foreground\">\n                  Our agents can dial out, greet prospects, handle objections, and book meetings dynamically based on the conversation flow.\n                </p>\n              </CardContent>\n            </Card>\n\n            <Card className=\"bg-card/50 backdrop-blur border-primary/10 hover:border-primary/30 transition-all duration-300\">\n              <CardHeader>\n                <div className=\"w-12 h-12 rounded-lg bg-primary/10 flex items-center justify-center mb-4\">\n                  <MessageSquare className=\"h-6 w-6 text-primary\" />\n                </div>\n                <CardTitle>Bulk SMS</CardTitle>\n                <CardDescription>Instant follow-ups</CardDescription>\n              </CardHeader>\n              <CardContent>\n                <p className=\"text-muted-foreground\">\n                  Send thousands of personalized SMS messages to follow up after calls or re-engage cold leads automatically.\n                </p>\n              </CardContent>\n            </Card>\n\n            <Card className=\"bg-card/50 backdrop-blur border-primary/10 hover:border-primary/30 transition-all duration-300\">\n              <CardHeader>\n                <div className=\"w-12 h-12 rounded-lg bg-primary/10 flex items-center justify-center mb-4\">\n                  <BarChart3 className=\"h-6 w-6 text-primary\" />\n                </div>\n                <CardTitle>Integrated CRM</CardTitle>\n                <CardDescription>Track every interaction</CardDescription>\n              </CardHeader>\n              <CardContent>\n                <p className=\"text-muted-foreground\">\n                  Built-in CRM to manage leads, view call transcripts, and track success rates without leaving the platform.\n                </p>\n              </CardContent>\n            </Card>\n          </div>\n        </div>\n      </section>\n\n      {/* Industry Solutions Section */}\n      <section className=\"py-24 bg-background relative overflow-hidden\">\n        <div className=\"absolute inset-0 z-0 opacity-10\">\n          <div className=\"absolute top-1/4 left-1/4 w-96 h-96 bg-primary rounded-full blur-[120px]\" />\n          <div className=\"absolute bottom-1/4 right-1/4 w-96 h-96 bg-blue-500 rounded-full blur-[120px]\" />\n        </div>\n        \n        <div className=\"container relative z-10 mx-auto px-4\">\n          <div className=\"text-center mb-16\">\n            <h2 className=\"text-4xl md:text-5xl font-bold mb-6\">\n              Fields Where <span className=\"text-primary\">NIJVOX</span> <br/>\n              is a Game Changer\n            </h2>\n            <p className=\"text-muted-foreground max-w-2xl mx-auto text-lg\">\n              From AI Calling to Automated WhatsApp and Bulk SMS, \n              NIJVOX revolutionizes communication across industries.\n            </p>\n          </div>\n\n          <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 max-w-6xl mx-auto\">\n            {[\n              {\n                title: \"E-Commerce\",\n                desc: \"Use NIJVOX for product promotions, abandoned cart recovery, and customer feedback.\",\n                icon: \"ðŸ›ï¸\",\n                color: \"bg-purple-500/10 text-purple-500\"\n              },\n              {\n                title: \"Financial Services\",\n                desc: \"Automate loan processing, KYC verification, and customer reminders with compliant AI.\",\n                icon: \"ðŸ’°\",\n                color: \"bg-emerald-500/10 text-emerald-500\"\n              },\n              {\n                title: \"Education & EdTech\",\n                desc: \"Engage students with admission follow-ups, course reminders, and exam notifications.\",\n                icon: \"ðŸŽ“\",\n                color: \"bg-orange-500/10 text-orange-500\"\n              },\n              {\n                title: \"Health & Medical\",\n                desc: \"Automate appointment reminders, health check-up follow-ups, and patient feedback.\",\n                icon: \"ðŸ¥\",\n                color: \"bg-red-500/10 text-red-500\"\n              },\n              {\n                title: \"Real Estate & Automotive\",\n                desc: \"Qualify leads instantly, schedule property or car viewings, and follow up on inquiries.\",\n                icon: \"ðŸ \",\n                color: \"bg-blue-500/10 text-blue-500\"\n              },\n              {\n                title: \"Travel & Hospitality\",\n                desc: \"Send booking confirmations, travel reminders, and gather customer feedback post-trip.\",\n                icon: \"âœˆï¸\",\n                color: \"bg-pink-500/10 text-pink-500\"\n              },\n              {\n                title: \"Lead Generation Agencies\",\n                desc: \"Automate prospect outreach, score leads, and nurture them effectively with AI.\",\n                icon: \"ðŸŽ¯\",\n                color: \"bg-indigo-500/10 text-indigo-500\"\n              },\n              {\n                title: \"Consumer Services\",\n                desc: \"Engage customers for maintenance reminders, service feedback and support automation.\",\n                icon: \"ðŸ› ï¸\",\n                color: \"bg-amber-500/10 text-amber-500\"\n              },\n              {\n                title: \"SaaS & Technology\",\n                desc: \"Automate demo scheduling, trial onboarding, and feature announcement calls.\",\n                icon: \"ðŸ’»\",\n                color: \"bg-cyan-500/10 text-cyan-500\"\n              }\n            ].map((industry, i) => (\n              <Card key={i} className=\"group hover-elevate border-primary/10 bg-card/50 backdrop-blur-sm overflow-hidden\">\n                <CardHeader className=\"flex flex-row items-center gap-4\">\n                  <div className={`w-12 h-12 rounded-xl flex items-center justify-center text-2xl shadow-inner ${industry.color}`}>\n                    {industry.icon}\n                  </div>\n                  <CardTitle className=\"text-xl group-hover:text-primary transition-colors\">{industry.title}</CardTitle>\n                </CardHeader>\n                <CardContent>\n                  <p className=\"text-muted-foreground leading-relaxed\">\n                    {industry.desc}\n                  </p>\n                </CardContent>\n              </Card>\n            ))}\n          </div>\n        </div>\n      </section>\n\n      {/* CTA */}\n      <section className=\"py-24 bg-primary text-primary-foreground\">\n        <div className=\"container mx-auto px-4 text-center\">\n          <h2 className=\"text-3xl md:text-5xl font-bold mb-6\">Ready to replace the busywork?</h2>\n          <p className=\"text-xl opacity-90 mb-10 max-w-2xl mx-auto\">\n            Join 2,000+ companies using NIJVOX to automate their sales outreach.\n          </p>\n          <Link href=\"/register\">\n            <Button size=\"lg\" variant=\"secondary\" className=\"h-14 px-10 text-lg rounded-full\">\n              Get Started Now\n            </Button>\n          </Link>\n        </div>\n      </section>\n    </div>\n  );\n}\n","path":null,"size_bytes":11430,"size_tokens":null},"client/src/components/ui/card.tsx":{"content":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Card = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\n      \"rounded-xl border bg-card text-card-foreground shadow\",\n      className\n    )}\n    {...props}\n  />\n))\nCard.displayName = \"Card\"\n\nconst CardHeader = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"flex flex-col space-y-1.5 p-6\", className)}\n    {...props}\n  />\n))\nCardHeader.displayName = \"CardHeader\"\n\nconst CardTitle = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"font-semibold leading-none tracking-tight\", className)}\n    {...props}\n  />\n))\nCardTitle.displayName = \"CardTitle\"\n\nconst CardDescription = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nCardDescription.displayName = \"CardDescription\"\n\nconst CardContent = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div ref={ref} className={cn(\"p-6 pt-0\", className)} {...props} />\n))\nCardContent.displayName = \"CardContent\"\n\nconst CardFooter = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"flex items-center p-6 pt-0\", className)}\n    {...props}\n  />\n))\nCardFooter.displayName = \"CardFooter\"\n\nexport { Card, CardHeader, CardFooter, CardTitle, CardDescription, CardContent }\n","path":null,"size_bytes":1828,"size_tokens":null},"client/src/components/ui/collapsible.tsx":{"content":"\"use client\"\n\nimport * as CollapsiblePrimitive from \"@radix-ui/react-collapsible\"\n\nconst Collapsible = CollapsiblePrimitive.Root\n\nconst CollapsibleTrigger = CollapsiblePrimitive.CollapsibleTrigger\n\nconst CollapsibleContent = CollapsiblePrimitive.CollapsibleContent\n\nexport { Collapsible, CollapsibleTrigger, CollapsibleContent }\n","path":null,"size_bytes":329,"size_tokens":null},"client/src/components/ui/button-group.tsx":{"content":"import { Slot } from \"@radix-ui/react-slot\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Separator } from \"@/components/ui/separator\"\n\nconst buttonGroupVariants = cva(\n  \"flex w-fit items-stretch has-[>[data-slot=button-group]]:gap-2 [&>*]:focus-visible:relative [&>*]:focus-visible:z-10 has-[select[aria-hidden=true]:last-child]:[&>[data-slot=select-trigger]:last-of-type]:rounded-r-md [&>[data-slot=select-trigger]:not([class*='w-'])]:w-fit [&>input]:flex-1\",\n  {\n    variants: {\n      orientation: {\n        horizontal:\n          \"[&>*:not(:first-child)]:rounded-l-none [&>*:not(:first-child)]:border-l-0 [&>*:not(:last-child)]:rounded-r-none\",\n        vertical:\n          \"flex-col [&>*:not(:first-child)]:rounded-t-none [&>*:not(:first-child)]:border-t-0 [&>*:not(:last-child)]:rounded-b-none\",\n      },\n    },\n    defaultVariants: {\n      orientation: \"horizontal\",\n    },\n  }\n)\n\nfunction ButtonGroup({\n  className,\n  orientation,\n  ...props\n}: React.ComponentProps<\"div\"> & VariantProps<typeof buttonGroupVariants>) {\n  return (\n    <div\n      role=\"group\"\n      data-slot=\"button-group\"\n      data-orientation={orientation}\n      className={cn(buttonGroupVariants({ orientation }), className)}\n      {...props}\n    />\n  )\n}\n\nfunction ButtonGroupText({\n  className,\n  asChild = false,\n  ...props\n}: React.ComponentProps<\"div\"> & {\n  asChild?: boolean\n}) {\n  const Comp = asChild ? Slot : \"div\"\n\n  return (\n    <Comp\n      className={cn(\n        \"bg-muted shadow-xs flex items-center gap-2 rounded-md border px-4 text-sm font-medium [&_svg:not([class*='size-'])]:size-4 [&_svg]:pointer-events-none\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction ButtonGroupSeparator({\n  className,\n  orientation = \"vertical\",\n  ...props\n}: React.ComponentProps<typeof Separator>) {\n  return (\n    <Separator\n      data-slot=\"button-group-separator\"\n      orientation={orientation}\n      className={cn(\n        \"bg-input relative !m-0 self-stretch data-[orientation=vertical]:h-auto\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nexport {\n  ButtonGroup,\n  ButtonGroupSeparator,\n  ButtonGroupText,\n  buttonGroupVariants,\n}\n","path":null,"size_bytes":2209,"size_tokens":null},"client/src/components/ui/button.tsx":{"content":"import * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst buttonVariants = cva(\n  \"inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\" +\n\" hover-elevate active-elevate-2\",\n  {\n    variants: {\n      variant: {\n        default:\n           // @replit: no hover, and add primary border\n           \"bg-primary text-primary-foreground border border-primary-border\",\n        destructive:\n          \"bg-destructive text-destructive-foreground shadow-sm border-destructive-border\",\n        outline:\n          // @replit Shows the background color of whatever card / sidebar / accent background it is inside of.\n          // Inherits the current text color. Uses shadow-xs. no shadow on active\n          // No hover state\n          \" border [border-color:var(--button-outline)] shadow-xs active:shadow-none \",\n        secondary:\n          // @replit border, no hover, no shadow, secondary border.\n          \"border bg-secondary text-secondary-foreground border border-secondary-border \",\n        // @replit no hover, transparent border\n        ghost: \"border border-transparent\",\n        link: \"text-primary underline-offset-4 hover:underline\",\n      },\n      size: {\n        // @replit changed sizes\n        default: \"min-h-9 px-4 py-2\",\n        sm: \"min-h-8 rounded-md px-3 text-xs\",\n        lg: \"min-h-10 rounded-md px-8\",\n        icon: \"h-9 w-9\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  }\n)\n\nexport interface ButtonProps\n  extends React.ButtonHTMLAttributes<HTMLButtonElement>,\n    VariantProps<typeof buttonVariants> {\n  asChild?: boolean\n}\n\nconst Button = React.forwardRef<HTMLButtonElement, ButtonProps>(\n  ({ className, variant, size, asChild = false, ...props }, ref) => {\n    const Comp = asChild ? Slot : \"button\"\n    return (\n      <Comp\n        className={cn(buttonVariants({ variant, size, className }))}\n        ref={ref}\n        {...props}\n      />\n    )\n  }\n)\nButton.displayName = \"Button\"\n\nexport { Button, buttonVariants }\n","path":null,"size_bytes":2356,"size_tokens":null},"client/src/components/ui/empty.tsx":{"content":"import { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nfunction Empty({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"empty\"\n      className={cn(\n        \"flex min-w-0 flex-1 flex-col items-center justify-center gap-6 text-balance rounded-lg border-dashed p-6 text-center md:p-12\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction EmptyHeader({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"empty-header\"\n      className={cn(\n        \"flex max-w-sm flex-col items-center gap-2 text-center\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nconst emptyMediaVariants = cva(\n  \"mb-2 flex shrink-0 items-center justify-center [&_svg]:pointer-events-none [&_svg]:shrink-0\",\n  {\n    variants: {\n      variant: {\n        default: \"bg-transparent\",\n        icon: \"bg-muted text-foreground flex size-10 shrink-0 items-center justify-center rounded-lg [&_svg:not([class*='size-'])]:size-6\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  }\n)\n\nfunction EmptyMedia({\n  className,\n  variant = \"default\",\n  ...props\n}: React.ComponentProps<\"div\"> & VariantProps<typeof emptyMediaVariants>) {\n  return (\n    <div\n      data-slot=\"empty-icon\"\n      data-variant={variant}\n      className={cn(emptyMediaVariants({ variant, className }))}\n      {...props}\n    />\n  )\n}\n\nfunction EmptyTitle({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"empty-title\"\n      className={cn(\"text-lg font-medium tracking-tight\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction EmptyDescription({ className, ...props }: React.ComponentProps<\"p\">) {\n  return (\n    <div\n      data-slot=\"empty-description\"\n      className={cn(\n        \"text-muted-foreground [&>a:hover]:text-primary text-sm/relaxed [&>a]:underline [&>a]:underline-offset-4\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction EmptyContent({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"empty-content\"\n      className={cn(\n        \"flex w-full min-w-0 max-w-sm flex-col items-center gap-4 text-balance text-sm\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nexport {\n  Empty,\n  EmptyHeader,\n  EmptyTitle,\n  EmptyDescription,\n  EmptyContent,\n  EmptyMedia,\n}\n","path":null,"size_bytes":2396,"size_tokens":null},"server/index.ts":{"content":"import \"dotenv/config\";\nimport express, { type Request, Response, NextFunction } from \"express\";\nimport { registerRoutes } from \"./routes\";\nimport { serveStatic } from \"./static\";\nimport { createServer } from \"http\";\n\nconst app = express();\nconst httpServer = createServer(app);\n\ndeclare module \"http\" {\n  interface IncomingMessage {\n    rawBody: unknown;\n  }\n}\n\napp.use(\n  express.json({\n    verify: (req, _res, buf) => {\n      req.rawBody = buf;\n    },\n  }),\n);\n\napp.use(express.urlencoded({ extended: false }));\n\nexport function log(message: string, source = \"express\") {\n  const formattedTime = new Date().toLocaleTimeString(\"en-US\", {\n    hour: \"numeric\",\n    minute: \"2-digit\",\n    second: \"2-digit\",\n    hour12: true,\n  });\n\n  console.log(`${formattedTime} [${source}] ${message}`);\n}\n\napp.use((req, res, next) => {\n  const start = Date.now();\n  const path = req.path;\n  let capturedJsonResponse: Record<string, any> | undefined = undefined;\n\n  const originalResJson = res.json;\n  res.json = function (bodyJson, ...args) {\n    capturedJsonResponse = bodyJson;\n    return originalResJson.apply(res, [bodyJson, ...args]);\n  };\n\n  res.on(\"finish\", () => {\n    const duration = Date.now() - start;\n    if (path.startsWith(\"/api\")) {\n      let logLine = `${req.method} ${path} ${res.statusCode} in ${duration}ms`;\n      if (capturedJsonResponse) {\n        logLine += ` :: ${JSON.stringify(capturedJsonResponse)}`;\n      }\n\n      log(logLine);\n    }\n  });\n\n  next();\n});\n\n(async () => {\n  await registerRoutes(httpServer, app);\n\n  app.use((err: any, _req: Request, res: Response, _next: NextFunction) => {\n    const status = err.status || err.statusCode || 500;\n    const message = err.message || \"Internal Server Error\";\n\n    res.status(status).json({ message });\n    throw err;\n  });\n\n  // importantly only setup vite in development and after\n  // setting up all the other routes so the catch-all route\n  // doesn't interfere with the other routes\n  if (process.env.NODE_ENV === \"production\") {\n    serveStatic(app);\n  } else {\n    const { setupVite } = await import(\"./vite\");\n    await setupVite(httpServer, app);\n  }\n\n  // ALWAYS serve the app on the port specified in the environment variable PORT\n  // Other ports are firewalled. Default to 5000 if not specified.\n  // this serves both the API and the client.\n  // It is the only port that is not firewalled.\n  const port = parseInt(process.env.PORT || \"5000\", 10);\n  httpServer.listen(\n    {\n      port,\n      host: \"0.0.0.0\",\n      reusePort: true,\n    },\n    () => {\n      log(`serving on port ${port}`);\n    },\n  );\n})();\n","path":null,"size_bytes":2584,"size_tokens":null},"client/src/App.tsx":{"content":"import { Switch, Route, Router as WouterRouter, useLocation } from \"wouter\";\nimport { queryClient } from \"./lib/queryClient\";\nimport { QueryClientProvider } from \"@tanstack/react-query\";\nimport { Toaster } from \"@/components/ui/toaster\";\nimport { TooltipProvider } from \"@/components/ui/tooltip\";\nimport { ThemeProvider } from \"@/components/theme-provider\";\nimport { AuthProvider } from \"@/lib/auth\";\nimport { Navbar } from \"@/components/layout/navbar\";\nimport { Footer } from \"@/components/layout/footer\";\nimport NotFound from \"@/pages/not-found\";\nimport Home from \"@/pages/home\";\nimport Auth from \"@/pages/auth\";\nimport Dashboard from \"@/pages/dashboard\";\nimport Features from \"@/pages/features\";\nimport Pricing from \"@/pages/pricing\";\nimport About from \"@/pages/about\";\nimport Contact from \"@/pages/contact\";\nimport HowItWorks from \"@/pages/how-it-works\";\nimport AdminLogin from \"@/pages/admin-login\";\nimport AdminPlans from \"@/pages/admin-plans\";\nimport Notifications from \"@/pages/notifications\";\nimport BulkWhatsapp from \"@/pages/bulk-whatsapp\";\nimport Payment from \"@/pages/payment\";\n\nfunction Router() {\n  const isProduction = import.meta.env.PROD;\n  const base = isProduction ? \"/aiagent\" : \"\";\n  const [location] = useLocation();\n\n  const hideFooterRoutes = [\"/login\", \"/register\", \"/admin\", \"/dashboard\", \"/admin/dashboard\", \"/admin/plans\", \"/payment\", \"/bulk-whatsapp\", \"/notifications\"];\n  const shouldHideFooter = hideFooterRoutes.includes(location);\n\n  return (\n    <WouterRouter base={base}>\n      <div className=\"flex flex-col min-h-screen\">\n        <Navbar />\n        <main className=\"flex-grow\">\n          <Switch>\n            <Route path=\"/dashboard\" component={Dashboard} />\n            <Route path=\"/payment\" component={Payment} />\n            <Route path=\"/notifications\" component={Notifications} />\n            <Route path=\"/bulk-whatsapp\" component={BulkWhatsapp} />\n            <Route path=\"/admin/dashboard\" component={Dashboard} />\n            <Route path=\"/admin/plans\" component={AdminPlans} />\n            <Route path=\"/admin\" component={AdminLogin} />\n            <Route path=\"/login\" component={Auth} />\n            <Route path=\"/register\" component={Auth} />\n            <Route path=\"/features\" component={Features} />\n            <Route path=\"/pricing\" component={Pricing} />\n            <Route path=\"/about\" component={About} />\n            <Route path=\"/contact\" component={Contact} />\n            <Route path=\"/how-it-works\" component={HowItWorks} />\n            <Route path=\"/\" component={Home} />\n            <Route component={NotFound} />\n          </Switch>\n        </main>\n        {!shouldHideFooter && <Footer />}\n      </div>\n    </WouterRouter>\n  );\n}\n\nfunction App() {\n  return (\n    <QueryClientProvider client={queryClient}>\n      <ThemeProvider defaultTheme=\"dark\" storageKey=\"vite-ui-theme\">\n        <AuthProvider>\n          <TooltipProvider>\n            <Toaster />\n            <Router />\n          </TooltipProvider>\n        </AuthProvider>\n      </ThemeProvider>\n    </QueryClientProvider>\n  );\n}\n\nexport default App;\n","path":null,"size_bytes":3073,"size_tokens":null},"client/src/pages/bulk-sms.tsx":{"content":"import { useState, useEffect } from \"react\";\nimport { useAuth } from \"@/lib/auth\";\nimport { Card, CardContent, CardHeader, CardTitle, CardDescription } from \"@/components/ui/card\";\nimport { Input } from \"@/components/ui/input\";\nimport { Search, Smartphone, Calendar as CalendarIcon, Send, Loader2 } from \"lucide-react\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { campaignsApi, leadsApi } from \"@/lib/api\";\nimport type { Campaign, Lead } from \"@shared/schema\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\";\nimport { Button } from \"@/components/ui/button\";\nimport { Textarea } from \"@/components/ui/textarea\";\n\nexport default function BulkSms() {\n  const { user } = useAuth();\n  const { toast } = useToast();\n  const [searchTerm, setSearchTerm] = useState(\"\");\n  const [campaignFilter, setCampaignFilter] = useState(\"all\");\n  const [dateRange, setDateRange] = useState({ start: \"\", end: \"\" });\n  const [campaigns, setCampaigns] = useState<Campaign[]>([]);\n  const [leads, setLeads] = useState<Lead[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [selectedLeads, setSelectedLeads] = useState<string[]>([]);\n  const [message, setMessage] = useState(\"\");\n  const [sending, setSending] = useState(false);\n\n  useEffect(() => {\n    const fetchData = async () => {\n      try {\n        const [cRes, lRes] = await Promise.all([\n          campaignsApi.getAll(),\n          leadsApi.getAll()\n        ]);\n        setCampaigns(Array.isArray(cRes) ? cRes : (cRes as any).campaigns || []);\n        setLeads(Array.isArray(lRes) ? lRes : (lRes as any).leads || []);\n      } catch (error: any) {\n        toast({ variant: \"destructive\", title: \"Error loading data\", description: error.message });\n      } finally {\n        setLoading(false);\n      }\n    };\n    fetchData();\n  }, [toast]);\n\n  const filteredLeads = leads.filter(lead => {\n    const nameStr = lead.name || \"\";\n    const phoneStr = lead.phone || \"\";\n    const matchesSearch = nameStr.toLowerCase().includes(searchTerm.toLowerCase()) || \n                         phoneStr.includes(searchTerm);\n    const matchesCampaign = campaignFilter === \"all\" || lead.campaignId === campaignFilter;\n    \n    let matchesDate = true;\n    if (dateRange.start || dateRange.end) {\n      const contactDate = lead.lastContact ? new Date(lead.lastContact) : new Date(lead.createdAt);\n      if (dateRange.start && contactDate < new Date(dateRange.start)) matchesDate = false;\n      if (dateRange.end && contactDate > new Date(dateRange.end)) matchesDate = false;\n    }\n\n    return matchesSearch && matchesCampaign && matchesDate;\n  });\n\n  const handleSelectAll = () => {\n    if (selectedLeads.length === filteredLeads.length && filteredLeads.length > 0) {\n      setSelectedLeads([]);\n    } else {\n      setSelectedLeads(filteredLeads.map(l => l._id));\n    }\n  };\n\n  const handleToggleLead = (id: string) => {\n    setSelectedLeads(prev => \n      prev.includes(id) ? prev.filter(i => i !== id) : [...prev, id]\n    );\n  };\n\n  const handleSendSms = async () => {\n    if (selectedLeads.length === 0) {\n      toast({ variant: \"destructive\", title: \"No leads selected\" });\n      return;\n    }\n    if (!message.trim()) {\n      toast({ variant: \"destructive\", title: \"Message cannot be empty\" });\n      return;\n    }\n\n    setSending(true);\n    try {\n      await new Promise(resolve => setTimeout(resolve, 1500));\n      toast({ title: \"Success\", description: `SMS sent to ${selectedLeads.length} leads.` });\n      setMessage(\"\");\n      setSelectedLeads([]);\n    } catch (error: any) {\n      toast({ variant: \"destructive\", title: \"Failed to send SMS\", description: error.message });\n    } finally {\n      setSending(false);\n    }\n  };\n\n  if (!user) return null;\n\n  if (loading) {\n    return (\n      <div className=\"flex items-center justify-center min-h-[400px]\">\n        <Loader2 className=\"h-8 w-8 animate-spin text-primary\" />\n        <span className=\"ml-2 text-muted-foreground\">Loading SMS data...</span>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"p-6 space-y-6\">\n      <div className=\"flex flex-col gap-2\">\n        <h1 className=\"text-3xl font-bold flex items-center gap-2\">\n          <Smartphone className=\"h-8 w-8 text-primary\" />\n          Bulk SMS\n        </h1>\n        <p className=\"text-muted-foreground\">Select leads and send bulk SMS messages.</p>\n      </div>\n\n      <div className=\"flex flex-wrap items-center gap-4 bg-muted/20 p-4 rounded-lg border border-border/50\">\n        <div className=\"relative min-w-[240px]\">\n          <Search className=\"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground\" />\n          <Input \n            placeholder=\"Search name or phone...\" \n            className=\"pl-9 h-9\" \n            value={searchTerm}\n            onChange={(e) => setSearchTerm(e.target.value)}\n          />\n        </div>\n\n        <Select value={campaignFilter} onValueChange={setCampaignFilter}>\n          <SelectTrigger className=\"w-[200px] h-9\">\n            <SelectValue placeholder=\"All Campaigns\" />\n          </SelectTrigger>\n          <SelectContent>\n            <SelectItem value=\"all\">All Campaigns</SelectItem>\n            {campaigns.map(c => (\n              <SelectItem key={c._id} value={c._id}>{c.name}</SelectItem>\n            ))}\n          </SelectContent>\n        </Select>\n\n        <div className=\"flex items-center gap-2 h-9\">\n          <Input \n            type=\"date\" \n            className=\"h-9 w-[150px]\"\n            value={dateRange.start} \n            onChange={(e) => setDateRange(prev => ({ ...prev, start: e.target.value }))}\n          />\n          <span className=\"text-muted-foreground\">â†’</span>\n          <Input \n            type=\"date\" \n            className=\"h-9 w-[150px]\"\n            value={dateRange.end} \n            onChange={(e) => setDateRange(prev => ({ ...prev, end: e.target.value }))}\n          />\n        </div>\n      </div>\n\n      <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-6\">\n        <div className=\"lg:col-span-2\">\n          <Card className=\"border-border/50\">\n            <CardHeader className=\"flex flex-row items-center justify-between gap-2\">\n              <div>\n                <CardTitle>SMS History</CardTitle>\n                <CardDescription>{filteredLeads.length} leads found</CardDescription>\n              </div>\n              <Button variant=\"outline\" size=\"sm\" onClick={handleSelectAll} className=\"h-8\">\n                {selectedLeads.length === filteredLeads.length && filteredLeads.length > 0 ? \"Deselect All\" : \"Select All\"}\n              </Button>\n            </CardHeader>\n            <CardContent>\n              <div className=\"rounded-md border h-[600px] overflow-auto\">\n                <table className=\"w-full text-sm\">\n                  <thead className=\"bg-muted/50 sticky top-0 z-10\">\n                    <tr>\n                      <th className=\"p-3 text-left w-10\">\n                        <input \n                          type=\"checkbox\" \n                          className=\"rounded border-gray-300\"\n                          checked={selectedLeads.length === filteredLeads.length && filteredLeads.length > 0}\n                          onChange={handleSelectAll}\n                        />\n                      </th>\n                      <th className=\"p-3 text-left\">Name</th>\n                      <th className=\"p-3 text-left\">Phone</th>\n                      <th className=\"p-3 text-left\">Campaign</th>\n                      <th className=\"p-3 text-left\">Status</th>\n                      <th className=\"p-3 text-left\">Last Interaction</th>\n                    </tr>\n                  </thead>\n                  <tbody>\n                    {filteredLeads.map(lead => (\n                      <tr key={lead._id} className=\"border-t hover:bg-muted/30 transition-colors\">\n                        <td className=\"p-3\">\n                          <input \n                            type=\"checkbox\" \n                            className=\"rounded border-gray-300\"\n                            checked={selectedLeads.includes(lead._id)}\n                            onChange={() => handleToggleLead(lead._id)}\n                          />\n                        </td>\n                        <td className=\"p-3 font-medium\">{lead.name}</td>\n                        <td className=\"p-3\">{lead.phone}</td>\n                        <td className=\"p-3\">\n                          {campaigns.find(c => c._id === lead.campaignId)?.name || \"-\"}\n                        </td>\n                        <td className=\"p-3\">\n                          <Badge variant=\"outline\">{lead.status}</Badge>\n                        </td>\n                        <td className=\"p-3 text-muted-foreground\">\n                          {lead.lastContact ? new Date(lead.lastContact).toLocaleDateString() : \"No contact\"}\n                        </td>\n                      </tr>\n                    ))}\n                    {filteredLeads.length === 0 && (\n                      <tr>\n                        <td colSpan={6} className=\"p-12 text-center text-muted-foreground\">\n                          No SMS records found matching your filters.\n                        </td>\n                      </tr>\n                    )}\n                  </tbody>\n                </table>\n              </div>\n            </CardContent>\n          </Card>\n        </div>\n\n        <div className=\"space-y-6\">\n          <Card className=\"border-border/50 h-fit sticky top-6\">\n            <CardHeader>\n              <CardTitle>Send Message</CardTitle>\n              <CardDescription>\n                {selectedLeads.length} leads selected\n              </CardDescription>\n            </CardHeader>\n            <CardContent className=\"space-y-4\">\n              <div className=\"space-y-2\">\n                <label className=\"text-sm font-medium\">Message</label>\n                <Textarea \n                  placeholder=\"Type your SMS message here...\" \n                  className=\"min-h-[200px] resize-none\"\n                  value={message}\n                  onChange={(e) => setMessage(e.target.value)}\n                />\n                <p className=\"text-xs text-muted-foreground text-right\">\n                  {message.length} characters\n                </p>\n              </div>\n              <Button \n                className=\"w-full\" \n                disabled={sending || selectedLeads.length === 0}\n                onClick={handleSendSms}\n              >\n                {sending ? <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" /> : null}\n                {sending ? \"Sending...\" : \"Send Bulk SMS\"}\n                <Send className=\"ml-2 h-4 w-4\" />\n              </Button>\n            </CardContent>\n          </Card>\n        </div>\n      </div>\n    </div>\n  );\n}\n","path":null,"size_bytes":10786,"size_tokens":null},"DEPLOYMENT_SUMMARY.md":{"content":"# ðŸš€ AIAgent Production Deployment - Complete Build Ready\n\n## ðŸ“¦ Download Your Production Build\n\nYour complete production build is ready to deploy! Here are the files you need:\n\n### Main Build Package\n- **File:** `aiagent-production-build.tar.gz` (5.3 MB)\n- **Contains:** Compiled frontend + backend, all source code, package.json, package-lock.json\n- **Ready:** Yes, fully compiled and optimized for production\n\n### Documentation Files  \n- **DEPLOYMENT_README.txt** - Comprehensive step-by-step guide\n- **.env.template** - Environment variables template\n- **PRODUCTION_DEPLOYMENT.md** - Technical deployment details\n\n## âš¡ Quick Deployment (3 Steps)\n\n```bash\n# 1. Extract on your server\ntar -xzf aiagent-production-build.tar.gz\n\n# 2. Install dependencies\nnpm install --production\n\n# 3. Create .env file and start\nnode dist/index.cjs\n```\n\n## âœ… What's Already Configured\n\n### Routing (Your Requirement)\nâœ… Base path set to `/aiagent/` for production\nâœ… After login redirects to `http://3.208.52.220/aiagent/dashboard/` âœ“\nâœ… NOT `http://3.208.52.220/dashboard/` âœ“\n\n### Frontend\nâœ… React + Vite fully optimized\nâœ… All pages under `/aiagent/` prefix\nâœ… CSS & JS minified (319 KB gzipped JS, 17.7 KB gzipped CSS)\nâœ… Images compressed and optimized\n\n### Backend\nâœ… Express.js compiled to production binary\nâœ… MongoDB integration ready\nâœ… Session management configured\nâœ… API routes working\nâœ… Static file serving enabled\n\n### Features Working\nâœ… Authentication (Login/Register)\nâœ… Campaign Management with search filtering\nâœ… Lead Management\nâœ… Notes with DataTable (all CRUD operations)\nâœ… Appointments\nâœ… Analytics Dashboard\nâœ… Admin Panel\nâœ… Dark/Light Theme\nâœ… Full responsive design\n\n## ðŸ“‹ Pre-Deployment Checklist\n\n- [ ] Download `aiagent-production-build.tar.gz`\n- [ ] Have MongoDB connection string ready\n- [ ] Have SSH access to EC2 instance\n- [ ] Apache is running and configured for `/aiagent/` proxy\n- [ ] Port 3000 is available on EC2\n\n## ðŸ”§ Deployment Steps\n\n### Step 1: Upload to Server\n```bash\nscp aiagent-production-build.tar.gz ec2-user@3.208.52.220:/var/www/\n```\n\n### Step 2: Extract & Setup\n```bash\nssh ec2-user@3.208.52.220\ncd /var/www\ntar -xzf aiagent-production-build.tar.gz\ncd dist && ls -la\n```\n\n### Step 3: Configure Environment\nCreate `/var/www/aiagent/.env`:\n```\nNODE_ENV=production\nPORT=3000\nMONGODB_URI=your_mongodb_connection_string\nSESSION_SECRET=your_random_secret_key\n```\n\n### Step 4: Install & Start\n```bash\nnpm install --production\nnode dist/index.cjs\n```\n\n### Step 5: Verify\n- Homepage: http://3.208.52.220/aiagent/\n- Login: http://3.208.52.220/aiagent/login\n- Dashboard: http://3.208.52.220/aiagent/dashboard/ (after login)\n\n## ðŸ“Š Build Statistics\n\n| Component | Size | Status |\n|-----------|------|--------|\n| JavaScript (gzipped) | 319 KB | âœ… Optimized |\n| CSS (gzipped) | 17.7 KB | âœ… Optimized |\n| Total Assets | 3.3 MB | âœ… Compressed |\n| Backend Binary | 2.3 MB | âœ… Compiled |\n| Build Time | 13.26s | âœ… Fast |\n\n## ðŸ”’ Security\n\n- Environment variables handled via .env (never committed)\n- Session secret required for production\n- NODE_ENV=production enables security optimizations\n- No hardcoded credentials in build\n- Ready for HTTPS (configure in Apache)\n\n## ðŸ“ Important Notes\n\n1. **MongoDB Connection:** Must be provided in .env\n2. **SESSION_SECRET:** Generate a strong random value\n3. **Node.js Version:** Requires Node.js 16+ (18+ recommended)\n4. **Apache Config:** Already handles `/aiagent/` proxy (from previous build)\n5. **Port 3000:** Must be accessible from localhost for Apache proxy\n\n## ðŸ†˜ Troubleshooting\n\n**Q: Getting blank page at `/aiagent/`?**\nA: Ensure Node.js is running: `curl http://localhost:3000/`\n\n**Q: API calls failing?**\nA: Check MongoDB URI in .env and verify connection\n\n**Q: Redirects to wrong path?**\nA: Already fixed in this build! Uses wouter base path `/aiagent/`\n\n**Q: Styling not loading?**\nA: Clear browser cache (Ctrl+Shift+Del)\n\nSee DEPLOYMENT_README.txt for full troubleshooting guide.\n\n## ðŸ“ž Support\n\nAll features have been tested and are production-ready. If you encounter issues:\n\n1. Check application logs\n2. Verify .env configuration\n3. Test MongoDB connectivity\n4. Confirm Apache proxy setup\n5. Review DEPLOYMENT_README.txt section on troubleshooting\n\n---\n\n**Build Date:** December 21, 2025\n**Status:** âœ… READY FOR PRODUCTION\n**Tested:** âœ… YES\n**Optimized:** âœ… YES\n\nYour deployment is ready to go! Follow the 3-step Quick Deployment guide above.\n","path":null,"size_bytes":4491,"size_tokens":null},"client/src/pages/auth.tsx":{"content":"import { Button } from \"@/components/ui/button\";\nimport { Card, CardContent, CardDescription, CardFooter, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\nimport { Phone, ArrowLeft, Loader2 } from \"lucide-react\";\nimport { Link, useLocation } from \"wouter\";\nimport { useState } from \"react\";\nimport { useAuth } from \"@/lib/auth\";\nimport { authApi } from \"@/lib/api\";\nimport { useToast } from \"@/hooks/use-toast\";\n\nexport default function Auth() {\n  const [location, setLocation] = useLocation();\n  const isLogin = location === \"/login\";\n  const { login } = useAuth();\n  const { toast } = useToast();\n  const [isLoading, setIsLoading] = useState(false);\n\n  const handleLogin = async (e: React.FormEvent<HTMLFormElement>) => {\n    e.preventDefault();\n    setIsLoading(true);\n    const formData = new FormData(e.currentTarget);\n    const email = formData.get(\"email\") as string;\n    const password = formData.get(\"password\") as string;\n\n    try {\n      await login(email, password);\n      toast({\n        title: \"Welcome back!\",\n        description: \"You've successfully logged in.\",\n      });\n    } catch (error: any) {\n      toast({\n        variant: \"destructive\",\n        title: \"Login failed\",\n        description: error.message || \"Invalid email or password\",\n      });\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  const handleRegister = async (e: React.FormEvent<HTMLFormElement>) => {\n    e.preventDefault();\n    setIsLoading(true);\n    const formData = new FormData(e.currentTarget);\n    const firstName = formData.get(\"first-name\") as string;\n    const lastName = formData.get(\"last-name\") as string;\n    const email = formData.get(\"reg-email\") as string;\n    const password = formData.get(\"reg-password\") as string;\n    \n    const queryParams = new URLSearchParams(window.location.search);\n    const selectedPlanId = queryParams.get(\"plan\");\n\n    if (!selectedPlanId) {\n      toast({\n        variant: \"destructive\",\n        title: \"Plan required\",\n        description: \"Please select a pricing plan before registering.\",\n      });\n      setLocation(\"/pricing\");\n      return;\n    }\n\n    try {\n      const user = await authApi.register({\n        email,\n        password,\n        firstName,\n        lastName,\n        role: \"user\",\n        selectedPlanId: selectedPlanId || undefined,\n      });\n\n      // No login here yet, wait for payment\n      \n      const response = await fetch(`/api/plans/${selectedPlanId}`);\n      const plan = await response.json();\n\n      if (plan && plan.price === 0) {\n        // For free plan, we can login and redirect\n        await login(email, password);\n        toast({\n          title: \"Account created!\",\n          description: \"Free Plan Activated. Welcome to NIJVOX!\",\n        });\n        setLocation(\"/dashboard\");\n      } else {\n        toast({\n          title: \"Account created!\",\n          description: \"Please complete the payment to activate your account.\",\n        });\n        // Redirect to payment page with email for prefill\n        setLocation(`/payment?plan=${selectedPlanId}&email=${encodeURIComponent(email)}`);\n      }\n      \n    } catch (error: any) {\n      toast({\n        variant: \"destructive\",\n        title: \"Registration failed\",\n        description: error.message || \"Could not create account\",\n      });\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  return (\n    <div className=\"min-h-screen flex items-center justify-center bg-muted/20 px-4\">\n      <div className=\"absolute top-8 left-8\">\n        <Link href=\"/\" className=\"flex items-center text-muted-foreground hover:text-foreground transition-colors\">\n          <ArrowLeft className=\"mr-2 h-4 w-4\" /> Back to Home\n        </Link>\n      </div>\n\n      <Card className=\"w-full max-w-md border-primary/10 shadow-xl shadow-primary/5\">\n        <CardHeader className=\"text-center space-y-2\">\n          <div className=\"flex justify-center mb-4\">\n            <div className=\"flex h-12 w-12 items-center justify-center rounded-xl bg-primary text-primary-foreground\">\n              <Phone className=\"h-6 w-6\" />\n            </div>\n          </div>\n          <CardTitle className=\"text-2xl font-bold tracking-tighter\">NIJVOX</CardTitle>\n          <CardDescription>\n            Sign in to your account or create a new one to get started.\n          </CardDescription>\n        </CardHeader>\n        <CardContent>\n          <Tabs defaultValue={isLogin ? \"login\" : \"register\"} className=\"w-full\" onValueChange={(val) => setLocation(val === \"login\" ? \"/login\" : \"/register\")}>\n            <TabsList className=\"grid w-full grid-cols-2 mb-8\">\n              <TabsTrigger value=\"login\">Login</TabsTrigger>\n              <TabsTrigger value=\"register\">Register</TabsTrigger>\n            </TabsList>\n            \n            <TabsContent value=\"login\">\n              <form className=\"space-y-4\" onSubmit={handleLogin}>\n                <div className=\"space-y-2\">\n                  <Label htmlFor=\"email\">Email</Label>\n                  <Input \n                    id=\"email\" \n                    name=\"email\"\n                    type=\"email\" \n                    placeholder=\"name@example.com\" \n                    required \n                    data-testid=\"input-email\"\n                    disabled={isLoading}\n                  />\n                </div>\n                <div className=\"space-y-2\">\n                  <div className=\"flex justify-between items-center\">\n                    <Label htmlFor=\"password\">Password</Label>\n                    <a href=\"#\" className=\"text-xs text-primary hover:underline\">Forgot password?</a>\n                  </div>\n                  <Input \n                    id=\"password\" \n                    name=\"password\"\n                    type=\"password\" \n                    required \n                    data-testid=\"input-password\"\n                    disabled={isLoading}\n                  />\n                </div>\n                <Button type=\"submit\" className=\"w-full h-10\" data-testid=\"button-login\" disabled={isLoading}>\n                  {isLoading ? (\n                    <>\n                      <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" />\n                      Signing in...\n                    </>\n                  ) : (\n                    \"Sign In\"\n                  )}\n                </Button>\n              </form>\n            </TabsContent>\n            \n            <TabsContent value=\"register\">\n              <form className=\"space-y-4\" onSubmit={handleRegister}>\n                <div className=\"grid grid-cols-2 gap-4\">\n                  <div className=\"space-y-2\">\n                    <Label htmlFor=\"first-name\">First name</Label>\n                    <Input \n                      id=\"first-name\" \n                      name=\"first-name\"\n                      placeholder=\"John\" \n                      required \n                      data-testid=\"input-firstname\"\n                      disabled={isLoading}\n                    />\n                  </div>\n                  <div className=\"space-y-2\">\n                    <Label htmlFor=\"last-name\">Last name</Label>\n                    <Input \n                      id=\"last-name\" \n                      name=\"last-name\"\n                      placeholder=\"Doe\" \n                      required \n                      data-testid=\"input-lastname\"\n                      disabled={isLoading}\n                    />\n                  </div>\n                </div>\n                <div className=\"space-y-2\">\n                  <Label htmlFor=\"reg-email\">Email</Label>\n                  <Input \n                    id=\"reg-email\" \n                    name=\"reg-email\"\n                    type=\"email\" \n                    placeholder=\"name@example.com\" \n                    required \n                    data-testid=\"input-reg-email\"\n                    disabled={isLoading}\n                  />\n                </div>\n                <div className=\"space-y-2\">\n                  <Label htmlFor=\"reg-password\">Password</Label>\n                  <Input \n                    id=\"reg-password\" \n                    name=\"reg-password\"\n                    type=\"password\" \n                    required \n                    minLength={6}\n                    data-testid=\"input-reg-password\"\n                    disabled={isLoading}\n                  />\n                </div>\n                <Button type=\"submit\" className=\"w-full h-10\" data-testid=\"button-register\" disabled={isLoading}>\n                  {isLoading ? (\n                    <>\n                      <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" />\n                      Creating account...\n                    </>\n                  ) : (\n                    \"Create Account\"\n                  )}\n                </Button>\n              </form>\n            </TabsContent>\n          </Tabs>\n        </CardContent>\n        <CardFooter className=\"justify-center border-t p-6 text-sm text-muted-foreground\">\n          By clicking continue, you agree to our <a href=\"#\" className=\"underline hover:text-primary ml-1\">Terms of Service</a>\n        </CardFooter>\n      </Card>\n    </div>\n  );\n}\n","path":null,"size_bytes":9260,"size_tokens":null},"server/vite.ts":{"content":"import { type Express } from \"express\";\nimport { createServer as createViteServer, createLogger } from \"vite\";\nimport { type Server } from \"http\";\nimport viteConfig from \"../vite.config\";\nimport fs from \"fs\";\nimport path from \"path\";\nimport { nanoid } from \"nanoid\";\n\nconst viteLogger = createLogger();\n\nexport async function setupVite(server: Server, app: Express) {\n  const serverOptions = {\n    middlewareMode: true,\n    hmr: { server, path: \"/vite-hmr\" },\n    allowedHosts: true as const,\n  };\n\n  const vite = await createViteServer({\n    ...viteConfig,\n    configFile: false,\n    customLogger: {\n      ...viteLogger,\n      error: (msg, options) => {\n        viteLogger.error(msg, options);\n        process.exit(1);\n      },\n    },\n    server: serverOptions,\n    appType: \"custom\",\n  });\n\n  app.use(vite.middlewares);\n\n  app.use(\"*\", async (req, res, next) => {\n    const url = req.originalUrl;\n\n    try {\n      const clientTemplate = path.resolve(\n        import.meta.dirname,\n        \"..\",\n        \"client\",\n        \"index.html\",\n      );\n\n      // always reload the index.html file from disk incase it changes\n      let template = await fs.promises.readFile(clientTemplate, \"utf-8\");\n      template = template.replace(\n        `src=\"/src/main.tsx\"`,\n        `src=\"/src/main.tsx?v=${nanoid()}\"`,\n      );\n      const page = await vite.transformIndexHtml(url, template);\n      res.status(200).set({ \"Content-Type\": \"text/html\" }).end(page);\n    } catch (e) {\n      vite.ssrFixStacktrace(e as Error);\n      next(e);\n    }\n  });\n}\n","path":null,"size_bytes":1534,"size_tokens":null},"client/src/components/ui/select.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as SelectPrimitive from \"@radix-ui/react-select\"\nimport { Check, ChevronDown, ChevronUp } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Select = SelectPrimitive.Root\n\nconst SelectGroup = SelectPrimitive.Group\n\nconst SelectValue = SelectPrimitive.Value\n\nconst SelectTrigger = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Trigger>\n>(({ className, children, ...props }, ref) => (\n  <SelectPrimitive.Trigger\n    ref={ref}\n    className={cn(\n      \"flex h-9 w-full items-center justify-between whitespace-nowrap rounded-md border border-input bg-transparent px-3 py-2 text-sm shadow-sm ring-offset-background data-[placeholder]:text-muted-foreground focus:outline-none focus:ring-1 focus:ring-ring disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <SelectPrimitive.Icon asChild>\n      <ChevronDown className=\"h-4 w-4 opacity-50\" />\n    </SelectPrimitive.Icon>\n  </SelectPrimitive.Trigger>\n))\nSelectTrigger.displayName = SelectPrimitive.Trigger.displayName\n\nconst SelectScrollUpButton = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.ScrollUpButton>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.ScrollUpButton>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.ScrollUpButton\n    ref={ref}\n    className={cn(\n      \"flex cursor-default items-center justify-center py-1\",\n      className\n    )}\n    {...props}\n  >\n    <ChevronUp className=\"h-4 w-4\" />\n  </SelectPrimitive.ScrollUpButton>\n))\nSelectScrollUpButton.displayName = SelectPrimitive.ScrollUpButton.displayName\n\nconst SelectScrollDownButton = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.ScrollDownButton>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.ScrollDownButton>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.ScrollDownButton\n    ref={ref}\n    className={cn(\n      \"flex cursor-default items-center justify-center py-1\",\n      className\n    )}\n    {...props}\n  >\n    <ChevronDown className=\"h-4 w-4\" />\n  </SelectPrimitive.ScrollDownButton>\n))\nSelectScrollDownButton.displayName =\n  SelectPrimitive.ScrollDownButton.displayName\n\nconst SelectContent = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Content>\n>(({ className, children, position = \"popper\", ...props }, ref) => (\n  <SelectPrimitive.Portal>\n    <SelectPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"relative z-50 max-h-[--radix-select-content-available-height] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-select-content-transform-origin]\",\n        position === \"popper\" &&\n          \"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1\",\n        className\n      )}\n      position={position}\n      {...props}\n    >\n      <SelectScrollUpButton />\n      <SelectPrimitive.Viewport\n        className={cn(\n          \"p-1\",\n          position === \"popper\" &&\n            \"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]\"\n        )}\n      >\n        {children}\n      </SelectPrimitive.Viewport>\n      <SelectScrollDownButton />\n    </SelectPrimitive.Content>\n  </SelectPrimitive.Portal>\n))\nSelectContent.displayName = SelectPrimitive.Content.displayName\n\nconst SelectLabel = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Label>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.Label\n    ref={ref}\n    className={cn(\"px-2 py-1.5 text-sm font-semibold\", className)}\n    {...props}\n  />\n))\nSelectLabel.displayName = SelectPrimitive.Label.displayName\n\nconst SelectItem = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Item>\n>(({ className, children, ...props }, ref) => (\n  <SelectPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-2 pr-8 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute right-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <SelectPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </SelectPrimitive.ItemIndicator>\n    </span>\n    <SelectPrimitive.ItemText>{children}</SelectPrimitive.ItemText>\n  </SelectPrimitive.Item>\n))\nSelectItem.displayName = SelectPrimitive.Item.displayName\n\nconst SelectSeparator = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-muted\", className)}\n    {...props}\n  />\n))\nSelectSeparator.displayName = SelectPrimitive.Separator.displayName\n\nexport {\n  Select,\n  SelectGroup,\n  SelectValue,\n  SelectTrigger,\n  SelectContent,\n  SelectLabel,\n  SelectItem,\n  SelectSeparator,\n  SelectScrollUpButton,\n  SelectScrollDownButton,\n}\n","path":null,"size_bytes":5745,"size_tokens":null},"client/src/components/ui/aspect-ratio.tsx":{"content":"import * as AspectRatioPrimitive from \"@radix-ui/react-aspect-ratio\"\n\nconst AspectRatio = AspectRatioPrimitive.Root\n\nexport { AspectRatio }\n","path":null,"size_bytes":140,"size_tokens":null},"client/src/components/ui/field.tsx":{"content":"\"use client\"\n\nimport { useMemo } from \"react\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Label } from \"@/components/ui/label\"\nimport { Separator } from \"@/components/ui/separator\"\n\nfunction FieldSet({ className, ...props }: React.ComponentProps<\"fieldset\">) {\n  return (\n    <fieldset\n      data-slot=\"field-set\"\n      className={cn(\n        \"flex flex-col gap-6\",\n        \"has-[>[data-slot=checkbox-group]]:gap-3 has-[>[data-slot=radio-group]]:gap-3\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction FieldLegend({\n  className,\n  variant = \"legend\",\n  ...props\n}: React.ComponentProps<\"legend\"> & { variant?: \"legend\" | \"label\" }) {\n  return (\n    <legend\n      data-slot=\"field-legend\"\n      data-variant={variant}\n      className={cn(\n        \"mb-3 font-medium\",\n        \"data-[variant=legend]:text-base\",\n        \"data-[variant=label]:text-sm\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction FieldGroup({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"field-group\"\n      className={cn(\n        \"group/field-group @container/field-group flex w-full flex-col gap-7 data-[slot=checkbox-group]:gap-3 [&>[data-slot=field-group]]:gap-4\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nconst fieldVariants = cva(\n  \"group/field data-[invalid=true]:text-destructive flex w-full gap-3\",\n  {\n    variants: {\n      orientation: {\n        vertical: [\"flex-col [&>*]:w-full [&>.sr-only]:w-auto\"],\n        horizontal: [\n          \"flex-row items-center\",\n          \"[&>[data-slot=field-label]]:flex-auto\",\n          \"has-[>[data-slot=field-content]]:[&>[role=checkbox],[role=radio]]:mt-px has-[>[data-slot=field-content]]:items-start\",\n        ],\n        responsive: [\n          \"@md/field-group:flex-row @md/field-group:items-center @md/field-group:[&>*]:w-auto flex-col [&>*]:w-full [&>.sr-only]:w-auto\",\n          \"@md/field-group:[&>[data-slot=field-label]]:flex-auto\",\n          \"@md/field-group:has-[>[data-slot=field-content]]:items-start @md/field-group:has-[>[data-slot=field-content]]:[&>[role=checkbox],[role=radio]]:mt-px\",\n        ],\n      },\n    },\n    defaultVariants: {\n      orientation: \"vertical\",\n    },\n  }\n)\n\nfunction Field({\n  className,\n  orientation = \"vertical\",\n  ...props\n}: React.ComponentProps<\"div\"> & VariantProps<typeof fieldVariants>) {\n  return (\n    <div\n      role=\"group\"\n      data-slot=\"field\"\n      data-orientation={orientation}\n      className={cn(fieldVariants({ orientation }), className)}\n      {...props}\n    />\n  )\n}\n\nfunction FieldContent({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"field-content\"\n      className={cn(\n        \"group/field-content flex flex-1 flex-col gap-1.5 leading-snug\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction FieldLabel({\n  className,\n  ...props\n}: React.ComponentProps<typeof Label>) {\n  return (\n    <Label\n      data-slot=\"field-label\"\n      className={cn(\n        \"group/field-label peer/field-label flex w-fit gap-2 leading-snug group-data-[disabled=true]/field:opacity-50\",\n        \"has-[>[data-slot=field]]:w-full has-[>[data-slot=field]]:flex-col has-[>[data-slot=field]]:rounded-md has-[>[data-slot=field]]:border [&>[data-slot=field]]:p-4\",\n        \"has-data-[state=checked]:bg-primary/5 has-data-[state=checked]:border-primary dark:has-data-[state=checked]:bg-primary/10\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction FieldTitle({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"field-label\"\n      className={cn(\n        \"flex w-fit items-center gap-2 text-sm font-medium leading-snug group-data-[disabled=true]/field:opacity-50\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction FieldDescription({ className, ...props }: React.ComponentProps<\"p\">) {\n  return (\n    <p\n      data-slot=\"field-description\"\n      className={cn(\n        \"text-muted-foreground text-sm font-normal leading-normal group-has-[[data-orientation=horizontal]]/field:text-balance\",\n        \"nth-last-2:-mt-1 last:mt-0 [[data-variant=legend]+&]:-mt-1.5\",\n        \"[&>a:hover]:text-primary [&>a]:underline [&>a]:underline-offset-4\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction FieldSeparator({\n  children,\n  className,\n  ...props\n}: React.ComponentProps<\"div\"> & {\n  children?: React.ReactNode\n}) {\n  return (\n    <div\n      data-slot=\"field-separator\"\n      data-content={!!children}\n      className={cn(\n        \"relative -my-2 h-5 text-sm group-data-[variant=outline]/field-group:-mb-2\",\n        className\n      )}\n      {...props}\n    >\n      <Separator className=\"absolute inset-0 top-1/2\" />\n      {children && (\n        <span\n          className=\"bg-background text-muted-foreground relative mx-auto block w-fit px-2\"\n          data-slot=\"field-separator-content\"\n        >\n          {children}\n        </span>\n      )}\n    </div>\n  )\n}\n\nfunction FieldError({\n  className,\n  children,\n  errors,\n  ...props\n}: React.ComponentProps<\"div\"> & {\n  errors?: Array<{ message?: string } | undefined>\n}) {\n  const content = useMemo(() => {\n    if (children) {\n      return children\n    }\n\n    if (!errors) {\n      return null\n    }\n\n    if (errors?.length === 1 && errors[0]?.message) {\n      return errors[0].message\n    }\n\n    return (\n      <ul className=\"ml-4 flex list-disc flex-col gap-1\">\n        {errors.map(\n          (error, index) =>\n            error?.message && <li key={index}>{error.message}</li>\n        )}\n      </ul>\n    )\n  }, [children, errors])\n\n  if (!content) {\n    return null\n  }\n\n  return (\n    <div\n      role=\"alert\"\n      data-slot=\"field-error\"\n      className={cn(\"text-destructive text-sm font-normal\", className)}\n      {...props}\n    >\n      {content}\n    </div>\n  )\n}\n\nexport {\n  Field,\n  FieldLabel,\n  FieldDescription,\n  FieldError,\n  FieldGroup,\n  FieldLegend,\n  FieldSeparator,\n  FieldSet,\n  FieldContent,\n  FieldTitle,\n}\n","path":null,"size_bytes":6044,"size_tokens":null},"client/src/pages/notifications.tsx":{"content":"import { useState, useEffect } from \"react\";\nimport { useAuth } from \"@/lib/auth\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { ScrollArea } from \"@/components/ui/scroll-area\";\nimport { Bell, Clock, Info, X } from \"lucide-react\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Button } from \"@/components/ui/button\";\nimport { useLocation } from \"wouter\";\nimport { apiRequest } from \"@/lib/queryClient\";\n\nexport default function Notifications() {\n  const { user } = useAuth();\n  const [location, setLocation] = useLocation();\n  const [notifications, setNotifications] = useState<any[]>([]);\n\n  useEffect(() => {\n    const fetchNotifications = async () => {\n      try {\n        const res = await apiRequest(\"GET\", \"/api/notifications\");\n        const data = await res.json();\n        setNotifications(data.notifications || []);\n      } catch (error) {\n        console.error(\"Failed to fetch notifications:\", error);\n      }\n    };\n    fetchNotifications();\n  }, []);\n\n  const goToOverview = () => {\n    setLocation(\"/dashboard\");\n  };\n\n  const removeNotification = async (id: string) => {\n    try {\n      await apiRequest(\"POST\", `/api/notifications/${id}/read`);\n      setNotifications(prev => prev.filter(n => n._id !== id));\n    } catch (error) {\n      console.error(\"Failed to mark notification as read:\", error);\n    }\n  };\n\n  const userNotifications = notifications.filter(n => n.type === \"notification\" && !n.readBy.includes(user?._id));\n\n  return (\n    <div className=\"container mx-auto p-6 max-w-4xl relative\">\n      <Button \n        variant=\"ghost\" \n        size=\"icon\" \n        className=\"absolute right-6 top-6\"\n        onClick={goToOverview}\n      >\n        <X className=\"h-6 w-6\" />\n      </Button>\n\n      <div className=\"flex items-center gap-2 mb-8\">\n        <Bell className=\"h-6 w-6 text-primary\" />\n        <h1 className=\"text-3xl font-bold\">Notifications</h1>\n      </div>\n\n      <ScrollArea className=\"h-[calc(100vh-200px)]\">\n        <div className=\"space-y-4\">\n          {userNotifications.map((n) => (\n            <Card key={n._id} className=\"hover-elevate transition-all border-l-4 border-l-primary relative group\">\n              <Button \n                variant=\"ghost\" \n                size=\"icon\" \n                className=\"absolute right-2 top-2 h-8 w-8 opacity-0 group-hover:opacity-100 transition-opacity\"\n                onClick={() => removeNotification(n._id)}\n              >\n                <X className=\"h-4 w-4\" />\n              </Button>\n              <CardHeader className=\"pb-2\">\n                <div className=\"flex items-center justify-between pr-8\">\n                  <CardTitle className=\"text-lg flex items-center gap-2 font-semibold\">\n                    Notification\n                  </CardTitle>\n                  <Badge variant=\"outline\" className=\"text-xs\">\n                    <Clock className=\"h-3 w-3 mr-1\" />\n                    {new Date(n.createdAt).toLocaleDateString()}\n                  </Badge>\n                </div>\n              </CardHeader>\n              <CardContent>\n                <p className=\"text-muted-foreground\">{n.message}</p>\n              </CardContent>\n            </Card>\n          ))}\n          {userNotifications.length === 0 && (\n            <div className=\"text-center py-12 text-muted-foreground\">\n              No notifications yet.\n            </div>\n          )}\n        </div>\n      </ScrollArea>\n    </div>\n  );\n}\n","path":null,"size_bytes":3457,"size_tokens":null},"client/src/lib/utils.ts":{"content":"import { clsx, type ClassValue } from \"clsx\"\nimport { twMerge } from \"tailwind-merge\"\n\nexport function cn(...inputs: ClassValue[]) {\n  return twMerge(clsx(inputs))\n}\n","path":null,"size_bytes":166,"size_tokens":null},"client/src/components/ui/input-group.tsx":{"content":"import * as React from \"react\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Button } from \"@/components/ui/button\"\nimport { Input } from \"@/components/ui/input\"\nimport { Textarea } from \"@/components/ui/textarea\"\n\nfunction InputGroup({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"input-group\"\n      role=\"group\"\n      className={cn(\n        \"group/input-group border-input dark:bg-input/30 shadow-xs relative flex w-full items-center rounded-md border outline-none transition-[color,box-shadow]\",\n        \"h-9 has-[>textarea]:h-auto\",\n\n        // Variants based on alignment.\n        \"has-[>[data-align=inline-start]]:[&>input]:pl-2\",\n        \"has-[>[data-align=inline-end]]:[&>input]:pr-2\",\n        \"has-[>[data-align=block-start]]:h-auto has-[>[data-align=block-start]]:flex-col has-[>[data-align=block-start]]:[&>input]:pb-3\",\n        \"has-[>[data-align=block-end]]:h-auto has-[>[data-align=block-end]]:flex-col has-[>[data-align=block-end]]:[&>input]:pt-3\",\n\n        // Focus state.\n        \"has-[[data-slot=input-group-control]:focus-visible]:ring-ring has-[[data-slot=input-group-control]:focus-visible]:ring-1\",\n\n        // Error state.\n        \"has-[[data-slot][aria-invalid=true]]:ring-destructive/20 has-[[data-slot][aria-invalid=true]]:border-destructive dark:has-[[data-slot][aria-invalid=true]]:ring-destructive/40\",\n\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nconst inputGroupAddonVariants = cva(\n  \"text-muted-foreground flex h-auto cursor-text select-none items-center justify-center gap-2 py-1.5 text-sm font-medium group-data-[disabled=true]/input-group:opacity-50 [&>kbd]:rounded-[calc(var(--radius)-5px)] [&>svg:not([class*='size-'])]:size-4\",\n  {\n    variants: {\n      align: {\n        \"inline-start\":\n          \"order-first pl-3 has-[>button]:ml-[-0.45rem] has-[>kbd]:ml-[-0.35rem]\",\n        \"inline-end\":\n          \"order-last pr-3 has-[>button]:mr-[-0.4rem] has-[>kbd]:mr-[-0.35rem]\",\n        \"block-start\":\n          \"[.border-b]:pb-3 order-first w-full justify-start px-3 pt-3 group-has-[>input]/input-group:pt-2.5\",\n        \"block-end\":\n          \"[.border-t]:pt-3 order-last w-full justify-start px-3 pb-3 group-has-[>input]/input-group:pb-2.5\",\n      },\n    },\n    defaultVariants: {\n      align: \"inline-start\",\n    },\n  }\n)\n\nfunction InputGroupAddon({\n  className,\n  align = \"inline-start\",\n  ...props\n}: React.ComponentProps<\"div\"> & VariantProps<typeof inputGroupAddonVariants>) {\n  return (\n    <div\n      role=\"group\"\n      data-slot=\"input-group-addon\"\n      data-align={align}\n      className={cn(inputGroupAddonVariants({ align }), className)}\n      onClick={(e) => {\n        if ((e.target as HTMLElement).closest(\"button\")) {\n          return\n        }\n        e.currentTarget.parentElement?.querySelector(\"input\")?.focus()\n      }}\n      {...props}\n    />\n  )\n}\n\nconst inputGroupButtonVariants = cva(\n  \"flex items-center gap-2 text-sm shadow-none\",\n  {\n    variants: {\n      size: {\n        xs: \"h-6 gap-1 rounded-[calc(var(--radius)-5px)] px-2 has-[>svg]:px-2 [&>svg:not([class*='size-'])]:size-3.5\",\n        sm: \"h-8 gap-1.5 rounded-md px-2.5 has-[>svg]:px-2.5\",\n        \"icon-xs\":\n          \"size-6 rounded-[calc(var(--radius)-5px)] p-0 has-[>svg]:p-0\",\n        \"icon-sm\": \"size-8 p-0 has-[>svg]:p-0\",\n      },\n    },\n    defaultVariants: {\n      size: \"xs\",\n    },\n  }\n)\n\nfunction InputGroupButton({\n  className,\n  type = \"button\",\n  variant = \"ghost\",\n  size = \"xs\",\n  ...props\n}: Omit<React.ComponentProps<typeof Button>, \"size\"> &\n  VariantProps<typeof inputGroupButtonVariants>) {\n  return (\n    <Button\n      type={type}\n      data-size={size}\n      variant={variant}\n      className={cn(inputGroupButtonVariants({ size }), className)}\n      {...props}\n    />\n  )\n}\n\nfunction InputGroupText({ className, ...props }: React.ComponentProps<\"span\">) {\n  return (\n    <span\n      className={cn(\n        \"text-muted-foreground flex items-center gap-2 text-sm [&_svg:not([class*='size-'])]:size-4 [&_svg]:pointer-events-none\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction InputGroupInput({\n  className,\n  ...props\n}: React.ComponentProps<\"input\">) {\n  return (\n    <Input\n      data-slot=\"input-group-control\"\n      className={cn(\n        \"flex-1 rounded-none border-0 bg-transparent shadow-none focus-visible:ring-0 dark:bg-transparent\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction InputGroupTextarea({\n  className,\n  ...props\n}: React.ComponentProps<\"textarea\">) {\n  return (\n    <Textarea\n      data-slot=\"input-group-control\"\n      className={cn(\n        \"flex-1 resize-none rounded-none border-0 bg-transparent py-3 shadow-none focus-visible:ring-0 dark:bg-transparent\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nexport {\n  InputGroup,\n  InputGroupAddon,\n  InputGroupButton,\n  InputGroupText,\n  InputGroupInput,\n  InputGroupTextarea,\n}\n","path":null,"size_bytes":4971,"size_tokens":null},"aiagent-deployment.tar/aiagent-deployment/stop.sh":{"content":"#!/bin/bash\n\n# Stop script for AIAgent Application\n\nAPP_DIR=\"$(cd \"$(dirname \"${BASH_SOURCE[0]}\")\" && pwd)\"\nPID_FILE=\"$APP_DIR/app.pid\"\n\nif [ -f \"$PID_FILE\" ]; then\n    PID=$(cat \"$PID_FILE\")\n    if kill -0 \"$PID\" 2>/dev/null; then\n        kill \"$PID\"\n        rm \"$PID_FILE\"\n        echo \"Application stopped successfully\"\n    else\n        echo \"Application is not running\"\n        rm \"$PID_FILE\"\n    fi\nelse\n    echo \"PID file not found. Application may not be running.\"\nfi\n","path":null,"size_bytes":475,"size_tokens":null},"deploy/DEPLOYMENT_README.md":{"content":"# NIJVOX Deployment Guide for AWS EC2 with Apache\n\nThis guide explains how to deploy NIJVOX to an AWS EC2 instance with Apache serving the frontend and proxying API requests to the Node.js backend.\n\n## Prerequisites\n\n- AWS EC2 instance with Ubuntu/Amazon Linux\n- Apache2 installed and running\n- Node.js 18+ installed\n- PM2 installed globally (`npm install -g pm2`)\n- MongoDB Atlas connection string\n\n## Deployment Structure\n\n```\n/var/www/html/aiagent/\nâ”œâ”€â”€ public/           # Frontend static files (built React app)\nâ”‚   â”œâ”€â”€ index.html\nâ”‚   â”œâ”€â”€ assets/\nâ”‚   â””â”€â”€ ...\nâ”œâ”€â”€ dist/\nâ”‚   â””â”€â”€ index.cjs     # Backend compiled code\nâ”œâ”€â”€ uploads/          # File uploads directory\nâ”œâ”€â”€ node_modules/     # Production dependencies\nâ”œâ”€â”€ package.json\nâ”œâ”€â”€ .env              # Environment variables\nâ””â”€â”€ ecosystem.config.cjs  # PM2 configuration\n```\n\n## Step-by-Step Deployment\n\n### 1. Build the Application (on your development machine)\n\n```bash\n# Install dependencies\nnpm install\n\n# Build both frontend and backend\nnpm run build\n```\n\nThis creates:\n- `dist/public/` - Frontend static files\n- `dist/index.cjs` - Backend compiled code\n\n### 2. Prepare Files for Upload\n\nCreate a deployment package with these files/folders:\n- `dist/` folder (entire folder)\n- `package.json`\n- `package-lock.json`\n- `deploy/ecosystem.config.cjs`\n- `deploy/.env.production` (rename to `.env` on server)\n\n### 3. Upload to EC2\n\n```bash\n# Using SCP (replace with your EC2 details)\nscp -i your-key.pem -r dist package.json package-lock.json deploy/ecosystem.config.cjs ubuntu@3.208.52.220:/tmp/aiagent/\n```\n\n### 4. Setup on EC2\n\n```bash\n# SSH into your EC2 instance\nssh -i your-key.pem ubuntu@3.208.52.220\n\n# Create application directory\nsudo mkdir -p /var/www/html/aiagent\nsudo chown -R $USER:$USER /var/www/html/aiagent\n\n# Move files\ncp -r /tmp/aiagent/* /var/www/html/aiagent/\n\n# Rename dist/public to public (for Apache serving)\nmv /var/www/html/aiagent/dist/public /var/www/html/aiagent/public\n\n# Create uploads directory\nmkdir -p /var/www/html/aiagent/uploads\nchmod 755 /var/www/html/aiagent/uploads\n\n# Install production dependencies\ncd /var/www/html/aiagent\nnpm install --production\n\n# Create .env file from template\ncp deploy/.env.production .env\nnano .env  # Edit with your actual values\n```\n\n### 5. Configure Environment Variables\n\nEdit `/var/www/html/aiagent/.env`:\n\n```env\nMONGODB_URI=mongodb+srv://your-username:your-password@your-cluster.mongodb.net/nijvox?retryWrites=true&w=majority\nPORT=6331\nNODE_ENV=production\nSESSION_SECRET=generate-a-secure-random-string-at-least-32-characters\nTRUST_PROXY=true\n```\n\n### 6. Setup Apache\n\n```bash\n# Enable required Apache modules\nsudo a2enmod proxy proxy_http rewrite headers\n\n# Copy Apache configuration\nsudo cp /var/www/html/aiagent/deploy/apache-aiagent.conf /etc/apache2/sites-available/aiagent.conf\n\n# Or add to existing default site:\nsudo nano /etc/apache2/sites-available/000-default.conf\n```\n\nAdd this inside your `<VirtualHost *:80>` block:\n\n```apache\n# NIJVOX AI Agent Application\nAlias /aiagent /var/www/html/aiagent/public\n\n<Directory /var/www/html/aiagent/public>\n    Options -Indexes +FollowSymLinks\n    AllowOverride All\n    Require all granted\n    \n    RewriteEngine On\n    RewriteBase /aiagent/\n    RewriteCond %{REQUEST_FILENAME} !-f\n    RewriteCond %{REQUEST_FILENAME} !-d\n    RewriteRule . /aiagent/index.html [L]\n</Directory>\n\n# Proxy API requests to Node.js backend\nProxyPreserveHost On\nProxyPass /aiagent/api http://127.0.0.1:6331/api\nProxyPassReverse /aiagent/api http://127.0.0.1:6331/api\nProxyPass /aiagent/uploads http://127.0.0.1:6331/uploads\nProxyPassReverse /aiagent/uploads http://127.0.0.1:6331/uploads\n```\n\nRestart Apache:\n```bash\nsudo systemctl restart apache2\n```\n\n### 7. Start the Backend with PM2\n\n```bash\ncd /var/www/html/aiagent\n\n# Create log directory\nsudo mkdir -p /var/log/nijvox\nsudo chown -R $USER:$USER /var/log/nijvox\n\n# Start with PM2\npm2 start ecosystem.config.cjs\n\n# Save PM2 process list\npm2 save\n\n# Setup PM2 to start on boot\npm2 startup\n# (Follow the instructions it provides)\n```\n\n### 8. Verify Deployment\n\n1. Check backend is running:\n```bash\npm2 status\ncurl http://localhost:6331/api/auth/me\n```\n\n2. Check Apache configuration:\n```bash\nsudo apache2ctl configtest\n```\n\n3. Access the application:\n   - Open browser: http://3.208.52.220/aiagent/\n\n## Troubleshooting\n\n### Backend Issues\n\n```bash\n# View PM2 logs\npm2 logs nijvox-backend\n\n# Restart backend\npm2 restart nijvox-backend\n\n# Check if port is in use\nsudo netstat -tlnp | grep 6331\n```\n\n### Apache Issues\n\n```bash\n# Check Apache error logs\nsudo tail -f /var/log/apache2/aiagent-error.log\n\n# Test Apache configuration\nsudo apache2ctl configtest\n\n# Restart Apache\nsudo systemctl restart apache2\n```\n\n### Common Issues\n\n1. **502 Bad Gateway**: Backend not running. Check `pm2 status` and start if needed.\n\n2. **404 on refresh**: Apache rewrite rules not working. Ensure mod_rewrite is enabled.\n\n3. **API calls failing**: Check proxy configuration in Apache.\n\n4. **Session issues**: Ensure SESSION_SECRET is set and TRUST_PROXY=true.\n\n## Updating the Application\n\n```bash\n# Stop backend\npm2 stop nijvox-backend\n\n# Upload new files\n# (repeat scp commands with new build)\n\n# Install any new dependencies\nnpm install --production\n\n# Restart backend\npm2 restart nijvox-backend\n\n# Clear browser cache if needed\n```\n\n## Security Recommendations\n\n1. Enable HTTPS with Let's Encrypt\n2. Configure firewall (only allow ports 80, 443, 22)\n3. Keep Node.js and dependencies updated\n4. Use strong SESSION_SECRET\n5. Enable rate limiting in production\n\n## Test Accounts\n\nAfter deployment, you can seed the database:\n```bash\ncd /var/www/html/aiagent\nnode -e \"require('./dist/index.cjs')\" # Start server first, then in another terminal:\n# Run seed script if needed\n```\n\nDefault accounts:\n- Admin: admin@nijvox.com / admin123\n- User: test@example.com / test123\n","path":null,"size_bytes":5927,"size_tokens":null},"client/src/components/ui/dialog.tsx":{"content":"import * as React from \"react\"\nimport * as DialogPrimitive from \"@radix-ui/react-dialog\"\nimport { X } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Dialog = DialogPrimitive.Root\n\nconst DialogTrigger = DialogPrimitive.Trigger\n\nconst DialogPortal = DialogPrimitive.Portal\n\nconst DialogClose = DialogPrimitive.Close\n\nconst DialogOverlay = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <DialogPrimitive.Overlay\n    ref={ref}\n    className={cn(\n      \"fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0\",\n      className\n    )}\n    {...props}\n  />\n))\nDialogOverlay.displayName = DialogPrimitive.Overlay.displayName\n\nconst DialogContent = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Content>\n>(({ className, children, ...props }, ref) => (\n  <DialogPortal>\n    <DialogOverlay />\n    <DialogPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg\",\n        className\n      )}\n      {...props}\n    >\n      {children}\n      <DialogPrimitive.Close className=\"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground\">\n        <X className=\"h-4 w-4\" />\n        <span className=\"sr-only\">Close</span>\n      </DialogPrimitive.Close>\n    </DialogPrimitive.Content>\n  </DialogPortal>\n))\nDialogContent.displayName = DialogPrimitive.Content.displayName\n\nconst DialogHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col space-y-1.5 text-center sm:text-left\",\n      className\n    )}\n    {...props}\n  />\n)\nDialogHeader.displayName = \"DialogHeader\"\n\nconst DialogFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2\",\n      className\n    )}\n    {...props}\n  />\n)\nDialogFooter.displayName = \"DialogFooter\"\n\nconst DialogTitle = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <DialogPrimitive.Title\n    ref={ref}\n    className={cn(\n      \"text-lg font-semibold leading-none tracking-tight\",\n      className\n    )}\n    {...props}\n  />\n))\nDialogTitle.displayName = DialogPrimitive.Title.displayName\n\nconst DialogDescription = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <DialogPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nDialogDescription.displayName = DialogPrimitive.Description.displayName\n\nexport {\n  Dialog,\n  DialogPortal,\n  DialogOverlay,\n  DialogTrigger,\n  DialogClose,\n  DialogContent,\n  DialogHeader,\n  DialogFooter,\n  DialogTitle,\n  DialogDescription,\n}\n","path":null,"size_bytes":3835,"size_tokens":null},"client/src/lib/queryClient.ts":{"content":"import { QueryClient, QueryFunction } from \"@tanstack/react-query\";\n\nasync function throwIfResNotOk(res: Response) {\n  if (!res.ok) {\n    const text = (await res.text()) || res.statusText;\n    throw new Error(`${res.status}: ${text}`);\n  }\n}\n\nexport async function apiRequest(\n  method: string,\n  url: string,\n  data?: unknown | undefined,\n): Promise<Response> {\n  const isProd = import.meta.env.PROD;\n  const baseUrl = isProd ? \"/aiagent\" : \"\";\n  const finalUrl = url.startsWith(\"/api\") ? `${baseUrl}${url}` : url;\n\n  const res = await fetch(finalUrl, {\n    method,\n    headers: data ? { \"Content-Type\": \"application/json\" } : {},\n    body: data ? JSON.stringify(data) : undefined,\n    credentials: \"include\",\n  });\n\n  await throwIfResNotOk(res);\n  return res;\n}\n\ntype UnauthorizedBehavior = \"returnNull\" | \"throw\";\nexport const getQueryFn: <T>(options: {\n  on401: UnauthorizedBehavior;\n}) => QueryFunction<T> =\n  ({ on401: unauthorizedBehavior }) =>\n  async ({ queryKey }) => {\n    const isProd = import.meta.env.PROD;\n    const baseUrl = isProd ? \"/aiagent\" : \"\";\n    const url = queryKey.join(\"/\");\n    const finalUrl = url.startsWith(\"api\") ? `${baseUrl}/${url}` : url;\n\n    const res = await fetch(finalUrl, {\n      credentials: \"include\",\n    });\n\n    if (unauthorizedBehavior === \"returnNull\" && res.status === 401) {\n      return null;\n    }\n\n    await throwIfResNotOk(res);\n    \n    // Safety check for JSON\n    const contentType = res.headers.get(\"content-type\");\n    if (!contentType || !contentType.includes(\"application/json\")) {\n      console.error(\"Non-JSON response received from\", finalUrl);\n      throw new Error(\"Server returned non-JSON response. Check if /aiagent prefix is missing or incorrect.\");\n    }\n\n    return await res.json();\n  };\n\nexport const queryClient = new QueryClient({\n  defaultOptions: {\n    queries: {\n      queryFn: getQueryFn({ on401: \"throw\" }),\n      refetchInterval: false,\n      refetchOnWindowFocus: false,\n      staleTime: Infinity,\n      retry: false,\n    },\n    mutations: {\n      retry: false,\n    },\n  },\n});\n","path":null,"size_bytes":2062,"size_tokens":null},"client/src/components/ui/input.tsx":{"content":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Input = React.forwardRef<HTMLInputElement, React.ComponentProps<\"input\">>(\n  ({ className, type, ...props }, ref) => {\n    return (\n      <input\n        type={type}\n        className={cn(\n          \"flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-base shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm\",\n          className\n        )}\n        ref={ref}\n        {...props}\n      />\n    )\n  }\n)\nInput.displayName = \"Input\"\n\nexport { Input }\n","path":null,"size_bytes":768,"size_tokens":null},"client/src/pages/dashboard.tsx":{"content":"import { useState, useEffect } from \"react\";\nimport { Link, useLocation } from \"wouter\";\nimport { \n  LayoutDashboard, \n  Phone, \n  MessageSquare, \n  Users, \n  Settings, \n  LogOut, \n  Bell, \n  Search, \n  Plus, \n  MoreVertical,\n  ArrowUpRight,\n  PhoneCall,\n  CheckCircle2,\n  Clock,\n  Play,\n  UserCog,\n  Shield,\n  Mail,\n  Calendar,\n  FileText,\n  Upload,\n  File,\n  History,\n  CalendarDays,\n  Mic,\n  BrainCircuit,\n  X,\n  Bot,\n  User,\n  CreditCard,\n  Zap,\n  Moon,\n  Volume2,\n  Globe,\n  Lock,\n  ChevronRight,\n  ChevronLeft,\n  Loader2,\n  Trash2,\n  Edit3,\n  Pencil,\n  Building,\n  Building2,\n  Megaphone,\n  Wallet,\n  MessageCircle,\n  Eye,\n  Send\n} from \"lucide-react\";\nimport { useAuth } from \"@/lib/auth\";\nimport { leadsApi, campaignsApi, appointmentsApi, usersApi, settingsApi, uploadApi, notesApi, plansApi, notificationsApi, type UploadedFile } from \"@/lib/api\";\nimport { apiRequest, queryClient } from \"@/lib/queryClient\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport type { Lead, Campaign, Appointment, User as UserType, KnowledgeBaseFile, Plan, InsertPlan } from \"@shared/schema\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Avatar, AvatarFallback, AvatarImage } from \"@/components/ui/avatar\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle, CardFooter } from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Table, TableBody, TableCell, TableHead, TableHeader, TableRow } from \"@/components/ui/table\";\nimport { DropdownMenu, DropdownMenuContent, DropdownMenuItem, DropdownMenuTrigger, DropdownMenuLabel, DropdownMenuSeparator } from \"@/components/ui/dropdown-menu\";\nimport { useTheme } from \"@/components/theme-provider\";\nimport { Dialog, DialogContent, DialogDescription, DialogFooter, DialogHeader, DialogTitle, DialogTrigger } from \"@/components/ui/dialog\";\nimport { Label } from \"@/components/ui/label\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport { Sheet, SheetContent, SheetHeader, SheetTitle, SheetDescription } from \"@/components/ui/sheet\";\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\nimport { ScrollArea } from \"@/components/ui/scroll-area\";\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\";\nimport { Switch } from \"@/components/ui/switch\";\nimport { Progress } from \"@/components/ui/progress\";\nimport { AlertDialog, AlertDialogAction, AlertDialogCancel, AlertDialogContent, AlertDialogDescription, AlertDialogFooter, AlertDialogHeader, AlertDialogTitle } from \"@/components/ui/alert-dialog\";\nimport { LineChart, Line, PieChart, Pie, Cell, XAxis, YAxis, CartesianGrid, Tooltip as RechartsTooltip, Legend, ResponsiveContainer, AreaChart, Area, BarChart, Bar } from \"recharts\";\nimport { Tooltip, TooltipContent, TooltipProvider, TooltipTrigger } from \"@/components/ui/tooltip\";\nimport dashboardImage from \"@assets/generated_images/futuristic_dashboard_interface_mockup_glowing_in_orange..png\";\nimport BulkSms from \"./bulk-sms\";\nimport BulkWhatsapp from \"./bulk-whatsapp\";\nimport AdminPlans from \"./admin-plans\";\n\n// Helper function to format time ago\nconst formatTimeAgo = (date: Date | string) => {\n  const now = new Date();\n  const d = new Date(date);\n  const diff = Math.floor((now.getTime() - d.getTime()) / 1000);\n  if (diff < 60) return \"Just now\";\n  if (diff < 3600) return `${Math.floor(diff / 60)} mins ago`;\n  if (diff < 86400) return `${Math.floor(diff / 3600)} hours ago`;\n  return d.toLocaleDateString();\n};\n\nexport default function Dashboard() {\n  const [activeTab, setActiveTab] = useState(\"overview\");\n  const [location, setLocation] = useLocation();\n  const { theme } = useTheme();\n  const [plans, setPlans] = useState<Plan[]>([]);\n  const { user, logout, loading: authLoading } = useAuth();\n  const userPlan = plans.find(p => p.name === user?.subscription?.plan);\n\n  const { toast } = useToast();\n  \n  // Role Detection\n  const isAdmin = user?.role === \"admin\" || location.startsWith(\"/admin\");\n\n  // Data State\n  const [leads, setLeads] = useState<Lead[]>([]);\n  const [campaigns, setCampaigns] = useState<Campaign[]>([]);\n  const [appointments, setAppointments] = useState<Appointment[]>([]);\n  const [registeredUsers, setRegisteredUsers] = useState<UserType[]>([]);\n  const [notes, setNotes] = useState<any[]>([]);\n  const [notifications, setNotifications] = useState<any[]>([]);\n  const [loading, setLoading] = useState(true);\n\n  // UI State\n  const [isAddLeadOpen, setIsAddLeadOpen] = useState(false);\n  const [isEditLeadOpen, setIsEditLeadOpen] = useState(false);\n  const [isLeadDetailsOpen, setIsLeadDetailsOpen] = useState(false);\n  const [selectedLead, setSelectedLead] = useState<Lead | null>(null);\n  const [isCreateCampaignOpen, setIsCreateCampaignOpen] = useState(false);\n  const [isEditCampaignOpen, setIsEditCampaignOpen] = useState(false);\n  const [selectedCampaign, setSelectedCampaign] = useState<Campaign | null>(null);\n  const [isSaving, setIsSaving] = useState(false);\n  const [campaignTab, setCampaignTab] = useState(\"basics\");\n  const [isAddNoteOpen, setIsAddNoteOpen] = useState(false);\n  const [isEditNoteOpen, setIsEditNoteOpen] = useState(false);\n  const [selectedNote, setSelectedNote] = useState<any | null>(null);\n  const [noteForm, setNoteForm] = useState({ title: \"\", content: \"\" });\n\n  // Form State for New Lead\n  const [newLead, setNewLead] = useState({ name: \"\", company: \"\", email: \"\", phone: \"\", notes: \"\", status: \"New\" as const, campaignId: \"\" });\n  \n  // Form State for Edit Lead\n  const [editLead, setEditLead] = useState({ name: \"\", company: \"\", email: \"\", phone: \"\", notes: \"\", status: \"New\" as \"New\" | \"Interested\" | \"Follow Up\" | \"Closed\" | \"Unqualified\" | \"In Progress\", campaignId: \"\" });\n  \n  // Filter state for leads by campaign\n  const [leadCampaignFilter, setLeadCampaignFilter] = useState<string>(\"all\");\n\n  // Validation errors\n  const [leadErrors, setLeadErrors] = useState<{name?: string; phone?: string; email?: string}>({});\n  const [campaignErrors, setCampaignErrors] = useState<{name?: string; script?: string; callingHours?: string}>({});\n\n  // Campaign Form State\n  const [newCampaign, setNewCampaign] = useState<{\n    name: string;\n    goal: \"sales\" | \"support\" | \"survey\" | \"appointment\";\n    script: string;\n    voice: string;\n    additionalContext: string;\n    callingHours: { start: string; end: string };\n    knowledgeBaseFiles: UploadedFile[];\n    startDate: string;\n    endDate: string;\n  }>({\n    name: \"\",\n    goal: \"sales\",\n    script: \"\",\n    voice: \"Rachel (American)\",\n    additionalContext: \"\",\n    callingHours: { start: \"09:00\", end: \"17:00\" },\n    knowledgeBaseFiles: [],\n    startDate: \"\",\n    endDate: \"\"\n  });\n\n  // Edit Campaign Form State\n  const [editCampaignForm, setEditCampaignForm] = useState<{\n    name: string;\n    goal: \"sales\" | \"support\" | \"survey\" | \"appointment\";\n    script: string;\n    voice: string;\n    additionalContext: string;\n    callingHours: { start: string; end: string };\n    status: \"Active\" | \"Paused\" | \"Draft\";\n    knowledgeBaseFiles: UploadedFile[];\n    startDate: string;\n    endDate: string;\n  }>({\n    name: \"\",\n    goal: \"sales\",\n    script: \"\",\n    voice: \"Rachel (American)\",\n    additionalContext: \"\",\n    callingHours: { start: \"09:00\", end: \"17:00\" },\n    status: \"Draft\",\n    knowledgeBaseFiles: [],\n    startDate: \"\",\n    endDate: \"\"\n  });\n\n  // Campaign Search State\n  const [campaignSearch, setCampaignSearch] = useState(\"\");\n\n  // File upload state\n  const [isUploading, setIsUploading] = useState(false);\n  \n  // Delete confirmation state\n  const [deleteConfirm, setDeleteConfirm] = useState<{\n    type: \"lead\" | \"campaign\" | \"appointment\" | \"user\" | null;\n    id: string;\n    name: string;\n  }>({ type: null, id: \"\", name: \"\" });\n\n  // Calendar state\n  const [calendarDate, setCalendarDate] = useState(new Date());\n  const [isAddAppointmentOpen, setIsAddAppointmentOpen] = useState(false);\n  const [isEditAppointmentOpen, setIsEditAppointmentOpen] = useState(false);\n  const [selectedAppointment, setSelectedAppointment] = useState<Appointment | null>(null);\n  const [appointmentForm, setAppointmentForm] = useState({\n    leadId: \"\",\n    leadName: \"\",\n    title: \"\",\n    date: \"\",\n    time: \"09:00\",\n    type: \"Zoom\",\n    notes: \"\"\n  });\n  const [scheduleFromLead, setScheduleFromLead] = useState<Lead | null>(null);\n\n  // Activity Log State\n  const [isLogActivityOpen, setIsLogActivityOpen] = useState(false);\n  const [activityLog, setActivityLog] = useState({\n    type: \"call\" as \"call\" | \"email\" | \"note\",\n    note: \"\",\n    outcome: \"No Answer\",\n    duration: \"0:00\"\n  });\n\n  // Settings State\n  const [dndEnabled, setDndEnabled] = useState(user?.settings?.dndEnabled || false);\n  const [callLimit, setCallLimit] = useState(user?.settings?.dailyCallLimit || 500);\n  const [localPresence, setLocalPresence] = useState<boolean>(user?.settings?.localPresenceDialing ?? true);\n\n  // Profile Form State\n  const [profileForm, setProfileForm] = useState({\n    firstName: user?.firstName || \"\",\n    lastName: user?.lastName || \"\",\n    email: user?.email || \"\",\n    phone: user?.phone || \"\",\n    companyName: user?.companyName || \"\",\n    companyLogo: user?.companyLogo || \"\",\n    dltPrincipalEntityId: user?.dltPrincipalEntityId || \"\",\n    dltHeaderId: user?.dltHeaderId || \"\"\n  });\n  const [exotelForm, setExotelForm] = useState({\n    apiKey: \"\",\n    apiToken: \"\",\n    subdomain: \"\",\n    sid: \"\"\n  });\n  const [gupshupForm, setGupshupForm] = useState({\n    apiKey: \"\",\n    userId: \"\"\n  });\n\n  useEffect(() => {\n    if (user?.exotelConfig) {\n      setExotelForm(user.exotelConfig);\n    }\n    if (user?.gupshupConfig) {\n      setGupshupForm(user.gupshupConfig);\n    }\n  }, [user]);\n\n  const [passwordForm, setPasswordForm] = useState({ current: \"\", new: \"\", confirm: \"\" });\n\n  // Chart Filter State\n  const [selectedChartMonth, setSelectedChartMonth] = useState<number>(new Date().getMonth());\n  const [selectedChartYear, setSelectedChartYear] = useState<number>(new Date().getFullYear());\n  const [selectedAdminSubYear, setSelectedAdminSubYear] = useState<number>(new Date().getFullYear());\n  const [selectedAdminPieMonth, setSelectedAdminPieMonth] = useState<number>(new Date().getMonth());\n  const [selectedAdminPieYear, setSelectedAdminPieYear] = useState<number>(new Date().getFullYear());\n  const [selectedAdminRevenueYear, setSelectedAdminRevenueYear] = useState<number>(new Date().getFullYear());\n  const [selectedAdminCreditMonth, setSelectedAdminCreditMonth] = useState<number>(new Date().getMonth());\n  const [selectedAdminCreditYear, setSelectedAdminCreditYear] = useState<number>(new Date().getFullYear());\n\n  // Credit Usage Chart Filter State\n  const [creditUsageCampaignFilter, setCreditUsageCampaignFilter] = useState<string>(\"all\");\n  const [creditUsageMonthFilter, setCreditUsageMonthFilter] = useState<number>(new Date().getMonth());\n  const [creditUsageYearFilter, setCreditUsageYearFilter] = useState<number>(new Date().getFullYear());\n  const [creditUsageData, setCreditUsageData] = useState<any[]>([]);\n\n  // Call/SMS Confirmation State\n  const [callConfirm, setCallConfirm] = useState<{ leadId: string; type: \"call\" | \"sms\" } | null>(null);\n\n  const [logsCampaignFilter, setLogsCampaignFilter] = useState<string>(\"all\");\n  const [dailyActivityCampaignFilter, setDailyActivityCampaignFilter] = useState<string>(\"all\");\n  const [overviewCampaignFilter, setOverviewCampaignFilter] = useState<string>(\"all\");\n  const [callActivityCampaignFilter, setCallActivityCampaignFilter] = useState<string>(\"all\");\n\n  const [dismissedAnnouncements, setDismissedAnnouncements] = useState<string[]>([]);\n\n  const [isAddNotificationOpen, setIsAddNotificationOpen] = useState(false);\n  const [notificationForm, setNotificationForm] = useState({ message: \"\", type: \"notification\" as \"notification\" | \"announcement\" });\n\n  const [searchTerm, setSearchTerm] = useState(\"\");\n  const [campaignFilter, setCampaignFilter] = useState(\"all\");\n  const [dateRange, setDateRange] = useState({ start: \"\", end: \"\" });\n  const [selectedLeads, setSelectedLeads] = useState<string[]>([]);\n  const [message, setMessage] = useState(\"\");\n  const [sending, setSending] = useState(false);\n\n  // Stats derived from data\n  const stats = isAdmin ? [\n    { label: \"Total Users\", value: registeredUsers.length.toString(), icon: Users, tab: \"admin-users\", change: \"\" },\n    { label: \"Total Plans\", value: plans.length.toString(), icon: CreditCard, tab: \"plans\", change: \"\", href: \"/admin/plans\" },\n    { label: \"Active Subscriptions\", value: registeredUsers.filter(u => u.subscription?.status === \"Active\").length.toString(), icon: CheckCircle2, tab: \"admin-users\", change: \"\" },\n    { label: \"Total Revenue\", value: `â‚¹${registeredUsers.reduce((acc, u) => acc + (plans.find(p => p.name === u.subscription?.plan)?.price || 0), 0).toLocaleString()}`, icon: Wallet, tab: \"admin-users\", change: \"\" },\n  ] : [\n    { label: \"Leads\", value: leads.length.toString(), change: \"+12.5%\", icon: PhoneCall, tab: \"crm\" },\n    { label: \"Campaigns\", value: campaigns.filter(c => c.status === \"Active\").length.toString(), change: \"+4.2%\", icon: CheckCircle2, tab: \"campaigns\" },\n    { label: \"Appointments\", value: appointments.length.toString(), change: \"-1.1%\", icon: Clock, tab: \"calendar\" },\n    { label: \"Credit Balance\", value: `â‚¹${(user?.subscription?.monthlyCallCredits || 0).toLocaleString()}`, change: \"0%\", icon: Wallet, tab: \"settings\" },\n  ];\n\n  // Fetch data on mount\n  useEffect(() => {\n    if (!user) return;\n\n    const fetchData = async () => {\n      setLoading(true);\n      try {\n        const [leadsRes, campaignsRes, appointmentsRes, notesRes, plansRes, notificationsRes] = await Promise.all([\n          leadsApi.getAll(),\n          campaignsApi.getAll(),\n          appointmentsApi.getAll(),\n          notesApi.getAll(),\n          plansApi.getAll(),\n          notificationsApi.getAll()\n        ]);\n        \n        setLeads(Array.isArray(leadsRes) ? leadsRes : (leadsRes as any).leads || []);\n        setCampaigns(Array.isArray(campaignsRes) ? campaignsRes : (campaignsRes as any).campaigns || []);\n        setAppointments(Array.isArray(appointmentsRes) ? appointmentsRes : (appointmentsRes as any).appointments || []);\n        setNotes(Array.isArray(notesRes) ? notesRes : (notesRes as any).notes || []);\n        setPlans(Array.isArray(plansRes) ? plansRes : (plansRes as any).plans || []);\n        \n        setNotifications(Array.isArray(notificationsRes) ? notificationsRes : (notificationsRes as any).notifications || []);\n\n        if (isAdmin) {\n          const usersRes = await usersApi.getAll();\n          setRegisteredUsers(Array.isArray(usersRes) ? usersRes : (usersRes as any).users || []);\n        }\n      } catch (error: any) {\n        toast({\n          variant: \"destructive\",\n          title: \"Error loading data\",\n          description: error.message\n        });\n      } finally {\n        setLoading(false);\n      }\n    };\n\n    fetchData();\n  }, [user, isAdmin]);\n\n  useEffect(() => {\n    if (!user) return;\n\n    const fetchCreditUsage = async () => {\n      try {\n        const daysInMonth = new Date(creditUsageYearFilter, creditUsageMonthFilter + 1, 0).getDate();\n        const mockData = Array.from({ length: daysInMonth }, (_, i) => ({\n          date: i + 1,\n          call: Math.floor(Math.random() * 50),\n          sms: Math.floor(Math.random() * 30),\n          whatsapp: Math.floor(Math.random() * 20),\n        }));\n        setCreditUsageData(mockData);\n      } catch (error) {\n        console.error(\"Error fetching credit usage:\", error);\n      }\n    };\n\n    fetchCreditUsage();\n  }, [user, creditUsageMonthFilter, creditUsageYearFilter, creditUsageCampaignFilter]);\n\n  // Update profile form when user changes\n  useEffect(() => {\n    if (user) {\n      setProfileForm({\n        firstName: user.firstName || \"\",\n        lastName: user.lastName || \"\",\n        email: user.email || \"\",\n        phone: user.phone || \"\",\n        companyName: user.companyName || \"\",\n        companyLogo: user.companyLogo || \"\",\n        dltPrincipalEntityId: user.dltPrincipalEntityId || \"\",\n        dltHeaderId: user.dltHeaderId || \"\"\n      });\n      setDndEnabled(user.settings?.dndEnabled || false);\n      setCallLimit(user.settings?.dailyCallLimit || 500);\n      setLocalPresence(user.settings?.localPresenceDialing ?? true);\n    }\n  }, [user]);\n\n  // Redirect to login if not authenticated\n  useEffect(() => {\n    if (!authLoading && !user) {\n      setLocation(\"/login\");\n    }\n  }, [authLoading, user, setLocation]);\n\n  // Validation Functions\n  const handleFileUpload = async (e: React.ChangeEvent<HTMLInputElement>, isEdit = false) => {\n    const files = e.target.files;\n    if (!files || files.length === 0) return;\n\n    setIsUploading(true);\n    const formData = new FormData();\n    for (let i = 0; i < files.length; i++) {\n      formData.append(\"files\", files[i]);\n    }\n\n    try {\n      const response = await uploadApi.uploadFiles(Array.from(files));\n      const uploadedFiles = response || [];\n      \n      if (isEdit) {\n        setEditCampaignForm(prev => ({\n          ...prev,\n          knowledgeBaseFiles: [...(prev.knowledgeBaseFiles || []), ...uploadedFiles]\n        }));\n      } else {\n        setNewCampaign(prev => ({\n          ...prev,\n          knowledgeBaseFiles: [...(prev.knowledgeBaseFiles || []), ...uploadedFiles]\n        }));\n      }\n      toast({ title: \"Files uploaded successfully!\" });\n    } catch (error: any) {\n      toast({ variant: \"destructive\", title: \"Upload failed\", description: error.message });\n    } finally {\n      setIsUploading(false);\n      if (e.target) e.target.value = \"\";\n    }\n  };\n\n  const validateLead = (data: { name: string; phone: string; email: string }): boolean => {\n    const errors: typeof leadErrors = {};\n    if (!data.name.trim()) errors.name = \"Name is required\";\n    if (!data.phone.trim()) errors.phone = \"Phone number is required\";\n    else if (!/^[+]?[\\d\\s\\-()]{7,}$/.test(data.phone.replace(/\\s/g, ''))) errors.phone = \"Invalid phone number format\";\n    if (data.email && !/^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/.test(data.email)) errors.email = \"Invalid email format\";\n    setLeadErrors(errors);\n    return Object.keys(errors).length === 0;\n  };\n\n  const validateCampaign = (data: any): boolean => {\n    const errors: typeof campaignErrors = {};\n    if (!data.name.trim()) errors.name = \"Campaign name is required\";\n    if (!data.script.trim()) errors.script = \"Script/opening message is required\";\n    if (data.callingHours.start >= data.callingHours.end) errors.callingHours = \"End time must be after start time\";\n    setCampaignErrors(errors);\n    return Object.keys(errors).length === 0;\n  };\n\n  const handleAddLead = async (e: React.FormEvent) => {\n    e.preventDefault();\n    if (!user) return;\n    if (!validateLead(newLead)) return;\n    \n    setIsSaving(true);\n    try {\n      const lead = await leadsApi.create({\n        userId: user._id,\n        name: newLead.name.trim(),\n        company: newLead.company.trim(),\n        email: newLead.email.trim(),\n        phone: newLead.phone.trim(),\n        notes: newLead.notes.trim(),\n        status: \"New\",\n        outcome: \"Pending\",\n        campaignId: newLead.campaignId && newLead.campaignId !== \"none\" ? newLead.campaignId : undefined\n      });\n      const leadWithCampaign = (newLead.campaignId && newLead.campaignId !== \"none\")\n        ? { ...lead, campaignName: campaigns.find(c => c._id === newLead.campaignId)?.name }\n        : lead;\n      setLeads([leadWithCampaign as Lead, ...leads]);\n      setIsAddLeadOpen(false);\n      setNewLead({ name: \"\", company: \"\", email: \"\", phone: \"\", notes: \"\", status: \"New\", campaignId: \"\" });\n      setLeadErrors({});\n      toast({ title: \"Lead added successfully!\" });\n    } catch (error: any) {\n      toast({ variant: \"destructive\", title: \"Error adding lead\", description: error.message });\n    } finally {\n      setIsSaving(false);\n    }\n  };\n\n  const handleEditLead = (lead: Lead) => {\n    setSelectedLead(lead);\n    setEditLead({\n      name: lead.name,\n      company: lead.company || \"\",\n      email: lead.email || \"\",\n      phone: lead.phone,\n      notes: lead.notes || \"\",\n      status: lead.status,\n      campaignId: lead.campaignId || \"\"\n    });\n    setLeadErrors({});\n    setIsEditLeadOpen(true);\n  };\n\n  const handleUpdateProfile = async (e: React.FormEvent) => {\n    e.preventDefault();\n    setIsSaving(true);\n    try {\n      console.log(\"Sending profile update:\", profileForm);\n      const response = await apiRequest(\"PATCH\", \"/api/user\", profileForm);\n      const data = await response.json();\n      console.log(\"Profile update response:\", data);\n      await queryClient.invalidateQueries({ queryKey: [\"/api/auth/me\"] });\n      toast({ title: \"Profile updated successfully!\" });\n    } catch (error: any) {\n      console.error(\"Profile update error:\", error);\n      toast({ variant: \"destructive\", title: \"Update failed\", description: error.message });\n    } finally {\n      setIsSaving(false);\n    }\n  };\n\n  const handleLogoUpload = async (e: React.ChangeEvent<HTMLInputElement>) => {\n    const files = e.target.files;\n    if (!files || files.length === 0) return;\n\n    setIsUploading(true);\n    try {\n      const response = await uploadApi.uploadFiles([files[0]]);\n      const uploadedFiles = response || [];\n      if (uploadedFiles.length > 0) {\n        const logoUrl = uploadedFiles[0].url;\n        console.log(\"Logo uploaded, URL:\", logoUrl);\n        setProfileForm(prev => ({ ...prev, companyLogo: logoUrl }));\n        toast({ title: \"Logo uploaded! Click 'Save Changes' to update your profile.\" });\n      }\n    } catch (error: any) {\n      toast({ variant: \"destructive\", title: \"Upload failed\", description: error.message });\n    } finally {\n      setIsUploading(false);\n      if (e.target) e.target.value = \"\";\n    }\n  };\n\n  const handleUpdateExotelConfig = async (e: React.FormEvent) => {\n    e.preventDefault();\n    setIsSaving(true);\n    try {\n      const endpoint = isAdmin ? \"/api/admin/exotel\" : \"/api/user/exotel\";\n      await apiRequest(\"POST\", endpoint, exotelForm);\n      await queryClient.invalidateQueries({ queryKey: [\"/api/auth/me\"] });\n      toast({ title: \"Exotel configuration updated!\" });\n    } catch (error: any) {\n      toast({ variant: \"destructive\", title: \"Update failed\", description: error.message });\n    } finally {\n      setIsSaving(false);\n    }\n  };\n\n  const handleUpdateGupshupConfig = async (e: React.FormEvent) => {\n    e.preventDefault();\n    setIsSaving(true);\n    try {\n      const endpoint = isAdmin ? \"/api/admin/exotel\" : \"/api/user/gupshup\"; // Reusing admin endpoint if it handles all admin settings, but let's be specific\n      // Actually, admin setting update should probably handle both. \n      // For now, let's keep it simple for user\n      await apiRequest(\"POST\", isAdmin ? \"/api/admin/exotel\" : \"/api/user/gupshup\", gupshupForm);\n      await queryClient.invalidateQueries({ queryKey: [\"/api/auth/me\"] });\n      toast({ title: \"Gupshup configuration updated!\" });\n    } catch (error: any) {\n      toast({ variant: \"destructive\", title: \"Update failed\", description: error.message });\n    } finally {\n      setIsSaving(false);\n    }\n  };\n\n  const handleUpdateLead = async (e: React.FormEvent) => {\n    e.preventDefault();\n    if (!selectedLead) return;\n    if (!validateLead(editLead)) return;\n    \n    setIsSaving(true);\n    try {\n      const response = await leadsApi.update(selectedLead._id, {\n        name: editLead.name.trim(),\n        company: editLead.company.trim(),\n        email: editLead.email.trim(),\n        phone: editLead.phone.trim(),\n        notes: editLead.notes.trim(),\n        status: editLead.status,\n        campaignId: editLead.campaignId && editLead.campaignId !== \"none\" ? editLead.campaignId : undefined\n      });\n      \n      const updated = response;\n      \n      // Update selected lead details if it's the one currently viewed\n      const updatedLead = { \n        ...selectedLead, \n        ...updated,\n        campaignName: editLead.campaignId && editLead.campaignId !== \"none\" \n          ? campaigns.find(c => c._id === editLead.campaignId)?.name \n          : undefined \n      } as Lead;\n      \n      setSelectedLead(updatedLead);\n      setLeads(leads.map(l => l._id === selectedLead._id ? updatedLead : l));\n      setIsEditLeadOpen(false);\n      setLeadErrors({});\n      toast({ title: \"Lead updated successfully!\" });\n    } catch (error: any) {\n      toast({ variant: \"destructive\", title: \"Error updating lead\", description: error.message });\n    } finally {\n      setIsSaving(false);\n    }\n  };\n\n  const confirmDeleteLead = (lead: Lead) => {\n    setDeleteConfirm({ type: \"lead\", id: lead._id, name: lead.name });\n  };\n  \n  const handleDeleteLead = async (id: string) => {\n    try {\n      await leadsApi.delete(id);\n      setLeads(leads.filter(l => l._id !== id));\n      setIsLeadDetailsOpen(false);\n      setDeleteConfirm({ type: null, id: \"\", name: \"\" });\n      toast({ title: \"Lead deleted\" });\n    } catch (error: any) {\n      toast({ variant: \"destructive\", title: \"Error deleting lead\", description: error.message });\n    }\n  };\n\n  const handleCreateCampaign = async (e: React.FormEvent) => {\n    e.preventDefault();\n    if (!user) return;\n    if (!validateCampaign(newCampaign)) return;\n    \n    setIsSaving(true);\n    try {\n      const campaign = await campaignsApi.create({\n        ...newCampaign,\n        userId: user?._id || \"\",\n        status: \"Draft\",\n        knowledgeBaseFiles: newCampaign.knowledgeBaseFiles || []\n      });\n      setCampaigns([...campaigns, campaign]);\n      setIsCreateCampaignOpen(false);\n      setNewCampaign({\n        name: \"\",\n        goal: \"sales\",\n        script: \"\",\n        voice: \"Rachel (American)\",\n        additionalContext: \"\",\n        callingHours: { start: \"09:00\", end: \"17:00\" },\n        knowledgeBaseFiles: [],\n        startDate: \"\",\n        endDate: \"\"\n      });\n      setCampaignErrors({});\n      toast({ title: \"Campaign created successfully!\" });\n    } catch (error: any) {\n      toast({ variant: \"destructive\", title: \"Error creating campaign\", description: error.message });\n    } finally {\n      setIsSaving(false);\n    }\n  };\n\n  const handleUpdateCampaign = async (e: React.FormEvent) => {\n    e.preventDefault();\n    if (!selectedCampaign) return;\n    if (!validateCampaign(editCampaignForm)) return;\n\n    setIsSaving(true);\n    try {\n      const updated = await campaignsApi.update(selectedCampaign._id, {\n        name: editCampaignForm.name,\n        goal: editCampaignForm.goal,\n        script: editCampaignForm.script,\n        voice: editCampaignForm.voice,\n        additionalContext: editCampaignForm.additionalContext,\n        callingHours: editCampaignForm.callingHours,\n        status: editCampaignForm.status,\n        knowledgeBaseFiles: editCampaignForm.knowledgeBaseFiles,\n        startDate: editCampaignForm.startDate,\n        endDate: editCampaignForm.endDate\n      });\n      setCampaigns(campaigns.map(c => c._id === selectedCampaign._id ? updated : c));\n      setIsEditCampaignOpen(false);\n      setSelectedCampaign(null);\n      toast({ title: \"Campaign updated successfully!\" });\n    } catch (error: any) {\n      toast({ variant: \"destructive\", title: \"Error updating campaign\", description: error.message });\n    } finally {\n      setIsSaving(false);\n    }\n  };\n\n  const handleDeleteCampaign = async (id: string) => {\n    try {\n      await campaignsApi.delete(id);\n      setCampaigns(campaigns.filter(c => c._id !== id));\n      setDeleteConfirm({ type: null, id: \"\", name: \"\" });\n      toast({ title: \"Campaign deleted\" });\n    } catch (error: any) {\n      toast({ variant: \"destructive\", title: \"Error deleting campaign\", description: error.message });\n    }\n  };\n\n  const handleViewLead = (lead: Lead) => {\n    setSelectedLead(lead);\n    setIsLeadDetailsOpen(true);\n  };\n\n  const handleLogActivity = async () => {\n    if (!selectedLead || !activityLog.note.trim()) {\n      toast({ variant: \"destructive\", title: \"Please enter a note\" });\n      return;\n    }\n\n    setIsSaving(true);\n    try {\n      const historyItem = {\n        type: activityLog.type,\n        date: new Date().toISOString(),\n        note: activityLog.note.trim(),\n        outcome: activityLog.type === \"call\" ? activityLog.outcome : undefined,\n        duration: activityLog.type === \"call\" ? activityLog.duration : undefined\n      };\n\n      await leadsApi.addHistory(selectedLead._id, historyItem);\n      \n      const updatedLead = {\n        ...selectedLead,\n        history: [...(selectedLead.history || []), historyItem] as any,\n        lastContact: new Date(historyItem.date)\n      };\n      setSelectedLead(updatedLead);\n      setLeads(leads.map(l => l._id === selectedLead._id ? updatedLead : l));\n      \n      setIsLogActivityOpen(false);\n      setActivityLog({ type: \"call\", note: \"\", outcome: \"No Answer\", duration: \"0:00\" });\n      toast({ title: \"Activity logged successfully!\" });\n    } catch (error: any) {\n      toast({ variant: \"destructive\", title: \"Error logging activity\", description: error.message });\n    } finally {\n      setIsSaving(false);\n    }\n  };\n\n  const handleScheduleMeeting = (lead: Lead) => {\n    setScheduleFromLead(lead);\n    setAppointmentForm({\n      leadId: lead._id,\n      leadName: lead.name,\n      title: `Meeting with ${lead.name}`,\n      date: new Date().toISOString().split('T')[0],\n      time: \"09:00\",\n      type: \"Zoom\",\n      notes: \"\"\n    });\n    setIsAddAppointmentOpen(true);\n  };\n\n  const handleAddAppointment = async () => {\n    // Basic validation\n    if (!user || !appointmentForm.title?.trim() || !appointmentForm.date?.trim() || !appointmentForm.leadId?.trim()) {\n      toast({ \n        variant: \"destructive\", \n        title: \"Validation Error\", \n        description: \"Please fill in all required fields (Lead, Title, and Date).\" \n      });\n      return;\n    }\n    \n    setIsSaving(true);\n    try {\n      const response = await appointmentsApi.create({\n        userId: user._id,\n        leadId: appointmentForm.leadId,\n        leadName: appointmentForm.leadName,\n        title: appointmentForm.title,\n        date: appointmentForm.date,\n        time: appointmentForm.time,\n        type: appointmentForm.type,\n        notes: appointmentForm.notes\n      });\n      \n      const newApt = response;\n      setAppointments([...appointments, newApt]);\n      setIsAddAppointmentOpen(false);\n      setScheduleFromLead(null);\n      setAppointmentForm({ leadId: \"\", leadName: \"\", title: \"\", date: \"\", time: \"09:00\", type: \"Zoom\", notes: \"\" });\n      toast({ title: \"Appointment scheduled!\" });\n    } catch (error: any) {\n      toast({ variant: \"destructive\", title: \"Error creating appointment\", description: error.message });\n    } finally {\n      setIsSaving(false);\n    }\n  };\n\n  const handleEditAppointment = (apt: Appointment) => {\n    setSelectedAppointment(apt);\n    setAppointmentForm({\n      leadId: apt.leadId,\n      leadName: apt.leadName,\n      title: apt.title,\n      date: apt.date,\n      time: apt.time,\n      type: apt.type,\n      notes: apt.notes || \"\"\n    });\n    setIsEditAppointmentOpen(true);\n  };\n\n  const handleUpdateAppointment = async () => {\n    if (!selectedAppointment || !appointmentForm.title || !appointmentForm.date) {\n      toast({ variant: \"destructive\", title: \"Please fill in all required fields\" });\n      return;\n    }\n    \n    setIsSaving(true);\n    try {\n      const updated = await appointmentsApi.update(selectedAppointment._id, {\n        title: appointmentForm.title,\n        date: appointmentForm.date,\n        time: appointmentForm.time,\n        type: appointmentForm.type,\n        notes: appointmentForm.notes\n      });\n      setAppointments(appointments.map(a => a._id === selectedAppointment._id ? updated : a));\n      setIsEditAppointmentOpen(false);\n      setSelectedAppointment(null);\n      toast({ title: \"Appointment updated!\" });\n    } catch (error: any) {\n      toast({ variant: \"destructive\", title: \"Error updating appointment\", description: error.message });\n    } finally {\n      setIsSaving(false);\n    }\n  };\n\n  const confirmDeleteAppointment = (apt: Appointment) => {\n    setDeleteConfirm({ type: \"appointment\", id: apt._id, name: apt.title });\n  };\n\n  const handleDeleteAppointment = async (id: string) => {\n    try {\n      await appointmentsApi.delete(id);\n      setAppointments(appointments.filter(a => a._id !== id));\n      setDeleteConfirm({ type: null, id: \"\", name: \"\" });\n      toast({ title: \"Appointment deleted\" });\n    } catch (error: any) {\n      toast({ variant: \"destructive\", title: \"Error deleting appointment\", description: error.message });\n    }\n  };\n\n  const handleLogout = async () => {\n    try {\n      await logout();\n      setLocation(\"/login\");\n    } catch (error: any) {\n      toast({ variant: \"destructive\", title: \"Logout failed\", description: error.message });\n    }\n  };\n\n  if (authLoading || (loading && registeredUsers.length === 0 && isAdmin)) {\n    return (\n      <div className=\"flex items-center justify-center min-h-screen\">\n        <Loader2 className=\"h-8 w-8 animate-spin text-primary\" />\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"flex h-screen bg-background text-foreground overflow-hidden\">\n      {/* Sidebar */}\n      <aside className=\"w-64 border-r bg-card flex flex-col shrink-0\">\n        <div className=\"p-6 border-b flex items-center gap-2\">\n          <div className=\"flex h-8 w-8 items-center justify-center rounded-lg bg-primary text-primary-foreground\">\n            <Phone className=\"h-4 w-4\" />\n          </div>\n          <h2 className=\"font-bold text-xl tracking-tighter\">NIJVOX</h2>\n        </div>\n        \n        <ScrollArea className=\"flex-1 px-4 py-6\">\n          <nav className=\"space-y-1.5\">\n            <Button \n              variant={activeTab === \"overview\" ? \"secondary\" : \"ghost\"} \n              className=\"w-full justify-start hover-elevate h-11\"\n              onClick={() => setActiveTab(\"overview\")}\n            >\n              <LayoutDashboard className=\"mr-3 h-5 w-5\" />\n              Overview\n            </Button>\n            \n            {isAdmin ? (\n              <>\n                <div className=\"mt-6 mb-2 px-4 text-[10px] font-bold text-muted-foreground uppercase tracking-wider\">Administration</div>\n                <Button \n                  variant={activeTab === \"admin-users\" ? \"secondary\" : \"ghost\"} \n                  className=\"w-full justify-start hover-elevate h-11\"\n                  onClick={() => setActiveTab(\"admin-users\")}\n                >\n                  <Users className=\"mr-3 h-5 w-5\" />\n                  User Management\n                </Button>\n                <Button \n                  variant={activeTab === \"admin-notifications\" ? \"secondary\" : \"ghost\"} \n                  className=\"w-full justify-start hover-elevate h-11\"\n                  onClick={() => setActiveTab(\"admin-notifications\")}\n                >\n                  <Bell className=\"mr-3 h-5 w-5\" />\n                  Notifications\n                </Button>\n                <Button \n                  variant={activeTab === \"plans\" ? \"secondary\" : \"ghost\"} \n                  className=\"w-full justify-start hover-elevate h-11\"\n                  onClick={() => setActiveTab(\"plans\")}\n                >\n                  <CreditCard className=\"mr-3 h-5 w-5\" />\n                  Plan Management\n                </Button>\n              </>\n            ) : (\n              <>\n                <div className=\"mt-6 mb-2 px-4 text-[10px] font-bold text-muted-foreground uppercase tracking-wider\">Core Tools</div>\n                <Button \n                  variant={activeTab === \"crm\" ? \"secondary\" : \"ghost\"} \n                  className=\"w-full justify-start hover-elevate h-11\"\n                  onClick={() => setActiveTab(\"crm\")}\n                >\n                  <Users className=\"mr-3 h-5 w-5\" />\n                  Lead CRM\n                </Button>\n                <Button \n                  variant={activeTab === \"campaigns\" ? \"secondary\" : \"ghost\"} \n                  className=\"w-full justify-start hover-elevate h-11\"\n                  onClick={() => setActiveTab(\"campaigns\")}\n                >\n                  <Megaphone className=\"mr-3 h-5 w-5\" />\n                  Campaigns\n                </Button>\n                <Button \n                  variant={activeTab === \"calendar\" ? \"secondary\" : \"ghost\"} \n                  className=\"w-full justify-start hover-elevate h-11\"\n                  onClick={() => setActiveTab(\"calendar\")}\n                >\n                  <Calendar className=\"mr-3 h-5 w-5\" />\n                  Calendar\n                </Button>\n                <Button \n                  variant={activeTab === \"whatsapp\" ? \"secondary\" : \"ghost\"} \n                  className=\"w-full justify-start hover-elevate h-11\"\n                  onClick={() => setActiveTab(\"whatsapp\")}\n                >\n                  <MessageCircle className=\"mr-3 h-5 w-5\" />\n                  Bulk WhatsApp\n                </Button>\n                <Button \n                  variant={activeTab === \"sms\" ? \"secondary\" : \"ghost\"} \n                  className=\"w-full justify-start hover-elevate h-11\"\n                  onClick={() => setActiveTab(\"sms\")}\n                >\n                  <MessageSquare className=\"mr-3 h-5 w-5\" />\n                  Bulk SMS\n                </Button>\n                <Button \n                  variant={activeTab === \"callhistory\" ? \"secondary\" : \"ghost\"} \n                  className=\"w-full justify-start hover-elevate h-11\"\n                  onClick={() => setActiveTab(\"callhistory\")}\n                >\n                  <History className=\"mr-3 h-5 w-5\" />\n                  Call History\n                </Button>\n              </>\n            )}\n          </nav>\n        </ScrollArea>\n\n        <div className=\"p-4 border-t bg-muted/10\">\n          <DropdownMenu>\n            <DropdownMenuTrigger asChild>\n              <div className=\"flex items-center gap-3 p-3 rounded-lg hover:bg-muted/50 cursor-pointer transition-colors group\">\n                <Avatar className=\"h-9 w-9 border-2 border-background shadow-sm ring-1 ring-border group-hover:ring-primary/50 transition-all\">\n                  <AvatarImage src={user?.companyLogo || undefined} />\n                  <AvatarFallback className=\"bg-primary/10 text-primary text-xs font-bold\">{user?.firstName?.charAt(0)}{user?.lastName?.charAt(0)}</AvatarFallback>\n                </Avatar>\n                <div className=\"flex-1 min-w-0\">\n                  <p className=\"text-sm font-semibold truncate leading-none mb-1\">{user?.firstName} {user?.lastName}</p>\n                  <p className=\"text-[10px] text-muted-foreground truncate uppercase tracking-widest font-bold\">{user?.role || 'User'}</p>\n                </div>\n                <MoreVertical className=\"h-4 w-4 text-muted-foreground\" />\n              </div>\n            </DropdownMenuTrigger>\n            <DropdownMenuContent align=\"end\" className=\"w-56\">\n              <DropdownMenuLabel>My Account</DropdownMenuLabel>\n              <DropdownMenuSeparator />\n              <DropdownMenuItem onClick={() => setActiveTab(\"profile\")}>\n                <User className=\"mr-2 h-4 w-4\" /> Profile\n              </DropdownMenuItem>\n              {!isAdmin && (\n                <DropdownMenuItem onClick={() => setActiveTab(\"billing\")}>\n                  <Wallet className=\"mr-2 h-4 w-4\" /> Billing\n                </DropdownMenuItem>\n              )}\n              <DropdownMenuSeparator />\n              <DropdownMenuItem onClick={handleLogout} className=\"text-destructive\">\n                <LogOut className=\"mr-2 h-4 w-4\" /> Log out\n              </DropdownMenuItem>\n            </DropdownMenuContent>\n          </DropdownMenu>\n        </div>\n      </aside>\n\n      {/* Main Content */}\n      <main className=\"flex-1 flex flex-col min-w-0\">\n        <header className=\"h-16 border-b flex items-center justify-between px-6 bg-background/50 backdrop-blur sticky top-0 z-10\">\n          <div className=\"flex items-center gap-4 w-full max-w-md\">\n            <div className=\"relative w-full\">\n              <Search className=\"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground\" />\n              <Input placeholder={isAdmin ? \"Search users...\" : \"Search leads, campaigns...\"} className=\"pl-9 bg-muted/20 border-none focus-visible:ring-1\" />\n            </div>\n          </div>\n          <div className=\"flex items-center gap-4\">\n            <Button variant=\"ghost\" size=\"icon\" className=\"relative\" onClick={() => setLocation(\"/notifications\")}>\n              <Bell className=\"h-5 w-5\" />\n              {notifications.filter(n => n.readBy && Array.isArray(n.readBy) && user?._id && !n.readBy.includes(user._id)).length > 0 && (\n                <span className=\"absolute top-1 right-1 h-2 w-2 rounded-full bg-primary\" />\n              )}\n            </Button>\n          </div>\n        </header>\n\n        <div className=\"flex-1 p-6 overflow-auto\">\n          {activeTab === \"whatsapp\" && <BulkWhatsapp />}\n          {activeTab === \"sms\" && <BulkSms />}\n          {activeTab === \"plans\" && <AdminPlans />}\n          {activeTab === \"overview\" && (\n            <div className=\"space-y-6\">\n              {notifications\n                .filter(n => n.type === \"announcement\" && n.readBy && Array.isArray(n.readBy) && user?._id && !n.readBy.includes(user._id) && !dismissedAnnouncements.includes(n._id))\n                .map((announcement) => (\n                  <Card key={announcement._id} className=\"bg-primary/10 border-primary/20 relative group overflow-hidden\">\n                    <div className=\"flex items-center gap-4 p-4\">\n                      <div className=\"h-10 w-10 rounded-full bg-primary/20 flex items-center justify-center shrink-0\">\n                        <Megaphone className=\"h-5 w-5 text-primary\" />\n                      </div>\n                      <div className=\"flex-1 min-w-0\">\n                        <p className=\"text-sm font-medium leading-relaxed\">{announcement.message}</p>\n                      </div>\n                      <Button \n                        variant=\"ghost\" \n                        size=\"icon\" \n                        className=\"h-8 w-8 hover:bg-primary/20\" \n                        onClick={async () => {\n                          try {\n                            await apiRequest(\"POST\", `/api/notifications/${announcement._id}/read`);\n                            setDismissedAnnouncements(prev => [...prev, announcement._id]);\n                          } catch (err) {\n                            console.error(\"Failed to dismiss announcement:\", err);\n                          }\n                        }}\n                      >\n                        <X className=\"h-4 w-4\" />\n                      </Button>\n                    </div>\n                  </Card>\n                ))}\n\n              <div className=\"flex justify-between items-center\">\n                <h1 className=\"text-3xl font-bold tracking-tight\">Dashboard Overview</h1>\n              </div>\n\n              {/* Stats Grid */}\n              <div className=\"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4\">\n                {stats.map((stat, i) => (\n                  <Card key={i} className=\"hover-elevate cursor-pointer border-l-4 border-l-primary\" onClick={() => setActiveTab(stat.tab)}>\n                    <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\n                      <CardTitle className=\"text-sm font-medium text-muted-foreground\">{stat.label}</CardTitle>\n                      <stat.icon className=\"h-4 w-4 text-primary\" />\n                    </CardHeader>\n                    <CardContent>\n                      <div className=\"text-2xl font-bold\">{stat.value}</div>\n                      {(stat as any).change && (\n                        <p className={`text-xs ${(stat as any).change?.startsWith('+') ? 'text-green-500' : (stat as any).change === 'Balance' ? 'text-primary' : 'text-red-500'}`}>\n                          {(stat as any).change} {(stat as any).change !== 'Balance' && 'from last week'}\n                        </p>\n                      )}\n                    </CardContent>\n                  </Card>\n                ))}\n              </div>\n\n              {/* Admin Dashboard Charts */}\n              {isAdmin && (\n                <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6 mb-8\">\n                  <Card className=\"hover-elevate\">\n                    <CardHeader className=\"flex flex-row items-center justify-between\">\n                      <div>\n                        <CardTitle className=\"text-lg\">Subscription Growth</CardTitle>\n                        <CardDescription>Monthly new subscriptions</CardDescription>\n                      </div>\n                      <Select value={selectedAdminSubYear.toString()} onValueChange={(val) => setSelectedAdminSubYear(parseInt(val))}>\n                        <SelectTrigger className=\"w-[100px]\"><SelectValue placeholder=\"Year\" /></SelectTrigger>\n                        <SelectContent>{[2024, 2025, 2026].map(y => <SelectItem key={y} value={y.toString()}>{y}</SelectItem>)}</SelectContent>\n                      </Select>\n                    </CardHeader>\n                    <CardContent className=\"h-[300px]\">\n                      <ResponsiveContainer width=\"100%\" height=\"100%\">\n                        <AreaChart data={[{ month: \"Jan\", subs: 45 }, { month: \"Feb\", subs: 52 }, { month: \"Mar\", subs: 61 }, { month: \"Apr\", subs: 58 }, { month: \"May\", subs: 72 }, { month: \"Jun\", subs: 85 }, { month: \"Jul\", subs: 94 }, { month: \"Aug\", subs: 103 }, { month: \"Sep\", subs: 110 }, { month: \"Oct\", subs: 125 }, { month: \"Nov\", subs: 140 }, { month: \"Dec\", subs: 155 }]}>\n                          <defs><linearGradient id=\"colorSubs\" x1=\"0\" y1=\"0\" x2=\"0\" y2=\"1\"><stop offset=\"5%\" stopColor=\"hsl(var(--primary))\" stopOpacity={0.3}/><stop offset=\"95%\" stopColor=\"hsl(var(--primary))\" stopOpacity={0}/></linearGradient></defs>\n                          <CartesianGrid strokeDasharray=\"3 3\" vertical={false} stroke=\"hsl(var(--muted-foreground) / 0.1)\" />\n                          <XAxis dataKey=\"month\" axisLine={false} tickLine={false} tick={{fill: 'hsl(var(--muted-foreground))', fontSize: 12}} />\n                          <YAxis axisLine={false} tickLine={false} tick={{fill: 'hsl(var(--muted-foreground))', fontSize: 12}} />\n                          <RechartsTooltip contentStyle={{ backgroundColor: 'hsl(var(--card))', borderColor: 'hsl(var(--border))', borderRadius: '8px' }} />\n                          <Area type=\"monotone\" dataKey=\"subs\" stroke=\"hsl(var(--primary))\" fillOpacity={1} fill=\"url(#colorSubs)\" />\n                        </AreaChart>\n                      </ResponsiveContainer>\n                    </CardContent>\n                  </Card>\n\n                  <Card className=\"hover-elevate\">\n                    <CardHeader className=\"flex flex-row items-center justify-between\">\n                      <div><CardTitle className=\"text-lg\">Plan Distribution</CardTitle><CardDescription>Month-wise subscription split</CardDescription></div>\n                      <div className=\"flex gap-2\">\n                        <Select value={selectedAdminPieMonth.toString()} onValueChange={(val) => setSelectedAdminPieMonth(parseInt(val))}>\n                          <SelectTrigger className=\"w-[110px]\"><SelectValue placeholder=\"Month\" /></SelectTrigger>\n                          <SelectContent>{[\"Jan\", \"Feb\", \"Mar\", \"Apr\", \"May\", \"Jun\", \"Jul\", \"Aug\", \"Sep\", \"Oct\", \"Nov\", \"Dec\"].map((m, i) => <SelectItem key={m} value={i.toString()}>{m}</SelectItem>)}</SelectContent>\n                        </Select>\n                        <Select value={selectedAdminPieYear.toString()} onValueChange={(val) => setSelectedAdminPieYear(parseInt(val))}>\n                          <SelectTrigger className=\"w-[100px]\"><SelectValue placeholder=\"Year\" /></SelectTrigger>\n                          <SelectContent>{[2024, 2025, 2026].map(y => <SelectItem key={y} value={y.toString()}>{y}</SelectItem>)}</SelectContent>\n                        </Select>\n                      </div>\n                    </CardHeader>\n                    <CardContent className=\"h-[300px]\">\n                      <ResponsiveContainer width=\"100%\" height=\"100%\">\n                        <PieChart>\n                          <Pie data={[{ name: 'Basic', value: 400 }, { name: 'Advanced', value: 300 }, { name: 'Enterprise', value: 200 }]} cx=\"50%\" cy=\"50%\" innerRadius={60} outerRadius={80} paddingAngle={5} dataKey=\"value\">\n                            {['#f97316', '#3b82f6', '#10b981'].map((color, index) => <Cell key={`cell-${index}`} fill={color} />)}\n                          </Pie>\n                          <RechartsTooltip /><Legend />\n                        </PieChart>\n                      </ResponsiveContainer>\n                    </CardContent>\n                  </Card>\n\n                  <Card className=\"hover-elevate\">\n                    <CardHeader className=\"flex flex-row items-center justify-between\">\n                      <div><CardTitle className=\"text-lg\">Revenue Growth</CardTitle><CardDescription>Month-on-month sales (â‚¹)</CardDescription></div>\n                      <Select value={selectedAdminRevenueYear.toString()} onValueChange={(val) => setSelectedAdminRevenueYear(parseInt(val))}>\n                        <SelectTrigger className=\"w-[100px]\"><SelectValue placeholder=\"Year\" /></SelectTrigger>\n                        <SelectContent>{[2024, 2025, 2026].map(y => <SelectItem key={y} value={y.toString()}>{y}</SelectItem>)}</SelectContent>\n                      </Select>\n                    </CardHeader>\n                    <CardContent className=\"h-[300px]\">\n                      <ResponsiveContainer width=\"100%\" height=\"100%\">\n                        <LineChart data={[{ month: \"Jan\", rev: 120000 }, { month: \"Feb\", rev: 145000 }, { month: \"Mar\", rev: 168000 }, { month: \"Apr\", rev: 155000 }, { month: \"May\", rev: 192000 }, { month: \"Jun\", rev: 225000 }, { month: \"Jul\", rev: 254000 }, { month: \"Aug\", rev: 283000 }, { month: \"Sep\", rev: 310000 }, { month: \"Oct\", rev: 345000 }, { month: \"Nov\", rev: 380000 }, { month: \"Dec\", rev: 425000 }]}>\n                          <CartesianGrid strokeDasharray=\"3 3\" vertical={false} stroke=\"hsl(var(--muted-foreground) / 0.1)\" />\n                          <XAxis dataKey=\"month\" axisLine={false} tickLine={false} tick={{fill: 'hsl(var(--muted-foreground))', fontSize: 12}} />\n                          <YAxis axisLine={false} tickLine={false} tick={{fill: 'hsl(var(--muted-foreground))', fontSize: 12}} />\n                          <RechartsTooltip contentStyle={{ backgroundColor: 'hsl(var(--card))', borderColor: 'hsl(var(--border))', borderRadius: '8px' }} />\n                          <Line type=\"monotone\" dataKey=\"rev\" stroke=\"hsl(var(--primary))\" strokeWidth={2} dot={{ r: 4, fill: 'hsl(var(--primary))' }} />\n                        </LineChart>\n                      </ResponsiveContainer>\n                    </CardContent>\n                  </Card>\n\n                  <Card className=\"hover-elevate\">\n                    <CardHeader className=\"flex flex-row items-center justify-between\">\n                      <div><CardTitle className=\"text-lg\">Credit Usage</CardTitle><CardDescription>Daily platform consumption</CardDescription></div>\n                      <div className=\"flex gap-2\">\n                        <Select value={selectedAdminCreditMonth.toString()} onValueChange={(val) => setSelectedAdminCreditMonth(parseInt(val))}>\n                          <SelectTrigger className=\"w-[110px]\"><SelectValue placeholder=\"Month\" /></SelectTrigger>\n                          <SelectContent>{[\"Jan\", \"Feb\", \"Mar\", \"Apr\", \"May\", \"Jun\", \"Jul\", \"Aug\", \"Sep\", \"Oct\", \"Nov\", \"Dec\"].map((m, i) => <SelectItem key={m} value={i.toString()}>{m}</SelectItem>)}</SelectContent>\n                        </Select>\n                        <Select value={selectedAdminCreditYear.toString()} onValueChange={(val) => setSelectedAdminCreditYear(parseInt(val))}>\n                          <SelectTrigger className=\"w-[100px]\"><SelectValue placeholder=\"Year\" /></SelectTrigger>\n                          <SelectContent>{[2024, 2025, 2026].map(y => <SelectItem key={y} value={y.toString()}>{y}</SelectItem>)}</SelectContent>\n                        </Select>\n                      </div>\n                    </CardHeader>\n                    <CardContent className=\"h-[300px]\">\n                      <ResponsiveContainer width=\"100%\" height=\"100%\">\n                        <AreaChart data={[{ day: \"1\", usage: 4500 }, { day: \"5\", usage: 5200 }, { day: \"10\", usage: 6100 }, { day: \"15\", usage: 5800 }, { day: \"20\", usage: 7200 }, { day: \"25\", usage: 8500 }, { day: \"30\", usage: 9400 }]}>\n                          <defs><linearGradient id=\"colorUsage\" x1=\"0\" y1=\"0\" x2=\"0\" y2=\"1\"><stop offset=\"5%\" stopColor=\"hsl(var(--primary))\" stopOpacity={0.3}/><stop offset=\"95%\" stopColor=\"hsl(var(--primary))\" stopOpacity={0}/></linearGradient></defs>\n                          <CartesianGrid strokeDasharray=\"3 3\" vertical={false} stroke=\"hsl(var(--muted-foreground) / 0.1)\" />\n                          <XAxis dataKey=\"day\" axisLine={false} tickLine={false} tick={{fill: 'hsl(var(--muted-foreground))', fontSize: 12}} />\n                          <YAxis axisLine={false} tickLine={false} tick={{fill: 'hsl(var(--muted-foreground))', fontSize: 12}} />\n                          <RechartsTooltip contentStyle={{ backgroundColor: 'hsl(var(--card))', borderColor: 'hsl(var(--border))', borderRadius: '8px' }} />\n                          <Area type=\"monotone\" dataKey=\"usage\" stroke=\"hsl(var(--primary))\" fillOpacity={1} fill=\"url(#colorUsage)\" />\n                        </AreaChart>\n                      </ResponsiveContainer>\n                    </CardContent>\n                  </Card>\n                </div>\n              )}\n\n              {!isAdmin && (\n                <>\n                  <Card className=\"hover-elevate\">\n                    <CardHeader className=\"flex flex-row items-center justify-between gap-4\">\n                      <div><CardTitle>Recent Logs</CardTitle><CardDescription>Last 50 lead records</CardDescription></div>\n                      <div className=\"flex items-center gap-2\">\n                        <Select value={logsCampaignFilter} onValueChange={setLogsCampaignFilter}>\n                          <SelectTrigger className=\"w-[160px] h-8 text-xs\"><SelectValue placeholder=\"Filter by Campaign\" /></SelectTrigger>\n                          <SelectContent><SelectItem value=\"all\">All Campaigns</SelectItem>{campaigns.map(c => <SelectItem key={c._id} value={c._id}>{c.name}</SelectItem>)}</SelectContent>\n                        </Select>\n                        <Button variant=\"outline\" size=\"sm\" onClick={() => setActiveTab(\"callhistory\")}>View More<ChevronRight className=\"ml-2 h-4 w-4\" /></Button>\n                      </div>\n                    </CardHeader>\n                    <CardContent className=\"overflow-x-auto\">\n                      <Table>\n                        <TableHeader><TableRow><TableHead>Lead Name</TableHead><TableHead>Campaign</TableHead><TableHead>Channel</TableHead><TableHead>Status</TableHead><TableHead className=\"text-right\">Last Interaction</TableHead><TableHead className=\"text-right\">Action</TableHead></TableRow></TableHeader>\n                        <TableBody>\n                          {leads.filter(l => logsCampaignFilter === \"all\" || l.campaignId === logsCampaignFilter).slice(0, 50).map((lead) => (\n                            <TableRow key={lead._id}>\n                              <TableCell className=\"font-medium\">{lead.name}</TableCell>\n                              <TableCell>{lead.campaignName || \"General\"}</TableCell>\n                              <TableCell>\n                                <div className=\"flex items-center gap-2\">\n                                  <TooltipProvider><Tooltip><TooltipTrigger asChild><Phone className=\"h-4 w-4 text-primary cursor-pointer\" /></TooltipTrigger><TooltipContent>AI Call Enabled</TooltipContent></Tooltip></TooltipProvider>\n                                  <TooltipProvider><Tooltip><TooltipTrigger asChild><MessageSquare className=\"h-4 w-4 text-blue-500 cursor-pointer\" /></TooltipTrigger><TooltipContent>SMS Enabled</TooltipContent></Tooltip></TooltipProvider>\n                                  <TooltipProvider><Tooltip><TooltipTrigger asChild><MessageCircle className=\"h-4 w-4 text-green-500 cursor-pointer\" /></TooltipTrigger><TooltipContent>WhatsApp Enabled</TooltipContent></Tooltip></TooltipProvider>\n                                </div>\n                              </TableCell>\n                              <TableCell>\n                                <TooltipProvider><Tooltip><TooltipTrigger asChild><Badge variant={lead.status === 'Interested' ? 'default' : 'secondary'} className={`cursor-help ${lead.status === 'Interested' ? 'bg-green-500/15 text-green-600 dark:text-green-400 hover:bg-green-500/25 border-none' : ''}`}>{lead.status}</Badge></TooltipTrigger><TooltipContent className=\"max-w-xs\"><p className=\"text-xs font-semibold mb-1\">{lead.status} Meaning:</p><p className=\"text-xs opacity-90\">{lead.status === \"New\" && \"Initial lead entry, no contact yet.\"}{lead.status === \"In Progress\" && \"Active communication initiated.\"}{lead.status === \"Interested\" && \"Lead showed positive response.\"}{lead.status === \"Follow Up\" && \"Requires further interaction.\"}{lead.status === \"Closed\" && \"Deal successfully completed.\"}{lead.status === \"Unqualified\" && \"Not a fit for this campaign.\"}</p></TooltipContent></Tooltip></TooltipProvider>\n                              </TableCell>\n                              <TableCell className=\"text-right text-muted-foreground\">{formatTimeAgo(lead.lastContact)}</TableCell>\n                              <TableCell className=\"text-right\"><Button variant=\"ghost\" size=\"icon\" onClick={() => handleViewLead(lead)}><Eye className=\"h-4 w-4\" /></Button></TableCell>\n                            </TableRow>\n                          ))}\n                          {leads.length === 0 && <TableRow><TableCell colSpan={6} className=\"text-center text-muted-foreground py-8\">No leads yet.</TableCell></TableRow>}\n                        </TableBody>\n                      </Table>\n                    </CardContent>\n                  </Card>\n\n                  <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6\">\n                    <Card className=\"hover-elevate shadow-lg border-primary/10 overflow-hidden group\">\n                      <CardHeader className=\"flex flex-row items-center justify-between gap-4\">\n                        <div><CardTitle className=\"flex items-center gap-2\"><Zap className=\"h-5 w-5 text-primary\" />Lead Distribution</CardTitle><CardDescription>Visual breakdown by status</CardDescription></div>\n                        <Select value={overviewCampaignFilter} onValueChange={setOverviewCampaignFilter}>\n                          <SelectTrigger className=\"w-[160px] h-8 text-xs\"><SelectValue placeholder=\"All Campaigns\" /></SelectTrigger>\n                          <SelectContent><SelectItem value=\"all\">All Campaigns</SelectItem>{campaigns.map(c => <SelectItem key={c._id} value={c._id}>{c.name}</SelectItem>)}</SelectContent>\n                        </Select>\n                      </CardHeader>\n                      <CardContent className=\"h-80 relative\">\n                        {leads.length > 0 ? (\n                          <><ResponsiveContainer width=\"100%\" height=\"100%\"><PieChart><defs><filter id=\"advancedShadow\" x=\"-20%\" y=\"-20%\" width=\"140%\" height=\"140%\"><feGaussianBlur in=\"SourceAlpha\" stdDeviation=\"3\" /><feOffset dx=\"2\" dy=\"4\" result=\"offsetblur\" /><feComponentTransfer><feFuncA type=\"linear\" slope=\"0.5\" /></feComponentTransfer><feMerge><feMergeNode /><feMergeNode in=\"SourceGraphic\" /></feMerge></filter></defs><Pie data={[{ name: \"New\", value: leads.filter(l => l.status === \"New\" && (overviewCampaignFilter === \"all\" || l.campaignId === overviewCampaignFilter)).length }, { name: \"Interested\", value: leads.filter(l => l.status === \"Interested\" && (overviewCampaignFilter === \"all\" || l.campaignId === overviewCampaignFilter)).length }, { name: \"Follow Up\", value: leads.filter(l => l.status === \"Follow Up\" && (overviewCampaignFilter === \"all\" || l.campaignId === overviewCampaignFilter)).length }, { name: \"In Progress\", value: leads.filter(l => l.status === \"In Progress\" && (overviewCampaignFilter === \"all\" || l.campaignId === overviewCampaignFilter)).length }, { name: \"Closed\", value: leads.filter(l => l.status === \"Closed\" && (overviewCampaignFilter === \"all\" || l.campaignId === overviewCampaignFilter)).length }, { name: \"Unqualified\", value: leads.filter(l => l.status === \"Unqualified\" && (overviewCampaignFilter === \"all\" || l.campaignId === overviewCampaignFilter)).length }].filter(d => d.value > 0)} cx=\"50%\" cy=\"50%\" innerRadius={70} outerRadius={95} paddingAngle={5} dataKey=\"value\" stroke=\"none\">{[\"#f97316\", \"#10b981\", \"#3b82f6\", \"#8b5cf6\", \"#6366f1\", \"#94a3b8\"].map((color, index) => <Cell key={`cell-${index}`} fill={color} filter=\"url(#advancedShadow)\" className=\"hover:opacity-80 transition-all duration-300 cursor-pointer\" />)}</Pie><RechartsTooltip contentStyle={{ backgroundColor: 'hsl(var(--card))', borderColor: 'hsl(var(--border))', borderRadius: '12px', boxShadow: '0 10px 15px -3px rgb(0 0 0 / 0.1)' }} /><Legend verticalAlign=\"bottom\" height={36} iconType=\"circle\" /></PieChart></ResponsiveContainer><div className=\"absolute inset-0 flex items-center justify-center pointer-events-none mb-9\"><div className=\"text-center animate-in fade-in zoom-in duration-500\"><p className=\"text-3xl font-extrabold tracking-tighter\">{leads.filter(l => overviewCampaignFilter === \"all\" || l.campaignId === overviewCampaignFilter).length}</p><p className=\"text-[10px] text-muted-foreground uppercase tracking-widest font-bold\">Total Leads</p></div></div></>\n                        ) : <div className=\"flex h-full items-center justify-center text-muted-foreground\">No data yet</div>}\n                      </CardContent>\n                    </Card>\n\n                    <Card className=\"hover-elevate shadow-lg border-primary/10 overflow-hidden\">\n                      <CardHeader className=\"flex flex-row items-center justify-between gap-4\">\n                        <div><CardTitle className=\"flex items-center gap-2\"><BarChart className=\"h-5 w-5 text-primary\" />Growth Analytics</CardTitle><CardDescription>Monthly lead acquisition trajectory</CardDescription></div>\n                        <div className=\"flex items-center gap-2\">\n                          <Select value={dailyActivityCampaignFilter} onValueChange={setDailyActivityCampaignFilter}>\n                            <SelectTrigger className=\"w-[160px] h-8 text-xs\"><SelectValue placeholder=\"Filter by Campaign\" /></SelectTrigger>\n                            <SelectContent><SelectItem value=\"all\">All Campaigns</SelectItem>{campaigns.map(c => <SelectItem key={c._id} value={c._id}>{c.name}</SelectItem>)}</SelectContent>\n                          </Select>\n                          <Select \n                            value={selectedChartYear.toString()} \n                            onValueChange={(v) => setSelectedChartYear(parseInt(v))}\n                          >\n                            <SelectTrigger className=\"w-[100px] h-8 text-xs\">\n                              <SelectValue placeholder=\"Year\" />\n                            </SelectTrigger>\n                            <SelectContent>\n                              {[2024, 2025, 2026].map(y => (\n                                <SelectItem key={y} value={y.toString()}>{y}</SelectItem>\n                              ))}\n                            </SelectContent>\n                          </Select>\n                        </div>\n                      </CardHeader>\n                      <CardContent className=\"h-80\"><ResponsiveContainer width=\"100%\" height=\"100%\"><AreaChart data={[{ name: \"Jan\", leads: 400 }, { name: \"Feb\", leads: 300 }, { name: \"Mar\", leads: 600 }, { name: \"Apr\", leads: 800 }, { name: \"May\", leads: 500 }, { name: \"Jun\", leads: 900 }]}><defs><linearGradient id=\"colorGrowth\" x1=\"0\" y1=\"0\" x2=\"0\" y2=\"1\"><stop offset=\"5%\" stopColor=\"hsl(var(--primary))\" stopOpacity={0.6}/><stop offset=\"95%\" stopColor=\"hsl(var(--primary))\" stopOpacity={0}/></linearGradient></defs><CartesianGrid strokeDasharray=\"3 3\" vertical={false} stroke=\"hsl(var(--border))\" opacity={0.3} /><XAxis dataKey=\"name\" axisLine={false} tickLine={false} tick={{ fill: 'hsl(var(--muted-foreground))', fontSize: 12 }} /><YAxis axisLine={false} tickLine={false} tick={{ fill: 'hsl(var(--muted-foreground))', fontSize: 12 }} /><RechartsTooltip contentStyle={{ backgroundColor: 'hsl(var(--card))', borderColor: 'hsl(var(--border))', borderRadius: '12px', boxShadow: '0 10px 15px -3px rgb(0 0 0 / 0.1)' }} /><Area type=\"monotone\" dataKey=\"leads\" stroke=\"hsl(var(--primary))\" strokeWidth={5} fillOpacity={1} fill=\"url(#colorGrowth)\" animationDuration={2000} strokeLinecap=\"round\" /></AreaChart></ResponsiveContainer></CardContent>\n                    </Card>\n                  </div>\n\n                  <Card className=\"hover-elevate shadow-lg border-primary/10 overflow-hidden\">\n                    <CardHeader className=\"flex flex-row items-center justify-between gap-4\">\n                      <div><CardTitle className=\"flex items-center gap-2\"><History className=\"h-5 w-5 text-primary\" />Daily Call Activity</CardTitle><CardDescription>AI Call attempts per day</CardDescription></div>\n                      <Select value={callActivityCampaignFilter} onValueChange={setCallActivityCampaignFilter}>\n                        <SelectTrigger className=\"w-[160px] h-8 text-xs\"><SelectValue placeholder=\"Filter by Campaign\" /></SelectTrigger>\n                        <SelectContent><SelectItem value=\"all\">All Campaigns</SelectItem>{campaigns.map(c => <SelectItem key={c._id} value={c._id}>{c.name}</SelectItem>)}</SelectContent>\n                      </Select>\n                      <Select \n                        value={selectedChartMonth.toString()} \n                        onValueChange={(v) => setSelectedChartMonth(parseInt(v))}\n                      >\n                        <SelectTrigger className=\"w-[110px] h-8 text-xs\">\n                          <SelectValue placeholder=\"Month\" />\n                        </SelectTrigger>\n                        <SelectContent>\n                          {[\"Jan\", \"Feb\", \"Mar\", \"Apr\", \"May\", \"Jun\", \"Jul\", \"Aug\", \"Sep\", \"Oct\", \"Nov\", \"Dec\"].map((m, i) => (\n                            <SelectItem key={m} value={i.toString()}>{m}</SelectItem>\n                          ))}\n                        </SelectContent>\n                      </Select>\n                      <Select \n                        value={selectedChartYear.toString()} \n                        onValueChange={(v) => setSelectedChartYear(parseInt(v))}\n                      >\n                        <SelectTrigger className=\"w-[100px] h-8 text-xs\">\n                          <SelectValue placeholder=\"Year\" />\n                        </SelectTrigger>\n                        <SelectContent>\n                          {[2024, 2025, 2026].map(y => (\n                            <SelectItem key={y} value={y.toString()}>{y}</SelectItem>\n                          ))}\n                        </SelectContent>\n                      </Select>\n                    </CardHeader>\n                    <CardContent className=\"h-80\"><ResponsiveContainer width=\"100%\" height=\"100%\"><LineChart data={[{ name: \"Mon\", calls: 120 }, { name: \"Tue\", calls: 150 }, { name: \"Wed\", calls: 180 }, { name: \"Thu\", calls: 140 }, { name: \"Fri\", calls: 160 }, { name: \"Sat\", calls: 90 }, { name: \"Sun\", calls: 70 }]}><CartesianGrid strokeDasharray=\"3 3\" vertical={false} stroke=\"hsl(var(--border))\" opacity={0.3} /><XAxis dataKey=\"name\" axisLine={false} tickLine={false} tick={{ fill: 'hsl(var(--muted-foreground))', fontSize: 12 }} /><YAxis axisLine={false} tickLine={false} tick={{ fill: 'hsl(var(--muted-foreground))', fontSize: 12 }} /><RechartsTooltip contentStyle={{ backgroundColor: 'hsl(var(--card))', borderColor: 'hsl(var(--border))', borderRadius: '12px', boxShadow: '0 10px 15px -3px rgb(0 0 0 / 0.1)' }} /><Line type=\"monotone\" dataKey=\"calls\" stroke=\"hsl(var(--primary))\" strokeWidth={4} dot={{ r: 6, fill: \"hsl(var(--primary))\", strokeWidth: 2, stroke: \"hsl(var(--background))\" }} /></LineChart></ResponsiveContainer></CardContent>\n                  </Card>\n\n                  <Card>\n                    <CardHeader className=\"flex flex-row items-center justify-between\">\n                      <div><CardTitle>Notes</CardTitle><CardDescription>All your saved notes</CardDescription></div>\n                      <Dialog open={isAddNoteOpen} onOpenChange={setIsAddNoteOpen}>\n                        <DialogTrigger asChild><Button><Plus className=\"mr-2 h-4 w-4\" /> Add Note</Button></DialogTrigger>\n                        <DialogContent className=\"sm:max-w-[500px]\">\n                          <DialogHeader><DialogTitle>Add Note</DialogTitle></DialogHeader>\n                          <div className=\"space-y-4\">\n                            <div className=\"space-y-2\"><Label htmlFor=\"note-title\">Title</Label><Input id=\"note-title\" placeholder=\"Note title\" value={noteForm.title} onChange={(e) => setNoteForm({...noteForm, title: e.target.value})} data-testid=\"input-note-title\" /></div>\n                            <div className=\"space-y-2\"><Label htmlFor=\"note-content\">Content</Label><Textarea id=\"note-content\" placeholder=\"Note content\" className=\"min-h-32\" value={noteForm.content} onChange={(e) => setNoteForm({...noteForm, content: e.target.value})} data-testid=\"input-note-content\" /></div>\n                          </div>\n                          <DialogFooter>\n                            <Button variant=\"outline\" onClick={() => { setIsAddNoteOpen(false); setNoteForm({title: \"\", content: \"\"}); }} data-testid=\"button-cancel\">Cancel</Button>\n                            <Button onClick={async () => { if (noteForm.title.trim() && noteForm.content.trim()) { const newNote = await notesApi.create(noteForm); setNotes([newNote, ...notes]); setNoteForm({title: \"\", content: \"\"}); setIsAddNoteOpen(false); toast({title: \"Success\", description: \"Note added successfully\"}); } }} data-testid=\"button-add-note\">Add Note</Button>\n                          </DialogFooter>\n                        </DialogContent>\n                      </Dialog>\n                    </CardHeader>\n                    <CardContent>\n                      <div className=\"space-y-2 max-h-96 overflow-y-auto\">\n                        {notes.length > 0 ? (\n                          notes.map((note) => (\n                            <div key={note._id} className=\"p-3 border rounded-md bg-muted/30 hover:bg-muted/50 transition-colors\" data-testid={`card-note-${note._id}`}>\n                              <div className=\"flex items-start justify-between gap-3\">\n                                <div className=\"flex-1 min-w-0\"><h4 className=\"font-medium text-sm\">{note.title}</h4><p className=\"text-sm text-muted-foreground mt-1 line-clamp-2\">{note.content}</p><p className=\"text-xs text-muted-foreground mt-2\">{new Date(note.createdAt).toLocaleDateString()}</p></div>\n                                <div className=\"flex gap-1\">\n                                  <Dialog open={isEditNoteOpen && selectedNote?._id === note._id} onOpenChange={(open) => { if (!open) { setSelectedNote(null); setNoteForm({title: \"\", content: \"\"}); } setIsEditNoteOpen(open); }}>\n                                    <DialogTrigger asChild><Button size=\"icon\" variant=\"ghost\" className=\"h-8 w-8\" onClick={() => { setSelectedNote(note); setNoteForm({title: note.title, content: note.content}); }} data-testid={`button-edit-note-${note._id}`}><Edit3 className=\"h-4 w-4\" /></Button></DialogTrigger>\n                                    <DialogContent className=\"sm:max-w-[500px]\">\n                                      <DialogHeader><DialogTitle>Edit Note</DialogTitle></DialogHeader>\n                                      <div className=\"space-y-4\">\n                                        <div className=\"space-y-2\"><Label htmlFor=\"edit-note-title\">Title</Label><Input id=\"edit-note-title\" placeholder=\"Note title\" value={noteForm.title} onChange={(e) => setNoteForm({...noteForm, title: e.target.value})} /></div>\n                                        <div className=\"space-y-2\"><Label htmlFor=\"edit-note-content\">Content</Label><Textarea id=\"edit-note-content\" placeholder=\"Note content\" className=\"min-h-32\" value={noteForm.content} onChange={(e) => setNoteForm({...noteForm, content: e.target.value})} /></div>\n                                      </div>\n                                    <DialogFooter><Button variant=\"outline\" onClick={() => { setIsEditNoteOpen(false); setSelectedNote(null); setNoteForm({title: \"\", content: \"\"}); }}>Cancel</Button><Button onClick={async () => { if (selectedNote && noteForm.title.trim() && noteForm.content.trim()) { const updated = await notesApi.update(selectedNote._id, noteForm); setNotes(notes.map(n => n._id === (selectedNote as any)._id ? updated : n)); setNoteForm({title: \"\", content: \"\"}); setIsEditNoteOpen(false); setSelectedNote(null); toast({title: \"Success\", description: \"Note updated successfully\"}); } }}>Update Note</Button></DialogFooter>\n                                    </DialogContent>\n                                  </Dialog>\n                                  <Button size=\"icon\" variant=\"ghost\" className=\"h-8 w-8 text-muted-foreground hover:text-destructive\" onClick={async () => { if (confirm(\"Delete this note?\")) { await notesApi.delete(note._id); setNotes(notes.filter(n => n._id !== note._id)); toast({title: \"Success\", description: \"Note deleted\"}); } }} data-testid={`button-delete-note-${note._id}`}><Trash2 className=\"h-4 w-4\" /></Button>\n                                </div>\n                              </div>\n                            </div>\n                          ))\n                        ) : <div className=\"text-center py-6 text-muted-foreground text-sm\">No notes found.</div>}\n                      </div>\n                    </CardContent>\n                  </Card>\n\n                  {/* Credit Usage Daily Chart */}\n                  <Card className=\"hover-elevate mt-6\">\n                    <CardHeader className=\"flex flex-row items-center justify-between gap-4 space-y-0 pb-4\">\n                      <div>\n                        <CardTitle className=\"text-base font-semibold\">Daily Credit Usage</CardTitle>\n                        <CardDescription>Daily credit consumption for Calls, SMS, and WhatsApp</CardDescription>\n                      </div>\n                      <div className=\"flex flex-wrap items-center gap-2\">\n                        <Select value={creditUsageCampaignFilter} onValueChange={setCreditUsageCampaignFilter}>\n                          <SelectTrigger className=\"w-[140px] h-8 text-xs\">\n                            <SelectValue placeholder=\"Campaign\" />\n                          </SelectTrigger>\n                          <SelectContent>\n                            <SelectItem value=\"all\">All Campaigns</SelectItem>\n                            {campaigns.map(c => (\n                              <SelectItem key={c._id} value={c._id}>{c.name}</SelectItem>\n                            ))}\n                          </SelectContent>\n                        </Select>\n                        <Select value={creditUsageMonthFilter.toString()} onValueChange={(v) => setCreditUsageMonthFilter(parseInt(v))}>\n                          <SelectTrigger className=\"w-[110px] h-8 text-xs\">\n                            <SelectValue placeholder=\"Month\" />\n                          </SelectTrigger>\n                          <SelectContent>\n                            {[\"Jan\", \"Feb\", \"Mar\", \"Apr\", \"May\", \"Jun\", \"Jul\", \"Aug\", \"Sep\", \"Oct\", \"Nov\", \"Dec\"].map((m, i) => (\n                              <SelectItem key={m} value={i.toString()}>{m}</SelectItem>\n                            ))}\n                          </SelectContent>\n                        </Select>\n                        <Select value={creditUsageYearFilter.toString()} onValueChange={(v) => setCreditUsageYearFilter(parseInt(v))}>\n                          <SelectTrigger className=\"w-[90px] h-8 text-xs\">\n                            <SelectValue placeholder=\"Year\" />\n                          </SelectTrigger>\n                          <SelectContent>\n                            {[2024, 2025, 2026].map(y => (\n                              <SelectItem key={y} value={y.toString()}>{y}</SelectItem>\n                            ))}\n                          </SelectContent>\n                        </Select>\n                      </div>\n                    </CardHeader>\n                    <CardContent className=\"h-[300px] mt-2\">\n                      <ResponsiveContainer width=\"100%\" height=\"100%\">\n                        <LineChart data={creditUsageData} margin={{ top: 5, right: 10, left: 0, bottom: 0 }}>\n                          <CartesianGrid strokeDasharray=\"3 3\" vertical={false} stroke={theme === \"dark\" ? \"#333\" : \"#eee\"} />\n                          <XAxis \n                            dataKey=\"date\" \n                            fontSize={11} \n                            tickLine={false} \n                            axisLine={false} \n                            tick={{ fill: \"hsl(var(--muted-foreground))\" }}\n                          />\n                          <YAxis \n                            fontSize={11} \n                            tickLine={false} \n                            axisLine={false} \n                            tick={{ fill: \"hsl(var(--muted-foreground))\" }}\n                          />\n                          <RechartsTooltip \n                            contentStyle={{ \n                              backgroundColor: \"hsl(var(--card))\", \n                              borderColor: \"hsl(var(--border))\",\n                              borderRadius: \"8px\",\n                              fontSize: \"12px\"\n                            }}\n                          />\n                          <Legend iconType=\"circle\" wrapperStyle={{ fontSize: '11px', paddingTop: '10px' }} />\n                          <Line \n                            type=\"monotone\" \n                            dataKey=\"call\" \n                            name=\"Calls\"\n                            stroke=\"#f97316\" \n                            strokeWidth={2} \n                            dot={{ r: 3, fill: \"#f97316\" }} \n                            activeDot={{ r: 5 }} \n                          />\n                          <Line \n                            type=\"monotone\" \n                            dataKey=\"sms\" \n                            name=\"SMS\"\n                            stroke=\"#3b82f6\" \n                            strokeWidth={2} \n                            dot={{ r: 3, fill: \"#3b82f6\" }} \n                            activeDot={{ r: 5 }} \n                          />\n                          <Line \n                            type=\"monotone\" \n                            dataKey=\"whatsapp\" \n                            name=\"WhatsApp\"\n                            stroke=\"#22c55e\" \n                            strokeWidth={2} \n                            dot={{ r: 3, fill: \"#22c55e\" }} \n                            activeDot={{ r: 5 }} \n                          />\n                        </LineChart>\n                      </ResponsiveContainer>\n                    </CardContent>\n                  </Card>\n                </>\n              )}\n            </div>\n          )}\n\n          {activeTab === \"callhistory\" && !isAdmin && (\n            <div className=\"space-y-6\">\n              <div className=\"flex justify-between items-center\">\n                <h1 className=\"text-3xl font-bold tracking-tight\">Call History</h1>\n              </div>\n\n              <div className=\"flex flex-wrap items-center gap-4 bg-muted/20 p-4 rounded-lg border border-border/50\">\n                <div className=\"relative min-w-[240px]\">\n                  <Search className=\"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground\" />\n                  <Input \n                    placeholder=\"Search name or phone...\" \n                    className=\"pl-9 h-9\" \n                    value={searchTerm}\n                    onChange={(e) => setSearchTerm(e.target.value)}\n                  />\n                </div>\n\n                <Select value={campaignFilter} onValueChange={setCampaignFilter}>\n                  <SelectTrigger className=\"w-[200px] h-9\">\n                    <SelectValue placeholder=\"All Campaigns\" />\n                  </SelectTrigger>\n                  <SelectContent>\n                    <SelectItem value=\"all\">All Campaigns</SelectItem>\n                    {campaigns.map(c => (\n                      <SelectItem key={c._id} value={c._id}>{c.name}</SelectItem>\n                    ))}\n                  </SelectContent>\n                </Select>\n\n                <div className=\"flex items-center gap-2 h-9\">\n                  <Input \n                    type=\"date\" \n                    className=\"h-9 w-[150px]\"\n                    value={dateRange.start} \n                    onChange={(e) => setDateRange(prev => ({ ...prev, start: e.target.value }))}\n                  />\n                  <span className=\"text-muted-foreground\">â†’</span>\n                  <Input \n                    type=\"date\" \n                    className=\"h-9 w-[150px]\"\n                    value={dateRange.end} \n                    onChange={(e) => setDateRange(prev => ({ ...prev, end: e.target.value }))}\n                  />\n                </div>\n              </div>\n\n              <Card className=\"hover-elevate\">\n                <CardHeader>\n                  <CardTitle>Call Records</CardTitle>\n                  <CardDescription>Logs of all AI agent calling activity.</CardDescription>\n                </CardHeader>\n                <CardContent>\n                  <Table>\n                    <TableHeader>\n                      <TableRow>\n                        <TableHead>Lead Name</TableHead>\n                        <TableHead>Campaign</TableHead>\n                        <TableHead>Call Date & Time</TableHead>\n                        <TableHead>Status</TableHead>\n                        <TableHead>Duration</TableHead>\n                        <TableHead>Recording</TableHead>\n                        <TableHead className=\"text-right\">Call</TableHead>\n                        <TableHead className=\"text-right\">SMS</TableHead>\n                      </TableRow>\n                    </TableHeader>\n                    <TableBody>\n                      {leads.flatMap(lead => {\n                        const matchesSearch = lead.name.toLowerCase().includes(searchTerm.toLowerCase()) || lead.phone.includes(searchTerm);\n                        const matchesCampaign = campaignFilter === \"all\" || lead.campaignId === campaignFilter;\n                        \n                        return (lead.history || [])\n                          .filter(h => {\n                            if (h.type !== 'call') return false;\n                            if (!matchesSearch || !matchesCampaign) return false;\n                            \n                            if (dateRange.start || dateRange.end) {\n                              const contactDate = new Date(h.date);\n                              if (dateRange.start && contactDate < new Date(dateRange.start)) return false;\n                              if (dateRange.end && contactDate > new Date(dateRange.end)) return false;\n                            }\n                            return true;\n                          })\n                          .map((history, idx) => (\n                            <TableRow key={`${lead._id}-${idx}`}>\n                              <TableCell className=\"font-medium\">{lead.name}</TableCell>\n                              <TableCell>{lead.campaignName ? <Badge variant=\"secondary\">{lead.campaignName}</Badge> : <span className=\"text-muted-foreground\">-</span>}</TableCell>\n                              <TableCell className=\"text-sm\">{new Date(history.date).toLocaleString()}</TableCell>\n                              <TableCell><Badge variant=\"outline\">{history.outcome}</Badge></TableCell>\n                              <TableCell className=\"text-sm\">{history.duration}</TableCell>\n                              <TableCell><Button size=\"sm\" variant=\"ghost\"><Play className=\"h-4 w-4 mr-1\" /> Play</Button></TableCell>\n                              <TableCell className=\"text-right\"><Button size=\"sm\" variant=\"ghost\" onClick={(e) => { e.stopPropagation(); setCallConfirm({ leadId: lead._id, type: \"call\" }); }}><Phone className=\"h-4 w-4\" /></Button></TableCell>\n                              <TableCell className=\"text-right\"><Button size=\"sm\" variant=\"ghost\" onClick={(e) => { e.stopPropagation(); setCallConfirm({ leadId: lead._id, type: \"sms\" }); }}><MessageSquare className=\"h-4 w-4\" /></Button></TableCell>\n                            </TableRow>\n                          ));\n                      })}\n                      {leads.flatMap(lead => (lead.history || []).filter(h => h.type === 'call')).length === 0 && <TableRow><TableCell colSpan={8} className=\"text-center text-muted-foreground py-8\">No call history yet.</TableCell></TableRow>}\n                    </TableBody>\n                  </Table>\n                </CardContent>\n              </Card>\n            </div>\n          )}\n\n          {activeTab === \"crm\" && !isAdmin && (\n             <div className=\"space-y-6\">\n               <div className=\"flex justify-between items-center\">\n                <h1 className=\"text-3xl font-bold tracking-tight\">Lead CRM</h1>\n                <div className=\"flex gap-2\">\n                  <Button variant=\"outline\">Import CSV</Button>\n                  <Dialog open={isAddLeadOpen} onOpenChange={setIsAddLeadOpen}>\n                    <DialogTrigger asChild><Button><Plus className=\"mr-2 h-4 w-4\" /> Add Lead</Button></DialogTrigger>\n                    <DialogContent>\n                      <DialogHeader><DialogTitle>Add New Lead</DialogTitle><DialogDescription>Enter the details of the new prospect.</DialogDescription></DialogHeader>\n                      <form onSubmit={handleAddLead} className=\"space-y-4 py-4\">\n                        <div className=\"grid grid-cols-2 gap-4\">\n                          <div className=\"space-y-2\"><Label htmlFor=\"name\">Full Name <span className=\"text-destructive\">*</span></Label><Input id=\"name\" placeholder=\"John Doe\" value={newLead.name} onChange={e => setNewLead({...newLead, name: e.target.value})} className={leadErrors.name ? \"border-destructive\" : \"\"} />{leadErrors.name && <p className=\"text-xs text-destructive\">{leadErrors.name}</p>}</div>\n                          <div className=\"space-y-2\"><Label htmlFor=\"company\">Company</Label><Input id=\"company\" placeholder=\"Acme Inc\" value={newLead.company} onChange={e => setNewLead({...newLead, company: e.target.value})} /></div>\n                        </div>\n                        <div className=\"space-y-2\"><Label htmlFor=\"email\">Email</Label><Input id=\"email\" type=\"email\" placeholder=\"john@example.com\" value={newLead.email} onChange={e => setNewLead({...newLead, email: e.target.value})} className={leadErrors.email ? \"border-destructive\" : \"\"} />{leadErrors.email && <p className=\"text-xs text-destructive\">{leadErrors.email}</p>}</div>\n                        <div className=\"space-y-2\"><Label htmlFor=\"phone\">Phone Number <span className=\"text-destructive\">*</span></Label><Input id=\"phone\" placeholder=\"+1 (555) 000-0000\" value={newLead.phone} onChange={e => setNewLead({...newLead, phone: e.target.value})} className={leadErrors.phone ? \"border-destructive\" : \"\"} />{leadErrors.phone && <p className=\"text-xs text-destructive\">{leadErrors.phone}</p>}</div>\n                        <div className=\"space-y-2\"><Label htmlFor=\"notes\">Initial Notes</Label><Textarea id=\"notes\" placeholder=\"Any specific details...\" value={newLead.notes} onChange={e => setNewLead({...newLead, notes: e.target.value})} /></div>\n                        <div className=\"space-y-2\"><Label htmlFor=\"campaign\">Associated Campaign</Label><Select value={newLead.campaignId} onValueChange={(value) => setNewLead({...newLead, campaignId: value})}><SelectTrigger><SelectValue placeholder=\"Select a campaign (optional)\" /></SelectTrigger><SelectContent><SelectItem value=\"none\">No Campaign</SelectItem>{campaigns.map(c => <SelectItem key={c._id} value={c._id}>{c.name}</SelectItem>)}</SelectContent></Select></div>\n                        <DialogFooter><Button type=\"submit\" disabled={isSaving}>{isSaving ? <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" /> : null}Add Lead</Button></DialogFooter>\n                      </form>\n                    </DialogContent>\n                  </Dialog>\n\n                  {/* Edit Lead Dialog */}\n                  <Dialog open={isEditLeadOpen} onOpenChange={setIsEditLeadOpen}>\n                    <DialogContent>\n                      <DialogHeader><DialogTitle>Edit Lead</DialogTitle><DialogDescription>Update the details of the prospect.</DialogDescription></DialogHeader>\n                      <form onSubmit={handleUpdateLead} className=\"space-y-4 py-4\">\n                        <div className=\"grid grid-cols-2 gap-4\">\n                          <div className=\"space-y-2\"><Label htmlFor=\"edit-name\">Full Name <span className=\"text-destructive\">*</span></Label><Input id=\"edit-name\" placeholder=\"John Doe\" value={editLead.name} onChange={e => setEditLead({...editLead, name: e.target.value})} className={leadErrors.name ? \"border-destructive\" : \"\"} />{leadErrors.name && <p className=\"text-xs text-destructive\">{leadErrors.name}</p>}</div>\n                          <div className=\"space-y-2\"><Label htmlFor=\"edit-company\">Company</Label><Input id=\"edit-company\" placeholder=\"Acme Inc\" value={editLead.company} onChange={e => setEditLead({...editLead, company: e.target.value})} /></div>\n                        </div>\n                        <div className=\"space-y-2\"><Label htmlFor=\"edit-email\">Email</Label><Input id=\"edit-email\" type=\"email\" placeholder=\"john@example.com\" value={editLead.email} onChange={e => setEditLead({...editLead, email: e.target.value})} className={leadErrors.email ? \"border-destructive\" : \"\"} />{leadErrors.email && <p className=\"text-xs text-destructive\">{leadErrors.email}</p>}</div>\n                        <div className=\"space-y-2\"><Label htmlFor=\"edit-phone\">Phone Number <span className=\"text-destructive\">*</span></Label><Input id=\"edit-phone\" placeholder=\"+1 (555) 000-0000\" value={editLead.phone} onChange={e => setEditLead({...editLead, phone: e.target.value})} className={leadErrors.phone ? \"border-destructive\" : \"\"} />{leadErrors.phone && <p className=\"text-xs text-destructive\">{leadErrors.phone}</p>}</div>\n                        <div className=\"space-y-2\">\n                          <Label htmlFor=\"edit-status\">Status</Label>\n                          <Select value={editLead.status} onValueChange={(value: any) => setEditLead({...editLead, status: value})}>\n                            <SelectTrigger><SelectValue /></SelectTrigger>\n                            <SelectContent>\n                              <SelectItem value=\"New\">New</SelectItem>\n                              <SelectItem value=\"In Progress\">In Progress</SelectItem>\n                              <SelectItem value=\"Interested\">Interested</SelectItem>\n                              <SelectItem value=\"Follow Up\">Follow Up</SelectItem>\n                              <SelectItem value=\"Closed\">Closed</SelectItem>\n                              <SelectItem value=\"Unqualified\">Unqualified</SelectItem>\n                            </SelectContent>\n                          </Select>\n                        </div>\n                        <div className=\"space-y-2\"><Label htmlFor=\"edit-notes\">Notes</Label><Textarea id=\"edit-notes\" placeholder=\"Update notes...\" value={editLead.notes} onChange={e => setEditLead({...editLead, notes: e.target.value})} /></div>\n                        <div className=\"space-y-2\"><Label htmlFor=\"edit-campaign\">Associated Campaign</Label><Select value={editLead.campaignId} onValueChange={(value) => setEditLead({...editLead, campaignId: value})}><SelectTrigger><SelectValue placeholder=\"Select a campaign (optional)\" /></SelectTrigger><SelectContent><SelectItem value=\"none\">No Campaign</SelectItem>{campaigns.map(c => <SelectItem key={c._id} value={c._id}>{c.name}</SelectItem>)}</SelectContent></Select></div>\n                        <DialogFooter>\n                          <Button type=\"button\" variant=\"outline\" onClick={() => setIsEditLeadOpen(false)}>Cancel</Button>\n                          <Button type=\"submit\" disabled={isSaving}>{isSaving ? <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" /> : null}Update Lead</Button>\n                        </DialogFooter>\n                      </form>\n                    </DialogContent>\n                  </Dialog>\n                </div>\n              </div>\n              <Card className=\"hover-elevate\">\n                <CardHeader>\n                  <div className=\"flex flex-col space-y-4\">\n                    <div className=\"flex items-center justify-between\"><div><CardTitle>Manage Leads</CardTitle><CardDescription>View and filter all your campaign leads.</CardDescription></div></div>\n                    <div className=\"flex flex-wrap items-center gap-3\">\n                      <div className=\"relative flex-1 min-w-[200px]\"><Search className=\"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground\" /><Input placeholder=\"Search name, phone, email...\" className=\"pl-9 h-9\" value={campaignSearch} onChange={(e) => setCampaignSearch(e.target.value)} /></div>\n                      <div className=\"flex items-center gap-2\"><Select value={leadCampaignFilter} onValueChange={setLeadCampaignFilter}><SelectTrigger className=\"w-[180px] h-9\"><SelectValue placeholder=\"All Campaigns\" /></SelectTrigger><SelectContent><SelectItem value=\"all\">All Campaigns</SelectItem><SelectItem value=\"none\">No Campaign</SelectItem>{campaigns.map(c => <SelectItem key={c._id} value={c._id}>{c.name}</SelectItem>)}</SelectContent></Select></div>\n                      <div className=\"flex items-center gap-2 bg-muted/20 p-1 rounded-md border border-border/50 h-9\"><CalendarDays className=\"h-4 w-4 text-muted-foreground ml-2\" /><Input type=\"date\" className=\"h-7 w-[130px] text-xs border-none bg-transparent focus-visible:ring-0\" /><span className=\"text-muted-foreground text-xs\">â†’</span><Input type=\"date\" className=\"h-7 w-[130px] text-xs border-none bg-transparent focus-visible:ring-0\" /></div>\n                    </div>\n                  </div>\n                </CardHeader>\n                <CardContent className=\"p-0\">\n                  <Table>\n                    <TableHeader><TableRow><TableHead>Name</TableHead><TableHead>Company</TableHead><TableHead>Campaign</TableHead><TableHead>Status</TableHead><TableHead>Last Interaction</TableHead><TableHead className=\"text-right\">Call</TableHead><TableHead className=\"text-right\">SMS</TableHead><TableHead className=\"text-right\">Actions</TableHead></TableRow></TableHeader>\n                    <TableBody>\n                      {leads.filter(lead => { const searchLower = campaignSearch.toLowerCase(); const matchesSearch = !campaignSearch || lead.name.toLowerCase().includes(searchLower) || (lead.company || \"\").toLowerCase().includes(searchLower) || (lead.phone || \"\").toLowerCase().includes(searchLower) || (lead.email || \"\").toLowerCase().includes(searchLower) || (lead.status || \"\").toLowerCase().includes(searchLower) || (lead.campaignName || \"\").toLowerCase().includes(searchLower); if (!matchesSearch) return false; if (leadCampaignFilter === \"all\") return true; if (leadCampaignFilter === \"none\") return !lead.campaignId; return lead.campaignId === leadCampaignFilter; }).map((lead) => (\n                        <TableRow key={lead._id} className=\"cursor-pointer hover:bg-muted/50\" onClick={() => handleViewLead(lead)}>\n                          <TableCell className=\"font-medium\">{lead.name}</TableCell><TableCell>{lead.company || \"-\"}</TableCell><TableCell>{lead.campaignName ? <Badge variant=\"secondary\">{lead.campaignName}</Badge> : <span className=\"text-muted-foreground\">-</span>}</TableCell><TableCell><Badge variant=\"outline\">{lead.status}</Badge></TableCell><TableCell className=\"text-muted-foreground\">{formatTimeAgo(lead.lastContact)}</TableCell>\n                          <TableCell className=\"text-right\"><Button size=\"sm\" variant=\"ghost\" data-testid={`button-call-${lead._id}`} onClick={(e) => { e.stopPropagation(); setCallConfirm({ leadId: lead._id, type: \"call\" }); }}><Phone className=\"h-4 w-4\" /></Button></TableCell>\n                          <TableCell className=\"text-right\"><Button size=\"sm\" variant=\"ghost\" data-testid={`button-sms-${lead._id}`} onClick={(e) => { e.stopPropagation(); setCallConfirm({ leadId: lead._id, type: \"sms\" }); }}><MessageSquare className=\"h-4 w-4\" /></Button></TableCell>\n                          <TableCell className=\"text-right\"><DropdownMenu><DropdownMenuTrigger asChild><Button variant=\"ghost\" size=\"icon\" data-testid={`button-actions-${lead._id}`} onClick={(e) => e.stopPropagation()}><MoreVertical className=\"h-4 w-4\" /></Button></DropdownMenuTrigger><DropdownMenuContent align=\"end\"><DropdownMenuItem onClick={(e) => { e.stopPropagation(); handleViewLead(lead); }}>View Details</DropdownMenuItem><DropdownMenuItem onClick={(e) => { e.stopPropagation(); handleEditLead(lead); }}>Edit Lead</DropdownMenuItem><DropdownMenuSeparator /><DropdownMenuItem onClick={(e) => { e.stopPropagation(); confirmDeleteLead(lead); }} className=\"text-destructive\"><Trash2 className=\"mr-2 h-4 w-4\" /> Delete</DropdownMenuItem></DropdownMenuContent></DropdownMenu></TableCell>\n                        </TableRow>\n                      ))}\n                      {leads.length === 0 && <TableRow><TableCell colSpan={8} className=\"text-center text-muted-foreground py-8\">No leads yet. Add your first lead to get started.</TableCell></TableRow>}\n                    </TableBody>\n                  </Table>\n                </CardContent>\n              </Card>\n             </div>\n          )}\n\n          {/* Campaign Creation Dialog */}\n          <Dialog open={isCreateCampaignOpen} onOpenChange={setIsCreateCampaignOpen}>\n            <DialogContent className=\"sm:max-w-[700px] max-h-[90vh] overflow-y-auto\">\n              <DialogHeader>\n                <DialogTitle>Create New Campaign</DialogTitle>\n                <DialogDescription>Set up your AI calling agent with a goal and script.</DialogDescription>\n              </DialogHeader>\n              <form onSubmit={handleCreateCampaign} className=\"space-y-6 py-4\">\n                <Tabs value={campaignTab} onValueChange={setCampaignTab}>\n                  <TabsList className=\"grid w-full grid-cols-3\">\n                    <TabsTrigger value=\"basics\">Basics & Goal</TabsTrigger>\n                    <TabsTrigger value=\"agent\">AI Agent & Script</TabsTrigger>\n                    <TabsTrigger value=\"config\">Configuration</TabsTrigger>\n                  </TabsList>\n                  <TabsContent value=\"basics\" className=\"space-y-4 pt-4\">\n                    <div className=\"space-y-2\">\n                      <Label htmlFor=\"campaign-name\">Campaign Name <span className=\"text-destructive\">*</span></Label>\n                      <Input id=\"campaign-name\" placeholder=\"Summer Real Estate Leads\" value={newCampaign.name} onChange={e => setNewCampaign({...newCampaign, name: e.target.value})} className={campaignErrors.name ? \"border-destructive\" : \"\"} />\n                    </div>\n                    <div className=\"grid grid-cols-2 gap-4\">\n                      <div className=\"space-y-2\">\n                        <Label>Campaign Goal</Label>\n                        <Select value={newCampaign.goal} onValueChange={(v: any) => setNewCampaign({...newCampaign, goal: v})}>\n                          <SelectTrigger><SelectValue /></SelectTrigger>\n                          <SelectContent>\n                            <SelectItem value=\"sales\">Outbound Sales</SelectItem>\n                            <SelectItem value=\"support\">Customer Support</SelectItem>\n                            <SelectItem value=\"survey\">Market Survey</SelectItem>\n                            <SelectItem value=\"appointment\">Appointment Setting</SelectItem>\n                          </SelectContent>\n                        </Select>\n                      </div>\n                      <div className=\"space-y-2\">\n                        <Label>Voice Preference</Label>\n                        <Select value={newCampaign.voice} onValueChange={v => setNewCampaign({...newCampaign, voice: v})}>\n                          <SelectTrigger><SelectValue /></SelectTrigger>\n                          <SelectContent>\n                            <SelectItem value=\"Rachel (American)\">Rachel (American)</SelectItem>\n                            <SelectItem value=\"Drew (Professional)\">Drew (Professional)</SelectItem>\n                            <SelectItem value=\"Clyde (Friendly)\">Clyde (Friendly)</SelectItem>\n                          </SelectContent>\n                        </Select>\n                      </div>\n                    </div>\n                    <div className=\"grid grid-cols-2 gap-4\">\n                      <div className=\"space-y-2\">\n                        <Label>Start Date</Label>\n                        <Input type=\"date\" value={newCampaign.startDate} onChange={e => setNewCampaign({...newCampaign, startDate: e.target.value})} />\n                      </div>\n                      <div className=\"space-y-2\">\n                        <Label>End Date</Label>\n                        <Input type=\"date\" value={newCampaign.endDate} onChange={e => setNewCampaign({...newCampaign, endDate: e.target.value})} />\n                      </div>\n                    </div>\n                  </TabsContent>\n                  <TabsContent value=\"agent\" className=\"space-y-4 pt-4\">\n                    <div className=\"space-y-2\">\n                      <Label>AI Calling Script <span className=\"text-destructive\">*</span></Label>\n                      <Textarea placeholder=\"Hi, I'm calling from... [Use {name} for personalization]\" className=\"min-h-[150px]\" value={newCampaign.script} onChange={e => setNewCampaign({...newCampaign, script: e.target.value})} />\n                      <p className=\"text-xs text-muted-foreground\">Use variables like {'{name}'}, {'{company}'} to personalize the AI conversation.</p>\n                    </div>\n                    <div className=\"space-y-2\">\n                      <Label>Additional Context</Label>\n                      <Textarea placeholder=\"Information the AI should know about your business, common FAQs, etc.\" value={newCampaign.additionalContext} onChange={e => setNewCampaign({...newCampaign, additionalContext: e.target.value})} />\n                    </div>\n                  </TabsContent>\n                  <TabsContent value=\"config\" className=\"space-y-4 pt-4\">\n                    <div className=\"grid grid-cols-2 gap-4\">\n                      <div className=\"space-y-2\">\n                        <Label>Daily Call Limit</Label>\n                        <Input type=\"number\" placeholder=\"500\" />\n                      </div>\n                      <div className=\"space-y-2\">\n                        <Label>Calling Hours</Label>\n                        <div className=\"flex items-center gap-2\">\n                          <Input type=\"time\" value={newCampaign.callingHours.start} onChange={e => setNewCampaign({...newCampaign, callingHours: {...newCampaign.callingHours, start: e.target.value}})} />\n                          <span>to</span>\n                          <Input type=\"time\" value={newCampaign.callingHours.end} onChange={e => setNewCampaign({...newCampaign, callingHours: {...newCampaign.callingHours, end: e.target.value}})} />\n                        </div>\n                        {campaignErrors.callingHours && <p className=\"text-xs text-destructive\">{campaignErrors.callingHours}</p>}\n                      </div>\n                    </div>\n                    <div className=\"space-y-2\">\n                      <Label>Knowledge Base Files</Label>\n                      <div \n                        className=\"border-2 border-dashed rounded-lg p-6 text-center cursor-pointer hover:bg-muted/50 transition-colors\"\n                        onClick={() => document.getElementById('campaign-upload')?.click()}\n                      >\n                        <Upload className=\"mx-auto h-8 w-8 text-muted-foreground mb-2\" />\n                        <p className=\"text-sm text-muted-foreground\">\n                          {isUploading ? \"Uploading...\" : \"Click to upload or drag and drop PDFs, TXT, or DOCX files\"}\n                        </p>\n                        <input \n                          id=\"campaign-upload\"\n                          type=\"file\" \n                          multiple \n                          className=\"hidden\" \n                          onChange={(e) => handleFileUpload(e, false)}\n                          accept=\".pdf,.txt,.docx\"\n                        />\n                      </div>\n                      {newCampaign.knowledgeBaseFiles.length > 0 && (\n                        <div className=\"mt-2 space-y-2\">\n                          {newCampaign.knowledgeBaseFiles.map((file, idx) => (\n                            <div key={idx} className=\"flex items-center justify-between p-2 bg-muted/30 rounded-md border text-xs\">\n                              <span className=\"truncate max-w-[200px]\">{file.name}</span>\n                              <Button \n                                variant=\"ghost\" \n                                size=\"icon\" \n                                className=\"h-6 w-6\" \n                                onClick={() => setNewCampaign(prev => ({\n                                  ...prev,\n                                  knowledgeBaseFiles: prev.knowledgeBaseFiles.filter((_, i) => i !== idx)\n                                }))}\n                              >\n                                <X className=\"h-3 w-3\" />\n                              </Button>\n                            </div>\n                          ))}\n                        </div>\n                      )}\n                    </div>\n                  </TabsContent>\n                </Tabs>\n                <DialogFooter className=\"flex justify-end gap-2\">\n                  <Button type=\"button\" variant=\"outline\" onClick={() => setIsCreateCampaignOpen(false)} data-testid=\"button-cancel-campaign\">Cancel</Button>\n                  {campaignTab === \"basics\" ? (\n                    <Button type=\"button\" onClick={(e) => { e.preventDefault(); setCampaignTab(\"agent\"); }} data-testid=\"button-next-agent\">Next: Configure Agent</Button>\n                  ) : campaignTab === \"agent\" ? (\n                    <Button type=\"button\" onClick={(e) => { e.preventDefault(); setCampaignTab(\"config\"); }} data-testid=\"button-next-config\">Next: Configuration</Button>\n                  ) : (\n                    <Button type=\"submit\" disabled={isSaving} data-testid=\"button-submit-campaign\">\n                      {isSaving ? <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" /> : <Plus className=\"mr-2 h-4 w-4\" />}\n                      Create Campaign\n                    </Button>\n                  )}\n                </DialogFooter>\n              </form>\n            </DialogContent>\n          </Dialog>\n\n          {/* Edit Campaign Dialog */}\n          <Dialog open={isEditCampaignOpen} onOpenChange={setIsEditCampaignOpen}>\n            <DialogContent className=\"sm:max-w-[700px] max-h-[90vh] overflow-y-auto\">\n              <DialogHeader>\n                <DialogTitle>Edit Campaign</DialogTitle>\n                <DialogDescription>Update your campaign settings and agent script.</DialogDescription>\n              </DialogHeader>\n              <form onSubmit={handleUpdateCampaign} className=\"space-y-6 py-4\">\n                <Tabs defaultValue=\"basics\">\n                  <TabsList className=\"grid w-full grid-cols-3\">\n                    <TabsTrigger value=\"basics\">Basics & Goal</TabsTrigger>\n                    <TabsTrigger value=\"agent\">AI Agent & Script</TabsTrigger>\n                    <TabsTrigger value=\"config\">Configuration</TabsTrigger>\n                  </TabsList>\n                  <TabsContent value=\"basics\" className=\"space-y-4 pt-4\">\n                    <div className=\"space-y-2\">\n                      <Label htmlFor=\"edit-campaign-name\">Campaign Name</Label>\n                      <Input id=\"edit-campaign-name\" value={editCampaignForm.name} onChange={e => setEditCampaignForm({...editCampaignForm, name: e.target.value})} />\n                    </div>\n                    <div className=\"grid grid-cols-2 gap-4\">\n                      <div className=\"space-y-2\">\n                        <Label>Status</Label>\n                        <Select value={editCampaignForm.status} onValueChange={(v: any) => setEditCampaignForm({...editCampaignForm, status: v})}>\n                          <SelectTrigger><SelectValue /></SelectTrigger>\n                          <SelectContent>\n                            <SelectItem value=\"Active\">Active</SelectItem>\n                            <SelectItem value=\"Paused\">Paused</SelectItem>\n                            <SelectItem value=\"Draft\">Draft</SelectItem>\n                          </SelectContent>\n                        </Select>\n                      </div>\n                      <div className=\"space-y-2\">\n                        <Label>Goal</Label>\n                        <Select value={editCampaignForm.goal} onValueChange={(v: any) => setEditCampaignForm({...editCampaignForm, goal: v})}>\n                          <SelectTrigger><SelectValue /></SelectTrigger>\n                          <SelectContent>\n                            <SelectItem value=\"sales\">Outbound Sales</SelectItem>\n                            <SelectItem value=\"support\">Customer Support</SelectItem>\n                            <SelectItem value=\"survey\">Market Survey</SelectItem>\n                            <SelectItem value=\"appointment\">Appointment Setting</SelectItem>\n                          </SelectContent>\n                        </Select>\n                      </div>\n                    </div>\n                    <div className=\"grid grid-cols-2 gap-4\">\n                      <div className=\"space-y-2\">\n                        <Label>Start Date</Label>\n                        <Input type=\"date\" value={editCampaignForm.startDate} onChange={e => setEditCampaignForm({...editCampaignForm, startDate: e.target.value})} />\n                      </div>\n                      <div className=\"space-y-2\">\n                        <Label>End Date</Label>\n                        <Input type=\"date\" value={editCampaignForm.endDate} onChange={e => setEditCampaignForm({...editCampaignForm, endDate: e.target.value})} />\n                      </div>\n                    </div>\n                  </TabsContent>\n                  <TabsContent value=\"agent\" className=\"space-y-4 pt-4\">\n                    <div className=\"space-y-2\">\n                      <Label>Voice Preference</Label>\n                      <Select value={editCampaignForm.voice} onValueChange={v => setEditCampaignForm({...editCampaignForm, voice: v})}>\n                        <SelectTrigger><SelectValue /></SelectTrigger>\n                        <SelectContent>\n                          <SelectItem value=\"Rachel (American)\">Rachel (American)</SelectItem>\n                          <SelectItem value=\"Drew (Professional)\">Drew (Professional)</SelectItem>\n                          <SelectItem value=\"Clyde (Friendly)\">Clyde (Friendly)</SelectItem>\n                        </SelectContent>\n                      </Select>\n                    </div>\n                    <div className=\"space-y-2\">\n                      <Label>Script</Label>\n                      <Textarea className=\"min-h-[150px]\" value={editCampaignForm.script} onChange={e => setEditCampaignForm({...editCampaignForm, script: e.target.value})} />\n                    </div>\n                    <div className=\"space-y-2\">\n                      <Label>Additional Context</Label>\n                      <Textarea placeholder=\"Information the AI should know...\" value={editCampaignForm.additionalContext} onChange={e => setEditCampaignForm({...editCampaignForm, additionalContext: e.target.value})} />\n                    </div>\n                  </TabsContent>\n                  <TabsContent value=\"config\" className=\"space-y-4 pt-4\">\n                    <div className=\"space-y-2\">\n                      <Label>Calling Hours</Label>\n                      <div className=\"flex items-center gap-2\">\n                        <Input type=\"time\" value={editCampaignForm.callingHours.start} onChange={e => setEditCampaignForm({...editCampaignForm, callingHours: {...editCampaignForm.callingHours, start: e.target.value}})} />\n                        <span>to</span>\n                        <Input type=\"time\" value={editCampaignForm.callingHours.end} onChange={e => setEditCampaignForm({...editCampaignForm, callingHours: {...editCampaignForm.callingHours, end: e.target.value}})} />\n                      </div>\n                    </div>\n                    <div className=\"space-y-2\">\n                      <Label>Knowledge Base Files</Label>\n                      <div \n                        className=\"border-2 border-dashed rounded-lg p-6 text-center cursor-pointer hover:bg-muted/50 transition-colors\"\n                        onClick={() => document.getElementById('edit-campaign-upload')?.click()}\n                      >\n                        <Upload className=\"mx-auto h-8 w-8 text-muted-foreground mb-2\" />\n                        <p className=\"text-sm text-muted-foreground\">\n                          {isUploading ? \"Uploading...\" : \"Click to upload or drag and drop PDFs, TXT, or DOCX files\"}\n                        </p>\n                        <input \n                          id=\"edit-campaign-upload\"\n                          type=\"file\" \n                          multiple \n                          className=\"hidden\" \n                          onChange={(e) => handleFileUpload(e, true)}\n                          accept=\".pdf,.txt,.docx\"\n                        />\n                      </div>\n                      {editCampaignForm.knowledgeBaseFiles.length > 0 && (\n                        <div className=\"mt-2 space-y-2\">\n                          {editCampaignForm.knowledgeBaseFiles.map((file, idx) => (\n                            <div key={idx} className=\"flex items-center justify-between p-2 bg-muted/30 rounded-md border text-xs\">\n                              <span className=\"truncate max-w-[200px]\">{file.name}</span>\n                              <Button \n                                variant=\"ghost\" \n                                size=\"icon\" \n                                className=\"h-6 w-6\" \n                                onClick={() => setEditCampaignForm(prev => ({\n                                  ...prev,\n                                  knowledgeBaseFiles: prev.knowledgeBaseFiles.filter((_, i) => i !== idx)\n                                }))}\n                              >\n                                <X className=\"h-3 w-3\" />\n                              </Button>\n                            </div>\n                          ))}\n                        </div>\n                      )}\n                    </div>\n                  </TabsContent>\n                </Tabs>\n                <DialogFooter>\n                  <Button type=\"button\" variant=\"outline\" onClick={() => setIsEditCampaignOpen(false)}>Cancel</Button>\n                  <Button type=\"submit\" disabled={isSaving}>Update Campaign</Button>\n                </DialogFooter>\n              </form>\n            </DialogContent>\n          </Dialog>\n\n          {/* Lead Details Sheet */}\n          <Sheet open={isLeadDetailsOpen} onOpenChange={setIsLeadDetailsOpen}>\n            <SheetContent className=\"sm:max-w-xl w-full overflow-y-auto p-0 flex flex-col gap-0\">\n              {selectedLead && (\n                <>\n                  <div className=\"p-6 border-b bg-muted/10\">\n                    <div className=\"flex items-center gap-4\">\n                      <Avatar className=\"h-16 w-16 border-2 border-background shadow-sm\"><AvatarFallback className=\"text-xl bg-primary/10 text-primary\">{selectedLead.name.charAt(0)}</AvatarFallback></Avatar>\n                      <div className=\"flex-1\"><h3 className=\"text-2xl font-bold tracking-tight\">{selectedLead.name}</h3><p className=\"text-muted-foreground text-sm font-medium\">{selectedLead.company}</p><div className=\"flex items-center gap-2 mt-2\"><Badge variant={selectedLead.status === 'Interested' ? 'default' : 'secondary'}>{selectedLead.status}</Badge>{selectedLead.outcome === \"Meeting Booked\" && <Badge variant=\"outline\" className=\"border-green-500 text-green-600 bg-green-500/10\">Meeting Booked</Badge>}</div></div>\n                      <div className=\"flex flex-col gap-2\"><Button size=\"sm\"><Phone className=\"mr-2 h-4 w-4\" /> Call</Button><Button size=\"sm\" variant=\"outline\"><MessageSquare className=\"mr-2 h-4 w-4\" /> SMS</Button><Button size=\"sm\" variant=\"ghost\" onClick={() => { setIsLeadDetailsOpen(false); handleEditLead(selectedLead); }}><Settings className=\"mr-2 h-4 w-4\" /> Edit</Button></div>\n                    </div>\n                  </div>\n                  <Tabs defaultValue=\"overview\" className=\"flex-1 flex flex-col\">\n                    <div className=\"px-6 border-b bg-muted/5\"><TabsList className=\"w-full justify-start h-12 bg-transparent p-0 gap-6\"><TabsTrigger value=\"overview\" className=\"rounded-none px-0 h-full\">Overview</TabsTrigger><TabsTrigger value=\"activity\" className=\"rounded-none px-0 h-full\">Activity & Logs</TabsTrigger><TabsTrigger value=\"schedule\" className=\"rounded-none px-0 h-full\">Schedule</TabsTrigger></TabsList></div>\n                    <ScrollArea className=\"flex-1\"><div className=\"p-6\">\n                      <TabsContent value=\"overview\" className=\"mt-0 space-y-6\">\n                        {/* Credit Usage Daily Chart */}\n                        <Card className=\"hover-elevate\">\n                          <CardHeader className=\"flex flex-row items-center justify-between gap-4 space-y-0 pb-4\">\n                            <div>\n                              <CardTitle className=\"text-base font-semibold\">Daily Credit Usage</CardTitle>\n                              <CardDescription>Daily credit consumption for Calls, SMS, and WhatsApp</CardDescription>\n                            </div>\n                            <div className=\"flex flex-wrap items-center gap-2\">\n                              <Select value={creditUsageCampaignFilter} onValueChange={setCreditUsageCampaignFilter}>\n                                <SelectTrigger className=\"w-[140px] h-8 text-xs\">\n                                  <SelectValue placeholder=\"Campaign\" />\n                                </SelectTrigger>\n                                <SelectContent>\n                                  <SelectItem value=\"all\">All Campaigns</SelectItem>\n                                  {campaigns.map(c => (\n                                    <SelectItem key={c._id} value={c._id}>{c.name}</SelectItem>\n                                  ))}\n                                </SelectContent>\n                              </Select>\n                              <Select value={creditUsageMonthFilter.toString()} onValueChange={(v) => setCreditUsageMonthFilter(parseInt(v))}>\n                                <SelectTrigger className=\"w-[110px] h-8 text-xs\">\n                                  <SelectValue placeholder=\"Month\" />\n                                </SelectTrigger>\n                                <SelectContent>\n                                  {[\"Jan\", \"Feb\", \"Mar\", \"Apr\", \"May\", \"Jun\", \"Jul\", \"Aug\", \"Sep\", \"Oct\", \"Nov\", \"Dec\"].map((m, i) => (\n                                    <SelectItem key={m} value={i.toString()}>{m}</SelectItem>\n                                  ))}\n                                </SelectContent>\n                              </Select>\n                              <Select value={creditUsageYearFilter.toString()} onValueChange={(v) => setCreditUsageYearFilter(parseInt(v))}>\n                                <SelectTrigger className=\"w-[90px] h-8 text-xs\">\n                                  <SelectValue placeholder=\"Year\" />\n                                </SelectTrigger>\n                                <SelectContent>\n                                  {[2024, 2025, 2026].map(y => (\n                                    <SelectItem key={y} value={y.toString()}>{y}</SelectItem>\n                                  ))}\n                                </SelectContent>\n                              </Select>\n                            </div>\n                          </CardHeader>\n                          <CardContent className=\"h-[300px] mt-2\">\n                            <ResponsiveContainer width=\"100%\" height=\"100%\">\n                              <LineChart data={creditUsageData} margin={{ top: 5, right: 10, left: 0, bottom: 0 }}>\n                                <CartesianGrid strokeDasharray=\"3 3\" vertical={false} stroke={theme === \"dark\" ? \"#333\" : \"#eee\"} />\n                                <XAxis \n                                  dataKey=\"date\" \n                                  fontSize={11} \n                                  tickLine={false} \n                                  axisLine={false} \n                                  tick={{ fill: \"hsl(var(--muted-foreground))\" }}\n                                />\n                                <YAxis \n                                  fontSize={11} \n                                  tickLine={false} \n                                  axisLine={false} \n                                  tick={{ fill: \"hsl(var(--muted-foreground))\" }}\n                                />\n                                <RechartsTooltip \n                                  contentStyle={{ \n                                    backgroundColor: \"hsl(var(--card))\", \n                                    borderColor: \"hsl(var(--border))\",\n                                    borderRadius: \"8px\",\n                                    fontSize: \"12px\"\n                                  }}\n                                />\n                                <Legend iconType=\"circle\" wrapperStyle={{ fontSize: '11px', paddingTop: '10px' }} />\n                                <Line \n                                  type=\"monotone\" \n                                  dataKey=\"call\" \n                                  name=\"Calls\"\n                                  stroke=\"#f97316\" \n                                  strokeWidth={2} \n                                  dot={{ r: 3, fill: \"#f97316\" }} \n                                  activeDot={{ r: 5 }} \n                                />\n                                <Line \n                                  type=\"monotone\" \n                                  dataKey=\"sms\" \n                                  name=\"SMS\"\n                                  stroke=\"#3b82f6\" \n                                  strokeWidth={2} \n                                  dot={{ r: 3, fill: \"#3b82f6\" }} \n                                  activeDot={{ r: 5 }} \n                                />\n                                <Line \n                                  type=\"monotone\" \n                                  dataKey=\"whatsapp\" \n                                  name=\"WhatsApp\"\n                                  stroke=\"#22c55e\" \n                                  strokeWidth={2} \n                                  dot={{ r: 3, fill: \"#22c55e\" }} \n                                  activeDot={{ r: 5 }} \n                                />\n                              </LineChart>\n                            </ResponsiveContainer>\n                          </CardContent>\n                        </Card>\n\n                        <div className=\"grid grid-cols-2 gap-6\">\n                          <div className=\"space-y-1\"><Label className=\"text-xs text-muted-foreground uppercase tracking-wider\">Email</Label><div className=\"flex items-center gap-2 font-medium\"><Mail className=\"h-4 w-4 text-muted-foreground\" />{selectedLead.email || \"N/A\"}</div></div>\n                          <div className=\"space-y-1\"><Label className=\"text-xs text-muted-foreground uppercase tracking-wider\">Phone</Label><div className=\"flex items-center gap-2 font-medium\"><Phone className=\"h-4 w-4 text-muted-foreground\" />{selectedLead.phone}</div></div>\n                          <div className=\"space-y-1\"><Label className=\"text-xs text-muted-foreground uppercase tracking-wider\">Last Contact</Label><div className=\"flex items-center gap-2 font-medium\"><History className=\"h-4 w-4 text-muted-foreground\" />{formatTimeAgo(selectedLead.lastContact)}</div></div>\n                          <div className=\"space-y-1\"><Label className=\"text-xs text-muted-foreground uppercase tracking-wider\">Pipeline Stage</Label><div className=\"flex items-center gap-2 font-medium\"><BarChart className=\"h-4 w-4 text-muted-foreground\" />{selectedLead.outcome}</div></div>\n                          <div className=\"space-y-1\"><Label className=\"text-xs text-muted-foreground uppercase tracking-wider\">Campaign</Label><div className=\"flex items-center gap-2 font-medium\"><Megaphone className=\"h-4 w-4 text-muted-foreground\" />{selectedLead.campaignName || \"Not assigned\"}</div></div>\n                          <div className=\"space-y-1\"><Label className=\"text-xs text-muted-foreground uppercase tracking-wider\">Company</Label><div className=\"flex items-center gap-2 font-medium\"><Building className=\"h-4 w-4 text-muted-foreground\" />{selectedLead.company || \"N/A\"}</div></div>\n                        </div>\n                        <div className=\"space-y-2\"><Label className=\"flex items-center gap-2\"><FileText className=\"h-4 w-4\" /> Notes</Label><div className=\"bg-muted/50 p-4 rounded-md text-sm leading-relaxed border\">{selectedLead.notes || \"No notes available.\"}</div></div>\n                      </TabsContent>\n                      <TabsContent value=\"activity\" className=\"mt-0 space-y-6\">\n                        <div className=\"flex items-center justify-between mb-4\"><h4 className=\"font-semibold\">Interaction History</h4><Button size=\"sm\" variant=\"outline\" onClick={() => setIsLogActivityOpen(true)}><Plus className=\"h-3 w-3 mr-1\" /> Log Activity</Button></div>\n                        <div className=\"space-y-6 relative pl-6 border-l-2 border-muted\">{(selectedLead.history || []).map((item, i) => (<div key={i} className=\"relative\"><div className=\"absolute -left-[31px] top-0 h-8 w-8 rounded-full bg-background border-2 border-muted flex items-center justify-center\">{item.type === 'call' ? <Phone className=\"h-4 w-4 text-primary\" /> : item.type === 'email' ? <Mail className=\"h-4 w-4 text-blue-500\" /> : <FileText className=\"h-4 w-4 text-orange-500\" />}</div><div className=\"bg-card border rounded-lg p-4 shadow-sm\"><div className=\"flex justify-between items-start mb-1\"><div className=\"text-sm font-semibold\">{item.type.charAt(0).toUpperCase() + item.type.slice(1)} {item.outcome && `- ${item.outcome}`}</div><div className=\"text-xs text-muted-foreground\">{new Date(item.date).toLocaleString()}</div></div><div className=\"text-sm text-muted-foreground\">{item.note}</div>{item.type === 'call' && item.duration && <div className=\"mt-2 flex items-center gap-4\"><div className=\"text-xs font-medium\">Duration: {item.duration}</div><Button size=\"sm\" variant=\"ghost\" className=\"h-6 ml-auto\"><Play className=\"h-3 w-3 mr-1\" /> Listen</Button></div>}</div></div>))}</div>\n                      </TabsContent>\n                      <TabsContent value=\"schedule\" className=\"mt-0 space-y-6\">\n                        <div className=\"flex items-center justify-between mb-4\"><h4 className=\"font-semibold\">Scheduled Appointments</h4><Button size=\"sm\" variant=\"outline\" onClick={() => handleScheduleMeeting(selectedLead)}><Plus className=\"h-3 w-3 mr-1\" /> Schedule</Button></div>\n                        <div className=\"space-y-3\">{appointments.filter(a => a.leadId === selectedLead._id).map((apt) => (<div key={apt._id} className=\"p-4 border rounded-lg bg-card shadow-sm\"><div className=\"flex justify-between items-start mb-2\"><div><div className=\"font-semibold\">{apt.title}</div><div className=\"text-xs text-muted-foreground flex items-center gap-1 mt-1\"><Calendar className=\"h-3 w-3\" />{new Date(apt.date).toLocaleDateString()} at {apt.time}</div></div><Badge variant=\"secondary\">{apt.type}</Badge></div>{apt.notes && <div className=\"text-xs text-muted-foreground italic mt-2 border-t pt-2\">{apt.notes}</div>}<div className=\"flex justify-end gap-2 mt-3 pt-3 border-t\"><Button size=\"sm\" variant=\"ghost\" className=\"h-7 px-2\" onClick={() => handleEditAppointment(apt)}><Edit3 className=\"h-3 w-3 mr-1\" /> Edit</Button><Button size=\"sm\" variant=\"ghost\" className=\"h-7 px-2 text-destructive hover:text-destructive\" onClick={() => confirmDeleteAppointment(apt)}><Trash2 className=\"h-3 w-3 mr-1\" /> Cancel</Button></div></div>))}\n                        {appointments.filter(a => a.leadId === selectedLead._id).length === 0 && <div className=\"text-center py-8 text-muted-foreground text-sm border-2 border-dashed rounded-lg\">No meetings scheduled.</div>}</div>\n                      </TabsContent>\n                    </div></ScrollArea>\n                  </Tabs>\n                </>\n              )}\n            </SheetContent>\n          </Sheet>\n\n          {/* User Management View (Admin) */}\n          {activeTab === \"admin-users\" && isAdmin && (\n            <div className=\"space-y-6\">\n              <div className=\"flex justify-between items-center\">\n                <h1 className=\"text-3xl font-bold tracking-tight\">User Management</h1>\n                <Button><Plus className=\"mr-2 h-4 w-4\" /> Add User</Button>\n              </div>\n              <Card>\n                <CardHeader>\n                  <div className=\"flex flex-col space-y-4\">\n                    <div className=\"flex items-center justify-between\">\n                      <div>\n                        <CardTitle>Platform Users</CardTitle>\n                        <CardDescription>Total {registeredUsers.length} registered users.</CardDescription>\n                      </div>\n                    </div>\n                    \n                    <div className=\"flex flex-wrap items-center gap-3\">\n                      <div className=\"relative flex-1 min-w-[200px]\">\n                        <Search className=\"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground\" />\n                        <Input \n                          placeholder=\"Search name, email, company...\" \n                          className=\"pl-9 h-9\" \n                          value={searchTerm}\n                          onChange={(e) => setSearchTerm(e.target.value)}\n                        />\n                      </div>\n                      \n                      <Select value={campaignFilter} onValueChange={setCampaignFilter}>\n                        <SelectTrigger className=\"w-[180px] h-9\">\n                          <SelectValue placeholder=\"All Plans\" />\n                        </SelectTrigger>\n                        <SelectContent>\n                          <SelectItem value=\"all\">All Plans</SelectItem>\n                          <SelectItem value=\"Basic\">Basic</SelectItem>\n                          <SelectItem value=\"Advanced\">Advanced</SelectItem>\n                          <SelectItem value=\"Enterprise\">Enterprise</SelectItem>\n                          <SelectItem value=\"Free\">Free</SelectItem>\n                        </SelectContent>\n                      </Select>\n\n                      <Select value={logsCampaignFilter} onValueChange={setLogsCampaignFilter}>\n                        <SelectTrigger className=\"w-[150px] h-9\">\n                          <SelectValue placeholder=\"All Status\" />\n                        </SelectTrigger>\n                        <SelectContent>\n                          <SelectItem value=\"all\">All Status</SelectItem>\n                          <SelectItem value=\"Active\">Active</SelectItem>\n                          <SelectItem value=\"Inactive\">Inactive</SelectItem>\n                        </SelectContent>\n                      </Select>\n                    </div>\n                  </div>\n                </CardHeader>\n                <CardContent>\n                  <Table>\n                    <TableHeader><TableRow><TableHead>User</TableHead><TableHead>Company</TableHead><TableHead>Plan</TableHead><TableHead>Status</TableHead><TableHead>Joined</TableHead><TableHead className=\"text-right\">Actions</TableHead></TableRow></TableHeader>\n                    <TableBody>\n                      {registeredUsers\n                        .filter(u => {\n                          const searchLower = searchTerm.toLowerCase();\n                          const matchesSearch = !searchTerm || \n                            `${u.firstName} ${u.lastName}`.toLowerCase().includes(searchLower) ||\n                            u.email.toLowerCase().includes(searchLower) ||\n                            (u.companyName || \"\").toLowerCase().includes(searchLower);\n                          \n                          const matchesPlan = campaignFilter === \"all\" || (u.subscription?.plan === campaignFilter);\n                          const matchesStatus = (logsCampaignFilter === \"all\") || (u.subscription?.status === logsCampaignFilter);\n                          \n                          return !!(matchesSearch && matchesPlan && matchesStatus);\n                        })\n                        .map((u) => (\n                        <TableRow key={u._id}>\n                          <TableCell><div className=\"flex items-center gap-3\"><Avatar className=\"h-8 w-8\"><AvatarImage src={u.companyLogo || undefined} alt={u.firstName} /><AvatarFallback>{(u.firstName || \"\").charAt(0)}{(u.lastName || \"\").charAt(0)}</AvatarFallback></Avatar><div><div className=\"font-medium\">{u.firstName} {u.lastName}</div><div className=\"text-xs text-muted-foreground\">{u.email}</div></div></div></TableCell>\n                          <TableCell>{u.companyName || \"-\"}</TableCell>\n                          <TableCell><Badge variant=\"secondary\">{u.subscription?.plan || \"Free\"}</Badge></TableCell>\n                          <TableCell><Badge variant={u.subscription?.status === 'Active' ? 'default' : 'outline'} className={u.subscription?.status === 'Active' ? 'bg-green-500/15 text-green-600 border-none' : ''}>{u.subscription?.status || \"Inactive\"}</Badge></TableCell>\n                          <TableCell className=\"text-muted-foreground\">{new Date(u.createdAt).toLocaleDateString()}</TableCell>\n                          <TableCell className=\"text-right\"><Button variant=\"ghost\" size=\"icon\"><MoreVertical className=\"h-4 w-4\" /></Button></TableCell>\n                        </TableRow>\n                      ))}\n                    </TableBody>\n                  </Table>\n                </CardContent>\n              </Card>\n            </div>\n          )}\n\n          {activeTab === \"admin-notifications\" && isAdmin && (\n            <div className=\"space-y-6\">\n              <div className=\"flex justify-between items-center\">\n                <h1 className=\"text-3xl font-bold tracking-tight\">Notification Management</h1>\n                <Dialog open={isAddNotificationOpen} onOpenChange={setIsAddNotificationOpen}>\n                  <DialogTrigger asChild>\n                    <Button><Plus className=\"mr-2 h-4 w-4\" /> Add Notification</Button>\n                  </DialogTrigger>\n                  <DialogContent>\n                    <DialogHeader>\n                      <DialogTitle>Add Notification or Announcement</DialogTitle>\n                    </DialogHeader>\n                    <div className=\"space-y-4 py-4\">\n                      <div className=\"space-y-2\">\n                        <Label>Type</Label>\n                        <Select \n                          value={notificationForm.type} \n                          onValueChange={(val: any) => setNotificationForm({ ...notificationForm, type: val })}\n                        >\n                          <SelectTrigger>\n                            <SelectValue placeholder=\"Select type\" />\n                          </SelectTrigger>\n                          <SelectContent>\n                            <SelectItem value=\"notification\">Notification</SelectItem>\n                            <SelectItem value=\"announcement\">Announcement</SelectItem>\n                          </SelectContent>\n                        </Select>\n                      </div>\n                      <div className=\"space-y-2\">\n                        <Label>Message</Label>\n                        <Textarea \n                          placeholder=\"Type your message here...\" \n                          value={notificationForm.message}\n                          onChange={(e) => setNotificationForm({ ...notificationForm, message: e.target.value })}\n                        />\n                      </div>\n                    </div>\n                    <DialogFooter>\n                      <Button variant=\"outline\" onClick={() => setIsAddNotificationOpen(false)}>Cancel</Button>\n                      <Button onClick={async () => {\n                        if (!notificationForm.message) return;\n                        setIsSaving(true);\n                        try {\n                          const res = await apiRequest(\"POST\", \"/api/notifications\", notificationForm);\n                          const data = await res.json();\n                          const newNotif = data.notification;\n                          if (newNotif) {\n                            setNotifications([newNotif, ...notifications]);\n                          }\n                          setIsAddNotificationOpen(false);\n                          setNotificationForm({ message: \"\", type: \"notification\" });\n                          toast({ title: \"Notification created successfully\" });\n                        } catch (err) {\n                          toast({ variant: \"destructive\", title: \"Failed to create notification\" });\n                        } finally {\n                          setIsSaving(false);\n                        }\n                      }} disabled={isSaving}>Submit</Button>\n                    </DialogFooter>\n                  </DialogContent>\n                </Dialog>\n              </div>\n\n              <Card>\n                <CardHeader>\n                  <CardTitle>Sent Notifications & Announcements</CardTitle>\n                </CardHeader>\n                <CardContent>\n                  <Table>\n                    <TableHeader>\n                      <TableRow>\n                        <TableHead>S.No</TableHead>\n                        <TableHead>Message</TableHead>\n                        <TableHead>Type</TableHead>\n                        <TableHead>Date</TableHead>\n                      </TableRow>\n                    </TableHeader>\n                    <TableBody>\n                      {notifications && notifications.length > 0 ? (\n                        notifications.map((n, idx) => (\n                          <TableRow key={n._id}>\n                            <TableCell>{idx + 1}</TableCell>\n                            <TableCell className=\"max-w-md truncate\">{n.message}</TableCell>\n                            <TableCell>\n                              <Badge variant={n.type === \"announcement\" ? \"default\" : \"secondary\"}>\n                                {n.type}\n                              </Badge>\n                            </TableCell>\n                            <TableCell>{n.createdAt ? new Date(n.createdAt).toLocaleDateString() : \"-\"}</TableCell>\n                          </TableRow>\n                        ))\n                      ) : (\n                        <TableRow>\n                          <TableCell colSpan={4} className=\"text-center py-8 text-muted-foreground\">\n                            No notifications sent yet.\n                          </TableCell>\n                        </TableRow>\n                      )}\n                    </TableBody>\n                  </Table>\n                </CardContent>\n              </Card>\n            </div>\n          )}\n\n          {/* Campaigns View */}\n          {activeTab === \"campaigns\" && !isAdmin && (\n            <div className=\"space-y-6\">\n              <div className=\"flex justify-between items-center\">\n                <h1 className=\"text-3xl font-bold tracking-tight\">Campaigns</h1>\n                <Button onClick={() => setIsCreateCampaignOpen(true)}><Plus className=\"mr-2 h-4 w-4\" /> Create Campaign</Button>\n              </div>\n              <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">\n                {campaigns.map((campaign) => (\n                  <Card key={campaign._id} className=\"hover-elevate\">\n                    <CardHeader className=\"flex flex-row items-start justify-between space-y-0 pb-2\">\n                      <div className=\"space-y-1\"><CardTitle className=\"text-xl\">{campaign.name}</CardTitle><CardDescription className=\"flex items-center gap-1\"><Badge variant=\"outline\" className=\"text-[10px] uppercase py-0\">{campaign.goal}</Badge></CardDescription></div>\n                      <DropdownMenu><DropdownMenuTrigger asChild><Button variant=\"ghost\" size=\"icon\"><MoreVertical className=\"h-4 w-4\" /></Button></DropdownMenuTrigger><DropdownMenuContent align=\"end\"><DropdownMenuItem onClick={() => { setSelectedCampaign(campaign); setEditCampaignForm({ name: campaign.name, goal: (campaign.goal as \"sales\" | \"support\" | \"survey\" | \"appointment\") || \"sales\", script: campaign.script, voice: campaign.voice, additionalContext: campaign.additionalContext || \"\", callingHours: campaign.callingHours || { start: \"09:00\", end: \"17:00\" }, status: (campaign.status as \"Active\" | \"Paused\" | \"Draft\") || \"Draft\", knowledgeBaseFiles: campaign.knowledgeBaseFiles || [], startDate: campaign.startDate || \"\", endDate: campaign.endDate || \"\" }); setIsEditCampaignOpen(true); }}>Edit Campaign</DropdownMenuItem><DropdownMenuSeparator /><DropdownMenuItem className=\"text-destructive\" onClick={() => setDeleteConfirm({ type: \"campaign\", id: (campaign as any)._id, name: campaign.name })}>Delete Campaign</DropdownMenuItem></DropdownMenuContent></DropdownMenu>\n                    </CardHeader>\n                    <CardContent className=\"pb-2\"><p className=\"text-sm text-muted-foreground line-clamp-2 min-h-[2.5rem]\">{campaign.script}</p><div className=\"flex items-center gap-4 mt-4\"><div className=\"flex flex-col\"><span className=\"text-2xl font-bold\">{leads.filter(l => l.campaignId === campaign._id).length}</span><span className=\"text-[10px] text-muted-foreground uppercase font-bold\">Leads</span></div><div className=\"flex flex-col\"><span className=\"text-2xl font-bold\">{leads.filter(l => l.campaignId === campaign._id && l.status === 'Interested').length}</span><span className=\"text-[10px] text-muted-foreground uppercase font-bold\">Interested</span></div></div></CardContent>\n                    <CardFooter className=\"pt-2 border-t flex items-center justify-between bg-muted/5\"><Badge variant={campaign.status === \"Active\" ? \"default\" : \"secondary\"}>{campaign.status}</Badge><div className=\"flex items-center gap-2\"><Button variant=\"ghost\" size=\"icon\" className=\"h-8 w-8\">{campaign.status === \"Active\" ? <X className=\"h-4 w-4\" /> : <Play className=\"h-4 w-4\" />}</Button></div></CardFooter>\n                  </Card>\n                ))}\n              </div>\n            </div>\n          )}\n\n          {/* Calendar View */}\n          {activeTab === \"calendar\" && !isAdmin && (\n            <div className=\"space-y-6\">\n              <div className=\"flex justify-between items-center\">\n                <h1 className=\"text-3xl font-bold tracking-tight\">Calendar</h1>\n                <Button onClick={() => setIsAddAppointmentOpen(true)}><Plus className=\"mr-2 h-4 w-4\" /> Schedule</Button>\n              </div>\n              <Card className=\"p-6\">\n                <div className=\"flex items-center justify-between mb-8\">\n                  <div className=\"flex items-center gap-4\">\n                    <Button variant=\"outline\" size=\"icon\" onClick={() => setCalendarDate(new Date(calendarDate.getFullYear(), calendarDate.getMonth() - 1, 1))}><ChevronLeft className=\"h-4 w-4\" /></Button>\n                    <h2 className=\"text-xl font-bold\">{calendarDate.toLocaleDateString('en-US', { month: 'long', year: 'numeric' })}</h2>\n                    <Button variant=\"outline\" size=\"icon\" onClick={() => setCalendarDate(new Date(calendarDate.getFullYear(), calendarDate.getMonth() + 1, 1))}><ChevronRight className=\"h-4 w-4\" /></Button>\n                  </div>\n                </div>\n                <div className=\"grid grid-cols-7 gap-px bg-muted overflow-hidden rounded-lg border\">\n                  {['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'].map(day => <div key={day} className=\"bg-muted/50 p-2 text-center text-xs font-bold text-muted-foreground uppercase\">{day}</div>)}\n                  {Array.from({ length: 42 }).map((_, i) => {\n                    const firstDayOfMonth = new Date(calendarDate.getFullYear(), calendarDate.getMonth(), 1).getDay();\n                    const day = i - firstDayOfMonth + 1;\n                    const date = new Date(calendarDate.getFullYear(), calendarDate.getMonth(), day);\n                    const isCurrentMonth = date.getMonth() === calendarDate.getMonth();\n                    const isToday = date.toDateString() === new Date().toDateString();\n                    const dateAppointments = appointments.filter(app => new Date(app.date).toDateString() === date.toDateString());\n\n                    return (\n                      <div \n                        key={i} \n                        className={`h-24 md:h-32 bg-background p-2 transition-colors hover:bg-muted/50 cursor-pointer ${!isCurrentMonth ? 'opacity-30' : ''} ${isToday ? 'bg-primary/5' : ''}`}\n                        onClick={() => {\n                          const year = date.getFullYear();\n                          const month = String(date.getMonth() + 1).padStart(2, '0');\n                          const dayNum = String(date.getDate()).padStart(2, '0');\n                          const formattedDate = `${year}-${month}-${dayNum}`;\n                          setAppointmentForm({\n                            ...appointmentForm,\n                            date: formattedDate,\n                            leadId: \"\",\n                            leadName: \"\",\n                            title: \"\"\n                          });\n                          setIsAddAppointmentOpen(true);\n                        }}\n                      >\n                        <div className=\"flex justify-between items-start\">\n                          <span className={`text-sm font-medium ${isToday ? 'bg-primary text-primary-foreground h-6 w-6 rounded-full flex items-center justify-center' : ''}`}>\n                            {date.getDate()}\n                          </span>\n                        </div>\n                        <div className=\"mt-1 space-y-1 overflow-y-auto max-h-[calc(100%-1.5rem)]\">\n                          {dateAppointments.map((app) => (\n                            <div \n                              key={app._id} \n                              className=\"text-[10px] leading-tight p-1 rounded bg-blue-100 text-blue-700 dark:bg-blue-900/30 dark:text-blue-300 truncate\"\n                              onClick={(e) => {\n                                e.stopPropagation();\n                                handleEditAppointment(app);\n                              }}\n                            >\n                              {app.time} {app.title}\n                            </div>\n                          ))}\n                        </div>\n                      </div>\n                    );\n                  })}\n                </div>\n              </Card>\n\n              {/* Upcoming Appointments List */}\n              <Card className=\"hover-elevate\">\n                <CardHeader>\n                  <CardTitle className=\"flex items-center gap-2\">\n                    <CalendarDays className=\"h-5 w-5 text-primary\" />\n                    Upcoming Appointments\n                  </CardTitle>\n                  <CardDescription>Scheduled follow-ups and meetings.</CardDescription>\n                </CardHeader>\n                <CardContent>\n                  <div className=\"space-y-4\">\n                    {appointments.length > 0 ? (\n                      appointments\n                        .sort((a, b) => new Date(a.date).getTime() - new Date(b.date).getTime())\n                        .map((apt) => (\n                          <div \n                            key={apt._id} \n                            className=\"flex items-center justify-between p-4 border rounded-lg bg-card hover:bg-muted/30 transition-colors cursor-pointer\"\n                            onClick={() => handleEditAppointment(apt)}\n                          >\n                            <div className=\"flex items-center gap-4\">\n                              <div className=\"h-10 w-10 rounded-full bg-primary/10 flex items-center justify-center text-primary font-bold\">\n                                {new Date(apt.date).getDate()}\n                              </div>\n                              <div>\n                                <div className=\"font-semibold\">{apt.title}</div>\n                                <div className=\"text-sm text-muted-foreground flex items-center gap-2\">\n                                  <span>{apt.leadName}</span>\n                                  <span>â€¢</span>\n                                  <span>{new Date(apt.date).toLocaleDateString()} at {apt.time}</span>\n                                  <Badge variant=\"secondary\" className=\"text-[10px] ml-2\">{apt.type}</Badge>\n                                </div>\n                              </div>\n                            </div>\n                            <div className=\"flex items-center gap-2\">\n                              <Button variant=\"ghost\" size=\"icon\" className=\"h-8 w-8\" onClick={(e) => { e.stopPropagation(); handleEditAppointment(apt); }}>\n                                <Edit3 className=\"h-4 w-4\" />\n                              </Button>\n                              <Button variant=\"ghost\" size=\"icon\" className=\"h-8 w-8 text-destructive hover:text-destructive\" onClick={(e) => { e.stopPropagation(); confirmDeleteAppointment(apt); }}>\n                                <Trash2 className=\"h-4 w-4\" />\n                              </Button>\n                            </div>\n                          </div>\n                        ))\n                    ) : (\n                      <div className=\"text-center py-8 text-muted-foreground border-2 border-dashed rounded-lg\">\n                        No appointments scheduled.\n                      </div>\n                    )}\n                  </div>\n                </CardContent>\n              </Card>\n            </div>\n          )}\n\n          {activeTab === \"profile\" && (\n            <div className=\"max-w-4xl mx-auto space-y-8\">\n              <div><h1 className=\"text-3xl font-bold tracking-tight\">Profile Settings</h1><p className=\"text-muted-foreground\">Manage your personal information and platform preferences.</p></div>\n              <div className=\"grid grid-cols-1 md:grid-cols-3 gap-8\">\n                <div className=\"space-y-6\">\n                  <Card className=\"p-6 text-center\">\n                    <Avatar className=\"h-24 w-24 mx-auto mb-4 border-4 border-background shadow-xl ring-1 ring-primary/20\">\n                      <AvatarImage src={user?.companyLogo || \"\"} />\n                      <AvatarFallback className=\"text-3xl bg-primary/10 text-primary font-bold\">{user?.firstName?.charAt(0)}{user?.lastName?.charAt(0)}</AvatarFallback>\n                    </Avatar>\n                    <h3 className=\"font-bold text-lg\">{user?.firstName} {user?.lastName}</h3>\n                    <p className=\"text-sm text-muted-foreground mb-4\">{user?.email}</p>\n                    <Badge variant=\"secondary\" className=\"uppercase tracking-widest text-[10px]\">{user?.role || 'User'}</Badge>\n                  </Card>\n                  <Card className=\"p-6\">\n                    <h4 className=\"font-bold text-sm uppercase tracking-wider mb-4 flex items-center gap-2 text-primary\">\n                      <Building className=\"h-4 w-4\" /> Company Info\n                    </h4>\n                    <div className=\"space-y-4\">\n                          <div className=\"flex flex-col items-center gap-2\">\n                            {profileForm.companyLogo || user?.companyLogo ? (\n                              <img src={profileForm.companyLogo || user?.companyLogo} alt=\"Company Logo\" className=\"h-16 w-16 object-contain border rounded-md\" />\n                            ) : (\n                              <div className=\"h-16 w-16 bg-muted flex items-center justify-center rounded-md border border-dashed\">\n                                <Building className=\"h-8 w-8 text-muted-foreground\" />\n                              </div>\n                            )}\n                            <Input\n                              type=\"file\"\n                              accept=\"image/*\"\n                              className=\"text-xs\"\n                              onChange={async (e) => {\n                                const file = e.target.files?.[0];\n                                if (file) {\n                                  try {\n                                    const response = await uploadApi.uploadFiles([file]);\n                                    if (response && response.length > 0) {\n                                      const logoUrl = response[0].url;\n                                      console.log(\"Uploaded logo URL:\", logoUrl);\n                                      setProfileForm(prev => ({ ...prev, companyLogo: logoUrl }));\n                                      // Also update the user profile immediately to persist it\n                                      const updateRes = await apiRequest(\"PATCH\", \"/api/user\", { \n                                        firstName: profileForm.firstName,\n                                        lastName: profileForm.lastName,\n                                        companyName: profileForm.companyName,\n                                        phone: profileForm.phone,\n                                        companyLogo: logoUrl \n                                      });\n                                      console.log(\"Profile update response:\", updateRes);\n                                      await queryClient.invalidateQueries({ queryKey: [\"/api/user\"] });\n                                      toast({ title: \"Success\", description: \"Company logo uploaded and saved\" });\n                                    }\n                                  } catch (error: any) {\n                                    toast({ variant: \"destructive\", title: \"Upload failed\", description: error.message });\n                                  }\n                                }\n                              }}\n                            />\n                          </div>\n                      <div>\n                        <p className=\"text-xs text-muted-foreground\">Company Name</p>\n                        <p className=\"font-bold\">{user?.companyName || \"Not Set\"}</p>\n                      </div>\n                    </div>\n                  </Card>\n                </div>\n                <div className=\"md:col-span-3 space-y-6\">\n                  <Tabs defaultValue=\"profile\" className=\"w-full\">\n                    <TabsList className=\"grid w-full grid-cols-2\">\n                      <TabsTrigger value=\"profile\">Profile</TabsTrigger>\n                      <TabsTrigger value=\"security\">Security</TabsTrigger>\n                    </TabsList>\n                    <TabsContent value=\"profile\" className=\"mt-6\">\n                      <Card>\n                        <CardHeader>\n                          <CardTitle>Basic Information</CardTitle>\n                          <CardDescription>Update your personal details.</CardDescription>\n                        </CardHeader>\n                        <CardContent className=\"space-y-4\">\n                          <div className=\"space-y-4\">\n                            <div className=\"flex items-center gap-4\">\n                              <Avatar className=\"h-20 w-20 border-2 border-primary/20\">\n                                <AvatarImage src={profileForm.companyLogo || user?.companyLogo || undefined} />\n                                <AvatarFallback className=\"bg-primary/10 text-primary text-xl font-bold\">\n                                  {profileForm.firstName?.charAt(0)}{profileForm.lastName?.charAt(0)}\n                                </AvatarFallback>\n                              </Avatar>\n                              <div>\n                                <Label htmlFor=\"logo-upload\" className=\"cursor-pointer\">\n                                  <div className=\"flex items-center gap-2 text-sm text-primary hover:underline\">\n                                    <Upload className=\"h-4 w-4\" />\n                                    {isUploading ? \"Uploading...\" : \"Upload Company Logo\"}\n                                  </div>\n                                </Label>\n                                <Input \n                                  id=\"logo-upload\" \n                                  type=\"file\" \n                                  className=\"hidden\" \n                                  accept=\"image/*\"\n                                  onChange={handleLogoUpload}\n                                />\n                                <p className=\"text-xs text-muted-foreground mt-1\">Recommended: Square image, max 2MB</p>\n                              </div>\n                            </div>\n                            <div className=\"grid grid-cols-2 gap-4\">\n                              <div className=\"space-y-2\">\n                                <Label>First Name</Label>\n                                <Input value={profileForm.firstName} onChange={e => setProfileForm({...profileForm, firstName: e.target.value})} />\n                              </div>\n                              <div className=\"space-y-2\">\n                                <Label>Last Name</Label>\n                                <Input value={profileForm.lastName} onChange={e => setProfileForm({...profileForm, lastName: e.target.value})} />\n                              </div>\n                            </div>\n                            <div className=\"space-y-2\">\n                              <Label>Email Address</Label>\n                              <Input value={profileForm.email} readOnly className=\"bg-muted\" />\n                            </div>\n                            <div className=\"space-y-2\">\n                              <Label>Phone Number</Label>\n                              <Input value={profileForm.phone} onChange={e => setProfileForm({...profileForm, phone: e.target.value})} />\n                            </div>\n                            <div className=\"space-y-2\">\n                              <Label>Company Name</Label>\n                              <Input value={profileForm.companyName} onChange={e => setProfileForm({...profileForm, companyName: e.target.value})} />\n                            </div>\n                            <div className=\"grid grid-cols-2 gap-4\">\n                              <div className=\"space-y-2\">\n                                <Label>DLT Principal Entity ID</Label>\n                                <Input \n                                  placeholder=\"Enter PE ID\" \n                                  value={profileForm.dltPrincipalEntityId} \n                                  onChange={(e) => setProfileForm({ ...profileForm, dltPrincipalEntityId: e.target.value })} \n                                />\n                              </div>\n                              <div className=\"space-y-2\">\n                                <Label>DLT Header ID (Sender ID)</Label>\n                                <Input \n                                  placeholder=\"Enter Header ID\" \n                                  value={profileForm.dltHeaderId} \n                                  onChange={(e) => setProfileForm({ ...profileForm, dltHeaderId: e.target.value })} \n                                />\n                              </div>\n                            </div>\n                          </div>\n                          <Button className=\"mt-4 w-full\" disabled={isSaving} onClick={handleUpdateProfile}>\n                            {isSaving ? <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" /> : null}\n                            Save Changes\n                          </Button>\n\n                          {/* Exotel Configuration Section */}\n                          {(isAdmin || (userPlan?.selfBranding)) && (\n                            <div className=\"mt-8 pt-8 border-t\">\n                              <h3 className=\"text-lg font-medium mb-4\">Exotel API Configuration</h3>\n                              <form onSubmit={handleUpdateExotelConfig} className=\"space-y-4\">\n                                <div className=\"grid grid-cols-2 gap-4\">\n                                  <div className=\"space-y-2\">\n                                    <Label htmlFor=\"exotelApiKey\">API Key</Label>\n                                    <Input \n                                      id=\"exotelApiKey\" \n                                      value={exotelForm.apiKey} \n                                      onChange={(e) => setExotelForm({...exotelForm, apiKey: e.target.value})}\n                                      placeholder=\"Exotel API Key\"\n                                    />\n                                  </div>\n                                  <div className=\"space-y-2\">\n                                    <Label htmlFor=\"exotelApiToken\">API Token</Label>\n                                    <Input \n                                      id=\"exotelApiToken\" \n                                      type=\"password\"\n                                      value={exotelForm.apiToken} \n                                      onChange={(e) => setExotelForm({...exotelForm, apiToken: e.target.value})}\n                                      placeholder=\"Exotel API Token\"\n                                    />\n                                  </div>\n                                  <div className=\"space-y-2\">\n                                    <Label htmlFor=\"exotelSubdomain\">Subdomain</Label>\n                                    <Input \n                                      id=\"exotelSubdomain\" \n                                      value={exotelForm.subdomain} \n                                      onChange={(e) => setExotelForm({...exotelForm, subdomain: e.target.value})}\n                                      placeholder=\"e.g. api.exotel.com\"\n                                    />\n                                  </div>\n                                  <div className=\"space-y-2\">\n                                    <Label htmlFor=\"exotelSid\">Account SID</Label>\n                                    <Input \n                                      id=\"exotelSid\" \n                                      value={exotelForm.sid} \n                                      onChange={(e) => setExotelForm({...exotelForm, sid: e.target.value})}\n                                      placeholder=\"Exotel Account SID\"\n                                    />\n                                  </div>\n                                </div>\n                                <Button type=\"submit\" disabled={isSaving}>Save Exotel Config</Button>\n                              </form>\n\n                              {/* Gupshup Configuration Section */}\n                              <div className=\"mt-8 pt-8 border-t\">\n                                <h3 className=\"text-lg font-medium mb-4\">Gupshup SMS Configuration</h3>\n                                <form onSubmit={handleUpdateGupshupConfig} className=\"space-y-4\">\n                                  <div className=\"grid grid-cols-2 gap-4\">\n                                    <div className=\"space-y-2\">\n                                      <Label htmlFor=\"gupshupApiKey\">Gupshup API Key</Label>\n                                      <Input \n                                        id=\"gupshupApiKey\" \n                                        type=\"password\"\n                                        value={gupshupForm.apiKey} \n                                        onChange={(e) => setGupshupForm({...gupshupForm, apiKey: e.target.value})}\n                                        placeholder=\"Gupshup API Key\"\n                                      />\n                                    </div>\n                                    <div className=\"space-y-2\">\n                                      <Label htmlFor=\"gupshupUserId\">Gupshup User ID</Label>\n                                      <Input \n                                        id=\"gupshupUserId\" \n                                        value={gupshupForm.userId} \n                                        onChange={(e) => setGupshupForm({...gupshupForm, userId: e.target.value})}\n                                        placeholder=\"Gupshup User ID\"\n                                      />\n                                    </div>\n                                  </div>\n                                  <Button type=\"submit\" disabled={isSaving}>Save Gupshup Config</Button>\n                                </form>\n                              </div>\n                            </div>\n                          )}\n                        </CardContent>\n                      </Card>\n                    </TabsContent>\n                    <TabsContent value=\"security\" className=\"mt-6\">\n                      <Card>\n                        <CardHeader>\n                          <CardTitle>Change Password</CardTitle>\n                          <CardDescription>Ensure your account remains secure.</CardDescription>\n                        </CardHeader>\n                        <CardContent className=\"space-y-4\">\n                          <div className=\"space-y-2\">\n                            <Label>Current Password</Label>\n                            <Input type=\"password\" value={passwordForm.current} onChange={e => setPasswordForm({...passwordForm, current: e.target.value})} />\n                          </div>\n                          <div className=\"space-y-2\">\n                            <Label>New Password</Label>\n                            <Input type=\"password\" value={passwordForm.new} onChange={e => setPasswordForm({...passwordForm, new: e.target.value})} />\n                          </div>\n                          <div className=\"space-y-2\">\n                            <Label>Confirm New Password</Label>\n                            <Input type=\"password\" value={passwordForm.confirm} onChange={e => setPasswordForm({...passwordForm, confirm: e.target.value})} />\n                          </div>\n                          <Button className=\"mt-4\" onClick={async () => {\n                            if (passwordForm.new !== passwordForm.confirm) {\n                              return toast({ title: \"Error\", description: \"Passwords do not match\", variant: \"destructive\" });\n                            }\n                            try {\n                              await apiRequest(\"POST\", \"/api/user/change-password\", {\n                                currentPassword: passwordForm.current,\n                                newPassword: passwordForm.new\n                              });\n                              setPasswordForm({ current: \"\", new: \"\", confirm: \"\" });\n                              toast({ title: \"Success\", description: \"Password updated successfully\" });\n                            } catch (err) {\n                              toast({ title: \"Error\", description: \"Failed to update password\", variant: \"destructive\" });\n                            }\n                          }}>Update Password</Button>\n                        </CardContent>\n                      </Card>\n                    </TabsContent>\n                  </Tabs>\n                </div>\n              </div>\n            </div>\n          )}\n\n                {/* Billing View */}\n                {activeTab === \"billing\" && (\n                  <div className=\"max-w-4xl mx-auto space-y-8\">\n                    <div>\n                      <h1 className=\"text-3xl font-bold tracking-tight\">Billing & Subscription</h1>\n                      <p className=\"text-muted-foreground\">Manage your subscription, view usage, and billing history.</p>\n                    </div>\n\n                    <div className=\"grid grid-cols-1 md:grid-cols-3 gap-6\">\n                      <Card className=\"md:col-span-2\">\n                        <CardHeader>\n                          <CardTitle>Current Plan</CardTitle>\n                          <CardDescription>Details about your current active subscription.</CardDescription>\n                        </CardHeader>\n                        <CardContent className=\"space-y-6\">\n                          <div className=\"flex items-center justify-between p-4 bg-primary/5 rounded-lg border border-primary/10\">\n                            <div>\n                              <h3 className=\"text-lg font-bold\">{user?.subscription?.plan || \"Free\"} Plan</h3>\n                              <p className=\"text-sm text-muted-foreground\">Next renewal: {user?.subscription?.renewalDate ? new Date(user.subscription.renewalDate).toLocaleDateString() : \"N/A\"}</p>\n                            </div>\n                            <Badge variant=\"default\" className=\"bg-green-500 hover:bg-green-600 border-none\">\n                              {user?.subscription?.status || \"Active\"}\n                            </Badge>\n                          </div>\n\n                          <div className=\"grid grid-cols-2 gap-4 pt-4\">\n                            <div className=\"p-4 border rounded-lg\">\n                              <p className=\"text-xs text-muted-foreground mb-1 uppercase font-bold tracking-wider\">Plan Cost</p>\n                              <p className=\"text-2xl font-bold\">â‚¹{plans.find(p => p.name === user?.subscription?.plan)?.price || 0}/mo</p>\n                            </div>\n                            <div className=\"p-4 border rounded-lg\">\n                              <p className=\"text-xs text-muted-foreground mb-1 uppercase font-bold tracking-wider\">Remaining Credits</p>\n                              <p className=\"text-2xl font-bold\">{(user?.subscription?.monthlyCallCredits || 0) - (user?.subscription?.creditsUsed || 0)}</p>\n                            </div>\n                          </div>\n                        </CardContent>\n                        <CardFooter className=\"border-t bg-muted/5 flex flex-wrap justify-between gap-4\">\n                          <Dialog>\n                            <DialogTrigger asChild>\n                              <Button variant=\"outline\">View Billing History</Button>\n                            </DialogTrigger>\n                            <DialogContent className=\"max-w-2xl\">\n                              <DialogHeader>\n                                <DialogTitle>Billing History</DialogTitle>\n                                <DialogDescription>Your recent invoices and transactions.</DialogDescription>\n                              </DialogHeader>\n                              <Table>\n                                <TableHeader>\n                                  <TableRow>\n                                    <TableHead>Date</TableHead>\n                                    <TableHead>Description</TableHead>\n                                    <TableHead>Amount</TableHead>\n                                    <TableHead>Status</TableHead>\n                                    <TableHead className=\"text-right\">Invoice</TableHead>\n                                  </TableRow>\n                                </TableHeader>\n                                <TableBody>\n                                  {user?.subscription?.joinedDate ? (\n                                    <TableRow>\n                                      <TableCell>{new Date(user.subscription.joinedDate).toLocaleDateString()}</TableCell>\n                                      <TableCell>{user.subscription.plan} Plan Activation</TableCell>\n                                      <TableCell>â‚¹{plans.find(p => p.name === user.subscription?.plan)?.price || 0}</TableCell>\n                                      <TableCell><Badge variant=\"outline\" className=\"text-green-600 bg-green-50\">Paid</Badge></TableCell>\n                                      <TableCell className=\"text-right\">\n                                        <Button variant=\"ghost\" size=\"sm\" className=\"h-8\"><FileText className=\"h-4 w-4 mr-2\" /> PDF</Button>\n                                      </TableCell>\n                                    </TableRow>\n                                  ) : (\n                                    <TableRow><TableCell colSpan={5} className=\"text-center py-4 text-muted-foreground\">No billing history found.</TableCell></TableRow>\n                                  )}\n                                </TableBody>\n                              </Table>\n                            </DialogContent>\n                          </Dialog>\n                          \n                          <div className=\"flex gap-2\">\n                            <Button variant=\"outline\" className=\"text-primary border-primary hover:bg-primary/5\" onClick={async () => {\n                              const plan = plans.find(p => p.name === user?.subscription?.plan);\n                              if (!plan) return;\n                              \n                              if (window.confirm(`Renewing your ${plan.name} plan for â‚¹${plan.price}. Proceed to payment?`)) {\n                                try {\n                                  await apiRequest(\"POST\", \"/api/billing/renew\", {});\n                                  await queryClient.invalidateQueries({ queryKey: [\"/api/auth/me\"] });\n                                  toast({ title: \"Success\", description: \"Subscription renewed successfully\" });\n                                } catch (err) {\n                                  toast({ title: \"Error\", description: \"Renewal failed\", variant: \"destructive\" });\n                                }\n                              }\n                            }}>Renew Now</Button>\n                            \n                            <Dialog>\n                              <DialogTrigger asChild>\n                                <Button>Upgrade Plan</Button>\n                              </DialogTrigger>\n                              <DialogContent className=\"max-w-4xl max-h-[90vh] overflow-y-auto\">\n                                <DialogHeader>\n                                  <DialogTitle>Available Plans</DialogTitle>\n                                  <DialogDescription>Choose a plan that fits your business needs.</DialogDescription>\n                                </DialogHeader>\n                                <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4 py-4\">\n                                  {plans.map((plan) => (\n                                    <Card key={plan._id} className={`flex flex-col ${user?.subscription?.plan === plan.name ? 'ring-2 ring-primary border-primary' : ''}`}>\n                                      <CardHeader>\n                                        <CardTitle>{plan.name}</CardTitle>\n                                        <CardDescription>{plan.description}</CardDescription>\n                                        <div className=\"mt-2 text-3xl font-bold\">â‚¹{plan.price}<span className=\"text-sm font-normal text-muted-foreground\">/mo</span></div>\n                                      </CardHeader>\n                                      <CardContent className=\"flex-1\">\n                                        <ul className=\"space-y-2 text-sm\">\n                                          {plan.features?.map((f, idx) => (\n                                            <li key={idx} className=\"flex items-center gap-2\">\n                                              <CheckCircle2 className=\"h-4 w-4 text-green-500\" /> {f}\n                                            </li>\n                                          ))}\n                                        </ul>\n                                      </CardContent>\n                                      <CardFooter>\n                                        <Button \n                                          className=\"w-full\" \n                                          variant={user?.subscription?.plan === plan.name ? \"outline\" : \"default\"}\n                                          disabled={user?.subscription?.plan === plan.name || isSaving}\n                                          onClick={async () => {\n                                            if (window.confirm(`Upgrading to ${plan.name} plan for â‚¹${plan.price}. Proceed to payment?`)) {\n                                              setIsSaving(true);\n                                              try {\n                                                await apiRequest(\"POST\", \"/api/billing/upgrade\", { planId: plan._id });\n                                                await queryClient.invalidateQueries({ queryKey: [\"/api/auth/me\"] });\n                                                toast({ title: \"Success\", description: `Upgraded to ${plan.name} plan` });\n                                              } catch (err) {\n                                                toast({ title: \"Error\", description: \"Upgrade failed\", variant: \"destructive\" });\n                                              } finally {\n                                                setIsSaving(false);\n                                              }\n                                            }\n                                          }}\n                                        >\n                                          {user?.subscription?.plan === plan.name ? \"Current Plan\" : \"Choose Plan\"}\n                                        </Button>\n                                      </CardFooter>\n                                    </Card>\n                                  ))}\n                                </div>\n                              </DialogContent>\n                            </Dialog>\n                          </div>\n                        </CardFooter>\n                      </Card>\n\n                      <Card>\n                        <CardHeader>\n                          <CardTitle className=\"text-sm\">Usage Stats</CardTitle>\n                        </CardHeader>\n                        <CardContent className=\"space-y-4\">\n                          <div className=\"space-y-2\">\n                            <div className=\"flex justify-between text-xs\">\n                              <span className=\"text-muted-foreground uppercase font-bold\">Credits Used</span>\n                              <span className=\"font-bold\">{user?.subscription?.creditsUsed || 0} / {user?.subscription?.monthlyCallCredits || 1000}</span>\n                            </div>\n                            <div className=\"h-2 bg-muted rounded-full overflow-hidden\">\n                              <div className=\"h-full bg-primary\" style={{ width: `${Math.min(100, ((user?.subscription?.creditsUsed || 0) / (user?.subscription?.monthlyCallCredits || 1000)) * 100)}%` }} />\n                            </div>\n                          </div>\n                          <div className=\"space-y-2\">\n                            <div className=\"flex justify-between text-xs\">\n                              <span className=\"text-muted-foreground uppercase font-bold\">API Calls</span>\n                              <span className=\"font-bold\">45 / 100</span>\n                            </div>\n                            <div className=\"h-2 bg-muted rounded-full overflow-hidden\">\n                              <div className=\"h-full bg-blue-500\" style={{ width: \"45%\" }} />\n                            </div>\n                          </div>\n                          <div className=\"pt-4 border-t\">\n                            <p className=\"text-xs text-muted-foreground\">Renewal in 12 days</p>\n                          </div>\n                        </CardContent>\n                      </Card>\n                    </div>\n\n                    <Card>\n                      <CardHeader>\n                        <CardTitle>Usage History</CardTitle>\n                        <CardDescription>Detailed breakdown of your credit consumption.</CardDescription>\n                      </CardHeader>\n                      <CardContent>\n                        <div className=\"h-[250px] w-full\">\n                          <ResponsiveContainer width=\"100%\" height=\"100%\">\n                            <BarChart data={[\n                              { name: 'Jan 10', usage: 120 },\n                              { name: 'Jan 11', usage: 150 },\n                              { name: 'Jan 12', usage: 80 },\n                              { name: 'Jan 13', usage: 210 },\n                              { name: 'Jan 14', usage: 180 },\n                              { name: 'Jan 15', usage: 140 },\n                            ]}>\n                              <CartesianGrid strokeDasharray=\"3 3\" vertical={false} stroke=\"hsl(var(--border))\" opacity={0.3} />\n                              <XAxis dataKey=\"name\" axisLine={false} tickLine={false} tick={{ fill: 'hsl(var(--muted-foreground))', fontSize: 12 }} />\n                              <YAxis axisLine={false} tickLine={false} tick={{ fill: 'hsl(var(--muted-foreground))', fontSize: 12 }} />\n                              <RechartsTooltip contentStyle={{ backgroundColor: 'hsl(var(--card))', borderColor: 'hsl(var(--border))', borderRadius: '12px' }} />\n                              <Bar dataKey=\"usage\" fill=\"hsl(var(--primary))\" radius={[4, 4, 0, 0]} />\n                            </BarChart>\n                          </ResponsiveContainer>\n                        </div>\n                      </CardContent>\n                    </Card>\n                  </div>\n                )}\n        </div>\n      </main>\n\n      {/* Confirmation Dialogs */}\n      <Dialog open={isLogActivityOpen} onOpenChange={setIsLogActivityOpen}>\n        <DialogContent>\n          <DialogHeader>\n            <DialogTitle>Log Activity</DialogTitle>\n            <DialogDescription>Record a manual interaction with this lead.</DialogDescription>\n          </DialogHeader>\n          <div className=\"space-y-4 py-4\">\n            <div className=\"space-y-2\">\n              <Label>Activity Type</Label>\n              <Select value={activityLog.type} onValueChange={(v: any) => setActivityLog({...activityLog, type: v})}>\n                <SelectTrigger><SelectValue /></SelectTrigger>\n                <SelectContent>\n                  <SelectItem value=\"call\">Call</SelectItem>\n                  <SelectItem value=\"email\">Email</SelectItem>\n                  <SelectItem value=\"note\">Note</SelectItem>\n                </SelectContent>\n              </Select>\n            </div>\n            {activityLog.type === \"call\" && (\n              <div className=\"grid grid-cols-2 gap-4\">\n                <div className=\"space-y-2\">\n                  <Label>Outcome</Label>\n                  <Select value={activityLog.outcome} onValueChange={v => setActivityLog({...activityLog, outcome: v})}>\n                    <SelectTrigger><SelectValue /></SelectTrigger>\n                    <SelectContent>\n                      <SelectItem value=\"Answered\">Answered</SelectItem>\n                      <SelectItem value=\"No Answer\">No Answer</SelectItem>\n                      <SelectItem value=\"Busy\">Busy</SelectItem>\n                      <SelectItem value=\"Wrong Number\">Wrong Number</SelectItem>\n                    </SelectContent>\n                  </Select>\n                </div>\n                <div className=\"space-y-2\">\n                  <Label>Duration</Label>\n                  <Input placeholder=\"e.g. 2:30\" value={activityLog.duration} onChange={e => setActivityLog({...activityLog, duration: e.target.value})} />\n                </div>\n              </div>\n            )}\n            <div className=\"space-y-2\">\n              <Label>Notes/Summary</Label>\n              <Textarea placeholder=\"What happened during this interaction?\" value={activityLog.note} onChange={e => setActivityLog({...activityLog, note: e.target.value})} />\n            </div>\n          </div>\n          <DialogFooter>\n            <Button variant=\"outline\" onClick={() => setIsLogActivityOpen(false)}>Cancel</Button>\n            <Button onClick={handleLogActivity} disabled={isSaving}>\n              {isSaving && <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" />}\n              Save Activity\n            </Button>\n          </DialogFooter>\n        </DialogContent>\n      </Dialog>\n\n      <Dialog open={isAddAppointmentOpen} onOpenChange={setIsAddAppointmentOpen}>\n        <DialogContent>\n          <DialogHeader>\n            <DialogTitle>Schedule Meeting</DialogTitle>\n            <DialogDescription>Set up a follow-up appointment with {appointmentForm.leadName}.</DialogDescription>\n          </DialogHeader>\n          <div className=\"space-y-4 py-4\">\n            <div className=\"space-y-2\">\n              <Label>Select Lead <span className=\"text-destructive\">*</span></Label>\n              <Select value={appointmentForm.leadId} onValueChange={(val) => {\n                const lead = leads.find(l => l._id === val);\n                if (lead) {\n                  setAppointmentForm({\n                    ...appointmentForm,\n                    leadId: lead._id,\n                    leadName: lead.name,\n                    title: appointmentForm.title || `Meeting with ${lead.name}`\n                  });\n                }\n              }}>\n                <SelectTrigger>\n                  <SelectValue placeholder=\"Select a lead\" />\n                </SelectTrigger>\n                <SelectContent>\n                  {leads.map(lead => (\n                    <SelectItem key={lead._id} value={lead._id}>{lead.name} ({lead.company})</SelectItem>\n                  ))}\n                </SelectContent>\n              </Select>\n            </div>\n            <div className=\"space-y-2\">\n              <Label>Title <span className=\"text-destructive\">*</span></Label>\n              <Input value={appointmentForm.title} onChange={e => setAppointmentForm({...appointmentForm, title: e.target.value})} />\n            </div>\n            <div className=\"grid grid-cols-2 gap-4\">\n              <div className=\"space-y-2\">\n                <Label>Date <span className=\"text-destructive\">*</span></Label>\n                <Input type=\"date\" value={appointmentForm.date} onChange={e => setAppointmentForm({...appointmentForm, date: e.target.value})} />\n              </div>\n              <div className=\"space-y-2\">\n                <Label>Time</Label>\n                <Input type=\"time\" value={appointmentForm.time} onChange={e => setAppointmentForm({...appointmentForm, time: e.target.value})} />\n              </div>\n            </div>\n            <div className=\"space-y-2\">\n              <Label>Type</Label>\n              <Select value={appointmentForm.type} onValueChange={v => setAppointmentForm({...appointmentForm, type: v})}>\n                <SelectTrigger><SelectValue /></SelectTrigger>\n                <SelectContent>\n                  <SelectItem value=\"Zoom\">Zoom Meeting</SelectItem>\n                  <SelectItem value=\"Google Meet\">Google Meet</SelectItem>\n                  <SelectItem value=\"Phone Call\">Phone Call</SelectItem>\n                  <SelectItem value=\"In Person\">In Person</SelectItem>\n                </SelectContent>\n              </Select>\n            </div>\n            <div className=\"space-y-2\">\n              <Label>Notes</Label>\n              <Textarea placeholder=\"Meeting agenda or details...\" value={appointmentForm.notes} onChange={e => setAppointmentForm({...appointmentForm, notes: e.target.value})} />\n            </div>\n          </div>\n          <DialogFooter>\n            <Button variant=\"outline\" onClick={() => setIsAddAppointmentOpen(false)}>Cancel</Button>\n            <Button onClick={handleAddAppointment} disabled={isSaving}>\n              {isSaving && <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" />}\n              Schedule\n            </Button>\n          </DialogFooter>\n        </DialogContent>\n      </Dialog>\n\n      <Dialog open={isEditAppointmentOpen} onOpenChange={setIsEditAppointmentOpen}>\n        <DialogContent>\n          <DialogHeader>\n            <DialogTitle>Edit Meeting</DialogTitle>\n            <DialogDescription>Update appointment details for {appointmentForm.leadName}.</DialogDescription>\n          </DialogHeader>\n          <div className=\"space-y-4 py-4\">\n            <div className=\"space-y-2\">\n              <Label>Title <span className=\"text-destructive\">*</span></Label>\n              <Input value={appointmentForm.title} onChange={e => setAppointmentForm({...appointmentForm, title: e.target.value})} />\n            </div>\n            <div className=\"grid grid-cols-2 gap-4\">\n              <div className=\"space-y-2\">\n                <Label>Date <span className=\"text-destructive\">*</span></Label>\n                <Input type=\"date\" value={appointmentForm.date} onChange={e => setAppointmentForm({...appointmentForm, date: e.target.value})} />\n              </div>\n              <div className=\"space-y-2\">\n                <Label>Time</Label>\n                <Input type=\"time\" value={appointmentForm.time} onChange={e => setAppointmentForm({...appointmentForm, time: e.target.value})} />\n              </div>\n            </div>\n            <div className=\"space-y-2\">\n              <Label>Type</Label>\n              <Select value={appointmentForm.type} onValueChange={v => setAppointmentForm({...appointmentForm, type: v})}>\n                <SelectTrigger><SelectValue /></SelectTrigger>\n                <SelectContent>\n                  <SelectItem value=\"Zoom\">Zoom Meeting</SelectItem>\n                  <SelectItem value=\"Google Meet\">Google Meet</SelectItem>\n                  <SelectItem value=\"Phone Call\">Phone Call</SelectItem>\n                  <SelectItem value=\"In Person\">In Person</SelectItem>\n                </SelectContent>\n              </Select>\n            </div>\n            <div className=\"space-y-2\">\n              <Label>Notes</Label>\n              <Textarea placeholder=\"Meeting agenda or details...\" value={appointmentForm.notes} onChange={e => setAppointmentForm({...appointmentForm, notes: e.target.value})} />\n            </div>\n          </div>\n          <DialogFooter>\n            <div className=\"flex justify-between w-full\">\n              <Button variant=\"destructive\" onClick={() => { if (selectedAppointment) confirmDeleteAppointment(selectedAppointment); setIsEditAppointmentOpen(false); }}>Delete</Button>\n              <div className=\"flex gap-2\">\n                <Button variant=\"outline\" onClick={() => setIsEditAppointmentOpen(false)}>Cancel</Button>\n                <Button onClick={handleUpdateAppointment} disabled={isSaving}>\n                  {isSaving && <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" />}\n                  Update\n                </Button>\n              </div>\n            </div>\n          </DialogFooter>\n        </DialogContent>\n      </Dialog>\n\n      <AlertDialog open={callConfirm !== null} onOpenChange={(open) => !open && setCallConfirm(null)}>\n        <AlertDialogContent>\n          <AlertDialogHeader>\n            <AlertDialogTitle>Confirm {callConfirm?.type === \"call\" ? \"AI Call\" : \"SMS\"}</AlertDialogTitle>\n            <AlertDialogDescription>\n              Are you sure you want to initiate an {callConfirm?.type === \"call\" ? \"AI voice call\" : \"SMS message\"} to this lead? \n              This will consume credits from your balance.\n            </AlertDialogDescription>\n          </AlertDialogHeader>\n          <AlertDialogFooter>\n            <AlertDialogCancel>Cancel</AlertDialogCancel>\n            <AlertDialogAction \n              onClick={async () => {\n                if (!callConfirm) return;\n                try {\n                  if (callConfirm.type === \"call\") {\n                    await leadsApi.initiateCall(callConfirm.leadId);\n                    toast({ title: \"Call initiated\", description: \"The AI agent is now calling the lead.\" });\n                  } else {\n                    await leadsApi.sendSms(callConfirm.leadId);\n                    toast({ title: \"SMS sent\", description: \"Message has been queued for delivery.\" });\n                  }\n                } catch (err: any) {\n                  toast({ variant: \"destructive\", title: \"Error\", description: err.message });\n                }\n                setCallConfirm(null);\n              }}\n            >\n              Confirm\n            </AlertDialogAction>\n          </AlertDialogFooter>\n        </AlertDialogContent>\n      </AlertDialog>\n\n      <AlertDialog open={deleteConfirm.type !== null} onOpenChange={(open) => !open && setDeleteConfirm({ type: null, id: \"\", name: \"\" })}>\n        <AlertDialogContent><AlertDialogHeader><AlertDialogTitle>Are you absolutely sure?</AlertDialogTitle><AlertDialogDescription>This will permanently delete the {deleteConfirm.type} \"<strong>{deleteConfirm.name}</strong>\". This action cannot be undone.</AlertDialogDescription></AlertDialogHeader><AlertDialogFooter><AlertDialogCancel>Cancel</AlertDialogCancel><AlertDialogAction className=\"bg-destructive text-destructive-foreground hover:bg-destructive/90\" onClick={() => { if (deleteConfirm.type === 'lead') handleDeleteLead(deleteConfirm.id); else if (deleteConfirm.type === 'campaign') campaignsApi.delete(deleteConfirm.id).then(() => setCampaigns(campaigns.filter(c => c._id !== deleteConfirm.id))); else if (deleteConfirm.type === 'appointment') handleDeleteAppointment(deleteConfirm.id); setDeleteConfirm({ type: null, id: \"\", name: \"\" }); }}>Delete</AlertDialogAction></AlertDialogFooter></AlertDialogContent>\n      </AlertDialog>\n    </div>\n  );\n}\n","path":null,"size_bytes":195248,"size_tokens":null},"server/routes.ts":{"content":"import type { Express, Request, Response } from \"express\";\nimport { Server } from \"http\";\nimport { storage } from \"./storage\";\nimport { connectDB } from \"./db\";\nimport bcryptjs from \"bcryptjs\";\nimport session from \"express-session\";\nimport multer from \"multer\";\nimport path from \"path\";\nimport fs from \"fs\";\nimport {\n  insertUserSchema,\n  updateUserSchema,\n  changePasswordSchema,\n  insertLeadSchema,\n  insertCampaignSchema,\n  insertAppointmentSchema,\n  updateSettingsSchema,\n  insertNoteSchema,\n  updateNoteSchema,\n  insertPlanSchema,\n  insertFeatureSchema,\n  insertNotificationSchema,\n} from \"@shared/schema\";\n\n// ... Configure multer for file uploads ...\nconst uploadDir = path.join(process.cwd(), \"uploads\");\nif (!fs.existsSync(uploadDir)) {\n  fs.mkdirSync(uploadDir, { recursive: true });\n}\n\nconst fileStorage = multer.diskStorage({\n  destination: (req, file, cb) => {\n    cb(null, uploadDir);\n  },\n  filename: (req, file, cb) => {\n    const uniqueSuffix = Date.now() + \"-\" + Math.round(Math.random() * 1e9);\n    cb(null, uniqueSuffix + \"-\" + file.originalname);\n  },\n});\n\nconst upload = multer({\n  storage: fileStorage,\n  limits: { fileSize: 10 * 1024 * 1024 }, // 10MB limit\n  fileFilter: (req, file, cb) => {\n    const allowedTypes = [\n      \"application/pdf\",\n      \"application/msword\",\n      \"application/vnd.openxmlformats-officedocument.wordprocessingml.document\",\n      \"text/plain\",\n      \"image/jpeg\",\n      \"image/png\",\n      \"image/gif\",\n      \"image/webp\",\n    ];\n    if (allowedTypes.includes(file.mimetype)) {\n      cb(null, true);\n    } else {\n      cb(new Error(\"Invalid file type. Allowed: PDF, DOC, DOCX, TXT, JPG, PNG, GIF, WEBP\"));\n    }\n  },\n});\n\n// Extend session data\ndeclare module \"express-session\" {\n  interface SessionData {\n    userId?: string;\n  }\n}\n\nexport async function registerRoutes(server: Server, app: Express): Promise<void> {\n  // Connect to MongoDB\n  await connectDB();\n\n  // Session middleware MUST be registered BEFORE routes\n  app.use(\n    session({\n      secret: process.env.SESSION_SECRET || \"nijvox-secret-key-change-in-production\",\n      resave: true,\n      saveUninitialized: true,\n      name: \"aiagent.sid\",\n      rolling: true, // Force session cookie to be set on every response\n      cookie: {\n        secure: false, // Changed to false for HTTP EC2 instance\n        httpOnly: true,\n        path: \"/\", // Use root path for all environments to ensure cookie is always sent\n        maxAge: 1000 * 60 * 60 * 24 * 7, // 1 week\n        sameSite: \"lax\"\n      },\n    })\n  );\n\n  // Auth middleware\n  const requireAuth = (req: Request, res: Response, next: Function) => {\n    if (!req.session || !req.session.userId) {\n      const isProduction = process.env.NODE_ENV === \"production\";\n      const base = isProduction ? \"/aiagent\" : \"\";\n      \n      if (req.headers.referer?.includes(\"/admin\")) {\n        return res.status(401).json({ message: \"Unauthorized\", redirectTo: `${base}/admin` });\n      }\n      return res.status(401).json({ message: \"Unauthorized\", redirectTo: `${base}/login` });\n    }\n    next();\n  };\n\n  // Register\n  app.post(\"/api/auth/register\", async (req, res) => {\n    try {\n      const data = insertUserSchema.parse(req.body);\n      const existingUser = await storage.getUserByEmail(data.email);\n      if (existingUser) {\n        return res.status(400).json({ message: \"Email already in use\" });\n      }\n      const user = await storage.createUser(data);\n      res.status(201).json({ user });\n    } catch (error: any) {\n      res.status(400).json({ message: error.message });\n    }\n  });\n\n  // Login\n  app.post(\"/api/auth/login\", async (req, res) => {\n    try {\n      const { email, password } = req.body;\n      \n      const user = await storage.getUserByEmail(email);\n      if (!user) {\n        return res.status(401).json({ message: \"Invalid credentials\" });\n      }\n      \n      const userWithPassword: any = await storage.getUserByEmail(email);\n      const isValid = await bcryptjs.compare(password, userWithPassword.password);\n      \n      if (!isValid) {\n        return res.status(401).json({ message: \"Invalid credentials\" });\n      }\n      \n      req.session.userId = user._id;\n      const { password: _, ...userWithoutPassword } = userWithPassword;\n      \n      // Explicitly save session before responding\n      req.session.save((err) => {\n        if (err) {\n          return res.status(500).json({ message: \"Session save failed\" });\n        }\n        res.json({ user: userWithoutPassword });\n      });\n    } catch (error: any) {\n      res.status(400).json({ message: error.message });\n    }\n  });\n\n  // Logout\n  app.post(\"/api/auth/logout\", (req, res) => {\n    req.session.destroy((err) => {\n      if (err) {\n        return res.status(500).json({ message: \"Logout failed\" });\n      }\n      res.json({ message: \"Logged out successfully\" });\n    });\n  });\n\n  // Get current user\n  app.get(\"/api/auth/me\", requireAuth, async (req, res) => {\n    try {\n      const user = await storage.getUser(req.session.userId!);\n      if (!user) {\n        return res.status(404).json({ message: \"User not found\" });\n      }\n      res.json({ user });\n    } catch (error: any) {\n      res.status(500).json({ message: error.message });\n    }\n  });\n\n  // ==================== USER ROUTES ====================\n  \n  // Get all users (admin only)\n  app.get(\"/api/users\", requireAuth, async (req, res) => {\n    try {\n      const currentUser = await storage.getUser(req.session.userId!);\n      if (currentUser?.role !== \"admin\") {\n        return res.status(403).json({ message: \"Forbidden\" });\n      }\n      \n      const users = await storage.getAllUsers();\n      res.json({ users });\n    } catch (error: any) {\n      res.status(500).json({ message: error.message });\n    }\n  });\n\n  // Upload endpoint for various files\n  app.post(\"/api/upload\", requireAuth, upload.array(\"files\"), (req, res) => {\n    try {\n      const files = req.files as Express.Multer.File[];\n      const uploadedFiles = files.map(file => ({\n        url: `/uploads/${file.filename}`,\n        name: file.originalname,\n        size: file.size,\n        type: file.mimetype\n      }));\n      res.json(uploadedFiles);\n    } catch (error: any) {\n      res.status(400).json({ message: error.message });\n    }\n  });\n\n  // Update user profile\n  app.patch(\"/api/user\", requireAuth, async (req, res) => {\n    try {\n      const id = req.session.userId!;\n      console.log(\"Updating user profile:\", id, req.body);\n      const updates = updateUserSchema.partial().parse(req.body);\n      const user = await storage.updateUser(id, updates);\n      \n      if (!user) {\n        return res.status(404).json({ message: \"User not found\" });\n      }\n      \n      res.json({ user });\n    } catch (error: any) {\n      console.error(\"Profile update error:\", error);\n      res.status(400).json({ message: error.message });\n    }\n  });\n\n  // Update user profile by ID (admin only or self)\n  app.patch(\"/api/users/:id\", requireAuth, async (req, res) => {\n    try {\n      const { id } = req.params;\n      \n      // Users can only update their own profile unless admin\n      const currentUser = await storage.getUser(req.session.userId!);\n      if (currentUser?.role !== \"admin\" && id !== req.session.userId) {\n        return res.status(403).json({ message: \"Forbidden\" });\n      }\n      \n      const updates = updateUserSchema.parse(req.body);\n      const user = await storage.updateUser(id, updates);\n      \n      if (!user) {\n        return res.status(404).json({ message: \"User not found\" });\n      }\n      \n      res.json({ user });\n    } catch (error: any) {\n      res.status(400).json({ message: error.message });\n    }\n  });\n\n  // Change password\n  app.post(\"/api/users/:id/password\", requireAuth, async (req, res) => {\n    try {\n      const { id } = req.params;\n      \n      // Users can only change their own password\n      if (id !== req.session.userId) {\n        return res.status(403).json({ message: \"Forbidden\" });\n      }\n      \n      const { currentPassword, newPassword } = changePasswordSchema.parse(req.body);\n      const success = await storage.changePassword(id, currentPassword, newPassword);\n      \n      if (!success) {\n        return res.status(400).json({ message: \"Invalid current password\" });\n      }\n      \n      res.json({ message: \"Password changed successfully\" });\n    } catch (error: any) {\n      res.status(400).json({ message: error.message });\n    }\n  });\n\n  // ==================== LEAD ROUTES ====================\n  \n  // Get all leads for current user (optionally filter by campaign)\n  app.get(\"/api/leads\", requireAuth, async (req, res) => {\n    try {\n      const campaignId = req.query.campaignId as string | undefined;\n      const leads = await storage.getLeads(req.session.userId!, campaignId);\n      res.json({ leads });\n    } catch (error: any) {\n      res.status(500).json({ message: error.message });\n    }\n  });\n\n  // Get single lead\n  app.get(\"/api/leads/:id\", requireAuth, async (req, res) => {\n    try {\n      const lead = await storage.getLead(req.params.id);\n      \n      if (!lead) {\n        return res.status(404).json({ message: \"Lead not found\" });\n      }\n      \n      // Verify ownership\n      if (lead.userId !== req.session.userId) {\n        return res.status(403).json({ message: \"Forbidden\" });\n      }\n      \n      res.json({ lead });\n    } catch (error: any) {\n      res.status(500).json({ message: error.message });\n    }\n  });\n\n  // Create lead\n  app.post(\"/api/leads\", requireAuth, async (req, res) => {\n    try {\n      const data = insertLeadSchema.parse({\n        ...req.body,\n        userId: req.session.userId,\n      });\n      \n      const lead = await storage.createLead(data);\n      res.status(201).json({ lead });\n    } catch (error: any) {\n      res.status(400).json({ message: error.message });\n    }\n  });\n\n  // Update lead\n  app.patch(\"/api/leads/:id\", requireAuth, async (req, res) => {\n    try {\n      const lead = await storage.getLead(req.params.id);\n      \n      if (!lead) {\n        return res.status(404).json({ message: \"Lead not found\" });\n      }\n      \n      if (lead.userId !== req.session.userId) {\n        return res.status(403).json({ message: \"Forbidden\" });\n      }\n      \n      const updatedLead = await storage.updateLead(req.params.id, req.body);\n      res.json({ lead: updatedLead });\n    } catch (error: any) {\n      res.status(400).json({ message: error.message });\n    }\n  });\n\n  // Delete lead\n  app.delete(\"/api/leads/:id\", requireAuth, async (req, res) => {\n    try {\n      const lead = await storage.getLead(req.params.id);\n      \n      if (!lead) {\n        return res.status(404).json({ message: \"Lead not found\" });\n      }\n      \n      if (lead.userId !== req.session.userId) {\n        return res.status(403).json({ message: \"Forbidden\" });\n      }\n      \n      await storage.deleteLead(req.params.id);\n      res.json({ message: \"Lead deleted successfully\" });\n    } catch (error: any) {\n      res.status(500).json({ message: error.message });\n    }\n  });\n\n  // Add lead history entry\n  app.post(\"/api/leads/:id/history\", requireAuth, async (req, res) => {\n    try {\n      const lead = await storage.getLead(req.params.id);\n      \n      if (!lead) {\n        return res.status(404).json({ message: \"Lead not found\" });\n      }\n      \n      if (lead.userId !== req.session.userId) {\n        return res.status(403).json({ message: \"Forbidden\" });\n      }\n      \n      const updatedLead = await storage.addLeadHistory(req.params.id, req.body);\n      res.json({ lead: updatedLead });\n    } catch (error: any) {\n      res.status(400).json({ message: error.message });\n    }\n  });\n\n  // ==================== CAMPAIGN ROUTES ====================\n  \n  // Get all campaigns\n  app.get(\"/api/campaigns\", requireAuth, async (req, res) => {\n    try {\n      const campaigns = await storage.getCampaigns(req.session.userId!);\n      res.json({ campaigns });\n    } catch (error: any) {\n      res.status(500).json({ message: error.message });\n    }\n  });\n\n  // Get single campaign\n  app.get(\"/api/campaigns/:id\", requireAuth, async (req, res) => {\n    try {\n      const campaign = await storage.getCampaign(req.params.id);\n      \n      if (!campaign) {\n        return res.status(404).json({ message: \"Campaign not found\" });\n      }\n      \n      if (campaign.userId !== req.session.userId) {\n        return res.status(403).json({ message: \"Forbidden\" });\n      }\n      \n      res.json({ campaign });\n    } catch (error: any) {\n      res.status(500).json({ message: error.message });\n    }\n  });\n\n  // Create campaign\n  app.post(\"/api/campaigns\", requireAuth, async (req, res) => {\n    try {\n      const data = insertCampaignSchema.parse({\n        ...req.body,\n        userId: req.session.userId,\n      });\n      \n      const campaign = await storage.createCampaign(data);\n      res.status(201).json({ campaign });\n    } catch (error: any) {\n      res.status(400).json({ message: error.message });\n    }\n  });\n\n  // Update campaign\n  app.patch(\"/api/campaigns/:id\", requireAuth, async (req, res) => {\n    try {\n      const campaign = await storage.getCampaign(req.params.id);\n      \n      if (!campaign) {\n        return res.status(404).json({ message: \"Campaign not found\" });\n      }\n      \n      if (campaign.userId !== req.session.userId) {\n        return res.status(403).json({ message: \"Forbidden\" });\n      }\n      \n      const updatedCampaign = await storage.updateCampaign(req.params.id, req.body);\n      res.json({ campaign: updatedCampaign });\n    } catch (error: any) {\n      res.status(400).json({ message: error.message });\n    }\n  });\n\n  // Delete campaign\n  app.delete(\"/api/campaigns/:id\", requireAuth, async (req, res) => {\n    try {\n      const campaign = await storage.getCampaign(req.params.id);\n      \n      if (!campaign) {\n        return res.status(404).json({ message: \"Campaign not found\" });\n      }\n      \n      if (campaign.userId !== req.session.userId) {\n        return res.status(403).json({ message: \"Forbidden\" });\n      }\n      \n      await storage.deleteCampaign(req.params.id);\n      res.json({ message: \"Campaign deleted successfully\" });\n    } catch (error: any) {\n      res.status(500).json({ message: error.message });\n    }\n  });\n\n  // ==================== NOTIFICATION ROUTES ====================\n\n  // Get all notifications\n  app.get(\"/api/notifications\", requireAuth, async (req, res) => {\n    try {\n      const notifications = await storage.getNotifications();\n      res.json({ notifications });\n    } catch (error: any) {\n      res.status(500).json({ message: error.message });\n    }\n  });\n\n  // Create notification (admin only)\n  app.post(\"/api/notifications\", requireAuth, async (req, res) => {\n    try {\n      const currentUser = await storage.getUser(req.session.userId!);\n      if (currentUser?.role !== \"admin\") {\n        return res.status(403).json({ message: \"Forbidden\" });\n      }\n\n      const data = insertNotificationSchema.parse(req.body);\n      const notification = await storage.createNotification(data);\n      res.status(201).json({ notification });\n    } catch (error: any) {\n      res.status(400).json({ message: error.message });\n    }\n  });\n\n  // Mark notification as read\n  app.post(\"/api/notifications/:id/read\", requireAuth, async (req, res) => {\n    try {\n      await storage.markNotificationRead(req.params.id, req.session.userId!);\n      res.json({ message: \"Notification marked as read\" });\n    } catch (error: any) {\n      res.status(500).json({ message: error.message });\n    }\n  });\n\n  // ==================== FILE UPLOAD ROUTES ====================\n\n  // Serve uploaded files\n  const express = await import(\"express\");\n  app.use(\"/uploads\", express.default.static(uploadDir));\n\n  // Upload files for campaign knowledge base\n  app.post(\"/api/upload\", requireAuth, upload.array(\"files\", 10), async (req, res) => {\n    try {\n      const files = req.files as Express.Multer.File[];\n      if (!files || files.length === 0) {\n        return res.status(400).json({ message: \"No files uploaded\" });\n      }\n\n      const uploadedFiles = files.map((file) => ({\n        id: file.filename.split(\"-\")[0] + \"-\" + file.filename.split(\"-\")[1],\n        name: file.originalname,\n        type: file.mimetype,\n        size: file.size,\n        url: `/uploads/${file.filename}`,\n        uploadedAt: new Date(),\n      }));\n\n      res.json({ files: uploadedFiles });\n    } catch (error: any) {\n      res.status(500).json({ message: error.message });\n    }\n  });\n\n  // Delete uploaded file\n  app.delete(\"/api/upload/:filename\", requireAuth, async (req, res) => {\n    try {\n      const filePath = path.join(uploadDir, req.params.filename);\n      if (fs.existsSync(filePath)) {\n        fs.unlinkSync(filePath);\n      }\n      res.json({ message: \"File deleted\" });\n    } catch (error: any) {\n      res.status(500).json({ message: error.message });\n    }\n  });\n\n  // Get single plan\n  app.get(\"/api/plans/:id\", async (req, res) => {\n    try {\n      const plan = await storage.getPlan(req.params.id);\n      if (!plan) {\n        return res.status(404).json({ message: \"Plan not found\" });\n      }\n      res.json(plan);\n    } catch (error: any) {\n      res.status(500).json({ message: error.message });\n    }\n  });\n\n  // Upgrade plan\n  app.post(\"/api/billing/upgrade\", requireAuth, async (req, res) => {\n    try {\n      const { planId } = req.body;\n      const plan = await storage.getPlan(planId);\n      if (!plan) {\n        return res.status(404).json({ message: \"Plan not found\" });\n      }\n      \n      const user = await storage.updateUserSubscription(req.session.userId!, {\n        plan: plan.name,\n        status: \"Active\",\n        monthlyCallCredits: plan.credits,\n        creditsUsed: 0,\n        renewalDate: new Date(Date.now() + 30 * 24 * 60 * 60 * 1000),\n        joinedDate: new Date(),\n      });\n      \n      res.json({ user });\n    } catch (error: any) {\n      res.status(400).json({ message: error.message });\n    }\n  });\n\n  // Renew subscription\n  app.post(\"/api/billing/renew\", requireAuth, async (req, res) => {\n    try {\n      const user = await storage.getUser(req.session.userId!);\n      if (!user || !user.subscription) {\n        return res.status(400).json({ message: \"No active subscription\" });\n      }\n      \n      const updatedUser = await storage.updateUserSubscription(req.session.userId!, {\n        ...user.subscription,\n        renewalDate: new Date(Date.now() + 30 * 24 * 60 * 60 * 1000),\n      });\n      \n      res.json({ user: updatedUser });\n    } catch (error: any) {\n      res.status(400).json({ message: error.message });\n    }\n  });\n\n  // ==================== APPOINTMENT ROUTES ====================\n  \n  // Get all appointments\n  app.get(\"/api/appointments\", requireAuth, async (req, res) => {\n    try {\n      const appointments = await storage.getAppointments(req.session.userId!);\n      res.json({ appointments });\n    } catch (error: any) {\n      res.status(500).json({ message: error.message });\n    }\n  });\n\n  // Get single appointment\n  app.get(\"/api/appointments/:id\", requireAuth, async (req, res) => {\n    try {\n      const appointment = await storage.getAppointment(req.params.id);\n      \n      if (!appointment) {\n        return res.status(404).json({ message: \"Appointment not found\" });\n      }\n      \n      if (appointment.userId !== req.session.userId) {\n        return res.status(403).json({ message: \"Forbidden\" });\n      }\n      \n      res.json({ appointment });\n    } catch (error: any) {\n      res.status(500).json({ message: error.message });\n    }\n  });\n\n  // Create appointment\n  app.post(\"/api/appointments\", requireAuth, async (req, res) => {\n    try {\n      const data = insertAppointmentSchema.parse({\n        ...req.body,\n        userId: req.session.userId,\n      });\n      \n      const appointment = await storage.createAppointment(data);\n      res.status(201).json({ appointment });\n    } catch (error: any) {\n      res.status(400).json({ message: error.message });\n    }\n  });\n\n  // Update appointment\n  app.patch(\"/api/appointments/:id\", requireAuth, async (req, res) => {\n    try {\n      const appointment = await storage.getAppointment(req.params.id);\n      \n      if (!appointment) {\n        return res.status(404).json({ message: \"Appointment not found\" });\n      }\n      \n      if (appointment.userId !== req.session.userId) {\n        return res.status(403).json({ message: \"Forbidden\" });\n      }\n      \n      const updatedAppointment = await storage.updateAppointment(req.params.id, req.body);\n      res.json({ appointment: updatedAppointment });\n    } catch (error: any) {\n      res.status(400).json({ message: error.message });\n    }\n  });\n\n  // Delete appointment\n  app.delete(\"/api/appointments/:id\", requireAuth, async (req, res) => {\n    try {\n      const appointment = await storage.getAppointment(req.params.id);\n      \n      if (!appointment) {\n        return res.status(404).json({ message: \"Appointment not found\" });\n      }\n      \n      if (appointment.userId !== req.session.userId) {\n        return res.status(403).json({ message: \"Forbidden\" });\n      }\n      \n      await storage.deleteAppointment(req.params.id);\n      res.json({ message: \"Appointment deleted successfully\" });\n    } catch (error: any) {\n      res.status(500).json({ message: error.message });\n    }\n  });\n\n  // ==================== SETTINGS ROUTES ====================\n  \n  // Get user settings\n  app.get(\"/api/settings\", requireAuth, async (req, res) => {\n    try {\n      const user = await storage.getSettings(req.session.userId!);\n      \n      if (!user) {\n        return res.status(404).json({ message: \"User not found\" });\n      }\n      \n      res.json({ settings: user.settings, subscription: user.subscription, exotelConfig: user.exotelConfig, gupshupConfig: user.gupshupConfig });\n    } catch (error: any) {\n      res.status(500).json({ message: error.message });\n    }\n  });\n\n  // Get Admin Exotel Config\n  app.get(\"/api/admin/exotel\", requireAuth, async (req, res) => {\n    try {\n      const user = await storage.getUser(req.session.userId!);\n      if (user?.role !== \"admin\") return res.status(403).json({ message: \"Forbidden\" });\n      const config = await storage.getAdminSettings();\n      res.json(config);\n    } catch (error: any) {\n      res.status(500).json({ message: error.message });\n    }\n  });\n\n  // Update Admin Exotel Config\n  app.post(\"/api/admin/exotel\", requireAuth, async (req, res) => {\n    try {\n      const user = await storage.getUser(req.session.userId!);\n      if (user?.role !== \"admin\") return res.status(403).json({ message: \"Forbidden\" });\n      const config = await storage.updateAdminSettings(req.body);\n      res.json(config);\n    } catch (error: any) {\n      res.status(500).json({ message: error.message });\n    }\n  });\n\n  // Update User Exotel Config\n  app.post(\"/api/user/exotel\", requireAuth, async (req, res) => {\n    try {\n      const user = await storage.getUser(req.session.userId!);\n      if (!user) return res.status(404).json({ message: \"User not found\" });\n      \n      const plan = await storage.getPlans().then(plans => plans.find(p => p.name === user.subscription?.plan));\n      if (user.role !== \"admin\" && !plan?.selfBranding) {\n        return res.status(403).json({ message: \"Plan does not support self-branding\" });\n      }\n      \n      const updatedUser = await storage.updateExotelConfig(user._id, req.body);\n      res.json({ user: updatedUser });\n    } catch (error: any) {\n      res.status(500).json({ message: error.message });\n    }\n  });\n\n  // Update User Gupshup Config\n  app.post(\"/api/user/gupshup\", requireAuth, async (req, res) => {\n    try {\n      const user = await storage.getUser(req.session.userId!);\n      if (!user) return res.status(404).json({ message: \"User not found\" });\n\n      const plan = await storage.getPlans().then(plans => plans.find(p => p.name === user.subscription?.plan));\n      if (user.role !== \"admin\" && !plan?.selfBranding) {\n        return res.status(403).json({ message: \"Plan does not support self-branding\" });\n      }\n\n      const updatedUser = await storage.updateGupshupConfig(user._id, req.body);\n      res.json({ user: updatedUser });\n    } catch (error: any) {\n      res.status(500).json({ message: error.message });\n    }\n  });\n\n  // Update user settings\n  app.patch(\"/api/settings\", requireAuth, async (req, res) => {\n    try {\n      const settings = updateSettingsSchema.parse(req.body);\n      const user = await storage.updateSettings(req.session.userId!, settings);\n      \n      if (!user) {\n        return res.status(404).json({ message: \"User not found\" });\n      }\n      \n      res.json({ settings: user.settings });\n    } catch (error: any) {\n      res.status(400).json({ message: error.message });\n    }\n  });\n\n  // ==================== NOTES ROUTES ====================\n\n  // Get all notes\n  app.get(\"/api/notes\", requireAuth, async (req, res) => {\n    try {\n      const notes = await storage.getNotes(req.session.userId!);\n      res.json({ notes });\n    } catch (error: any) {\n      res.status(500).json({ message: error.message });\n    }\n  });\n\n  // Create note\n  app.post(\"/api/notes\", requireAuth, async (req, res) => {\n    try {\n      const data = insertNoteSchema.parse({\n        ...req.body,\n        userId: req.session.userId,\n      });\n      const note = await storage.createNote(data);\n      res.status(201).json({ note });\n    } catch (error: any) {\n      res.status(400).json({ message: error.message });\n    }\n  });\n\n  // Update note\n  app.patch(\"/api/notes/:id\", requireAuth, async (req, res) => {\n    try {\n      const note = await storage.getNote(req.params.id);\n      if (!note) {\n        return res.status(404).json({ message: \"Note not found\" });\n      }\n      if (note.userId !== req.session.userId) {\n        return res.status(403).json({ message: \"Forbidden\" });\n      }\n      const updatedNote = await storage.updateNote(req.params.id, req.body);\n      res.json({ note: updatedNote });\n    } catch (error: any) {\n      res.status(400).json({ message: error.message });\n    }\n  });\n\n  // Delete note\n  app.delete(\"/api/notes/:id\", requireAuth, async (req, res) => {\n    try {\n      const note = await storage.getNote(req.params.id);\n      if (!note) {\n        return res.status(404).json({ message: \"Note not found\" });\n      }\n      if (note.userId !== req.session.userId) {\n        return res.status(403).json({ message: \"Forbidden\" });\n      }\n      await storage.deleteNote(req.params.id);\n      res.json({ message: \"Note deleted successfully\" });\n    } catch (error: any) {\n      res.status(500).json({ message: error.message });\n    }\n  });\n\n  // ==================== PLAN ROUTES ====================\n\n  // Get all plans\n  app.get(\"/api/plans\", async (req, res) => {\n    try {\n      const plans = await storage.getPlans();\n      res.json({ plans });\n    } catch (error: any) {\n      res.status(500).json({ message: error.message });\n    }\n  });\n\n  // Get all features\n  app.get(\"/api/features\", async (req, res) => {\n    try {\n      const features = await storage.getFeatures();\n      res.json({ features });\n    } catch (error: any) {\n      res.status(500).json({ message: error.message });\n    }\n  });\n\n  // Create feature (admin only)\n  app.post(\"/api/features\", requireAuth, async (req, res) => {\n    try {\n      const user = await storage.getUser(req.session.userId!);\n      if (user?.role !== \"admin\") {\n        return res.status(403).json({ message: \"Forbidden\" });\n      }\n      const data = insertFeatureSchema.parse(req.body);\n      const feature = await storage.createFeature(data);\n      res.status(201).json({ feature });\n    } catch (error: any) {\n      res.status(400).json({ message: error.message });\n    }\n  });\n\n  // Create plan (admin only)\n  app.post(\"/api/plans\", requireAuth, async (req, res) => {\n    try {\n      const user = await storage.getUser(req.session.userId!);\n      if (user?.role !== \"admin\") {\n        return res.status(403).json({ message: \"Forbidden\" });\n      }\n\n      const data = insertPlanSchema.parse(req.body);\n      const plan = await storage.createPlan(data);\n      res.status(201).json({ plan });\n    } catch (error: any) {\n      res.status(400).json({ message: error.message });\n    }\n  });\n\n  // Update plan (admin only)\n  app.patch(\"/api/plans/:id\", requireAuth, async (req, res) => {\n    try {\n      const user = await storage.getUser(req.session.userId!);\n      if (user?.role !== \"admin\") {\n        return res.status(403).json({ message: \"Forbidden\" });\n      }\n\n      const updatedPlan = await storage.updatePlan(req.params.id, req.body);\n      if (!updatedPlan) {\n        return res.status(404).json({ message: \"Plan not found\" });\n      }\n      res.json({ plan: updatedPlan });\n    } catch (error: any) {\n      res.status(400).json({ message: error.message });\n    }\n  });\n\n  // Delete plan (admin only)\n  app.delete(\"/api/plans/:id\", requireAuth, async (req, res) => {\n    try {\n      const user = await storage.getUser(req.session.userId!);\n      if (user?.role !== \"admin\") {\n        return res.status(403).json({ message: \"Forbidden\" });\n      }\n\n      const success = await storage.deletePlan(req.params.id);\n      if (!success) {\n        return res.status(404).json({ message: \"Plan not found\" });\n      }\n      res.json({ message: \"Plan deleted successfully\" });\n    } catch (error: any) {\n      res.status(500).json({ message: error.message });\n    }\n  });\n}\n","path":null,"size_bytes":29270,"size_tokens":null},"client/src/pages/not-found.tsx":{"content":"import { Card, CardContent } from \"@/components/ui/card\";\nimport { AlertCircle } from \"lucide-react\";\n\nexport default function NotFound() {\n  return (\n    <div className=\"min-h-screen w-full flex items-center justify-center bg-gray-50\">\n      <Card className=\"w-full max-w-md mx-4\">\n        <CardContent className=\"pt-6\">\n          <div className=\"flex mb-4 gap-2\">\n            <AlertCircle className=\"h-8 w-8 text-red-500\" />\n            <h1 className=\"text-2xl font-bold text-gray-900\">404 Page Not Found</h1>\n          </div>\n\n          <p className=\"mt-4 text-sm text-gray-600\">\n            Did you forget to add the page to the router?\n          </p>\n        </CardContent>\n      </Card>\n    </div>\n  );\n}\n","path":null,"size_bytes":711,"size_tokens":null},"drizzle.config.ts":{"content":"import { defineConfig } from \"drizzle-kit\";\n\nif (!process.env.DATABASE_URL) {\n  throw new Error(\"DATABASE_URL, ensure the database is provisioned\");\n}\n\nexport default defineConfig({\n  out: \"./migrations\",\n  schema: \"./shared/schema.ts\",\n  dialect: \"postgresql\",\n  dbCredentials: {\n    url: process.env.DATABASE_URL,\n  },\n});\n","path":null,"size_bytes":325,"size_tokens":null},"vite.config.ts":{"content":"import { defineConfig } from \"vite\";\nimport react from \"@vitejs/plugin-react\";\nimport tailwindcss from \"@tailwindcss/vite\";\nimport path from \"path\";\nimport runtimeErrorOverlay from \"@replit/vite-plugin-runtime-error-modal\";\nimport { metaImagesPlugin } from \"./vite-plugin-meta-images\";\n\nexport default defineConfig({\n  plugins: [\n    react(),\n    runtimeErrorOverlay(),\n    tailwindcss(),\n    metaImagesPlugin(),\n    ...(process.env.NODE_ENV !== \"production\" &&\n    process.env.REPL_ID !== undefined\n      ? [\n          await import(\"@replit/vite-plugin-cartographer\").then((m) =>\n            m.cartographer(),\n          ),\n          await import(\"@replit/vite-plugin-dev-banner\").then((m) =>\n            m.devBanner(),\n          ),\n        ]\n      : []),\n  ],\n  resolve: {\n    alias: {\n      \"@\": path.resolve(import.meta.dirname, \"client\", \"src\"),\n      \"@shared\": path.resolve(import.meta.dirname, \"shared\"),\n      \"@assets\": path.resolve(import.meta.dirname, \"attached_assets\"),\n    },\n  },\n  css: {\n    postcss: {\n      plugins: [],\n    },\n  },\n  root: path.resolve(import.meta.dirname, \"client\"),\n  base: process.env.NODE_ENV === \"production\" ? \"/aiagent/\" : \"/\",\n  build: {\n    outDir: path.resolve(import.meta.dirname, \"dist/public\"),\n    emptyOutDir: true,\n  },\n  server: {\n    host: \"0.0.0.0\",\n    allowedHosts: true,\n    fs: {\n      strict: true,\n      deny: [\"**/.*\"],\n    },\n  },\n});\n","path":null,"size_bytes":1397,"size_tokens":null},"client/src/components/ui/switch.tsx":{"content":"import * as React from \"react\"\nimport * as SwitchPrimitives from \"@radix-ui/react-switch\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Switch = React.forwardRef<\n  React.ElementRef<typeof SwitchPrimitives.Root>,\n  React.ComponentPropsWithoutRef<typeof SwitchPrimitives.Root>\n>(({ className, ...props }, ref) => (\n  <SwitchPrimitives.Root\n    className={cn(\n      \"peer inline-flex h-5 w-9 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent shadow-sm transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input\",\n      className\n    )}\n    {...props}\n    ref={ref}\n  >\n    <SwitchPrimitives.Thumb\n      className={cn(\n        \"pointer-events-none block h-4 w-4 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-4 data-[state=unchecked]:translate-x-0\"\n      )}\n    />\n  </SwitchPrimitives.Root>\n))\nSwitch.displayName = SwitchPrimitives.Root.displayName\n\nexport { Switch }\n","path":null,"size_bytes":1148,"size_tokens":null},"client/src/pages/how-it-works.tsx":{"content":"import { motion } from \"framer-motion\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { UploadCloud, BrainCircuit, PhoneCall, MessageCircle, LayoutDashboard, ArrowRight } from \"lucide-react\";\nimport { Link } from \"wouter\";\nimport { Button } from \"@/components/ui/button\";\n\nconst steps = [\n  {\n    id: 1,\n    title: \"Upload Data & Campaign Setup\",\n    description: \"Clients upload a CSV with phone numbers and PDFs to set up a new campaign.\",\n    icon: UploadCloud,\n    color: \"bg-orange-500\",\n    details: \"Import your leads and documentation in seconds. Our system handles data cleaning and formatting automatically.\"\n  },\n  {\n    id: 2,\n    title: \"AI Training & Scheduling\",\n    description: \"NIJVOX's AI gets trained on PDFs/FAQs and the client schedules auto-calls.\",\n    icon: BrainCircuit,\n    color: \"bg-orange-500\",\n    details: \"Our advanced RAG system absorbs your business knowledge, ensuring the AI represents your brand accurately.\"\n  },\n  {\n    id: 3,\n    title: \"AI Calling & Lead Qualification\",\n    description: \"NIJVOX's AI starts calling, interacts with users, and qualifies leads based on responses.\",\n    icon: PhoneCall,\n    color: \"bg-orange-500\",\n    details: \"Natural-sounding conversations that handle objections and extract key information from prospects.\"\n  },\n  {\n    id: 4,\n    title: \"AI WhatsApp & SMS Follow-Up\",\n    description: \"AI continues conversation on WhatsApp or sends DLT-compliant SMS messages.\",\n    icon: MessageCircle,\n    color: \"bg-orange-500\",\n    details: \"Multi-channel engagement ensures no lead goes cold. High delivery rates through verified routes.\"\n  },\n  {\n    id: 5,\n    title: \"CRM Dashboard & Human Handoff\",\n    description: \"Clients track leads, listen to recordings, and handover hot leads to human agents.\",\n    icon: LayoutDashboard,\n    color: \"bg-orange-500\",\n    details: \"Real-time analytics and seamless handoff to your sales team for the final closing.\"\n  }\n];\n\nexport default function HowItWorks() {\n  return (\n    <div className=\"flex flex-col min-h-screen bg-background\">\n      {/* Hero Section */}\n      <section className=\"relative pt-24 pb-16 overflow-hidden border-b\">\n        <div className=\"absolute inset-0 z-0 opacity-10\">\n          <div className=\"absolute top-0 left-1/2 -translate-x-1/2 w-[800px] h-[400px] bg-primary rounded-full blur-[120px]\" />\n        </div>\n        \n        <div className=\"container relative z-10 mx-auto px-4 text-center\">\n          <motion.div\n            initial={{ opacity: 0, y: 20 }}\n            animate={{ opacity: 1, y: 0 }}\n            transition={{ duration: 0.6 }}\n          >\n            <Badge variant=\"outline\" className=\"mb-4 border-primary/50 text-primary px-4 py-1\">\n              Platform Workflow\n            </Badge>\n            <h1 className=\"text-4xl md:text-6xl font-bold tracking-tight mb-6\">\n              How <span className=\"text-primary\">NIJVOX</span> Works\n            </h1>\n            <p className=\"text-xl text-muted-foreground max-w-2xl mx-auto leading-relaxed\">\n              From CSV Upload to AI Calls, WhatsApp, and SMS Follow-Ups, \n              NIJVOX Automates Communication Like Never Before!\n            </p>\n          </motion.div>\n        </div>\n      </section>\n\n      {/* Process Steps */}\n      <section className=\"py-24\">\n        <div className=\"container mx-auto px-4\">\n          <div className=\"relative\">\n            {/* Connection Line (Desktop) */}\n            <div className=\"hidden lg:block absolute top-[60px] left-[10%] right-[10%] h-0.5 bg-gradient-to-r from-orange-500/20 via-orange-500 to-orange-500/20 z-0\" />\n            \n            <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-8 relative z-10\">\n              {steps.map((step, index) => (\n                <motion.div\n                  key={step.id}\n                  initial={{ opacity: 0, y: 20 }}\n                  whileInView={{ opacity: 1, y: 0 }}\n                  transition={{ delay: index * 0.1 }}\n                  viewport={{ once: true }}\n                >\n                  <div className=\"flex flex-col items-center text-center group\">\n                    <div className={`w-14 h-14 ${step.color} rounded-full flex items-center justify-center text-white font-bold text-xl mb-6 shadow-lg shadow-orange-500/30 group-hover:scale-110 transition-transform`}>\n                      {step.id}\n                    </div>\n                    <div className=\"bg-card border-2 border-primary/5 rounded-2xl p-6 hover:border-primary/20 transition-colors h-full shadow-sm\">\n                      <div className=\"w-12 h-12 rounded-xl bg-primary/10 flex items-center justify-center mb-4 mx-auto\">\n                        <step.icon className=\"h-6 w-6 text-primary\" />\n                      </div>\n                      <h3 className=\"font-bold text-lg mb-3 leading-tight\">{step.title}</h3>\n                      <p className=\"text-sm text-muted-foreground leading-relaxed\">\n                        {step.description}\n                      </p>\n                    </div>\n                    {index < steps.length - 1 && (\n                      <div className=\"lg:hidden mt-4 text-primary/30\">\n                        <ArrowRight className=\"rotate-90 md:rotate-0\" />\n                      </div>\n                    )}\n                  </div>\n                </motion.div>\n              ))}\n            </div>\n          </div>\n        </div>\n      </section>\n\n      {/* Deep Dive Section */}\n      <section className=\"py-24 bg-muted/30 border-y\">\n        <div className=\"container mx-auto px-4\">\n          <div className=\"max-w-4xl mx-auto space-y-24\">\n            {steps.map((step, index) => (\n              <div \n                key={step.id} \n                className={`flex flex-col md:flex-row gap-12 items-center ${index % 2 === 1 ? 'md:flex-row-reverse' : ''}`}\n              >\n                <div className=\"flex-1 space-y-6\">\n                  <div className=\"inline-flex items-center gap-2 px-3 py-1 rounded-full bg-primary/10 text-primary text-sm font-bold\">\n                    <span className=\"w-6 h-6 rounded-full bg-primary text-white flex items-center justify-center text-xs\">\n                      {step.id}\n                    </span>\n                    Step {step.id}\n                  </div>\n                  <h2 className=\"text-3xl font-bold\">{step.title}</h2>\n                  <p className=\"text-lg text-muted-foreground leading-relaxed italic\">\n                    \"{step.description}\"\n                  </p>\n                  <p className=\"text-muted-foreground text-lg\">\n                    {step.details}\n                  </p>\n                </div>\n                <div className=\"flex-1 w-full max-w-sm\">\n                  <Card className=\"border-4 border-background shadow-2xl overflow-hidden aspect-square bg-muted flex items-center justify-center\">\n                    <step.icon className=\"w-32 h-32 text-primary/20\" />\n                  </Card>\n                </div>\n              </div>\n            ))}\n          </div>\n        </div>\n      </section>\n\n      {/* Final CTA */}\n      <section className=\"py-24 bg-primary text-primary-foreground text-center\">\n        <div className=\"container mx-auto px-4\">\n          <h2 className=\"text-3xl md:text-5xl font-bold mb-8\">Experience the future of calling</h2>\n          <Link href=\"/register\">\n            <Button size=\"lg\" variant=\"secondary\" className=\"h-14 px-10 text-lg rounded-full\">\n              Get Started for Free\n            </Button>\n          </Link>\n        </div>\n      </section>\n    </div>\n  );\n}\n","path":null,"size_bytes":7634,"size_tokens":null},"client/src/components/layout/navbar.tsx":{"content":"import { Link, useLocation } from \"wouter\";\nimport { useTheme } from \"@/components/theme-provider\";\nimport { Button } from \"@/components/ui/button\";\nimport { Moon, Sun, Menu, X, Phone } from \"lucide-react\";\nimport { useState } from \"react\";\nimport { Sheet, SheetContent, SheetTrigger } from \"@/components/ui/sheet\";\n\nexport function Navbar() {\n  const { setTheme, theme } = useTheme();\n  const [location] = useLocation();\n  const isDashboard = location.startsWith(\"/dashboard\") || location.startsWith(\"/admin\") || location.startsWith(\"/aiagent/dashboard\") || location.startsWith(\"/aiagent/admin\");\n\n  if (isDashboard) return null;\n\n  const NavLink = ({ href, children }: { href: string; children: React.ReactNode }) => (\n    <Link href={href} className={`text-sm font-medium transition-colors hover:text-primary ${location === href ? \"text-primary\" : \"text-muted-foreground\"}`}>\n      {children}\n    </Link>\n  );\n\n  return (\n    <header className=\"sticky top-0 z-50 w-full border-b bg-background/80 backdrop-blur-md supports-[backdrop-filter]:bg-background/60\">\n      <div className=\"container mx-auto flex h-16 items-center justify-between px-4\">\n        <Link href=\"/\" className=\"flex items-center gap-2 text-xl font-bold tracking-tighter hover:opacity-80 transition-opacity\">\n            <div className=\"flex h-8 w-8 items-center justify-center rounded-lg bg-primary text-primary-foreground\">\n              <Phone className=\"h-4 w-4\" />\n            </div>\n            <span>NIJVOX</span>\n        </Link>\n\n        {/* Desktop Nav */}\n        <nav className=\"hidden md:flex items-center gap-8\">\n          <NavLink href=\"/\">Home</NavLink>\n          <NavLink href=\"/how-it-works\">How It Works</NavLink>\n          <NavLink href=\"/features\">Features</NavLink>\n          <NavLink href=\"/pricing\">Pricing</NavLink>\n          <NavLink href=\"/about\">About</NavLink>\n          <NavLink href=\"/contact\">Contact</NavLink>\n        </nav>\n\n        <div className=\"hidden md:flex items-center gap-4\">\n          <Button\n            variant=\"ghost\"\n            size=\"icon\"\n            onClick={() => setTheme(theme === \"dark\" ? \"light\" : \"dark\")}\n          >\n            <Sun className=\"h-5 w-5 rotate-0 scale-100 transition-all dark:-rotate-90 dark:scale-0\" />\n            <Moon className=\"absolute h-5 w-5 rotate-90 scale-0 transition-all dark:rotate-0 dark:scale-100\" />\n            <span className=\"sr-only\">Toggle theme</span>\n          </Button>\n          <Link href=\"/login\">\n            <Button variant=\"ghost\">Login</Button>\n          </Link>\n          <Link href=\"/register\">\n            <Button>Get Started</Button>\n          </Link>\n        </div>\n\n        {/* Mobile Nav */}\n        <div className=\"md:hidden flex items-center gap-2\">\n           <Button\n            variant=\"ghost\"\n            size=\"icon\"\n            onClick={() => setTheme(theme === \"dark\" ? \"light\" : \"dark\")}\n          >\n            <Sun className=\"h-5 w-5 rotate-0 scale-100 transition-all dark:-rotate-90 dark:scale-0\" />\n            <Moon className=\"absolute h-5 w-5 rotate-90 scale-0 transition-all dark:rotate-0 dark:scale-100\" />\n          </Button>\n          \n          <Sheet>\n            <SheetTrigger asChild>\n              <Button variant=\"ghost\" size=\"icon\">\n                <Menu className=\"h-5 w-5\" />\n              </Button>\n            </SheetTrigger>\n            <SheetContent>\n              <div className=\"flex flex-col gap-4 mt-8\">\n                <Link href=\"/\" className=\"text-lg font-medium\">Home</Link>\n                <Link href=\"/how-it-works\" className=\"text-lg font-medium\">How It Works</Link>\n                <Link href=\"/features\" className=\"text-lg font-medium\">Features</Link>\n                <Link href=\"/pricing\" className=\"text-lg font-medium\">Pricing</Link>\n                <Link href=\"/about\" className=\"text-lg font-medium\">About</Link>\n                <Link href=\"/contact\" className=\"text-lg font-medium\">Contact</Link>\n                <div className=\"h-px bg-border my-2\" />\n                <Link href=\"/login\"><Button variant=\"outline\" className=\"w-full\">Login</Button></Link>\n                <Link href=\"/register\"><Button className=\"w-full\">Get Started</Button></Link>\n              </div>\n            </SheetContent>\n          </Sheet>\n        </div>\n      </div>\n    </header>\n  );\n}\n","path":null,"size_bytes":4299,"size_tokens":null},"client/src/components/ui/resizable.tsx":{"content":"\"use client\"\n\nimport { GripVertical } from \"lucide-react\"\nimport * as ResizablePrimitive from \"react-resizable-panels\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ResizablePanelGroup = ({\n  className,\n  ...props\n}: React.ComponentProps<typeof ResizablePrimitive.PanelGroup>) => (\n  <ResizablePrimitive.PanelGroup\n    className={cn(\n      \"flex h-full w-full data-[panel-group-direction=vertical]:flex-col\",\n      className\n    )}\n    {...props}\n  />\n)\n\nconst ResizablePanel = ResizablePrimitive.Panel\n\nconst ResizableHandle = ({\n  withHandle,\n  className,\n  ...props\n}: React.ComponentProps<typeof ResizablePrimitive.PanelResizeHandle> & {\n  withHandle?: boolean\n}) => (\n  <ResizablePrimitive.PanelResizeHandle\n    className={cn(\n      \"relative flex w-px items-center justify-center bg-border after:absolute after:inset-y-0 after:left-1/2 after:w-1 after:-translate-x-1/2 focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring focus-visible:ring-offset-1 data-[panel-group-direction=vertical]:h-px data-[panel-group-direction=vertical]:w-full data-[panel-group-direction=vertical]:after:left-0 data-[panel-group-direction=vertical]:after:h-1 data-[panel-group-direction=vertical]:after:w-full data-[panel-group-direction=vertical]:after:-translate-y-1/2 data-[panel-group-direction=vertical]:after:translate-x-0 [&[data-panel-group-direction=vertical]>div]:rotate-90\",\n      className\n    )}\n    {...props}\n  >\n    {withHandle && (\n      <div className=\"z-10 flex h-4 w-3 items-center justify-center rounded-sm border bg-border\">\n        <GripVertical className=\"h-2.5 w-2.5\" />\n      </div>\n    )}\n  </ResizablePrimitive.PanelResizeHandle>\n)\n\nexport { ResizablePanelGroup, ResizablePanel, ResizableHandle }\n","path":null,"size_bytes":1723,"size_tokens":null},"aiagent-deployment.tar/aiagent-deployment/DEPLOYMENT_GUIDE.md":{"content":"# AIAgent Application - Production Deployment Guide\n\n## Server Details\n- **Server**: AWS EC2 Instance\n- **IP Address**: 3.208.52.220\n- **URL**: http://3.208.52.220/aiagent/\n- **Installation Path**: /home/ubuntu/aiagent/\n- **Web Server**: Apache with mod_proxy\n\n---\n\n## Prerequisites\n\nEnsure the following are installed on your EC2 instance:\n- Node.js (v18 or higher)\n- Apache web server (httpd)\n- Apache modules: mod_proxy, mod_proxy_http, mod_headers\n- MongoDB connection (cloud or local)\n\n### Install Node.js (if not already installed):\n```bash\ncurl -fsSL https://deb.nodesource.com/setup_18.x | sudo -E bash -\nsudo apt-get install -y nodejs\n```\n\n### Enable Apache modules:\n```bash\nsudo a2enmod proxy\nsudo a2enmod proxy_http\nsudo a2enmod headers\nsudo a2enmod deflate\nsudo systemctl restart apache2\n```\n\n---\n\n## Deployment Steps\n\n### 1. Extract and Setup Application Files\n\n```bash\n# Create application directory\nsudo mkdir -p /home/ubuntu/aiagent\ncd /home/ubuntu/aiagent\n\n# Extract the deployment package\nsudo tar -xzf aiagent-deployment.tar.gz -C /home/ubuntu/aiagent/\n\n# Set proper permissions\nsudo chown -R ubuntu:ubuntu /home/ubuntu/aiagent\nchmod +x /home/ubuntu/aiagent/start.sh\nchmod +x /home/ubuntu/aiagent/stop.sh\n```\n\n### 2. Configure Environment Variables\n\n```bash\n# Edit the environment file with your settings\nnano /home/ubuntu/aiagent/.env.production\n```\n\n**Required Environment Variables:**\n- `MONGODB_URI` - Your MongoDB connection string\n- `SESSION_SECRET` - Generate a secure random string for sessions\n- `NODE_ENV` - Set to \"production\"\n- `PORT` - Set to 5000 (used internally, Apache proxies it)\n\n**Example .env.production:**\n```\nNODE_ENV=production\nPORT=5000\nMONGODB_URI=mongodb+srv://user:password@cluster.mongodb.net/aiagent?retryWrites=true&w=majority\nSESSION_SECRET=your-very-long-random-string-here-min-32-chars\n```\n\n### 3. Install Dependencies\n\n```bash\ncd /home/ubuntu/aiagent\nnpm install --only=production\n```\n\n### 4. Configure Apache\n\n```bash\n# Copy Apache configuration\nsudo cp /home/ubuntu/aiagent/aiagent.conf /etc/apache2/sites-available/aiagent.conf\n\n# Enable the site\nsudo a2ensite aiagent.conf\n\n# Test Apache configuration\nsudo apache2ctl configtest\n\n# Restart Apache\nsudo systemctl restart apache2\n```\n\n### 5. Start the Application\n\n```bash\ncd /home/ubuntu/aiagent\n./start.sh\n```\n\n**Verify the application is running:**\n```bash\n# Check if process is running\nps aux | grep \"node dist/index.cjs\"\n\n# Check logs\ntail -f /home/ubuntu/aiagent/app.log\n\n# Test the endpoint\ncurl http://localhost:5000/api/auth/me\n```\n\n### 6. Access the Application\n\nOpen your browser and navigate to:\n```\nhttp://3.208.52.220/aiagent/\n```\n\n---\n\n## Managing the Application\n\n### Start Application:\n```bash\n/home/ubuntu/aiagent/start.sh\n```\n\n### Stop Application:\n```bash\n/home/ubuntu/aiagent/stop.sh\n```\n\n### View Live Logs:\n```bash\ntail -f /home/ubuntu/aiagent/app.log\n```\n\n### Check Application Status:\n```bash\nps aux | grep \"node dist/index.cjs\"\ncat /home/ubuntu/aiagent/app.pid\n```\n\n### Restart Application:\n```bash\n/home/ubuntu/aiagent/stop.sh\nsleep 2\n/home/ubuntu/aiagent/start.sh\n```\n\n---\n\n## Production Considerations\n\n### 1. Enable HTTPS (SSL/TLS)\n```bash\n# Install Certbot\nsudo apt-get install -y certbot python3-certbot-apache\n\n# Get SSL certificate\nsudo certbot --apache -d 3.208.52.220\n\n# Auto-renewal is enabled by default\n```\n\n### 2. Setup Process Manager (PM2) - Recommended for Production\n```bash\n# Install PM2 globally\nsudo npm install -g pm2\n\n# Create PM2 ecosystem file\ncat > /home/ubuntu/aiagent/ecosystem.config.js << 'EOF'\nmodule.exports = {\n  apps: [{\n    name: 'aiagent',\n    script: './dist/index.cjs',\n    cwd: '/home/ubuntu/aiagent',\n    env: {\n      NODE_ENV: 'production',\n      PORT: 5000\n    },\n    autorestart: true,\n    max_memory_restart: '1G',\n    error_file: './pm2-error.log',\n    out_file: './pm2-out.log'\n  }]\n};\nEOF\n\n# Start with PM2\ncd /home/ubuntu/aiagent\npm2 start ecosystem.config.js\n\n# Save PM2 configuration to restart on reboot\npm2 startup\npm2 save\n```\n\n### 3. Firewall Configuration\n```bash\nsudo ufw allow 22/tcp    # SSH\nsudo ufw allow 80/tcp    # HTTP\nsudo ufw allow 443/tcp   # HTTPS\nsudo ufw enable\n```\n\n### 4. Monitor Disk Space\n```bash\ndf -h\n# Make sure /home/ubuntu has adequate space for logs and uploads\n```\n\n### 5. Regular Backups\n- Database backups (MongoDB)\n- Upload files backup (if stored locally)\n- Configuration files backup\n\n---\n\n## Troubleshooting\n\n### Application won't start\n1. Check logs: `tail -f /home/ubuntu/aiagent/app.log`\n2. Verify .env.production has correct values\n3. Check MongoDB connection: `mongosh \"mongodb+srv://...\"`\n4. Ensure Node.js is in PATH: `which node`\n\n### Apache proxy issues\n1. Check Apache is running: `sudo systemctl status apache2`\n2. Check Apache logs: `sudo tail -f /var/log/apache2/aiagent_error.log`\n3. Verify proxy modules: `apache2ctl -M | grep proxy`\n4. Test internal connection: `curl http://127.0.0.1:5000/`\n\n### High memory usage\n1. Check node process: `ps aux | grep node`\n2. Use PM2 for automatic memory management\n3. Review logs for errors causing memory leaks\n\n### Database connection errors\n1. Verify MongoDB URI is correct\n2. Check MongoDB credentials\n3. Ensure EC2 security group allows MongoDB port (27017 for local, or your cloud DB IP whitelist)\n\n---\n\n## Performance Optimization\n\n### 1. Enable Compression\nAlready configured in Apache (aiagent.conf)\n\n### 2. Setup Redis for Sessions (Optional)\n```bash\nsudo apt-get install -y redis-server\nsudo systemctl enable redis-server\nsudo systemctl start redis-server\n```\n\n### 3. Configure CloudFront (Optional)\n- Create CloudFront distribution pointing to 3.208.52.220\n- Cache /aiagent/assets/ and /uploads/\n- Purge cache on new deployments\n\n---\n\n## Updating the Application\n\nTo deploy a new version:\n\n```bash\n# Stop the application\n/home/ubuntu/aiagent/stop.sh\n\n# Backup current version (optional)\ntar -czf /home/ubuntu/aiagent-backup-$(date +%s).tar.gz /home/ubuntu/aiagent/dist\n\n# Extract new build\ntar -xzf aiagent-deployment.tar.gz -C /home/ubuntu/aiagent/\n\n# Install/update dependencies\ncd /home/ubuntu/aiagent\nnpm install --only=production\n\n# Start the application\n./start.sh\n```\n\n---\n\n## Useful Commands Reference\n\n```bash\n# Check application status\nsystemctl status aiagent\n\n# View all logs\nless /home/ubuntu/aiagent/app.log\n\n# Check port usage\nlsof -i :5000\n\n# Monitor resource usage\ntop -p $(cat /home/ubuntu/aiagent/app.pid)\n\n# Reload Apache config without restart\nsudo apache2ctl reload\n\n# Check MongoDB connection\nmongosh \"your-mongodb-uri\"\n\n# Clean up old logs\nfind /home/ubuntu/aiagent -name \"*.log\" -mtime +30 -delete\n```\n\n---\n\n## Support & Maintenance\n\n- Monitor application logs regularly\n- Keep Node.js and dependencies updated\n- Set up log rotation to prevent disk space issues\n- Regular database backups\n- Monitor CPU and memory usage\n- Setup alerts for application crashes\n\n---\n\n**Deployment completed! Your AIAgent application is now live at http://3.208.52.220/aiagent/**\n","path":null,"size_bytes":6968,"size_tokens":null},"client/src/pages/contact.tsx":{"content":"import { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport { Card, CardContent, CardHeader, CardTitle, CardDescription } from \"@/components/ui/card\";\nimport { Mail, Phone, MapPin } from \"lucide-react\";\n\nexport default function Contact() {\n  return (\n    <div className=\"flex flex-col min-h-screen\">\n      <section className=\"py-24 bg-muted/10\">\n        <div className=\"container mx-auto px-4 text-center\">\n          <h1 className=\"text-4xl md:text-6xl font-bold mb-6\">\n            Get in <span className=\"text-primary\">Touch</span>\n          </h1>\n          <p className=\"text-xl text-muted-foreground max-w-2xl mx-auto\">\n            Have questions about enterprise plans? Need a custom demo? We're here to help.\n          </p>\n        </div>\n      </section>\n\n      <section className=\"py-16\">\n        <div className=\"container mx-auto px-4\">\n          <div className=\"grid md:grid-cols-2 gap-12 max-w-5xl mx-auto\">\n            {/* Contact Info */}\n            <div className=\"space-y-8\">\n              <Card>\n                <CardHeader>\n                  <CardTitle className=\"flex items-center gap-3\">\n                    <Mail className=\"h-5 w-5 text-primary\" /> Sales\n                  </CardTitle>\n                </CardHeader>\n                <CardContent>\n                  <p className=\"text-muted-foreground mb-2\">For demo requests and pricing inquiries:</p>\n                  <a href=\"mailto:sales@aiagent.com\" className=\"text-lg font-medium hover:text-primary transition-colors\">sales@aiagent.com</a>\n                </CardContent>\n              </Card>\n\n              <Card>\n                <CardHeader>\n                  <CardTitle className=\"flex items-center gap-3\">\n                    <Phone className=\"h-5 w-5 text-primary\" /> Support\n                  </CardTitle>\n                </CardHeader>\n                <CardContent>\n                  <p className=\"text-muted-foreground mb-2\">For technical assistance:</p>\n                  <a href=\"tel:+18005550123\" className=\"text-lg font-medium hover:text-primary transition-colors\">+1 (800) 555-0123</a>\n                </CardContent>\n              </Card>\n\n              <Card>\n                <CardHeader>\n                  <CardTitle className=\"flex items-center gap-3\">\n                    <MapPin className=\"h-5 w-5 text-primary\" /> HQ\n                  </CardTitle>\n                </CardHeader>\n                <CardContent>\n                  <p className=\"text-muted-foreground\">\n                    123 Tech Plaza, Suite 400<br/>\n                    San Francisco, CA 94105\n                  </p>\n                </CardContent>\n              </Card>\n            </div>\n\n            {/* Contact Form */}\n            <div>\n              <Card className=\"h-full\">\n                <CardHeader>\n                  <CardTitle>Send us a message</CardTitle>\n                  <CardDescription>We usually respond within 2 hours during business days.</CardDescription>\n                </CardHeader>\n                <CardContent>\n                  <form className=\"space-y-4\" onSubmit={(e) => e.preventDefault()}>\n                    <div className=\"grid grid-cols-2 gap-4\">\n                      <div className=\"space-y-2\">\n                        <label className=\"text-sm font-medium\">First Name</label>\n                        <Input placeholder=\"John\" />\n                      </div>\n                      <div className=\"space-y-2\">\n                        <label className=\"text-sm font-medium\">Last Name</label>\n                        <Input placeholder=\"Doe\" />\n                      </div>\n                    </div>\n                    <div className=\"space-y-2\">\n                      <label className=\"text-sm font-medium\">Email</label>\n                      <Input type=\"email\" placeholder=\"john@company.com\" />\n                    </div>\n                    <div className=\"space-y-2\">\n                      <label className=\"text-sm font-medium\">Message</label>\n                      <Textarea placeholder=\"Tell us about your needs...\" className=\"min-h-[150px]\" />\n                    </div>\n                    <Button type=\"submit\" className=\"w-full\">SendMessage</Button>\n                  </form>\n                </CardContent>\n              </Card>\n            </div>\n          </div>\n        </div>\n      </section>\n    </div>\n  );\n}\n","path":null,"size_bytes":4418,"size_tokens":null},"client/src/components/ui/spinner.tsx":{"content":"import { Loader2Icon } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nfunction Spinner({ className, ...props }: React.ComponentProps<\"svg\">) {\n  return (\n    <Loader2Icon\n      role=\"status\"\n      aria-label=\"Loading\"\n      className={cn(\"size-4 animate-spin\", className)}\n      {...props}\n    />\n  )\n}\n\nexport { Spinner }\n","path":null,"size_bytes":331,"size_tokens":null},"client/src/components/ui/kbd.tsx":{"content":"import { cn } from \"@/lib/utils\"\n\nfunction Kbd({ className, ...props }: React.ComponentProps<\"kbd\">) {\n  return (\n    <kbd\n      data-slot=\"kbd\"\n      className={cn(\n        \"bg-muted text-muted-foreground pointer-events-none inline-flex h-5 w-fit min-w-5 select-none items-center justify-center gap-1 rounded-sm px-1 font-sans text-xs font-medium\",\n        \"[&_svg:not([class*='size-'])]:size-3\",\n        \"[[data-slot=tooltip-content]_&]:bg-background/20 [[data-slot=tooltip-content]_&]:text-background dark:[[data-slot=tooltip-content]_&]:bg-background/10\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction KbdGroup({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <kbd\n      data-slot=\"kbd-group\"\n      className={cn(\"inline-flex items-center gap-1\", className)}\n      {...props}\n    />\n  )\n}\n\nexport { Kbd, KbdGroup }\n","path":null,"size_bytes":862,"size_tokens":null},"client/src/pages/pricing.tsx":{"content":"import { useQuery } from \"@tanstack/react-query\";\nimport { type Plan, type Feature } from \"@shared/schema\";\nimport { Check, X, Loader2, Phone, MessageSquare, MessageCircle } from \"lucide-react\";\nimport { Accordion, AccordionContent, AccordionItem, AccordionTrigger } from \"@/components/ui/accordion\";\nimport { Button } from \"@/components/ui/button\";\nimport { \n  Table, \n  TableBody, \n  TableCell, \n  TableHead, \n  TableHeader, \n  TableRow \n} from \"@/components/ui/table\";\nimport { Card, CardContent } from \"@/components/ui/card\";\nimport { useLocation } from \"wouter\";\n\nexport default function Pricing() {\n  const [, setLocation] = useLocation();\n  const { data: plansResponse, isLoading: plansLoading } = useQuery<{ plans: Plan[] } | Plan[]>({ \n    queryKey: [\"/api/plans\"],\n    queryFn: async () => {\n      const isProduction = import.meta.env.PROD || window.location.hostname === '3.208.52.220';\n      const basePath = isProduction ? '/aiagent' : (import.meta.env.BASE_URL || '/');\n      const base = basePath.endsWith('/') ? basePath.slice(0, -1) : basePath;\n      const url = `${base}/api/plans`;\n      console.log('Fetching plans from:', url);\n      const response = await fetch(url);\n      if (!response.ok) throw new Error(\"Failed to fetch plans\");\n      return response.json();\n    }\n  });\n  const { data: featuresResponse, isLoading: featuresLoading } = useQuery<{ features: Feature[] } | Feature[]>({ \n    queryKey: [\"/api/features\"],\n    queryFn: async () => {\n      const isProduction = import.meta.env.PROD || window.location.hostname === '3.208.52.220';\n      const basePath = isProduction ? '/aiagent' : (import.meta.env.BASE_URL || '/');\n      const base = basePath.endsWith('/') ? basePath.slice(0, -1) : basePath;\n      const url = `${base}/api/features`;\n      console.log('Fetching features from:', url);\n      const response = await fetch(url);\n      if (!response.ok) throw new Error(\"Failed to fetch features\");\n      return response.json();\n    }\n  });\n\n  const plans = Array.isArray(plansResponse) ? plansResponse : (plansResponse && 'plans' in plansResponse ? plansResponse.plans : []);\n  const features = Array.isArray(featuresResponse) ? featuresResponse : (featuresResponse && 'features' in featuresResponse ? featuresResponse.features : []);\n\n  const handleGetStarted = (planId: string) => {\n    setLocation(`/register?plan=${planId}`);\n  };\n\n  if (plansLoading || featuresLoading) {\n    return (\n      <div className=\"flex items-center justify-center min-h-screen\">\n        <Loader2 className=\"h-8 w-8 animate-spin text-primary\" />\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"flex flex-col min-h-screen\">\n      <section className=\"py-24 bg-muted/10\">\n        <div className=\"container mx-auto px-4 text-center\">\n          <h1 className=\"text-4xl md:text-6xl font-bold mb-6\">\n            Simple, <span className=\"text-primary\">Transparent</span> Pricing\n          </h1>\n          <p className=\"text-xl text-muted-foreground max-w-2xl mx-auto mb-10\">\n            No hidden fees. Scale as you grow. Cancel anytime.\n          </p>\n        </div>\n      </section>\n\n      <section className=\"py-12\">\n        <div className=\"container mx-auto px-4 overflow-x-auto\">\n          <Card className=\"max-w-6xl mx-auto border-none shadow-none bg-transparent\">\n            <CardContent className=\"p-0\">\n              <Table className=\"border-collapse\">\n                <TableHeader>\n                  <TableRow className=\"hover:bg-transparent border-b-2\">\n                    <TableHead className=\"w-[300px] text-lg font-bold py-6\">Features</TableHead>\n                    {plans.map((plan) => (\n                      <TableHead key={plan._id} className=\"text-center py-6\">\n                        <div className=\"space-y-2\">\n                          <div className=\"text-xl font-bold text-foreground\">{plan.name}</div>\n                          <div className=\"text-3xl font-bold text-primary\">â‚¹{plan.price}</div>\n                          <div className=\"text-sm text-muted-foreground capitalize\">{plan.duration}</div>\n                          <Button \n                            size=\"sm\" \n                            className=\"w-full mt-4 hover-elevate active-elevate-2\" \n                            variant={plan.name.toLowerCase().includes('growth') ? 'default' : 'outline'}\n                            onClick={() => handleGetStarted(plan._id)}\n                          >\n                            Get Started\n                          </Button>\n                        </div>\n                      </TableHead>\n                    ))}\n                  </TableRow>\n                </TableHeader>\n                <TableBody>\n                  <TableRow className=\"bg-muted/50\">\n                    <TableCell className=\"font-semibold py-4\">Credits</TableCell>\n                    {plans.map((plan) => (\n                      <TableCell key={plan._id} className=\"text-center font-bold py-4\">\n                        {plan.credits.toLocaleString()}\n                      </TableCell>\n                    ))}\n                  </TableRow>\n                  \n                  {/* Rates Row */}\n                  <TableRow className=\"bg-muted/30\">\n                    <TableCell className=\"font-semibold py-4\">Consumption Rates</TableCell>\n                    {plans.map((plan) => (\n                      <TableCell key={plan._id} className=\"py-4\">\n                        <div className=\"flex flex-col gap-1 items-center text-xs\">\n                          <div className=\"flex items-center gap-1.5\">\n                            <Phone className=\"h-3 w-3 text-primary\" />\n                            <span>â‚¹{plan.callingRate}/min</span>\n                          </div>\n                          <div className=\"flex items-center gap-1.5\">\n                            <MessageSquare className=\"h-3 w-3 text-primary\" />\n                            <span>â‚¹{plan.smsRate}/msg</span>\n                          </div>\n                          <div className=\"flex items-center gap-1.5\">\n                            <MessageCircle className=\"h-3 w-3 text-primary\" />\n                            <span>â‚¹{plan.whatsappRate}/msg</span>\n                          </div>\n                        </div>\n                      </TableCell>\n                    ))}\n                  </TableRow>\n\n                  {features.map((feature) => (\n                    <TableRow key={feature._id} className=\"hover:bg-muted/30 border-b\">\n                      <TableCell className=\"py-4\">\n                        <div className=\"font-medium\">{feature.name}</div>\n                      </TableCell>\n                      {plans.map((plan) => {\n                        const hasFeature = plan.features?.includes(feature.name);\n                        return (\n                          <TableCell key={plan._id} className=\"text-center py-4\">\n                            {hasFeature ? (\n                              <Check className=\"h-5 w-5 text-primary mx-auto\" />\n                            ) : (\n                              <X className=\"h-5 w-5 text-muted-foreground/30 mx-auto\" />\n                            )}\n                          </TableCell>\n                        );\n                      })}\n                    </TableRow>\n                  ))}\n                </TableBody>\n              </Table>\n            </CardContent>\n          </Card>\n        </div>\n      </section>\n\n      <section className=\"py-24 bg-muted/20\">\n        <div className=\"container mx-auto px-4 max-w-3xl\">\n          <h2 className=\"text-3xl font-bold text-center mb-12\">Frequently Asked Questions</h2>\n          <Accordion type=\"single\" collapsible>\n            <AccordionItem value=\"item-1\">\n              <AccordionTrigger>Does the AI really sound human?</AccordionTrigger>\n              <AccordionContent>\n                Yes. We use the latest generative audio models that include breath, pause, and intonation variations. Most prospects cannot tell they are speaking to an AI.\n              </AccordionContent>\n            </AccordionItem>\n            <AccordionItem value=\"item-2\">\n              <AccordionTrigger>Can I upload my own leads?</AccordionTrigger>\n              <AccordionContent>\n                Absolutely. You can upload CSV files or connect your CRM (Salesforce, HubSpot, etc.) to sync leads automatically.\n              </AccordionContent>\n            </AccordionItem>\n            <AccordionItem value=\"item-3\">\n              <AccordionTrigger>Is it legal to use AI for calling?</AccordionTrigger>\n              <AccordionContent>\n                Yes, but you must comply with local regulations like TCPA (in the US). Our platform includes compliance tools to help you manage consent and do-not-call lists.\n              </AccordionContent>\n            </AccordionItem>\n            <AccordionItem value=\"item-4\">\n              <AccordionTrigger>What happens if the AI doesn't know the answer?</AccordionTrigger>\n              <AccordionContent>\n                You can configure \"fallback\" rules. If confidence is low, the AI can politely offer to have a human specialist call back, or transfer the call immediately if a human is available.\n              </AccordionContent>\n            </AccordionItem>\n          </Accordion>\n        </div>\n      </section>\n    </div>\n  );\n}\n","path":null,"size_bytes":9318,"size_tokens":null}},"version":2}